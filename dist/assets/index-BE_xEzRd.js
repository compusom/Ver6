(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function a(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=a(i);fetch(i.href,o)}})();function kp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ou={exports:{}},dl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function gb(){if(g1)return dl;g1=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(s,i,o){var f=null;if(o!==void 0&&(f=""+o),i.key!==void 0&&(f=""+i.key),"key"in i){o={};for(var d in i)d!=="key"&&(o[d]=i[d])}else o=i;return i=o.ref,{$$typeof:e,type:s,key:f,ref:i!==void 0?i:null,props:o}}return dl.Fragment=n,dl.jsx=a,dl.jsxs=a,dl}var v1;function vb(){return v1||(v1=1,Ou.exports=gb()),Ou.exports}var c=vb(),Ru={exports:{}},it={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1;function bb(){if(b1)return it;b1=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),f=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function b(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,_={};function w(H,oe,k){this.props=H,this.context=oe,this.refs=_,this.updater=k||y}w.prototype.isReactComponent={},w.prototype.setState=function(H,oe){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,oe,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function S(){}S.prototype=w.prototype;function D(H,oe,k){this.props=H,this.context=oe,this.refs=_,this.updater=k||y}var A=D.prototype=new S;A.constructor=D,E(A,w.prototype),A.isPureReactComponent=!0;var z=Array.isArray,V={H:null,A:null,T:null,S:null,V:null},Y=Object.prototype.hasOwnProperty;function j(H,oe,k,q,U,R){return k=R.ref,{$$typeof:e,type:H,key:oe,ref:k!==void 0?k:null,props:R}}function Q(H,oe){return j(H.type,oe,void 0,void 0,void 0,H.props)}function B(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function ne(H){var oe={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(k){return oe[k]})}var K=/\/+/g;function X(H,oe){return typeof H=="object"&&H!==null&&H.key!=null?ne(""+H.key):oe.toString(36)}function ee(){}function he(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(ee,ee):(H.status="pending",H.then(function(oe){H.status==="pending"&&(H.status="fulfilled",H.value=oe)},function(oe){H.status==="pending"&&(H.status="rejected",H.reason=oe)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function _e(H,oe,k,q,U){var R=typeof H;(R==="undefined"||R==="boolean")&&(H=null);var W=!1;if(H===null)W=!0;else switch(R){case"bigint":case"string":case"number":W=!0;break;case"object":switch(H.$$typeof){case e:case n:W=!0;break;case p:return W=H._init,_e(W(H._payload),oe,k,q,U)}}if(W)return U=U(H),W=q===""?"."+X(H,0):q,z(U)?(k="",W!=null&&(k=W.replace(K,"$&/")+"/"),_e(U,oe,k,"",function(Se){return Se})):U!=null&&(B(U)&&(U=Q(U,k+(U.key==null||H&&H.key===U.key?"":(""+U.key).replace(K,"$&/")+"/")+W)),oe.push(U)),1;W=0;var pe=q===""?".":q+":";if(z(H))for(var ve=0;ve<H.length;ve++)q=H[ve],R=pe+X(q,ve),W+=_e(q,oe,k,R,U);else if(ve=b(H),typeof ve=="function")for(H=ve.call(H),ve=0;!(q=H.next()).done;)q=q.value,R=pe+X(q,ve++),W+=_e(q,oe,k,R,U);else if(R==="object"){if(typeof H.then=="function")return _e(he(H),oe,k,q,U);throw oe=String(H),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return W}function Z(H,oe,k){if(H==null)return H;var q=[],U=0;return _e(H,q,"","",function(R){return oe.call(k,R,U++)}),q}function ue(H){if(H._status===-1){var oe=H._result;oe=oe(),oe.then(function(k){(H._status===0||H._status===-1)&&(H._status=1,H._result=k)},function(k){(H._status===0||H._status===-1)&&(H._status=2,H._result=k)}),H._status===-1&&(H._status=0,H._result=oe)}if(H._status===1)return H._result.default;throw H._result}var Re=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function te(){}return it.Children={map:Z,forEach:function(H,oe,k){Z(H,function(){oe.apply(this,arguments)},k)},count:function(H){var oe=0;return Z(H,function(){oe++}),oe},toArray:function(H){return Z(H,function(oe){return oe})||[]},only:function(H){if(!B(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},it.Component=w,it.Fragment=a,it.Profiler=i,it.PureComponent=D,it.StrictMode=s,it.Suspense=x,it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,it.__COMPILER_RUNTIME={__proto__:null,c:function(H){return V.H.useMemoCache(H)}},it.cache=function(H){return function(){return H.apply(null,arguments)}},it.cloneElement=function(H,oe,k){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var q=E({},H.props),U=H.key,R=void 0;if(oe!=null)for(W in oe.ref!==void 0&&(R=void 0),oe.key!==void 0&&(U=""+oe.key),oe)!Y.call(oe,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&oe.ref===void 0||(q[W]=oe[W]);var W=arguments.length-2;if(W===1)q.children=k;else if(1<W){for(var pe=Array(W),ve=0;ve<W;ve++)pe[ve]=arguments[ve+2];q.children=pe}return j(H.type,U,void 0,void 0,R,q)},it.createContext=function(H){return H={$$typeof:f,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:o,_context:H},H},it.createElement=function(H,oe,k){var q,U={},R=null;if(oe!=null)for(q in oe.key!==void 0&&(R=""+oe.key),oe)Y.call(oe,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(U[q]=oe[q]);var W=arguments.length-2;if(W===1)U.children=k;else if(1<W){for(var pe=Array(W),ve=0;ve<W;ve++)pe[ve]=arguments[ve+2];U.children=pe}if(H&&H.defaultProps)for(q in W=H.defaultProps,W)U[q]===void 0&&(U[q]=W[q]);return j(H,R,void 0,void 0,null,U)},it.createRef=function(){return{current:null}},it.forwardRef=function(H){return{$$typeof:d,render:H}},it.isValidElement=B,it.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:ue}},it.memo=function(H,oe){return{$$typeof:m,type:H,compare:oe===void 0?null:oe}},it.startTransition=function(H){var oe=V.T,k={};V.T=k;try{var q=H(),U=V.S;U!==null&&U(k,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(te,Re)}catch(R){Re(R)}finally{V.T=oe}},it.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},it.use=function(H){return V.H.use(H)},it.useActionState=function(H,oe,k){return V.H.useActionState(H,oe,k)},it.useCallback=function(H,oe){return V.H.useCallback(H,oe)},it.useContext=function(H){return V.H.useContext(H)},it.useDebugValue=function(){},it.useDeferredValue=function(H,oe){return V.H.useDeferredValue(H,oe)},it.useEffect=function(H,oe,k){var q=V.H;if(typeof k=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return q.useEffect(H,oe)},it.useId=function(){return V.H.useId()},it.useImperativeHandle=function(H,oe,k){return V.H.useImperativeHandle(H,oe,k)},it.useInsertionEffect=function(H,oe){return V.H.useInsertionEffect(H,oe)},it.useLayoutEffect=function(H,oe){return V.H.useLayoutEffect(H,oe)},it.useMemo=function(H,oe){return V.H.useMemo(H,oe)},it.useOptimistic=function(H,oe){return V.H.useOptimistic(H,oe)},it.useReducer=function(H,oe,k){return V.H.useReducer(H,oe,k)},it.useRef=function(H){return V.H.useRef(H)},it.useState=function(H){return V.H.useState(H)},it.useSyncExternalStore=function(H,oe,k){return V.H.useSyncExternalStore(H,oe,k)},it.useTransition=function(){return V.H.useTransition()},it.version="19.1.1",it}var y1;function uf(){return y1||(y1=1,Ru.exports=bb()),Ru.exports}var se=uf();const yb=kp(se);var ju={exports:{}},hl={},Mu={exports:{}},Lu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E1;function Eb(){return E1||(E1=1,function(e){function n(Z,ue){var Re=Z.length;Z.push(ue);e:for(;0<Re;){var te=Re-1>>>1,H=Z[te];if(0<i(H,ue))Z[te]=ue,Z[Re]=H,Re=te;else break e}}function a(Z){return Z.length===0?null:Z[0]}function s(Z){if(Z.length===0)return null;var ue=Z[0],Re=Z.pop();if(Re!==ue){Z[0]=Re;e:for(var te=0,H=Z.length,oe=H>>>1;te<oe;){var k=2*(te+1)-1,q=Z[k],U=k+1,R=Z[U];if(0>i(q,Re))U<H&&0>i(R,q)?(Z[te]=R,Z[U]=Re,te=U):(Z[te]=q,Z[k]=Re,te=k);else if(U<H&&0>i(R,Re))Z[te]=R,Z[U]=Re,te=U;else break e}}return ue}function i(Z,ue){var Re=Z.sortIndex-ue.sortIndex;return Re!==0?Re:Z.id-ue.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var f=Date,d=f.now();e.unstable_now=function(){return f.now()-d}}var x=[],m=[],p=1,v=null,b=3,y=!1,E=!1,_=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function z(Z){for(var ue=a(m);ue!==null;){if(ue.callback===null)s(m);else if(ue.startTime<=Z)s(m),ue.sortIndex=ue.expirationTime,n(x,ue);else break;ue=a(m)}}function V(Z){if(_=!1,z(Z),!E)if(a(x)!==null)E=!0,Y||(Y=!0,X());else{var ue=a(m);ue!==null&&_e(V,ue.startTime-Z)}}var Y=!1,j=-1,Q=5,B=-1;function ne(){return w?!0:!(e.unstable_now()-B<Q)}function K(){if(w=!1,Y){var Z=e.unstable_now();B=Z;var ue=!0;try{e:{E=!1,_&&(_=!1,D(j),j=-1),y=!0;var Re=b;try{t:{for(z(Z),v=a(x);v!==null&&!(v.expirationTime>Z&&ne());){var te=v.callback;if(typeof te=="function"){v.callback=null,b=v.priorityLevel;var H=te(v.expirationTime<=Z);if(Z=e.unstable_now(),typeof H=="function"){v.callback=H,z(Z),ue=!0;break t}v===a(x)&&s(x),z(Z)}else s(x);v=a(x)}if(v!==null)ue=!0;else{var oe=a(m);oe!==null&&_e(V,oe.startTime-Z),ue=!1}}break e}finally{v=null,b=Re,y=!1}ue=void 0}}finally{ue?X():Y=!1}}}var X;if(typeof A=="function")X=function(){A(K)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,he=ee.port2;ee.port1.onmessage=K,X=function(){he.postMessage(null)}}else X=function(){S(K,0)};function _e(Z,ue){j=S(function(){Z(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Z){switch(b){case 1:case 2:case 3:var ue=3;break;default:ue=b}var Re=b;b=ue;try{return Z()}finally{b=Re}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(Z,ue){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Re=b;b=Z;try{return ue()}finally{b=Re}},e.unstable_scheduleCallback=function(Z,ue,Re){var te=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?te+Re:te):Re=te,Z){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Re+H,Z={id:p++,callback:ue,priorityLevel:Z,startTime:Re,expirationTime:H,sortIndex:-1},Re>te?(Z.sortIndex=Re,n(m,Z),a(x)===null&&Z===a(m)&&(_?(D(j),j=-1):_=!0,_e(V,Re-te))):(Z.sortIndex=H,n(x,Z),E||y||(E=!0,Y||(Y=!0,X()))),Z},e.unstable_shouldYield=ne,e.unstable_wrapCallback=function(Z){var ue=b;return function(){var Re=b;b=ue;try{return Z.apply(this,arguments)}finally{b=Re}}}}(Lu)),Lu}var _1;function _b(){return _1||(_1=1,Mu.exports=Eb()),Mu.exports}var Fu={exports:{}},ya={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1;function wb(){if(w1)return ya;w1=1;var e=uf();function n(x){var m="https://react.dev/errors/"+x;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+x+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(x,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:x,containerInfo:m,implementation:p}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(x,m){if(x==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ya.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ya.createPortal=function(x,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(n(299));return o(x,m,null,p)},ya.flushSync=function(x){var m=f.T,p=s.p;try{if(f.T=null,s.p=2,x)return x()}finally{f.T=m,s.p=p,s.d.f()}},ya.preconnect=function(x,m){typeof x=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(x,m))},ya.prefetchDNS=function(x){typeof x=="string"&&s.d.D(x)},ya.preinit=function(x,m){if(typeof x=="string"&&m&&typeof m.as=="string"){var p=m.as,v=d(p,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,y=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?s.d.S(x,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:y}):p==="script"&&s.d.X(x,{crossOrigin:v,integrity:b,fetchPriority:y,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ya.preinitModule=function(x,m){if(typeof x=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=d(m.as,m.crossOrigin);s.d.M(x,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(x)},ya.preload=function(x,m){if(typeof x=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=d(p,m.crossOrigin);s.d.L(x,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ya.preloadModule=function(x,m){if(typeof x=="string")if(m){var p=d(m.as,m.crossOrigin);s.d.m(x,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(x)},ya.requestFormReset=function(x){s.d.r(x)},ya.unstable_batchedUpdates=function(x,m){return x(m)},ya.useFormState=function(x,m,p){return f.H.useFormState(x,m,p)},ya.useFormStatus=function(){return f.H.useHostTransitionStatus()},ya.version="19.1.1",ya}var T1;function Tb(){if(T1)return Fu.exports;T1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Fu.exports=wb(),Fu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S1;function Sb(){if(S1)return hl;S1=1;var e=_b(),n=uf(),a=Tb();function s(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function o(t){var r=t,l=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(l=r.return),t=r.return;while(t)}return r.tag===3?l:null}function f(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function d(t){if(o(t)!==t)throw Error(s(188))}function x(t){var r=t.alternate;if(!r){if(r=o(t),r===null)throw Error(s(188));return r!==t?null:t}for(var l=t,u=r;;){var h=l.return;if(h===null)break;var g=h.alternate;if(g===null){if(u=h.return,u!==null){l=u;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===l)return d(h),t;if(g===u)return d(h),r;g=g.sibling}throw Error(s(188))}if(l.return!==u.return)l=h,u=g;else{for(var T=!1,C=h.child;C;){if(C===l){T=!0,l=h,u=g;break}if(C===u){T=!0,u=h,l=g;break}C=C.sibling}if(!T){for(C=g.child;C;){if(C===l){T=!0,l=g,u=h;break}if(C===u){T=!0,u=g,l=h;break}C=C.sibling}if(!T)throw Error(s(189))}}if(l.alternate!==u)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?t:r}function m(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=m(t),r!==null)return r;t=t.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),A=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),ne=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function X(t){return t===null||typeof t!="object"?null:(t=K&&t[K]||t["@@iterator"],typeof t=="function"?t:null)}var ee=Symbol.for("react.client.reference");function he(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===ee?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case E:return"Fragment";case w:return"Profiler";case _:return"StrictMode";case V:return"Suspense";case Y:return"SuspenseList";case B:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case y:return"Portal";case A:return(t.displayName||"Context")+".Provider";case D:return(t._context.displayName||"Context")+".Consumer";case z:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case j:return r=t.displayName||null,r!==null?r:he(t.type)||"Memo";case Q:r=t._payload,t=t._init;try{return he(t(r))}catch{}}return null}var _e=Array.isArray,Z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},te=[],H=-1;function oe(t){return{current:t}}function k(t){0>H||(t.current=te[H],te[H]=null,H--)}function q(t,r){H++,te[H]=t.current,t.current=r}var U=oe(null),R=oe(null),W=oe(null),pe=oe(null);function ve(t,r){switch(q(W,r),q(R,t),q(U,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?Yx(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=Yx(r),t=Xx(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}k(U),q(U,t)}function Se(){k(U),k(R),k(W)}function we(t){t.memoizedState!==null&&q(pe,t);var r=U.current,l=Xx(r,t.type);r!==l&&(q(R,t),q(U,l))}function Be(t){R.current===t&&(k(U),k(R)),pe.current===t&&(k(pe),ll._currentValue=Re)}var I=Object.prototype.hasOwnProperty,Pe=e.unstable_scheduleCallback,Ue=e.unstable_cancelCallback,We=e.unstable_shouldYield,Ve=e.unstable_requestPaint,ge=e.unstable_now,Ie=e.unstable_getCurrentPriorityLevel,pt=e.unstable_ImmediatePriority,ye=e.unstable_UserBlockingPriority,je=e.unstable_NormalPriority,lt=e.unstable_LowPriority,Ge=e.unstable_IdlePriority,rt=e.log,Nt=e.unstable_setDisableYieldValue,ct=null,nt=null;function Ce(t){if(typeof rt=="function"&&Nt(t),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(ct,t)}catch{}}var Je=Math.clz32?Math.clz32:wt,De=Math.log,ze=Math.LN2;function wt(t){return t>>>=0,t===0?32:31-(De(t)/ze|0)|0}var Et=256,Pt=4194304;function $a(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function sn(t,r,l){var u=t.pendingLanes;if(u===0)return 0;var h=0,g=t.suspendedLanes,T=t.pingedLanes;t=t.warmLanes;var C=u&134217727;return C!==0?(u=C&~g,u!==0?h=$a(u):(T&=C,T!==0?h=$a(T):l||(l=C&~t,l!==0&&(h=$a(l))))):(C=u&~g,C!==0?h=$a(C):T!==0?h=$a(T):l||(l=u&~t,l!==0&&(h=$a(l)))),h===0?0:r!==0&&r!==h&&(r&g)===0&&(g=h&-h,l=r&-r,g>=l||g===32&&(l&4194048)!==0)?r:h}function Ir(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function _s(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pn(){var t=Et;return Et<<=1,(Et&4194048)===0&&(Et=256),t}function Hn(){var t=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),t}function zn(t){for(var r=[],l=0;31>l;l++)r.push(t);return r}function Sr(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function ln(t,r,l,u,h,g){var T=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var C=t.entanglements,G=t.expirationTimes,le=t.hiddenUpdates;for(l=T&~l;0<l;){var Ee=31-Je(l),Ae=1<<Ee;C[Ee]=0,G[Ee]=-1;var de=le[Ee];if(de!==null)for(le[Ee]=null,Ee=0;Ee<de.length;Ee++){var me=de[Ee];me!==null&&(me.lane&=-536870913)}l&=~Ae}u!==0&&ws(t,u,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(T&~r))}function ws(t,r,l){t.pendingLanes|=r,t.suspendedLanes&=~r;var u=31-Je(r);t.entangledLanes|=r,t.entanglements[u]=t.entanglements[u]|1073741824|l&4194090}function Ts(t,r){var l=t.entangledLanes|=r;for(t=t.entanglements;l;){var u=31-Je(l),h=1<<u;h&r|t[u]&r&&(t[u]|=r),l&=~h}}function Vn(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Ht(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ss(){var t=ue.p;return t!==0?t:(t=window.event,t===void 0?32:f1(t.type))}function As(t,r){var l=ue.p;try{return ue.p=t,r()}finally{ue.p=l}}var dr=Math.random().toString(36).slice(2),Xt="__reactFiber$"+dr,$t="__reactProps$"+dr,hr="__reactContainer$"+dr,Ye="__reactEvents$"+dr,ot="__reactListeners$"+dr,N="__reactHandles$"+dr,L="__reactResources$"+dr,O="__reactMarker$"+dr;function M(t){delete t[Xt],delete t[$t],delete t[Ye],delete t[ot],delete t[N]}function F(t){var r=t[Xt];if(r)return r;for(var l=t.parentNode;l;){if(r=l[hr]||l[Xt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(t=$x(t);t!==null;){if(l=t[Xt])return l;t=$x(t)}return r}t=l,l=t.parentNode}return null}function P(t){if(t=t[Xt]||t[hr]){var r=t.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return t}return null}function ce(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(s(33))}function be(t){var r=t[L];return r||(r=t[L]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function re(t){t[O]=!0}var fe=new Set,xe={};function Ne(t,r){Oe(t,r),Oe(t+"Capture",r)}function Oe(t,r){for(xe[t]=r,t=0;t<r.length;t++)fe.add(r[t])}var Le=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ke={},Me={};function tt(t){return I.call(Me,t)?!0:I.call(ke,t)?!1:Le.test(t)?Me[t]=!0:(ke[t]=!0,!1)}function Ct(t,r,l){if(tt(r))if(l===null)t.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+l)}}function kt(t,r,l){if(l===null)t.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+l)}}function Mt(t,r,l,u){if(u===null)t.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(r,l,""+u)}}var Br,cn;function Za(t){if(Br===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Br=r&&r[1]||"",cn=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Br+t+cn}var xr=!1;function Gn(t,r){if(!t||xr)return"";xr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var Ae=function(){throw Error()};if(Object.defineProperty(Ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ae,[])}catch(me){var de=me}Reflect.construct(t,[],Ae)}else{try{Ae.call()}catch(me){de=me}t.call(Ae.prototype)}}else{try{throw Error()}catch(me){de=me}(Ae=t())&&typeof Ae.catch=="function"&&Ae.catch(function(){})}}catch(me){if(me&&de&&typeof me.stack=="string")return[me.stack,de.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),T=g[0],C=g[1];if(T&&C){var G=T.split(`
`),le=C.split(`
`);for(h=u=0;u<G.length&&!G[u].includes("DetermineComponentFrameRoot");)u++;for(;h<le.length&&!le[h].includes("DetermineComponentFrameRoot");)h++;if(u===G.length||h===le.length)for(u=G.length-1,h=le.length-1;1<=u&&0<=h&&G[u]!==le[h];)h--;for(;1<=u&&0<=h;u--,h--)if(G[u]!==le[h]){if(u!==1||h!==1)do if(u--,h--,0>h||G[u]!==le[h]){var Ee=`
`+G[u].replace(" at new "," at ");return t.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",t.displayName)),Ee}while(1<=u&&0<=h);break}}}finally{xr=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?Za(l):""}function mr(t){switch(t.tag){case 26:case 27:case 5:return Za(t.type);case 16:return Za("Lazy");case 13:return Za("Suspense");case 19:return Za("SuspenseList");case 0:case 15:return Gn(t.type,!1);case 11:return Gn(t.type.render,!1);case 1:return Gn(t.type,!0);case 31:return Za("Activity");default:return""}}function Uf(t){try{var r="";do r+=mr(t),t=t.return;while(t);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Qa(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Pf(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function d2(t){var r=Pf(t)?"checked":"value",l=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),u=""+t[r];if(!t.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,g=l.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return h.call(this)},set:function(T){u=""+T,g.call(this,T)}}),Object.defineProperty(t,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Gl(t){t._valueTracker||(t._valueTracker=d2(t))}function Hf(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return t&&(u=Pf(t)?t.checked?"true":"false":t.value),t=u,t!==l?(r.setValue(t),!0):!1}function Yl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var h2=/[\n"\\]/g;function Ja(t){return t.replace(h2,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Co(t,r,l,u,h,g,T,C){t.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.type=T:t.removeAttribute("type"),r!=null?T==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+Qa(r)):t.value!==""+Qa(r)&&(t.value=""+Qa(r)):T!=="submit"&&T!=="reset"||t.removeAttribute("value"),r!=null?ko(t,T,Qa(r)):l!=null?ko(t,T,Qa(l)):u!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?t.name=""+Qa(C):t.removeAttribute("name")}function zf(t,r,l,u,h,g,T,C){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),r!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||r!=null))return;l=l!=null?""+Qa(l):"",r=r!=null?""+Qa(r):l,C||r===t.value||(t.value=r),t.defaultValue=r}u=u??h,u=typeof u!="function"&&typeof u!="symbol"&&!!u,t.checked=C?t.checked:!!u,t.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(t.name=T)}function ko(t,r,l){r==="number"&&Yl(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function Ns(t,r,l,u){if(t=t.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<t.length;l++)h=r.hasOwnProperty("$"+t[l].value),t[l].selected!==h&&(t[l].selected=h),h&&u&&(t[l].defaultSelected=!0)}else{for(l=""+Qa(l),r=null,h=0;h<t.length;h++){if(t[h].value===l){t[h].selected=!0,u&&(t[h].defaultSelected=!0);return}r!==null||t[h].disabled||(r=t[h])}r!==null&&(r.selected=!0)}}function Vf(t,r,l){if(r!=null&&(r=""+Qa(r),r!==t.value&&(t.value=r),l==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=l!=null?""+Qa(l):""}function Gf(t,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(s(92));if(_e(u)){if(1<u.length)throw Error(s(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Qa(r),t.defaultValue=l,u=t.textContent,u===l&&u!==""&&u!==null&&(t.value=u)}function Cs(t,r){if(r){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=r;return}}t.textContent=r}var x2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yf(t,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":u?t.setProperty(r,l):typeof l!="number"||l===0||x2.has(r)?r==="float"?t.cssFloat=l:t[r]=(""+l).trim():t[r]=l+"px"}function Xf(t,r,l){if(r!=null&&typeof r!="object")throw Error(s(62));if(t=t.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?t.setProperty(u,""):u==="float"?t.cssFloat="":t[u]="");for(var h in r)u=r[h],r.hasOwnProperty(h)&&l[h]!==u&&Yf(t,h,u)}else for(var g in r)r.hasOwnProperty(g)&&Yf(t,g,r[g])}function Do(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var m2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),p2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xl(t){return p2.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Oo=null;function Ro(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ks=null,Ds=null;function qf(t){var r=P(t);if(r&&(t=r.stateNode)){var l=t[$t]||null;e:switch(t=r.stateNode,r.type){case"input":if(Co(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ja(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==t&&u.form===t.form){var h=u[$t]||null;if(!h)throw Error(s(90));Co(u,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===t.form&&Hf(u)}break e;case"textarea":Vf(t,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Ns(t,!!l.multiple,r,!1)}}}var jo=!1;function Kf(t,r,l){if(jo)return t(r,l);jo=!0;try{var u=t(r);return u}finally{if(jo=!1,(ks!==null||Ds!==null)&&(Oc(),ks&&(r=ks,t=Ds,Ds=ks=null,qf(r),t)))for(r=0;r<t.length;r++)qf(t[r])}}function yi(t,r){var l=t.stateNode;if(l===null)return null;var u=l[$t]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(s(231,r,typeof l));return l}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mo=!1;if(Ur)try{var Ei={};Object.defineProperty(Ei,"passive",{get:function(){Mo=!0}}),window.addEventListener("test",Ei,Ei),window.removeEventListener("test",Ei,Ei)}catch{Mo=!1}var on=null,Lo=null,ql=null;function Wf(){if(ql)return ql;var t,r=Lo,l=r.length,u,h="value"in on?on.value:on.textContent,g=h.length;for(t=0;t<l&&r[t]===h[t];t++);var T=l-t;for(u=1;u<=T&&r[l-u]===h[g-u];u++);return ql=h.slice(t,1<u?1-u:void 0)}function Kl(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Wl(){return!0}function $f(){return!1}function Ma(t){function r(l,u,h,g,T){this._reactName=l,this._targetInst=h,this.type=u,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var C in t)t.hasOwnProperty(C)&&(l=t[C],this[C]=l?l(g):g[C]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Wl:$f,this.isPropagationStopped=$f,this}return p(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Wl)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Wl)},persist:function(){},isPersistent:Wl}),r}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$l=Ma(Yn),_i=p({},Yn,{view:0,detail:0}),g2=Ma(_i),Fo,Io,wi,Zl=p({},_i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uo,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wi&&(wi&&t.type==="mousemove"?(Fo=t.screenX-wi.screenX,Io=t.screenY-wi.screenY):Io=Fo=0,wi=t),Fo)},movementY:function(t){return"movementY"in t?t.movementY:Io}}),Zf=Ma(Zl),v2=p({},Zl,{dataTransfer:0}),b2=Ma(v2),y2=p({},_i,{relatedTarget:0}),Bo=Ma(y2),E2=p({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),_2=Ma(E2),w2=p({},Yn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),T2=Ma(w2),S2=p({},Yn,{data:0}),Qf=Ma(S2),A2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k2(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=C2[t])?!!r[t]:!1}function Uo(){return k2}var D2=p({},_i,{key:function(t){if(t.key){var r=A2[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Kl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?N2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uo,charCode:function(t){return t.type==="keypress"?Kl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Kl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),O2=Ma(D2),R2=p({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jf=Ma(R2),j2=p({},_i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uo}),M2=Ma(j2),L2=p({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),F2=Ma(L2),I2=p({},Zl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),B2=Ma(I2),U2=p({},Yn,{newState:0,oldState:0}),P2=Ma(U2),H2=[9,13,27,32],Po=Ur&&"CompositionEvent"in window,Ti=null;Ur&&"documentMode"in document&&(Ti=document.documentMode);var z2=Ur&&"TextEvent"in window&&!Ti,ed=Ur&&(!Po||Ti&&8<Ti&&11>=Ti),td=" ",ad=!1;function rd(t,r){switch(t){case"keyup":return H2.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Os=!1;function V2(t,r){switch(t){case"compositionend":return nd(r);case"keypress":return r.which!==32?null:(ad=!0,td);case"textInput":return t=r.data,t===td&&ad?null:t;default:return null}}function G2(t,r){if(Os)return t==="compositionend"||!Po&&rd(t,r)?(t=Wf(),ql=Lo=on=null,Os=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ed&&r.locale!=="ko"?null:r.data;default:return null}}var Y2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sd(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!Y2[t.type]:r==="textarea"}function id(t,r,l,u){ks?Ds?Ds.push(u):Ds=[u]:ks=u,r=Ic(r,"onChange"),0<r.length&&(l=new $l("onChange","change",null,l,u),t.push({event:l,listeners:r}))}var Si=null,Ai=null;function X2(t){Px(t,0)}function Ql(t){var r=ce(t);if(Hf(r))return t}function ld(t,r){if(t==="change")return r}var cd=!1;if(Ur){var Ho;if(Ur){var zo="oninput"in document;if(!zo){var od=document.createElement("div");od.setAttribute("oninput","return;"),zo=typeof od.oninput=="function"}Ho=zo}else Ho=!1;cd=Ho&&(!document.documentMode||9<document.documentMode)}function ud(){Si&&(Si.detachEvent("onpropertychange",fd),Ai=Si=null)}function fd(t){if(t.propertyName==="value"&&Ql(Ai)){var r=[];id(r,Ai,t,Ro(t)),Kf(X2,r)}}function q2(t,r,l){t==="focusin"?(ud(),Si=r,Ai=l,Si.attachEvent("onpropertychange",fd)):t==="focusout"&&ud()}function K2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ql(Ai)}function W2(t,r){if(t==="click")return Ql(r)}function $2(t,r){if(t==="input"||t==="change")return Ql(r)}function Z2(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Ua=typeof Object.is=="function"?Object.is:Z2;function Ni(t,r){if(Ua(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var l=Object.keys(t),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var h=l[u];if(!I.call(r,h)||!Ua(t[h],r[h]))return!1}return!0}function dd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hd(t,r){var l=dd(t);t=0;for(var u;l;){if(l.nodeType===3){if(u=t+l.textContent.length,t<=r&&u>=r)return{node:l,offset:r-t};t=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=dd(l)}}function xd(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?xd(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function md(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Yl(t.document);r instanceof t.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)t=r.contentWindow;else break;r=Yl(t.document)}return r}function Vo(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var Q2=Ur&&"documentMode"in document&&11>=document.documentMode,Rs=null,Go=null,Ci=null,Yo=!1;function pd(t,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Yo||Rs==null||Rs!==Yl(u)||(u=Rs,"selectionStart"in u&&Vo(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ci&&Ni(Ci,u)||(Ci=u,u=Ic(Go,"onSelect"),0<u.length&&(r=new $l("onSelect","select",null,r,l),t.push({event:r,listeners:u}),r.target=Rs)))}function Xn(t,r){var l={};return l[t.toLowerCase()]=r.toLowerCase(),l["Webkit"+t]="webkit"+r,l["Moz"+t]="moz"+r,l}var js={animationend:Xn("Animation","AnimationEnd"),animationiteration:Xn("Animation","AnimationIteration"),animationstart:Xn("Animation","AnimationStart"),transitionrun:Xn("Transition","TransitionRun"),transitionstart:Xn("Transition","TransitionStart"),transitioncancel:Xn("Transition","TransitionCancel"),transitionend:Xn("Transition","TransitionEnd")},Xo={},gd={};Ur&&(gd=document.createElement("div").style,"AnimationEvent"in window||(delete js.animationend.animation,delete js.animationiteration.animation,delete js.animationstart.animation),"TransitionEvent"in window||delete js.transitionend.transition);function qn(t){if(Xo[t])return Xo[t];if(!js[t])return t;var r=js[t],l;for(l in r)if(r.hasOwnProperty(l)&&l in gd)return Xo[t]=r[l];return t}var vd=qn("animationend"),bd=qn("animationiteration"),yd=qn("animationstart"),J2=qn("transitionrun"),ev=qn("transitionstart"),tv=qn("transitioncancel"),Ed=qn("transitionend"),_d=new Map,qo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qo.push("scrollEnd");function pr(t,r){_d.set(t,r),Ne(r,[t])}var wd=new WeakMap;function er(t,r){if(typeof t=="object"&&t!==null){var l=wd.get(t);return l!==void 0?l:(r={value:t,source:r,stack:Uf(r)},wd.set(t,r),r)}return{value:t,source:r,stack:Uf(r)}}var tr=[],Ms=0,Ko=0;function Jl(){for(var t=Ms,r=Ko=Ms=0;r<t;){var l=tr[r];tr[r++]=null;var u=tr[r];tr[r++]=null;var h=tr[r];tr[r++]=null;var g=tr[r];if(tr[r++]=null,u!==null&&h!==null){var T=u.pending;T===null?h.next=h:(h.next=T.next,T.next=h),u.pending=h}g!==0&&Td(l,h,g)}}function ec(t,r,l,u){tr[Ms++]=t,tr[Ms++]=r,tr[Ms++]=l,tr[Ms++]=u,Ko|=u,t.lanes|=u,t=t.alternate,t!==null&&(t.lanes|=u)}function Wo(t,r,l,u){return ec(t,r,l,u),tc(t)}function Ls(t,r){return ec(t,null,null,r),tc(t)}function Td(t,r,l){t.lanes|=l;var u=t.alternate;u!==null&&(u.lanes|=l);for(var h=!1,g=t.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&r!==null&&(h=31-Je(l),t=g.hiddenUpdates,u=t[h],u===null?t[h]=[r]:u.push(r),r.lane=l|536870912),g):null}function tc(t){if(50<Ji)throw Ji=0,tu=null,Error(s(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var Fs={};function av(t,r,l,u){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pa(t,r,l,u){return new av(t,r,l,u)}function $o(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pr(t,r){var l=t.alternate;return l===null?(l=Pa(t.tag,r,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=r,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,r=t.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function Sd(t,r){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,r=l.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function ac(t,r,l,u,h,g){var T=0;if(u=t,typeof t=="function")$o(t)&&(T=1);else if(typeof t=="string")T=nb(t,l,U.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case B:return t=Pa(31,l,r,h),t.elementType=B,t.lanes=g,t;case E:return Kn(l.children,h,g,r);case _:T=8,h|=24;break;case w:return t=Pa(12,l,r,h|2),t.elementType=w,t.lanes=g,t;case V:return t=Pa(13,l,r,h),t.elementType=V,t.lanes=g,t;case Y:return t=Pa(19,l,r,h),t.elementType=Y,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case S:case A:T=10;break e;case D:T=9;break e;case z:T=11;break e;case j:T=14;break e;case Q:T=16,u=null;break e}T=29,l=Error(s(130,t===null?"null":typeof t,"")),u=null}return r=Pa(T,l,r,h),r.elementType=t,r.type=u,r.lanes=g,r}function Kn(t,r,l,u){return t=Pa(7,t,u,r),t.lanes=l,t}function Zo(t,r,l){return t=Pa(6,t,null,r),t.lanes=l,t}function Qo(t,r,l){return r=Pa(4,t.children!==null?t.children:[],t.key,r),r.lanes=l,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var Is=[],Bs=0,rc=null,nc=0,ar=[],rr=0,Wn=null,Hr=1,zr="";function $n(t,r){Is[Bs++]=nc,Is[Bs++]=rc,rc=t,nc=r}function Ad(t,r,l){ar[rr++]=Hr,ar[rr++]=zr,ar[rr++]=Wn,Wn=t;var u=Hr;t=zr;var h=32-Je(u)-1;u&=~(1<<h),l+=1;var g=32-Je(r)+h;if(30<g){var T=h-h%5;g=(u&(1<<T)-1).toString(32),u>>=T,h-=T,Hr=1<<32-Je(r)+h|l<<h|u,zr=g+t}else Hr=1<<g|l<<h|u,zr=t}function Jo(t){t.return!==null&&($n(t,1),Ad(t,1,0))}function e0(t){for(;t===rc;)rc=Is[--Bs],Is[Bs]=null,nc=Is[--Bs],Is[Bs]=null;for(;t===Wn;)Wn=ar[--rr],ar[rr]=null,zr=ar[--rr],ar[rr]=null,Hr=ar[--rr],ar[rr]=null}var Ca=null,zt=null,Tt=!1,Zn=null,Ar=!1,t0=Error(s(519));function Qn(t){var r=Error(s(418,""));throw Oi(er(r,t)),t0}function Nd(t){var r=t.stateNode,l=t.type,u=t.memoizedProps;switch(r[Xt]=t,r[$t]=u,l){case"dialog":xt("cancel",r),xt("close",r);break;case"iframe":case"object":case"embed":xt("load",r);break;case"video":case"audio":for(l=0;l<tl.length;l++)xt(tl[l],r);break;case"source":xt("error",r);break;case"img":case"image":case"link":xt("error",r),xt("load",r);break;case"details":xt("toggle",r);break;case"input":xt("invalid",r),zf(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Gl(r);break;case"select":xt("invalid",r);break;case"textarea":xt("invalid",r),Gf(r,u.value,u.defaultValue,u.children),Gl(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||Gx(r.textContent,l)?(u.popover!=null&&(xt("beforetoggle",r),xt("toggle",r)),u.onScroll!=null&&xt("scroll",r),u.onScrollEnd!=null&&xt("scrollend",r),u.onClick!=null&&(r.onclick=Bc),r=!0):r=!1,r||Qn(t)}function Cd(t){for(Ca=t.return;Ca;)switch(Ca.tag){case 5:case 13:Ar=!1;return;case 27:case 3:Ar=!0;return;default:Ca=Ca.return}}function ki(t){if(t!==Ca)return!1;if(!Tt)return Cd(t),Tt=!0,!1;var r=t.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||gu(t.type,t.memoizedProps)),l=!l),l&&zt&&Qn(t),Cd(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8)if(l=t.data,l==="/$"){if(r===0){zt=vr(t.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;t=t.nextSibling}zt=null}}else r===27?(r=zt,Sn(t.type)?(t=Eu,Eu=null,zt=t):zt=r):zt=Ca?vr(t.stateNode.nextSibling):null;return!0}function Di(){zt=Ca=null,Tt=!1}function kd(){var t=Zn;return t!==null&&(Ia===null?Ia=t:Ia.push.apply(Ia,t),Zn=null),t}function Oi(t){Zn===null?Zn=[t]:Zn.push(t)}var a0=oe(null),Jn=null,Vr=null;function un(t,r,l){q(a0,r._currentValue),r._currentValue=l}function Gr(t){t._currentValue=a0.current,k(a0)}function r0(t,r,l){for(;t!==null;){var u=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),t===l)break;t=t.return}}function n0(t,r,l,u){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var T=h.child;g=g.firstContext;e:for(;g!==null;){var C=g;g=h;for(var G=0;G<r.length;G++)if(C.context===r[G]){g.lanes|=l,C=g.alternate,C!==null&&(C.lanes|=l),r0(g.return,l,t),u||(T=null);break e}g=C.next}}else if(h.tag===18){if(T=h.return,T===null)throw Error(s(341));T.lanes|=l,g=T.alternate,g!==null&&(g.lanes|=l),r0(T,l,t),T=null}else T=h.child;if(T!==null)T.return=h;else for(T=h;T!==null;){if(T===t){T=null;break}if(h=T.sibling,h!==null){h.return=T.return,T=h;break}T=T.return}h=T}}function Ri(t,r,l,u){t=null;for(var h=r,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var T=h.alternate;if(T===null)throw Error(s(387));if(T=T.memoizedProps,T!==null){var C=h.type;Ua(h.pendingProps.value,T.value)||(t!==null?t.push(C):t=[C])}}else if(h===pe.current){if(T=h.alternate,T===null)throw Error(s(387));T.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(ll):t=[ll])}h=h.return}t!==null&&n0(r,t,l,u),r.flags|=262144}function sc(t){for(t=t.firstContext;t!==null;){if(!Ua(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function es(t){Jn=t,Vr=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ba(t){return Dd(Jn,t)}function ic(t,r){return Jn===null&&es(t),Dd(t,r)}function Dd(t,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},Vr===null){if(t===null)throw Error(s(308));Vr=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Vr=Vr.next=r;return l}var rv=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(l,u){t.push(u)}};this.abort=function(){r.aborted=!0,t.forEach(function(l){return l()})}},nv=e.unstable_scheduleCallback,sv=e.unstable_NormalPriority,aa={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function s0(){return{controller:new rv,data:new Map,refCount:0}}function ji(t){t.refCount--,t.refCount===0&&nv(sv,function(){t.controller.abort()})}var Mi=null,i0=0,Us=0,Ps=null;function iv(t,r){if(Mi===null){var l=Mi=[];i0=0,Us=cu(),Ps={status:"pending",value:void 0,then:function(u){l.push(u)}}}return i0++,r.then(Od,Od),r}function Od(){if(--i0===0&&Mi!==null){Ps!==null&&(Ps.status="fulfilled");var t=Mi;Mi=null,Us=0,Ps=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function lv(t,r){var l=[],u={status:"pending",value:null,reason:null,then:function(h){l.push(h)}};return t.then(function(){u.status="fulfilled",u.value=r;for(var h=0;h<l.length;h++)(0,l[h])(r)},function(h){for(u.status="rejected",u.reason=h,h=0;h<l.length;h++)(0,l[h])(void 0)}),u}var Rd=Z.S;Z.S=function(t,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&iv(t,r),Rd!==null&&Rd(t,r)};var ts=oe(null);function l0(){var t=ts.current;return t!==null?t:Lt.pooledCache}function lc(t,r){r===null?q(ts,ts.current):q(ts,r.pool)}function jd(){var t=l0();return t===null?null:{parent:aa._currentValue,pool:t}}var Li=Error(s(460)),Md=Error(s(474)),cc=Error(s(542)),c0={then:function(){}};function Ld(t){return t=t.status,t==="fulfilled"||t==="rejected"}function oc(){}function Fd(t,r,l){switch(l=t[l],l===void 0?t.push(r):l!==r&&(r.then(oc,oc),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Bd(t),t;default:if(typeof r.status=="string")r.then(oc,oc);else{if(t=Lt,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=r,t.status="pending",t.then(function(u){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=u}},function(u){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Bd(t),t}throw Fi=r,Li}}var Fi=null;function Id(){if(Fi===null)throw Error(s(459));var t=Fi;return Fi=null,t}function Bd(t){if(t===Li||t===cc)throw Error(s(483))}var fn=!1;function o0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function u0(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function dn(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function hn(t,r,l){var u=t.updateQueue;if(u===null)return null;if(u=u.shared,(St&2)!==0){var h=u.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),u.pending=r,r=tc(t),Td(t,null,l),r}return ec(t,u,r,l),tc(t)}function Ii(t,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=t.pendingLanes,l|=u,r.lanes=l,Ts(t,l)}}function f0(t,r){var l=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var h=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?h=g=T:g=g.next=T,l=l.next}while(l!==null);g===null?h=g=r:g=g.next=r}else h=g=r;l={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=r:t.next=r,l.lastBaseUpdate=r}var d0=!1;function Bi(){if(d0){var t=Ps;if(t!==null)throw t}}function Ui(t,r,l,u){d0=!1;var h=t.updateQueue;fn=!1;var g=h.firstBaseUpdate,T=h.lastBaseUpdate,C=h.shared.pending;if(C!==null){h.shared.pending=null;var G=C,le=G.next;G.next=null,T===null?g=le:T.next=le,T=G;var Ee=t.alternate;Ee!==null&&(Ee=Ee.updateQueue,C=Ee.lastBaseUpdate,C!==T&&(C===null?Ee.firstBaseUpdate=le:C.next=le,Ee.lastBaseUpdate=G))}if(g!==null){var Ae=h.baseState;T=0,Ee=le=G=null,C=g;do{var de=C.lane&-536870913,me=de!==C.lane;if(me?(gt&de)===de:(u&de)===de){de!==0&&de===Us&&(d0=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var Ze=t,qe=C;de=r;var Rt=l;switch(qe.tag){case 1:if(Ze=qe.payload,typeof Ze=="function"){Ae=Ze.call(Rt,Ae,de);break e}Ae=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=qe.payload,de=typeof Ze=="function"?Ze.call(Rt,Ae,de):Ze,de==null)break e;Ae=p({},Ae,de);break e;case 2:fn=!0}}de=C.callback,de!==null&&(t.flags|=64,me&&(t.flags|=8192),me=h.callbacks,me===null?h.callbacks=[de]:me.push(de))}else me={lane:de,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Ee===null?(le=Ee=me,G=Ae):Ee=Ee.next=me,T|=de;if(C=C.next,C===null){if(C=h.shared.pending,C===null)break;me=C,C=me.next,me.next=null,h.lastBaseUpdate=me,h.shared.pending=null}}while(!0);Ee===null&&(G=Ae),h.baseState=G,h.firstBaseUpdate=le,h.lastBaseUpdate=Ee,g===null&&(h.shared.lanes=0),En|=T,t.lanes=T,t.memoizedState=Ae}}function Ud(t,r){if(typeof t!="function")throw Error(s(191,t));t.call(r)}function Pd(t,r){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)Ud(l[t],r)}var Hs=oe(null),uc=oe(0);function Hd(t,r){t=Zr,q(uc,t),q(Hs,r),Zr=t|r.baseLanes}function h0(){q(uc,Zr),q(Hs,Hs.current)}function x0(){Zr=uc.current,k(Hs),k(uc)}var xn=0,ut=null,Dt=null,Zt=null,fc=!1,zs=!1,as=!1,dc=0,Pi=0,Vs=null,cv=0;function qt(){throw Error(s(321))}function m0(t,r){if(r===null)return!1;for(var l=0;l<r.length&&l<t.length;l++)if(!Ua(t[l],r[l]))return!1;return!0}function p0(t,r,l,u,h,g){return xn=g,ut=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z.H=t===null||t.memoizedState===null?Th:Sh,as=!1,g=l(u,h),as=!1,zs&&(g=Vd(r,l,u,h)),zd(t),g}function zd(t){Z.H=vc;var r=Dt!==null&&Dt.next!==null;if(xn=0,Zt=Dt=ut=null,fc=!1,Pi=0,Vs=null,r)throw Error(s(300));t===null||ca||(t=t.dependencies,t!==null&&sc(t)&&(ca=!0))}function Vd(t,r,l,u){ut=t;var h=0;do{if(zs&&(Vs=null),Pi=0,zs=!1,25<=h)throw Error(s(301));if(h+=1,Zt=Dt=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Z.H=mv,g=r(l,u)}while(zs);return g}function ov(){var t=Z.H,r=t.useState()[0];return r=typeof r.then=="function"?Hi(r):r,t=t.useState()[0],(Dt!==null?Dt.memoizedState:null)!==t&&(ut.flags|=1024),r}function g0(){var t=dc!==0;return dc=0,t}function v0(t,r,l){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~l}function b0(t){if(fc){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}fc=!1}xn=0,Zt=Dt=ut=null,zs=!1,Pi=dc=0,Vs=null}function La(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?ut.memoizedState=Zt=t:Zt=Zt.next=t,Zt}function Qt(){if(Dt===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=Dt.next;var r=Zt===null?ut.memoizedState:Zt.next;if(r!==null)Zt=r,Dt=t;else{if(t===null)throw ut.alternate===null?Error(s(467)):Error(s(310));Dt=t,t={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Zt===null?ut.memoizedState=Zt=t:Zt=Zt.next=t}return Zt}function y0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hi(t){var r=Pi;return Pi+=1,Vs===null&&(Vs=[]),t=Fd(Vs,t,r),r=ut,(Zt===null?r.memoizedState:Zt.next)===null&&(r=r.alternate,Z.H=r===null||r.memoizedState===null?Th:Sh),t}function hc(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Hi(t);if(t.$$typeof===A)return ba(t)}throw Error(s(438,String(t)))}function E0(t){var r=null,l=ut.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=ut.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=y0(),ut.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(t),u=0;u<t;u++)l[u]=ne;return r.index++,l}function Yr(t,r){return typeof r=="function"?r(t):r}function xc(t){var r=Qt();return _0(r,Dt,t)}function _0(t,r,l){var u=t.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=l;var h=t.baseQueue,g=u.pending;if(g!==null){if(h!==null){var T=h.next;h.next=g.next,g.next=T}r.baseQueue=h=g,u.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{r=h.next;var C=T=null,G=null,le=r,Ee=!1;do{var Ae=le.lane&-536870913;if(Ae!==le.lane?(gt&Ae)===Ae:(xn&Ae)===Ae){var de=le.revertLane;if(de===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Ae===Us&&(Ee=!0);else if((xn&de)===de){le=le.next,de===Us&&(Ee=!0);continue}else Ae={lane:0,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?(C=G=Ae,T=g):G=G.next=Ae,ut.lanes|=de,En|=de;Ae=le.action,as&&l(g,Ae),g=le.hasEagerState?le.eagerState:l(g,Ae)}else de={lane:Ae,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},G===null?(C=G=de,T=g):G=G.next=de,ut.lanes|=Ae,En|=Ae;le=le.next}while(le!==null&&le!==r);if(G===null?T=g:G.next=C,!Ua(g,t.memoizedState)&&(ca=!0,Ee&&(l=Ps,l!==null)))throw l;t.memoizedState=g,t.baseState=T,t.baseQueue=G,u.lastRenderedState=g}return h===null&&(u.lanes=0),[t.memoizedState,u.dispatch]}function w0(t){var r=Qt(),l=r.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=t;var u=l.dispatch,h=l.pending,g=r.memoizedState;if(h!==null){l.pending=null;var T=h=h.next;do g=t(g,T.action),T=T.next;while(T!==h);Ua(g,r.memoizedState)||(ca=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),l.lastRenderedState=g}return[g,u]}function Gd(t,r,l){var u=ut,h=Qt(),g=Tt;if(g){if(l===void 0)throw Error(s(407));l=l()}else l=r();var T=!Ua((Dt||h).memoizedState,l);T&&(h.memoizedState=l,ca=!0),h=h.queue;var C=qd.bind(null,u,h,t);if(zi(2048,8,C,[t]),h.getSnapshot!==r||T||Zt!==null&&Zt.memoizedState.tag&1){if(u.flags|=2048,Gs(9,mc(),Xd.bind(null,u,h,l,r),null),Lt===null)throw Error(s(349));g||(xn&124)!==0||Yd(u,r,l)}return l}function Yd(t,r,l){t.flags|=16384,t={getSnapshot:r,value:l},r=ut.updateQueue,r===null?(r=y0(),ut.updateQueue=r,r.stores=[t]):(l=r.stores,l===null?r.stores=[t]:l.push(t))}function Xd(t,r,l,u){r.value=l,r.getSnapshot=u,Kd(r)&&Wd(t)}function qd(t,r,l){return l(function(){Kd(r)&&Wd(t)})}function Kd(t){var r=t.getSnapshot;t=t.value;try{var l=r();return!Ua(t,l)}catch{return!0}}function Wd(t){var r=Ls(t,2);r!==null&&Ya(r,t,2)}function T0(t){var r=La();if(typeof t=="function"){var l=t;if(t=l(),as){Ce(!0);try{l()}finally{Ce(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:t},r}function $d(t,r,l,u){return t.baseState=l,_0(t,Dt,typeof u=="function"?u:Yr)}function uv(t,r,l,u,h){if(gc(t))throw Error(s(485));if(t=r.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};Z.T!==null?l(!0):g.isTransition=!1,u(g),l=r.pending,l===null?(g.next=r.pending=g,Zd(r,g)):(g.next=l.next,r.pending=l.next=g)}}function Zd(t,r){var l=r.action,u=r.payload,h=t.state;if(r.isTransition){var g=Z.T,T={};Z.T=T;try{var C=l(h,u),G=Z.S;G!==null&&G(T,C),Qd(t,r,C)}catch(le){S0(t,r,le)}finally{Z.T=g}}else try{g=l(h,u),Qd(t,r,g)}catch(le){S0(t,r,le)}}function Qd(t,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Jd(t,r,u)},function(u){return S0(t,r,u)}):Jd(t,r,l)}function Jd(t,r,l){r.status="fulfilled",r.value=l,eh(r),t.state=l,r=t.pending,r!==null&&(l=r.next,l===r?t.pending=null:(l=l.next,r.next=l,Zd(t,l)))}function S0(t,r,l){var u=t.pending;if(t.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,eh(r),r=r.next;while(r!==u)}t.action=null}function eh(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function th(t,r){return r}function ah(t,r){if(Tt){var l=Lt.formState;if(l!==null){e:{var u=ut;if(Tt){if(zt){t:{for(var h=zt,g=Ar;h.nodeType!==8;){if(!g){h=null;break t}if(h=vr(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){zt=vr(h.nextSibling),u=h.data==="F!";break e}}Qn(u)}u=!1}u&&(r=l[0])}}return l=La(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:th,lastRenderedState:r},l.queue=u,l=Eh.bind(null,ut,u),u.dispatch=l,u=T0(!1),g=D0.bind(null,ut,!1,u.queue),u=La(),h={state:r,dispatch:null,action:t,pending:null},u.queue=h,l=uv.bind(null,ut,h,g,l),h.dispatch=l,u.memoizedState=t,[r,l,!1]}function rh(t){var r=Qt();return nh(r,Dt,t)}function nh(t,r,l){if(r=_0(t,r,th)[0],t=xc(Yr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Hi(r)}catch(T){throw T===Li?cc:T}else u=r;r=Qt();var h=r.queue,g=h.dispatch;return l!==r.memoizedState&&(ut.flags|=2048,Gs(9,mc(),fv.bind(null,h,l),null)),[u,g,t]}function fv(t,r){t.action=r}function sh(t){var r=Qt(),l=Dt;if(l!==null)return nh(r,l,t);Qt(),r=r.memoizedState,l=Qt();var u=l.queue.dispatch;return l.memoizedState=t,[r,u,!1]}function Gs(t,r,l,u){return t={tag:t,create:l,deps:u,inst:r,next:null},r=ut.updateQueue,r===null&&(r=y0(),ut.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=t.next=t:(u=l.next,l.next=t,t.next=u,r.lastEffect=t),t}function mc(){return{destroy:void 0,resource:void 0}}function ih(){return Qt().memoizedState}function pc(t,r,l,u){var h=La();u=u===void 0?null:u,ut.flags|=t,h.memoizedState=Gs(1|r,mc(),l,u)}function zi(t,r,l,u){var h=Qt();u=u===void 0?null:u;var g=h.memoizedState.inst;Dt!==null&&u!==null&&m0(u,Dt.memoizedState.deps)?h.memoizedState=Gs(r,g,l,u):(ut.flags|=t,h.memoizedState=Gs(1|r,g,l,u))}function lh(t,r){pc(8390656,8,t,r)}function ch(t,r){zi(2048,8,t,r)}function oh(t,r){return zi(4,2,t,r)}function uh(t,r){return zi(4,4,t,r)}function fh(t,r){if(typeof r=="function"){t=t();var l=r(t);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function dh(t,r,l){l=l!=null?l.concat([t]):null,zi(4,4,fh.bind(null,r,t),l)}function A0(){}function hh(t,r){var l=Qt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&m0(r,u[1])?u[0]:(l.memoizedState=[t,r],t)}function xh(t,r){var l=Qt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&m0(r,u[1]))return u[0];if(u=t(),as){Ce(!0);try{t()}finally{Ce(!1)}}return l.memoizedState=[u,r],u}function N0(t,r,l){return l===void 0||(xn&1073741824)!==0?t.memoizedState=r:(t.memoizedState=l,t=gx(),ut.lanes|=t,En|=t,l)}function mh(t,r,l,u){return Ua(l,r)?l:Hs.current!==null?(t=N0(t,l,u),Ua(t,r)||(ca=!0),t):(xn&42)===0?(ca=!0,t.memoizedState=l):(t=gx(),ut.lanes|=t,En|=t,r)}function ph(t,r,l,u,h){var g=ue.p;ue.p=g!==0&&8>g?g:8;var T=Z.T,C={};Z.T=C,D0(t,!1,r,l);try{var G=h(),le=Z.S;if(le!==null&&le(C,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var Ee=lv(G,u);Vi(t,r,Ee,Ga(t))}else Vi(t,r,u,Ga(t))}catch(Ae){Vi(t,r,{then:function(){},status:"rejected",reason:Ae},Ga())}finally{ue.p=g,Z.T=T}}function dv(){}function C0(t,r,l,u){if(t.tag!==5)throw Error(s(476));var h=gh(t).queue;ph(t,h,r,Re,l===null?dv:function(){return vh(t),l(u)})}function gh(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:Re},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:l},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function vh(t){var r=gh(t).next.queue;Vi(t,r,{},Ga())}function k0(){return ba(ll)}function bh(){return Qt().memoizedState}function yh(){return Qt().memoizedState}function hv(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var l=Ga();t=dn(l);var u=hn(r,t,l);u!==null&&(Ya(u,r,l),Ii(u,r,l)),r={cache:s0()},t.payload=r;return}r=r.return}}function xv(t,r,l){var u=Ga();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},gc(t)?_h(r,l):(l=Wo(t,r,l,u),l!==null&&(Ya(l,t,u),wh(l,r,u)))}function Eh(t,r,l){var u=Ga();Vi(t,r,l,u)}function Vi(t,r,l,u){var h={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(gc(t))_h(r,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var T=r.lastRenderedState,C=g(T,l);if(h.hasEagerState=!0,h.eagerState=C,Ua(C,T))return ec(t,r,h,0),Lt===null&&Jl(),!1}catch{}finally{}if(l=Wo(t,r,h,u),l!==null)return Ya(l,t,u),wh(l,r,u),!0}return!1}function D0(t,r,l,u){if(u={lane:2,revertLane:cu(),action:u,hasEagerState:!1,eagerState:null,next:null},gc(t)){if(r)throw Error(s(479))}else r=Wo(t,l,u,2),r!==null&&Ya(r,t,2)}function gc(t){var r=t.alternate;return t===ut||r!==null&&r===ut}function _h(t,r){zs=fc=!0;var l=t.pending;l===null?r.next=r:(r.next=l.next,l.next=r),t.pending=r}function wh(t,r,l){if((l&4194048)!==0){var u=r.lanes;u&=t.pendingLanes,l|=u,r.lanes=l,Ts(t,l)}}var vc={readContext:ba,use:hc,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useLayoutEffect:qt,useInsertionEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useSyncExternalStore:qt,useId:qt,useHostTransitionStatus:qt,useFormState:qt,useActionState:qt,useOptimistic:qt,useMemoCache:qt,useCacheRefresh:qt},Th={readContext:ba,use:hc,useCallback:function(t,r){return La().memoizedState=[t,r===void 0?null:r],t},useContext:ba,useEffect:lh,useImperativeHandle:function(t,r,l){l=l!=null?l.concat([t]):null,pc(4194308,4,fh.bind(null,r,t),l)},useLayoutEffect:function(t,r){return pc(4194308,4,t,r)},useInsertionEffect:function(t,r){pc(4,2,t,r)},useMemo:function(t,r){var l=La();r=r===void 0?null:r;var u=t();if(as){Ce(!0);try{t()}finally{Ce(!1)}}return l.memoizedState=[u,r],u},useReducer:function(t,r,l){var u=La();if(l!==void 0){var h=l(r);if(as){Ce(!0);try{l(r)}finally{Ce(!1)}}}else h=r;return u.memoizedState=u.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},u.queue=t,t=t.dispatch=xv.bind(null,ut,t),[u.memoizedState,t]},useRef:function(t){var r=La();return t={current:t},r.memoizedState=t},useState:function(t){t=T0(t);var r=t.queue,l=Eh.bind(null,ut,r);return r.dispatch=l,[t.memoizedState,l]},useDebugValue:A0,useDeferredValue:function(t,r){var l=La();return N0(l,t,r)},useTransition:function(){var t=T0(!1);return t=ph.bind(null,ut,t.queue,!0,!1),La().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,l){var u=ut,h=La();if(Tt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=r(),Lt===null)throw Error(s(349));(gt&124)!==0||Yd(u,r,l)}h.memoizedState=l;var g={value:l,getSnapshot:r};return h.queue=g,lh(qd.bind(null,u,g,t),[t]),u.flags|=2048,Gs(9,mc(),Xd.bind(null,u,g,l,r),null),l},useId:function(){var t=La(),r=Lt.identifierPrefix;if(Tt){var l=zr,u=Hr;l=(u&~(1<<32-Je(u)-1)).toString(32)+l,r=""+r+"R"+l,l=dc++,0<l&&(r+="H"+l.toString(32)),r+=""}else l=cv++,r=""+r+"r"+l.toString(32)+"";return t.memoizedState=r},useHostTransitionStatus:k0,useFormState:ah,useActionState:ah,useOptimistic:function(t){var r=La();r.memoizedState=r.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=D0.bind(null,ut,!0,l),l.dispatch=r,[t,r]},useMemoCache:E0,useCacheRefresh:function(){return La().memoizedState=hv.bind(null,ut)}},Sh={readContext:ba,use:hc,useCallback:hh,useContext:ba,useEffect:ch,useImperativeHandle:dh,useInsertionEffect:oh,useLayoutEffect:uh,useMemo:xh,useReducer:xc,useRef:ih,useState:function(){return xc(Yr)},useDebugValue:A0,useDeferredValue:function(t,r){var l=Qt();return mh(l,Dt.memoizedState,t,r)},useTransition:function(){var t=xc(Yr)[0],r=Qt().memoizedState;return[typeof t=="boolean"?t:Hi(t),r]},useSyncExternalStore:Gd,useId:bh,useHostTransitionStatus:k0,useFormState:rh,useActionState:rh,useOptimistic:function(t,r){var l=Qt();return $d(l,Dt,t,r)},useMemoCache:E0,useCacheRefresh:yh},mv={readContext:ba,use:hc,useCallback:hh,useContext:ba,useEffect:ch,useImperativeHandle:dh,useInsertionEffect:oh,useLayoutEffect:uh,useMemo:xh,useReducer:w0,useRef:ih,useState:function(){return w0(Yr)},useDebugValue:A0,useDeferredValue:function(t,r){var l=Qt();return Dt===null?N0(l,t,r):mh(l,Dt.memoizedState,t,r)},useTransition:function(){var t=w0(Yr)[0],r=Qt().memoizedState;return[typeof t=="boolean"?t:Hi(t),r]},useSyncExternalStore:Gd,useId:bh,useHostTransitionStatus:k0,useFormState:sh,useActionState:sh,useOptimistic:function(t,r){var l=Qt();return Dt!==null?$d(l,Dt,t,r):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:E0,useCacheRefresh:yh},Ys=null,Gi=0;function bc(t){var r=Gi;return Gi+=1,Ys===null&&(Ys=[]),Fd(Ys,t,r)}function Yi(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function yc(t,r){throw r.$$typeof===v?Error(s(525)):(t=Object.prototype.toString.call(r),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function Ah(t){var r=t._init;return r(t._payload)}function Nh(t){function r(ae,J){if(t){var ie=ae.deletions;ie===null?(ae.deletions=[J],ae.flags|=16):ie.push(J)}}function l(ae,J){if(!t)return null;for(;J!==null;)r(ae,J),J=J.sibling;return null}function u(ae){for(var J=new Map;ae!==null;)ae.key!==null?J.set(ae.key,ae):J.set(ae.index,ae),ae=ae.sibling;return J}function h(ae,J){return ae=Pr(ae,J),ae.index=0,ae.sibling=null,ae}function g(ae,J,ie){return ae.index=ie,t?(ie=ae.alternate,ie!==null?(ie=ie.index,ie<J?(ae.flags|=67108866,J):ie):(ae.flags|=67108866,J)):(ae.flags|=1048576,J)}function T(ae){return t&&ae.alternate===null&&(ae.flags|=67108866),ae}function C(ae,J,ie,Te){return J===null||J.tag!==6?(J=Zo(ie,ae.mode,Te),J.return=ae,J):(J=h(J,ie),J.return=ae,J)}function G(ae,J,ie,Te){var Fe=ie.type;return Fe===E?Ee(ae,J,ie.props.children,Te,ie.key):J!==null&&(J.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Q&&Ah(Fe)===J.type)?(J=h(J,ie.props),Yi(J,ie),J.return=ae,J):(J=ac(ie.type,ie.key,ie.props,null,ae.mode,Te),Yi(J,ie),J.return=ae,J)}function le(ae,J,ie,Te){return J===null||J.tag!==4||J.stateNode.containerInfo!==ie.containerInfo||J.stateNode.implementation!==ie.implementation?(J=Qo(ie,ae.mode,Te),J.return=ae,J):(J=h(J,ie.children||[]),J.return=ae,J)}function Ee(ae,J,ie,Te,Fe){return J===null||J.tag!==7?(J=Kn(ie,ae.mode,Te,Fe),J.return=ae,J):(J=h(J,ie),J.return=ae,J)}function Ae(ae,J,ie){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=Zo(""+J,ae.mode,ie),J.return=ae,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case b:return ie=ac(J.type,J.key,J.props,null,ae.mode,ie),Yi(ie,J),ie.return=ae,ie;case y:return J=Qo(J,ae.mode,ie),J.return=ae,J;case Q:var Te=J._init;return J=Te(J._payload),Ae(ae,J,ie)}if(_e(J)||X(J))return J=Kn(J,ae.mode,ie,null),J.return=ae,J;if(typeof J.then=="function")return Ae(ae,bc(J),ie);if(J.$$typeof===A)return Ae(ae,ic(ae,J),ie);yc(ae,J)}return null}function de(ae,J,ie,Te){var Fe=J!==null?J.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Fe!==null?null:C(ae,J,""+ie,Te);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case b:return ie.key===Fe?G(ae,J,ie,Te):null;case y:return ie.key===Fe?le(ae,J,ie,Te):null;case Q:return Fe=ie._init,ie=Fe(ie._payload),de(ae,J,ie,Te)}if(_e(ie)||X(ie))return Fe!==null?null:Ee(ae,J,ie,Te,null);if(typeof ie.then=="function")return de(ae,J,bc(ie),Te);if(ie.$$typeof===A)return de(ae,J,ic(ae,ie),Te);yc(ae,ie)}return null}function me(ae,J,ie,Te,Fe){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return ae=ae.get(ie)||null,C(J,ae,""+Te,Fe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:return ae=ae.get(Te.key===null?ie:Te.key)||null,G(J,ae,Te,Fe);case y:return ae=ae.get(Te.key===null?ie:Te.key)||null,le(J,ae,Te,Fe);case Q:var ft=Te._init;return Te=ft(Te._payload),me(ae,J,ie,Te,Fe)}if(_e(Te)||X(Te))return ae=ae.get(ie)||null,Ee(J,ae,Te,Fe,null);if(typeof Te.then=="function")return me(ae,J,ie,bc(Te),Fe);if(Te.$$typeof===A)return me(ae,J,ie,ic(J,Te),Fe);yc(J,Te)}return null}function Ze(ae,J,ie,Te){for(var Fe=null,ft=null,He=J,Ke=J=0,ua=null;He!==null&&Ke<ie.length;Ke++){He.index>Ke?(ua=He,He=null):ua=He.sibling;var _t=de(ae,He,ie[Ke],Te);if(_t===null){He===null&&(He=ua);break}t&&He&&_t.alternate===null&&r(ae,He),J=g(_t,J,Ke),ft===null?Fe=_t:ft.sibling=_t,ft=_t,He=ua}if(Ke===ie.length)return l(ae,He),Tt&&$n(ae,Ke),Fe;if(He===null){for(;Ke<ie.length;Ke++)He=Ae(ae,ie[Ke],Te),He!==null&&(J=g(He,J,Ke),ft===null?Fe=He:ft.sibling=He,ft=He);return Tt&&$n(ae,Ke),Fe}for(He=u(He);Ke<ie.length;Ke++)ua=me(He,ae,Ke,ie[Ke],Te),ua!==null&&(t&&ua.alternate!==null&&He.delete(ua.key===null?Ke:ua.key),J=g(ua,J,Ke),ft===null?Fe=ua:ft.sibling=ua,ft=ua);return t&&He.forEach(function(Dn){return r(ae,Dn)}),Tt&&$n(ae,Ke),Fe}function qe(ae,J,ie,Te){if(ie==null)throw Error(s(151));for(var Fe=null,ft=null,He=J,Ke=J=0,ua=null,_t=ie.next();He!==null&&!_t.done;Ke++,_t=ie.next()){He.index>Ke?(ua=He,He=null):ua=He.sibling;var Dn=de(ae,He,_t.value,Te);if(Dn===null){He===null&&(He=ua);break}t&&He&&Dn.alternate===null&&r(ae,He),J=g(Dn,J,Ke),ft===null?Fe=Dn:ft.sibling=Dn,ft=Dn,He=ua}if(_t.done)return l(ae,He),Tt&&$n(ae,Ke),Fe;if(He===null){for(;!_t.done;Ke++,_t=ie.next())_t=Ae(ae,_t.value,Te),_t!==null&&(J=g(_t,J,Ke),ft===null?Fe=_t:ft.sibling=_t,ft=_t);return Tt&&$n(ae,Ke),Fe}for(He=u(He);!_t.done;Ke++,_t=ie.next())_t=me(He,ae,Ke,_t.value,Te),_t!==null&&(t&&_t.alternate!==null&&He.delete(_t.key===null?Ke:_t.key),J=g(_t,J,Ke),ft===null?Fe=_t:ft.sibling=_t,ft=_t);return t&&He.forEach(function(pb){return r(ae,pb)}),Tt&&$n(ae,Ke),Fe}function Rt(ae,J,ie,Te){if(typeof ie=="object"&&ie!==null&&ie.type===E&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case b:e:{for(var Fe=ie.key;J!==null;){if(J.key===Fe){if(Fe=ie.type,Fe===E){if(J.tag===7){l(ae,J.sibling),Te=h(J,ie.props.children),Te.return=ae,ae=Te;break e}}else if(J.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===Q&&Ah(Fe)===J.type){l(ae,J.sibling),Te=h(J,ie.props),Yi(Te,ie),Te.return=ae,ae=Te;break e}l(ae,J);break}else r(ae,J);J=J.sibling}ie.type===E?(Te=Kn(ie.props.children,ae.mode,Te,ie.key),Te.return=ae,ae=Te):(Te=ac(ie.type,ie.key,ie.props,null,ae.mode,Te),Yi(Te,ie),Te.return=ae,ae=Te)}return T(ae);case y:e:{for(Fe=ie.key;J!==null;){if(J.key===Fe)if(J.tag===4&&J.stateNode.containerInfo===ie.containerInfo&&J.stateNode.implementation===ie.implementation){l(ae,J.sibling),Te=h(J,ie.children||[]),Te.return=ae,ae=Te;break e}else{l(ae,J);break}else r(ae,J);J=J.sibling}Te=Qo(ie,ae.mode,Te),Te.return=ae,ae=Te}return T(ae);case Q:return Fe=ie._init,ie=Fe(ie._payload),Rt(ae,J,ie,Te)}if(_e(ie))return Ze(ae,J,ie,Te);if(X(ie)){if(Fe=X(ie),typeof Fe!="function")throw Error(s(150));return ie=Fe.call(ie),qe(ae,J,ie,Te)}if(typeof ie.then=="function")return Rt(ae,J,bc(ie),Te);if(ie.$$typeof===A)return Rt(ae,J,ic(ae,ie),Te);yc(ae,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,J!==null&&J.tag===6?(l(ae,J.sibling),Te=h(J,ie),Te.return=ae,ae=Te):(l(ae,J),Te=Zo(ie,ae.mode,Te),Te.return=ae,ae=Te),T(ae)):l(ae,J)}return function(ae,J,ie,Te){try{Gi=0;var Fe=Rt(ae,J,ie,Te);return Ys=null,Fe}catch(He){if(He===Li||He===cc)throw He;var ft=Pa(29,He,null,ae.mode);return ft.lanes=Te,ft.return=ae,ft}finally{}}}var Xs=Nh(!0),Ch=Nh(!1),nr=oe(null),Nr=null;function mn(t){var r=t.alternate;q(ra,ra.current&1),q(nr,t),Nr===null&&(r===null||Hs.current!==null||r.memoizedState!==null)&&(Nr=t)}function kh(t){if(t.tag===22){if(q(ra,ra.current),q(nr,t),Nr===null){var r=t.alternate;r!==null&&r.memoizedState!==null&&(Nr=t)}}else pn()}function pn(){q(ra,ra.current),q(nr,nr.current)}function Xr(t){k(nr),Nr===t&&(Nr=null),k(ra)}var ra=oe(0);function Ec(t){for(var r=t;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||yu(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function O0(t,r,l,u){r=t.memoizedState,l=l(u,r),l=l==null?r:p({},r,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var R0={enqueueSetState:function(t,r,l){t=t._reactInternals;var u=Ga(),h=dn(u);h.payload=r,l!=null&&(h.callback=l),r=hn(t,h,u),r!==null&&(Ya(r,t,u),Ii(r,t,u))},enqueueReplaceState:function(t,r,l){t=t._reactInternals;var u=Ga(),h=dn(u);h.tag=1,h.payload=r,l!=null&&(h.callback=l),r=hn(t,h,u),r!==null&&(Ya(r,t,u),Ii(r,t,u))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var l=Ga(),u=dn(l);u.tag=2,r!=null&&(u.callback=r),r=hn(t,u,l),r!==null&&(Ya(r,t,l),Ii(r,t,l))}};function Dh(t,r,l,u,h,g,T){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,g,T):r.prototype&&r.prototype.isPureReactComponent?!Ni(l,u)||!Ni(h,g):!0}function Oh(t,r,l,u){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==t&&R0.enqueueReplaceState(r,r.state,null)}function rs(t,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(t=t.defaultProps){l===r&&(l=p({},l));for(var h in t)l[h]===void 0&&(l[h]=t[h])}return l}var _c=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function Rh(t){_c(t)}function jh(t){console.error(t)}function Mh(t){_c(t)}function wc(t,r){try{var l=t.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Lh(t,r,l){try{var u=t.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function j0(t,r,l){return l=dn(l),l.tag=3,l.payload={element:null},l.callback=function(){wc(t,r)},l}function Fh(t){return t=dn(t),t.tag=3,t}function Ih(t,r,l,u){var h=l.type.getDerivedStateFromError;if(typeof h=="function"){var g=u.value;t.payload=function(){return h(g)},t.callback=function(){Lh(r,l,u)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(t.callback=function(){Lh(r,l,u),typeof h!="function"&&(_n===null?_n=new Set([this]):_n.add(this));var C=u.stack;this.componentDidCatch(u.value,{componentStack:C!==null?C:""})})}function pv(t,r,l,u,h){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Ri(r,l,h,!0),l=nr.current,l!==null){switch(l.tag){case 13:return Nr===null?ru():l.alternate===null&&Vt===0&&(Vt=3),l.flags&=-257,l.flags|=65536,l.lanes=h,u===c0?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),su(t,u,h)),!1;case 22:return l.flags|=65536,u===c0?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),su(t,u,h)),!1}throw Error(s(435,l.tag))}return su(t,u,h),ru(),!1}if(Tt)return r=nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,u!==t0&&(t=Error(s(422),{cause:u}),Oi(er(t,l)))):(u!==t0&&(r=Error(s(423),{cause:u}),Oi(er(r,l))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,u=er(u,l),h=j0(t.stateNode,u,h),f0(t,h),Vt!==4&&(Vt=2)),!1;var g=Error(s(520),{cause:u});if(g=er(g,l),Qi===null?Qi=[g]:Qi.push(g),Vt!==4&&(Vt=2),r===null)return!0;u=er(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,t=h&-h,l.lanes|=t,t=j0(l.stateNode,u,t),f0(l,t),!1;case 1:if(r=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(_n===null||!_n.has(g))))return l.flags|=65536,h&=-h,l.lanes|=h,h=Fh(h),Ih(h,t,l,u),f0(l,h),!1}l=l.return}while(l!==null);return!1}var Bh=Error(s(461)),ca=!1;function ha(t,r,l,u){r.child=t===null?Ch(r,null,l,u):Xs(r,t.child,l,u)}function Uh(t,r,l,u,h){l=l.render;var g=r.ref;if("ref"in u){var T={};for(var C in u)C!=="ref"&&(T[C]=u[C])}else T=u;return es(r),u=p0(t,r,l,T,g,h),C=g0(),t!==null&&!ca?(v0(t,r,h),qr(t,r,h)):(Tt&&C&&Jo(r),r.flags|=1,ha(t,r,u,h),r.child)}function Ph(t,r,l,u,h){if(t===null){var g=l.type;return typeof g=="function"&&!$o(g)&&g.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=g,Hh(t,r,g,u,h)):(t=ac(l.type,null,u,r,r.mode,h),t.ref=r.ref,t.return=r,r.child=t)}if(g=t.child,!H0(t,h)){var T=g.memoizedProps;if(l=l.compare,l=l!==null?l:Ni,l(T,u)&&t.ref===r.ref)return qr(t,r,h)}return r.flags|=1,t=Pr(g,u),t.ref=r.ref,t.return=r,r.child=t}function Hh(t,r,l,u,h){if(t!==null){var g=t.memoizedProps;if(Ni(g,u)&&t.ref===r.ref)if(ca=!1,r.pendingProps=u=g,H0(t,h))(t.flags&131072)!==0&&(ca=!0);else return r.lanes=t.lanes,qr(t,r,h)}return M0(t,r,l,u,h)}function zh(t,r,l){var u=r.pendingProps,h=u.children,g=t!==null?t.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,t!==null){for(h=r.child=t.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;r.childLanes=g&~u}else r.childLanes=0,r.child=null;return Vh(t,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&lc(r,g!==null?g.cachePool:null),g!==null?Hd(r,g):h0(),kh(r);else return r.lanes=r.childLanes=536870912,Vh(t,r,g!==null?g.baseLanes|l:l,l)}else g!==null?(lc(r,g.cachePool),Hd(r,g),pn(),r.memoizedState=null):(t!==null&&lc(r,null),h0(),pn());return ha(t,r,h,l),r.child}function Vh(t,r,l,u){var h=l0();return h=h===null?null:{parent:aa._currentValue,pool:h},r.memoizedState={baseLanes:l,cachePool:h},t!==null&&lc(r,null),h0(),kh(r),t!==null&&Ri(t,r,u,!0),null}function Tc(t,r){var l=r.ref;if(l===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(t===null||t.ref!==l)&&(r.flags|=4194816)}}function M0(t,r,l,u,h){return es(r),l=p0(t,r,l,u,void 0,h),u=g0(),t!==null&&!ca?(v0(t,r,h),qr(t,r,h)):(Tt&&u&&Jo(r),r.flags|=1,ha(t,r,l,h),r.child)}function Gh(t,r,l,u,h,g){return es(r),r.updateQueue=null,l=Vd(r,u,l,h),zd(t),u=g0(),t!==null&&!ca?(v0(t,r,g),qr(t,r,g)):(Tt&&u&&Jo(r),r.flags|=1,ha(t,r,l,g),r.child)}function Yh(t,r,l,u,h){if(es(r),r.stateNode===null){var g=Fs,T=l.contextType;typeof T=="object"&&T!==null&&(g=ba(T)),g=new l(u,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=R0,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=u,g.state=r.memoizedState,g.refs={},o0(r),T=l.contextType,g.context=typeof T=="object"&&T!==null?ba(T):Fs,g.state=r.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(O0(r,l,T,u),g.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&R0.enqueueReplaceState(g,g.state,null),Ui(r,u,g,h),Bi(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(t===null){g=r.stateNode;var C=r.memoizedProps,G=rs(l,C);g.props=G;var le=g.context,Ee=l.contextType;T=Fs,typeof Ee=="object"&&Ee!==null&&(T=ba(Ee));var Ae=l.getDerivedStateFromProps;Ee=typeof Ae=="function"||typeof g.getSnapshotBeforeUpdate=="function",C=r.pendingProps!==C,Ee||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(C||le!==T)&&Oh(r,g,u,T),fn=!1;var de=r.memoizedState;g.state=de,Ui(r,u,g,h),Bi(),le=r.memoizedState,C||de!==le||fn?(typeof Ae=="function"&&(O0(r,l,Ae,u),le=r.memoizedState),(G=fn||Dh(r,l,G,u,de,le,T))?(Ee||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=le),g.props=u,g.state=le,g.context=T,u=G):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{g=r.stateNode,u0(t,r),T=r.memoizedProps,Ee=rs(l,T),g.props=Ee,Ae=r.pendingProps,de=g.context,le=l.contextType,G=Fs,typeof le=="object"&&le!==null&&(G=ba(le)),C=l.getDerivedStateFromProps,(le=typeof C=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==Ae||de!==G)&&Oh(r,g,u,G),fn=!1,de=r.memoizedState,g.state=de,Ui(r,u,g,h),Bi();var me=r.memoizedState;T!==Ae||de!==me||fn||t!==null&&t.dependencies!==null&&sc(t.dependencies)?(typeof C=="function"&&(O0(r,l,C,u),me=r.memoizedState),(Ee=fn||Dh(r,l,Ee,u,de,me,G)||t!==null&&t.dependencies!==null&&sc(t.dependencies))?(le||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,me,G),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,me,G)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===t.memoizedProps&&de===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===t.memoizedProps&&de===t.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=me),g.props=u,g.state=me,g.context=G,u=Ee):(typeof g.componentDidUpdate!="function"||T===t.memoizedProps&&de===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===t.memoizedProps&&de===t.memoizedState||(r.flags|=1024),u=!1)}return g=u,Tc(t,r),u=(r.flags&128)!==0,g||u?(g=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,t!==null&&u?(r.child=Xs(r,t.child,null,h),r.child=Xs(r,null,l,h)):ha(t,r,l,h),r.memoizedState=g.state,t=r.child):t=qr(t,r,h),t}function Xh(t,r,l,u){return Di(),r.flags|=256,ha(t,r,l,u),r.child}var L0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function F0(t){return{baseLanes:t,cachePool:jd()}}function I0(t,r,l){return t=t!==null?t.childLanes&~l:0,r&&(t|=sr),t}function qh(t,r,l){var u=r.pendingProps,h=!1,g=(r.flags&128)!==0,T;if((T=g)||(T=t!==null&&t.memoizedState===null?!1:(ra.current&2)!==0),T&&(h=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,t===null){if(Tt){if(h?mn(r):pn(),Tt){var C=zt,G;if(G=C){e:{for(G=C,C=Ar;G.nodeType!==8;){if(!C){C=null;break e}if(G=vr(G.nextSibling),G===null){C=null;break e}}C=G}C!==null?(r.memoizedState={dehydrated:C,treeContext:Wn!==null?{id:Hr,overflow:zr}:null,retryLane:536870912,hydrationErrors:null},G=Pa(18,null,null,0),G.stateNode=C,G.return=r,r.child=G,Ca=r,zt=null,G=!0):G=!1}G||Qn(r)}if(C=r.memoizedState,C!==null&&(C=C.dehydrated,C!==null))return yu(C)?r.lanes=32:r.lanes=536870912,null;Xr(r)}return C=u.children,u=u.fallback,h?(pn(),h=r.mode,C=Sc({mode:"hidden",children:C},h),u=Kn(u,h,l,null),C.return=r,u.return=r,C.sibling=u,r.child=C,h=r.child,h.memoizedState=F0(l),h.childLanes=I0(t,T,l),r.memoizedState=L0,u):(mn(r),B0(r,C))}if(G=t.memoizedState,G!==null&&(C=G.dehydrated,C!==null)){if(g)r.flags&256?(mn(r),r.flags&=-257,r=U0(t,r,l)):r.memoizedState!==null?(pn(),r.child=t.child,r.flags|=128,r=null):(pn(),h=u.fallback,C=r.mode,u=Sc({mode:"visible",children:u.children},C),h=Kn(h,C,l,null),h.flags|=2,u.return=r,h.return=r,u.sibling=h,r.child=u,Xs(r,t.child,null,l),u=r.child,u.memoizedState=F0(l),u.childLanes=I0(t,T,l),r.memoizedState=L0,r=h);else if(mn(r),yu(C)){if(T=C.nextSibling&&C.nextSibling.dataset,T)var le=T.dgst;T=le,u=Error(s(419)),u.stack="",u.digest=T,Oi({value:u,source:null,stack:null}),r=U0(t,r,l)}else if(ca||Ri(t,r,l,!1),T=(l&t.childLanes)!==0,ca||T){if(T=Lt,T!==null&&(u=l&-l,u=(u&42)!==0?1:Vn(u),u=(u&(T.suspendedLanes|l))!==0?0:u,u!==0&&u!==G.retryLane))throw G.retryLane=u,Ls(t,u),Ya(T,t,u),Bh;C.data==="$?"||ru(),r=U0(t,r,l)}else C.data==="$?"?(r.flags|=192,r.child=t.child,r=null):(t=G.treeContext,zt=vr(C.nextSibling),Ca=r,Tt=!0,Zn=null,Ar=!1,t!==null&&(ar[rr++]=Hr,ar[rr++]=zr,ar[rr++]=Wn,Hr=t.id,zr=t.overflow,Wn=r),r=B0(r,u.children),r.flags|=4096);return r}return h?(pn(),h=u.fallback,C=r.mode,G=t.child,le=G.sibling,u=Pr(G,{mode:"hidden",children:u.children}),u.subtreeFlags=G.subtreeFlags&65011712,le!==null?h=Pr(le,h):(h=Kn(h,C,l,null),h.flags|=2),h.return=r,u.return=r,u.sibling=h,r.child=u,u=h,h=r.child,C=t.child.memoizedState,C===null?C=F0(l):(G=C.cachePool,G!==null?(le=aa._currentValue,G=G.parent!==le?{parent:le,pool:le}:G):G=jd(),C={baseLanes:C.baseLanes|l,cachePool:G}),h.memoizedState=C,h.childLanes=I0(t,T,l),r.memoizedState=L0,u):(mn(r),l=t.child,t=l.sibling,l=Pr(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,t!==null&&(T=r.deletions,T===null?(r.deletions=[t],r.flags|=16):T.push(t)),r.child=l,r.memoizedState=null,l)}function B0(t,r){return r=Sc({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function Sc(t,r){return t=Pa(22,t,null,r),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function U0(t,r,l){return Xs(r,t.child,null,l),t=B0(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Kh(t,r,l){t.lanes|=r;var u=t.alternate;u!==null&&(u.lanes|=r),r0(t.return,r,l)}function P0(t,r,l,u,h){var g=t.memoizedState;g===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:h}:(g.isBackwards=r,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=h)}function Wh(t,r,l){var u=r.pendingProps,h=u.revealOrder,g=u.tail;if(ha(t,r,u.children,l),u=ra.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Kh(t,l,r);else if(t.tag===19)Kh(t,l,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}switch(q(ra,u),h){case"forwards":for(l=r.child,h=null;l!==null;)t=l.alternate,t!==null&&Ec(t)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),P0(r,!1,h,l,g);break;case"backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(t=h.alternate,t!==null&&Ec(t)===null){r.child=h;break}t=h.sibling,h.sibling=l,l=h,h=t}P0(r,!0,l,null,g);break;case"together":P0(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function qr(t,r,l){if(t!==null&&(r.dependencies=t.dependencies),En|=r.lanes,(l&r.childLanes)===0)if(t!==null){if(Ri(t,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(s(153));if(r.child!==null){for(t=r.child,l=Pr(t,t.pendingProps),r.child=l,l.return=r;t.sibling!==null;)t=t.sibling,l=l.sibling=Pr(t,t.pendingProps),l.return=r;l.sibling=null}return r.child}function H0(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&sc(t)))}function gv(t,r,l){switch(r.tag){case 3:ve(r,r.stateNode.containerInfo),un(r,aa,t.memoizedState.cache),Di();break;case 27:case 5:we(r);break;case 4:ve(r,r.stateNode.containerInfo);break;case 10:un(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(mn(r),r.flags|=128,null):(l&r.child.childLanes)!==0?qh(t,r,l):(mn(r),t=qr(t,r,l),t!==null?t.sibling:null);mn(r);break;case 19:var h=(t.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Ri(t,r,l,!1),u=(l&r.childLanes)!==0),h){if(u)return Wh(t,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),q(ra,ra.current),u)break;return null;case 22:case 23:return r.lanes=0,zh(t,r,l);case 24:un(r,aa,t.memoizedState.cache)}return qr(t,r,l)}function $h(t,r,l){if(t!==null)if(t.memoizedProps!==r.pendingProps)ca=!0;else{if(!H0(t,l)&&(r.flags&128)===0)return ca=!1,gv(t,r,l);ca=(t.flags&131072)!==0}else ca=!1,Tt&&(r.flags&1048576)!==0&&Ad(r,nc,r.index);switch(r.lanes=0,r.tag){case 16:e:{t=r.pendingProps;var u=r.elementType,h=u._init;if(u=h(u._payload),r.type=u,typeof u=="function")$o(u)?(t=rs(u,t),r.tag=1,r=Yh(null,r,u,t,l)):(r.tag=0,r=M0(null,r,u,t,l));else{if(u!=null){if(h=u.$$typeof,h===z){r.tag=11,r=Uh(null,r,u,t,l);break e}else if(h===j){r.tag=14,r=Ph(null,r,u,t,l);break e}}throw r=he(u)||u,Error(s(306,r,""))}}return r;case 0:return M0(t,r,r.type,r.pendingProps,l);case 1:return u=r.type,h=rs(u,r.pendingProps),Yh(t,r,u,h,l);case 3:e:{if(ve(r,r.stateNode.containerInfo),t===null)throw Error(s(387));u=r.pendingProps;var g=r.memoizedState;h=g.element,u0(t,r),Ui(r,u,null,l);var T=r.memoizedState;if(u=T.cache,un(r,aa,u),u!==g.cache&&n0(r,[aa],l,!0),Bi(),u=T.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=Xh(t,r,u,l);break e}else if(u!==h){h=er(Error(s(424)),r),Oi(h),r=Xh(t,r,u,l);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(zt=vr(t.firstChild),Ca=r,Tt=!0,Zn=null,Ar=!0,l=Ch(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Di(),u===h){r=qr(t,r,l);break e}ha(t,r,u,l)}r=r.child}return r;case 26:return Tc(t,r),t===null?(l=e1(r.type,null,r.pendingProps,null))?r.memoizedState=l:Tt||(l=r.type,t=r.pendingProps,u=Uc(W.current).createElement(l),u[Xt]=r,u[$t]=t,ma(u,l,t),re(u),r.stateNode=u):r.memoizedState=e1(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return we(r),t===null&&Tt&&(u=r.stateNode=Zx(r.type,r.pendingProps,W.current),Ca=r,Ar=!0,h=zt,Sn(r.type)?(Eu=h,zt=vr(u.firstChild)):zt=h),ha(t,r,r.pendingProps.children,l),Tc(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&Tt&&((h=u=zt)&&(u=Yv(u,r.type,r.pendingProps,Ar),u!==null?(r.stateNode=u,Ca=r,zt=vr(u.firstChild),Ar=!1,h=!0):h=!1),h||Qn(r)),we(r),h=r.type,g=r.pendingProps,T=t!==null?t.memoizedProps:null,u=g.children,gu(h,g)?u=null:T!==null&&gu(h,T)&&(r.flags|=32),r.memoizedState!==null&&(h=p0(t,r,ov,null,null,l),ll._currentValue=h),Tc(t,r),ha(t,r,u,l),r.child;case 6:return t===null&&Tt&&((t=l=zt)&&(l=Xv(l,r.pendingProps,Ar),l!==null?(r.stateNode=l,Ca=r,zt=null,t=!0):t=!1),t||Qn(r)),null;case 13:return qh(t,r,l);case 4:return ve(r,r.stateNode.containerInfo),u=r.pendingProps,t===null?r.child=Xs(r,null,u,l):ha(t,r,u,l),r.child;case 11:return Uh(t,r,r.type,r.pendingProps,l);case 7:return ha(t,r,r.pendingProps,l),r.child;case 8:return ha(t,r,r.pendingProps.children,l),r.child;case 12:return ha(t,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,un(r,r.type,u.value),ha(t,r,u.children,l),r.child;case 9:return h=r.type._context,u=r.pendingProps.children,es(r),h=ba(h),u=u(h),r.flags|=1,ha(t,r,u,l),r.child;case 14:return Ph(t,r,r.type,r.pendingProps,l);case 15:return Hh(t,r,r.type,r.pendingProps,l);case 19:return Wh(t,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},t===null?(l=Sc(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=Pr(t.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return zh(t,r,l);case 24:return es(r),u=ba(aa),t===null?(h=l0(),h===null&&(h=Lt,g=s0(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=l),h=g),r.memoizedState={parent:u,cache:h},o0(r),un(r,aa,h)):((t.lanes&l)!==0&&(u0(t,r),Ui(r,null,null,l),Bi()),h=t.memoizedState,g=r.memoizedState,h.parent!==u?(h={parent:u,cache:u},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),un(r,aa,u)):(u=g.cache,un(r,aa,u),u!==h.cache&&n0(r,[aa],l,!0))),ha(t,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function Kr(t){t.flags|=4}function Zh(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!s1(r)){if(r=nr.current,r!==null&&((gt&4194048)===gt?Nr!==null:(gt&62914560)!==gt&&(gt&536870912)===0||r!==Nr))throw Fi=c0,Md;t.flags|=8192}}function Ac(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?Hn():536870912,t.lanes|=r,$s|=r)}function Xi(t,r){if(!Tt)switch(t.tailMode){case"hidden":r=t.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function Ut(t){var r=t.alternate!==null&&t.alternate.child===t.child,l=0,u=0;if(r)for(var h=t.child;h!==null;)l|=h.lanes|h.childLanes,u|=h.subtreeFlags&65011712,u|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)l|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=u,t.childLanes=l,r}function vv(t,r,l){var u=r.pendingProps;switch(e0(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(r),null;case 1:return Ut(r),null;case 3:return l=r.stateNode,u=null,t!==null&&(u=t.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Gr(aa),Se(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(ki(r)?Kr(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,kd())),Ut(r),null;case 26:return l=r.memoizedState,t===null?(Kr(r),l!==null?(Ut(r),Zh(r,l)):(Ut(r),r.flags&=-16777217)):l?l!==t.memoizedState?(Kr(r),Ut(r),Zh(r,l)):(Ut(r),r.flags&=-16777217):(t.memoizedProps!==u&&Kr(r),Ut(r),r.flags&=-16777217),null;case 27:Be(r),l=W.current;var h=r.type;if(t!==null&&r.stateNode!=null)t.memoizedProps!==u&&Kr(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return Ut(r),null}t=U.current,ki(r)?Nd(r):(t=Zx(h,u,l),r.stateNode=t,Kr(r))}return Ut(r),null;case 5:if(Be(r),l=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==u&&Kr(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return Ut(r),null}if(t=U.current,ki(r))Nd(r);else{switch(h=Uc(W.current),t){case 1:t=h.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:t=h.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":t=h.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":t=h.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof u.is=="string"?h.createElement("select",{is:u.is}):h.createElement("select"),u.multiple?t.multiple=!0:u.size&&(t.size=u.size);break;default:t=typeof u.is=="string"?h.createElement(l,{is:u.is}):h.createElement(l)}}t[Xt]=r,t[$t]=u;e:for(h=r.child;h!==null;){if(h.tag===5||h.tag===6)t.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===r)break e;for(;h.sibling===null;){if(h.return===null||h.return===r)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}r.stateNode=t;e:switch(ma(t,l,u),l){case"button":case"input":case"select":case"textarea":t=!!u.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Kr(r)}}return Ut(r),r.flags&=-16777217,null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==u&&Kr(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(s(166));if(t=W.current,ki(r)){if(t=r.stateNode,l=r.memoizedProps,u=null,h=Ca,h!==null)switch(h.tag){case 27:case 5:u=h.memoizedProps}t[Xt]=r,t=!!(t.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Gx(t.nodeValue,l)),t||Qn(r)}else t=Uc(t).createTextNode(u),t[Xt]=r,r.stateNode=t}return Ut(r),null;case 13:if(u=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=ki(r),u!==null&&u.dehydrated!==null){if(t===null){if(!h)throw Error(s(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[Xt]=r}else Di(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ut(r),h=!1}else h=kd(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Xr(r),r):(Xr(r),null)}if(Xr(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,t=t!==null&&t.memoizedState!==null,l){u=r.child,h=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(h=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==h&&(u.flags|=2048)}return l!==t&&l&&(r.child.flags|=8192),Ac(r,r.updateQueue),Ut(r),null;case 4:return Se(),t===null&&du(r.stateNode.containerInfo),Ut(r),null;case 10:return Gr(r.type),Ut(r),null;case 19:if(k(ra),h=r.memoizedState,h===null)return Ut(r),null;if(u=(r.flags&128)!==0,g=h.rendering,g===null)if(u)Xi(h,!1);else{if(Vt!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(g=Ec(t),g!==null){for(r.flags|=128,Xi(h,!1),t=g.updateQueue,r.updateQueue=t,Ac(r,t),r.subtreeFlags=0,t=l,l=r.child;l!==null;)Sd(l,t),l=l.sibling;return q(ra,ra.current&1|2),r.child}t=t.sibling}h.tail!==null&&ge()>kc&&(r.flags|=128,u=!0,Xi(h,!1),r.lanes=4194304)}else{if(!u)if(t=Ec(g),t!==null){if(r.flags|=128,u=!0,t=t.updateQueue,r.updateQueue=t,Ac(r,t),Xi(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!Tt)return Ut(r),null}else 2*ge()-h.renderingStartTime>kc&&l!==536870912&&(r.flags|=128,u=!0,Xi(h,!1),r.lanes=4194304);h.isBackwards?(g.sibling=r.child,r.child=g):(t=h.last,t!==null?t.sibling=g:r.child=g,h.last=g)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=ge(),r.sibling=null,t=ra.current,q(ra,u?t&1|2:t&1),r):(Ut(r),null);case 22:case 23:return Xr(r),x0(),u=r.memoizedState!==null,t!==null?t.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Ut(r),r.subtreeFlags&6&&(r.flags|=8192)):Ut(r),l=r.updateQueue,l!==null&&Ac(r,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),t!==null&&k(ts),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Gr(aa),Ut(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function bv(t,r){switch(e0(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Gr(aa),Se(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return Be(r),null;case 13:if(Xr(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(s(340));Di()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return k(ra),null;case 4:return Se(),null;case 10:return Gr(r.type),null;case 22:case 23:return Xr(r),x0(),t!==null&&k(ts),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Gr(aa),null;case 25:return null;default:return null}}function Qh(t,r){switch(e0(r),r.tag){case 3:Gr(aa),Se();break;case 26:case 27:case 5:Be(r);break;case 4:Se();break;case 13:Xr(r);break;case 19:k(ra);break;case 10:Gr(r.type);break;case 22:case 23:Xr(r),x0(),t!==null&&k(ts);break;case 24:Gr(aa)}}function qi(t,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var h=u.next;l=h;do{if((l.tag&t)===t){u=void 0;var g=l.create,T=l.inst;u=g(),T.destroy=u}l=l.next}while(l!==h)}}catch(C){jt(r,r.return,C)}}function gn(t,r,l){try{var u=r.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&t)===t){var T=u.inst,C=T.destroy;if(C!==void 0){T.destroy=void 0,h=r;var G=l,le=C;try{le()}catch(Ee){jt(h,G,Ee)}}}u=u.next}while(u!==g)}}catch(Ee){jt(r,r.return,Ee)}}function Jh(t){var r=t.updateQueue;if(r!==null){var l=t.stateNode;try{Pd(r,l)}catch(u){jt(t,t.return,u)}}}function ex(t,r,l){l.props=rs(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(u){jt(t,r,u)}}function Ki(t,r){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var u=t.stateNode;break;case 30:u=t.stateNode;break;default:u=t.stateNode}typeof l=="function"?t.refCleanup=l(u):l.current=u}}catch(h){jt(t,r,h)}}function Cr(t,r){var l=t.ref,u=t.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(h){jt(t,r,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(h){jt(t,r,h)}else l.current=null}function tx(t){var r=t.type,l=t.memoizedProps,u=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(h){jt(t,t.return,h)}}function z0(t,r,l){try{var u=t.stateNode;Pv(u,t.type,l,r),u[$t]=r}catch(h){jt(t,t.return,h)}}function ax(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Sn(t.type)||t.tag===4}function V0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ax(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Sn(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function G0(t,r,l){var u=t.tag;if(u===5||u===6)t=t.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(t),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Bc));else if(u!==4&&(u===27&&Sn(t.type)&&(l=t.stateNode,r=null),t=t.child,t!==null))for(G0(t,r,l),t=t.sibling;t!==null;)G0(t,r,l),t=t.sibling}function Nc(t,r,l){var u=t.tag;if(u===5||u===6)t=t.stateNode,r?l.insertBefore(t,r):l.appendChild(t);else if(u!==4&&(u===27&&Sn(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(Nc(t,r,l),t=t.sibling;t!==null;)Nc(t,r,l),t=t.sibling}function rx(t){var r=t.stateNode,l=t.memoizedProps;try{for(var u=t.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);ma(r,u,l),r[Xt]=t,r[$t]=l}catch(g){jt(t,t.return,g)}}var Wr=!1,Kt=!1,Y0=!1,nx=typeof WeakSet=="function"?WeakSet:Set,oa=null;function yv(t,r){if(t=t.containerInfo,mu=Yc,t=md(t),Vo(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var h=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var T=0,C=-1,G=-1,le=0,Ee=0,Ae=t,de=null;t:for(;;){for(var me;Ae!==l||h!==0&&Ae.nodeType!==3||(C=T+h),Ae!==g||u!==0&&Ae.nodeType!==3||(G=T+u),Ae.nodeType===3&&(T+=Ae.nodeValue.length),(me=Ae.firstChild)!==null;)de=Ae,Ae=me;for(;;){if(Ae===t)break t;if(de===l&&++le===h&&(C=T),de===g&&++Ee===u&&(G=T),(me=Ae.nextSibling)!==null)break;Ae=de,de=Ae.parentNode}Ae=me}l=C===-1||G===-1?null:{start:C,end:G}}else l=null}l=l||{start:0,end:0}}else l=null;for(pu={focusedElem:t,selectionRange:l},Yc=!1,oa=r;oa!==null;)if(r=oa,t=r.child,(r.subtreeFlags&1024)!==0&&t!==null)t.return=r,oa=t;else for(;oa!==null;){switch(r=oa,g=r.alternate,t=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,l=r,h=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Ze=rs(l.type,h,l.elementType===l.type);t=u.getSnapshotBeforeUpdate(Ze,g),u.__reactInternalSnapshotBeforeUpdate=t}catch(qe){jt(l,l.return,qe)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,l=t.nodeType,l===9)bu(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":bu(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=r.sibling,t!==null){t.return=r.return,oa=t;break}oa=r.return}}function sx(t,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:vn(t,l),u&4&&qi(5,l);break;case 1:if(vn(t,l),u&4)if(t=l.stateNode,r===null)try{t.componentDidMount()}catch(T){jt(l,l.return,T)}else{var h=rs(l.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(h,r,t.__reactInternalSnapshotBeforeUpdate)}catch(T){jt(l,l.return,T)}}u&64&&Jh(l),u&512&&Ki(l,l.return);break;case 3:if(vn(t,l),u&64&&(t=l.updateQueue,t!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Pd(t,r)}catch(T){jt(l,l.return,T)}}break;case 27:r===null&&u&4&&rx(l);case 26:case 5:vn(t,l),r===null&&u&4&&tx(l),u&512&&Ki(l,l.return);break;case 12:vn(t,l);break;case 13:vn(t,l),u&4&&cx(t,l),u&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=kv.bind(null,l),qv(t,l))));break;case 22:if(u=l.memoizedState!==null||Wr,!u){r=r!==null&&r.memoizedState!==null||Kt,h=Wr;var g=Kt;Wr=u,(Kt=r)&&!g?bn(t,l,(l.subtreeFlags&8772)!==0):vn(t,l),Wr=h,Kt=g}break;case 30:break;default:vn(t,l)}}function ix(t){var r=t.alternate;r!==null&&(t.alternate=null,ix(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&M(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var It=null,Fa=!1;function $r(t,r,l){for(l=l.child;l!==null;)lx(t,r,l),l=l.sibling}function lx(t,r,l){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(ct,l)}catch{}switch(l.tag){case 26:Kt||Cr(l,r),$r(t,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Kt||Cr(l,r);var u=It,h=Fa;Sn(l.type)&&(It=l.stateNode,Fa=!1),$r(t,r,l),rl(l.stateNode),It=u,Fa=h;break;case 5:Kt||Cr(l,r);case 6:if(u=It,h=Fa,It=null,$r(t,r,l),It=u,Fa=h,It!==null)if(Fa)try{(It.nodeType===9?It.body:It.nodeName==="HTML"?It.ownerDocument.body:It).removeChild(l.stateNode)}catch(g){jt(l,r,g)}else try{It.removeChild(l.stateNode)}catch(g){jt(l,r,g)}break;case 18:It!==null&&(Fa?(t=It,Wx(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),fl(t)):Wx(It,l.stateNode));break;case 4:u=It,h=Fa,It=l.stateNode.containerInfo,Fa=!0,$r(t,r,l),It=u,Fa=h;break;case 0:case 11:case 14:case 15:Kt||gn(2,l,r),Kt||gn(4,l,r),$r(t,r,l);break;case 1:Kt||(Cr(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&ex(l,r,u)),$r(t,r,l);break;case 21:$r(t,r,l);break;case 22:Kt=(u=Kt)||l.memoizedState!==null,$r(t,r,l),Kt=u;break;default:$r(t,r,l)}}function cx(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{fl(t)}catch(l){jt(r,r.return,l)}}function Ev(t){switch(t.tag){case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new nx),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new nx),r;default:throw Error(s(435,t.tag))}}function X0(t,r){var l=Ev(t);r.forEach(function(u){var h=Dv.bind(null,t,u);l.has(u)||(l.add(u),u.then(h,h))})}function Ha(t,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var h=l[u],g=t,T=r,C=T;e:for(;C!==null;){switch(C.tag){case 27:if(Sn(C.type)){It=C.stateNode,Fa=!1;break e}break;case 5:It=C.stateNode,Fa=!1;break e;case 3:case 4:It=C.stateNode.containerInfo,Fa=!0;break e}C=C.return}if(It===null)throw Error(s(160));lx(g,T,h),It=null,Fa=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)ox(r,t),r=r.sibling}var gr=null;function ox(t,r){var l=t.alternate,u=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ha(r,t),za(t),u&4&&(gn(3,t,t.return),qi(3,t),gn(5,t,t.return));break;case 1:Ha(r,t),za(t),u&512&&(Kt||l===null||Cr(l,l.return)),u&64&&Wr&&(t=t.updateQueue,t!==null&&(u=t.callbacks,u!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var h=gr;if(Ha(r,t),za(t),u&512&&(Kt||l===null||Cr(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=t.memoizedState,l===null)if(u===null)if(t.stateNode===null){e:{u=t.type,l=t.memoizedProps,h=h.ownerDocument||h;t:switch(u){case"title":g=h.getElementsByTagName("title")[0],(!g||g[O]||g[Xt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(u),h.head.insertBefore(g,h.querySelector("head > title"))),ma(g,u,l),g[Xt]=t,re(g),u=g;break e;case"link":var T=r1("link","href",h).get(u+(l.href||""));if(T){for(var C=0;C<T.length;C++)if(g=T[C],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(C,1);break t}}g=h.createElement(u),ma(g,u,l),h.head.appendChild(g);break;case"meta":if(T=r1("meta","content",h).get(u+(l.content||""))){for(C=0;C<T.length;C++)if(g=T[C],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(C,1);break t}}g=h.createElement(u),ma(g,u,l),h.head.appendChild(g);break;default:throw Error(s(468,u))}g[Xt]=t,re(g),u=g}t.stateNode=u}else n1(h,t.type,t.stateNode);else t.stateNode=a1(h,u,t.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?n1(h,t.type,t.stateNode):a1(h,u,t.memoizedProps)):u===null&&t.stateNode!==null&&z0(t,t.memoizedProps,l.memoizedProps)}break;case 27:Ha(r,t),za(t),u&512&&(Kt||l===null||Cr(l,l.return)),l!==null&&u&4&&z0(t,t.memoizedProps,l.memoizedProps);break;case 5:if(Ha(r,t),za(t),u&512&&(Kt||l===null||Cr(l,l.return)),t.flags&32){h=t.stateNode;try{Cs(h,"")}catch(me){jt(t,t.return,me)}}u&4&&t.stateNode!=null&&(h=t.memoizedProps,z0(t,h,l!==null?l.memoizedProps:h)),u&1024&&(Y0=!0);break;case 6:if(Ha(r,t),za(t),u&4){if(t.stateNode===null)throw Error(s(162));u=t.memoizedProps,l=t.stateNode;try{l.nodeValue=u}catch(me){jt(t,t.return,me)}}break;case 3:if(zc=null,h=gr,gr=Pc(r.containerInfo),Ha(r,t),gr=h,za(t),u&4&&l!==null&&l.memoizedState.isDehydrated)try{fl(r.containerInfo)}catch(me){jt(t,t.return,me)}Y0&&(Y0=!1,ux(t));break;case 4:u=gr,gr=Pc(t.stateNode.containerInfo),Ha(r,t),za(t),gr=u;break;case 12:Ha(r,t),za(t);break;case 13:Ha(r,t),za(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Q0=ge()),u&4&&(u=t.updateQueue,u!==null&&(t.updateQueue=null,X0(t,u)));break;case 22:h=t.memoizedState!==null;var G=l!==null&&l.memoizedState!==null,le=Wr,Ee=Kt;if(Wr=le||h,Kt=Ee||G,Ha(r,t),Kt=Ee,Wr=le,za(t),u&8192)e:for(r=t.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(l===null||G||Wr||Kt||ns(t)),l=null,r=t;;){if(r.tag===5||r.tag===26){if(l===null){G=l=r;try{if(g=G.stateNode,h)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{C=G.stateNode;var Ae=G.memoizedProps.style,de=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null;C.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(me){jt(G,G.return,me)}}}else if(r.tag===6){if(l===null){G=r;try{G.stateNode.nodeValue=h?"":G.memoizedProps}catch(me){jt(G,G.return,me)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=t.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,X0(t,l))));break;case 19:Ha(r,t),za(t),u&4&&(u=t.updateQueue,u!==null&&(t.updateQueue=null,X0(t,u)));break;case 30:break;case 21:break;default:Ha(r,t),za(t)}}function za(t){var r=t.flags;if(r&2){try{for(var l,u=t.return;u!==null;){if(ax(u)){l=u;break}u=u.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var h=l.stateNode,g=V0(t);Nc(t,g,h);break;case 5:var T=l.stateNode;l.flags&32&&(Cs(T,""),l.flags&=-33);var C=V0(t);Nc(t,C,T);break;case 3:case 4:var G=l.stateNode.containerInfo,le=V0(t);G0(t,le,G);break;default:throw Error(s(161))}}catch(Ee){jt(t,t.return,Ee)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function ux(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;ux(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function vn(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)sx(t,r.alternate,r),r=r.sibling}function ns(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:gn(4,r,r.return),ns(r);break;case 1:Cr(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&ex(r,r.return,l),ns(r);break;case 27:rl(r.stateNode);case 26:case 5:Cr(r,r.return),ns(r);break;case 22:r.memoizedState===null&&ns(r);break;case 30:ns(r);break;default:ns(r)}t=t.sibling}}function bn(t,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,h=t,g=r,T=g.flags;switch(g.tag){case 0:case 11:case 15:bn(h,g,l),qi(4,g);break;case 1:if(bn(h,g,l),u=g,h=u.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(le){jt(u,u.return,le)}if(u=g,h=u.updateQueue,h!==null){var C=u.stateNode;try{var G=h.shared.hiddenCallbacks;if(G!==null)for(h.shared.hiddenCallbacks=null,h=0;h<G.length;h++)Ud(G[h],C)}catch(le){jt(u,u.return,le)}}l&&T&64&&Jh(g),Ki(g,g.return);break;case 27:rx(g);case 26:case 5:bn(h,g,l),l&&u===null&&T&4&&tx(g),Ki(g,g.return);break;case 12:bn(h,g,l);break;case 13:bn(h,g,l),l&&T&4&&cx(h,g);break;case 22:g.memoizedState===null&&bn(h,g,l),Ki(g,g.return);break;case 30:break;default:bn(h,g,l)}r=r.sibling}}function q0(t,r){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&ji(l))}function K0(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&ji(t))}function kr(t,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)fx(t,r,l,u),r=r.sibling}function fx(t,r,l,u){var h=r.flags;switch(r.tag){case 0:case 11:case 15:kr(t,r,l,u),h&2048&&qi(9,r);break;case 1:kr(t,r,l,u);break;case 3:kr(t,r,l,u),h&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&ji(t)));break;case 12:if(h&2048){kr(t,r,l,u),t=r.stateNode;try{var g=r.memoizedProps,T=g.id,C=g.onPostCommit;typeof C=="function"&&C(T,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(G){jt(r,r.return,G)}}else kr(t,r,l,u);break;case 13:kr(t,r,l,u);break;case 23:break;case 22:g=r.stateNode,T=r.alternate,r.memoizedState!==null?g._visibility&2?kr(t,r,l,u):Wi(t,r):g._visibility&2?kr(t,r,l,u):(g._visibility|=2,qs(t,r,l,u,(r.subtreeFlags&10256)!==0)),h&2048&&q0(T,r);break;case 24:kr(t,r,l,u),h&2048&&K0(r.alternate,r);break;default:kr(t,r,l,u)}}function qs(t,r,l,u,h){for(h=h&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var g=t,T=r,C=l,G=u,le=T.flags;switch(T.tag){case 0:case 11:case 15:qs(g,T,C,G,h),qi(8,T);break;case 23:break;case 22:var Ee=T.stateNode;T.memoizedState!==null?Ee._visibility&2?qs(g,T,C,G,h):Wi(g,T):(Ee._visibility|=2,qs(g,T,C,G,h)),h&&le&2048&&q0(T.alternate,T);break;case 24:qs(g,T,C,G,h),h&&le&2048&&K0(T.alternate,T);break;default:qs(g,T,C,G,h)}r=r.sibling}}function Wi(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=t,u=r,h=u.flags;switch(u.tag){case 22:Wi(l,u),h&2048&&q0(u.alternate,u);break;case 24:Wi(l,u),h&2048&&K0(u.alternate,u);break;default:Wi(l,u)}r=r.sibling}}var $i=8192;function Ks(t){if(t.subtreeFlags&$i)for(t=t.child;t!==null;)dx(t),t=t.sibling}function dx(t){switch(t.tag){case 26:Ks(t),t.flags&$i&&t.memoizedState!==null&&ib(gr,t.memoizedState,t.memoizedProps);break;case 5:Ks(t);break;case 3:case 4:var r=gr;gr=Pc(t.stateNode.containerInfo),Ks(t),gr=r;break;case 22:t.memoizedState===null&&(r=t.alternate,r!==null&&r.memoizedState!==null?(r=$i,$i=16777216,Ks(t),$i=r):Ks(t));break;default:Ks(t)}}function hx(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function Zi(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];oa=u,mx(u,t)}hx(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)xx(t),t=t.sibling}function xx(t){switch(t.tag){case 0:case 11:case 15:Zi(t),t.flags&2048&&gn(9,t,t.return);break;case 3:Zi(t);break;case 12:Zi(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,Cc(t)):Zi(t);break;default:Zi(t)}}function Cc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];oa=u,mx(u,t)}hx(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:gn(8,r,r.return),Cc(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Cc(r));break;default:Cc(r)}t=t.sibling}}function mx(t,r){for(;oa!==null;){var l=oa;switch(l.tag){case 0:case 11:case 15:gn(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ji(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,oa=u;else e:for(l=t;oa!==null;){u=oa;var h=u.sibling,g=u.return;if(ix(u),u===l){oa=null;break e}if(h!==null){h.return=g,oa=h;break e}oa=g}}}var _v={getCacheForType:function(t){var r=ba(aa),l=r.data.get(t);return l===void 0&&(l=t(),r.data.set(t,l)),l}},wv=typeof WeakMap=="function"?WeakMap:Map,St=0,Lt=null,ht=null,gt=0,At=0,Va=null,yn=!1,Ws=!1,W0=!1,Zr=0,Vt=0,En=0,ss=0,$0=0,sr=0,$s=0,Qi=null,Ia=null,Z0=!1,Q0=0,kc=1/0,Dc=null,_n=null,xa=0,wn=null,Zs=null,Qs=0,J0=0,eu=null,px=null,Ji=0,tu=null;function Ga(){if((St&2)!==0&&gt!==0)return gt&-gt;if(Z.T!==null){var t=Us;return t!==0?t:cu()}return Ss()}function gx(){sr===0&&(sr=(gt&536870912)===0||Tt?Pn():536870912);var t=nr.current;return t!==null&&(t.flags|=32),sr}function Ya(t,r,l){(t===Lt&&(At===2||At===9)||t.cancelPendingCommit!==null)&&(Js(t,0),Tn(t,gt,sr,!1)),Sr(t,l),((St&2)===0||t!==Lt)&&(t===Lt&&((St&2)===0&&(ss|=l),Vt===4&&Tn(t,gt,sr,!1)),Dr(t))}function vx(t,r,l){if((St&6)!==0)throw Error(s(327));var u=!l&&(r&124)===0&&(r&t.expiredLanes)===0||Ir(t,r),h=u?Av(t,r):nu(t,r,!0),g=u;do{if(h===0){Ws&&!u&&Tn(t,r,0,!1);break}else{if(l=t.current.alternate,g&&!Tv(l)){h=nu(t,r,!1),g=!1;continue}if(h===2){if(g=r,t.errorRecoveryDisabledLanes&g)var T=0;else T=t.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;e:{var C=t;h=Qi;var G=C.current.memoizedState.isDehydrated;if(G&&(Js(C,T).flags|=256),T=nu(C,T,!1),T!==2){if(W0&&!G){C.errorRecoveryDisabledLanes|=g,ss|=g,h=4;break e}g=Ia,Ia=h,g!==null&&(Ia===null?Ia=g:Ia.push.apply(Ia,g))}h=T}if(g=!1,h!==2)continue}}if(h===1){Js(t,0),Tn(t,r,0,!0);break}e:{switch(u=t,g=h,g){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:Tn(u,r,sr,!yn);break e;case 2:Ia=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(h=Q0+300-ge(),10<h)){if(Tn(u,r,sr,!yn),sn(u,0,!0)!==0)break e;u.timeoutHandle=qx(bx.bind(null,u,l,Ia,Dc,Z0,r,sr,ss,$s,yn,g,2,-0,0),h);break e}bx(u,l,Ia,Dc,Z0,r,sr,ss,$s,yn,g,0,-0,0)}}break}while(!0);Dr(t)}function bx(t,r,l,u,h,g,T,C,G,le,Ee,Ae,de,me){if(t.timeoutHandle=-1,Ae=r.subtreeFlags,(Ae&8192||(Ae&16785408)===16785408)&&(il={stylesheets:null,count:0,unsuspend:sb},dx(r),Ae=lb(),Ae!==null)){t.cancelPendingCommit=Ae(Ax.bind(null,t,r,g,l,u,h,T,C,G,Ee,1,de,me)),Tn(t,g,T,!le);return}Ax(t,r,g,l,u,h,T,C,G)}function Tv(t){for(var r=t;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var h=l[u],g=h.getSnapshot;h=h.value;try{if(!Ua(g(),h))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Tn(t,r,l,u){r&=~$0,r&=~ss,t.suspendedLanes|=r,t.pingedLanes&=~r,u&&(t.warmLanes|=r),u=t.expirationTimes;for(var h=r;0<h;){var g=31-Je(h),T=1<<g;u[g]=-1,h&=~T}l!==0&&ws(t,l,r)}function Oc(){return(St&6)===0?(el(0),!1):!0}function au(){if(ht!==null){if(At===0)var t=ht.return;else t=ht,Vr=Jn=null,b0(t),Ys=null,Gi=0,t=ht;for(;t!==null;)Qh(t.alternate,t),t=t.return;ht=null}}function Js(t,r){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,zv(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),au(),Lt=t,ht=l=Pr(t.current,null),gt=r,At=0,Va=null,yn=!1,Ws=Ir(t,r),W0=!1,$s=sr=$0=ss=En=Vt=0,Ia=Qi=null,Z0=!1,(r&8)!==0&&(r|=r&32);var u=t.entangledLanes;if(u!==0)for(t=t.entanglements,u&=r;0<u;){var h=31-Je(u),g=1<<h;r|=t[h],u&=~g}return Zr=r,Jl(),l}function yx(t,r){ut=null,Z.H=vc,r===Li||r===cc?(r=Id(),At=3):r===Md?(r=Id(),At=4):At=r===Bh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Va=r,ht===null&&(Vt=1,wc(t,er(r,t.current)))}function Ex(){var t=Z.H;return Z.H=vc,t===null?vc:t}function _x(){var t=Z.A;return Z.A=_v,t}function ru(){Vt=4,yn||(gt&4194048)!==gt&&nr.current!==null||(Ws=!0),(En&134217727)===0&&(ss&134217727)===0||Lt===null||Tn(Lt,gt,sr,!1)}function nu(t,r,l){var u=St;St|=2;var h=Ex(),g=_x();(Lt!==t||gt!==r)&&(Dc=null,Js(t,r)),r=!1;var T=Vt;e:do try{if(At!==0&&ht!==null){var C=ht,G=Va;switch(At){case 8:au(),T=6;break e;case 3:case 2:case 9:case 6:nr.current===null&&(r=!0);var le=At;if(At=0,Va=null,ei(t,C,G,le),l&&Ws){T=0;break e}break;default:le=At,At=0,Va=null,ei(t,C,G,le)}}Sv(),T=Vt;break}catch(Ee){yx(t,Ee)}while(!0);return r&&t.shellSuspendCounter++,Vr=Jn=null,St=u,Z.H=h,Z.A=g,ht===null&&(Lt=null,gt=0,Jl()),T}function Sv(){for(;ht!==null;)wx(ht)}function Av(t,r){var l=St;St|=2;var u=Ex(),h=_x();Lt!==t||gt!==r?(Dc=null,kc=ge()+500,Js(t,r)):Ws=Ir(t,r);e:do try{if(At!==0&&ht!==null){r=ht;var g=Va;t:switch(At){case 1:At=0,Va=null,ei(t,r,g,1);break;case 2:case 9:if(Ld(g)){At=0,Va=null,Tx(r);break}r=function(){At!==2&&At!==9||Lt!==t||(At=7),Dr(t)},g.then(r,r);break e;case 3:At=7;break e;case 4:At=5;break e;case 7:Ld(g)?(At=0,Va=null,Tx(r)):(At=0,Va=null,ei(t,r,g,7));break;case 5:var T=null;switch(ht.tag){case 26:T=ht.memoizedState;case 5:case 27:var C=ht;if(!T||s1(T)){At=0,Va=null;var G=C.sibling;if(G!==null)ht=G;else{var le=C.return;le!==null?(ht=le,Rc(le)):ht=null}break t}}At=0,Va=null,ei(t,r,g,5);break;case 6:At=0,Va=null,ei(t,r,g,6);break;case 8:au(),Vt=6;break e;default:throw Error(s(462))}}Nv();break}catch(Ee){yx(t,Ee)}while(!0);return Vr=Jn=null,Z.H=u,Z.A=h,St=l,ht!==null?0:(Lt=null,gt=0,Jl(),Vt)}function Nv(){for(;ht!==null&&!We();)wx(ht)}function wx(t){var r=$h(t.alternate,t,Zr);t.memoizedProps=t.pendingProps,r===null?Rc(t):ht=r}function Tx(t){var r=t,l=r.alternate;switch(r.tag){case 15:case 0:r=Gh(l,r,r.pendingProps,r.type,void 0,gt);break;case 11:r=Gh(l,r,r.pendingProps,r.type.render,r.ref,gt);break;case 5:b0(r);default:Qh(l,r),r=ht=Sd(r,Zr),r=$h(l,r,Zr)}t.memoizedProps=t.pendingProps,r===null?Rc(t):ht=r}function ei(t,r,l,u){Vr=Jn=null,b0(r),Ys=null,Gi=0;var h=r.return;try{if(pv(t,h,r,l,gt)){Vt=1,wc(t,er(l,t.current)),ht=null;return}}catch(g){if(h!==null)throw ht=h,g;Vt=1,wc(t,er(l,t.current)),ht=null;return}r.flags&32768?(Tt||u===1?t=!0:Ws||(gt&536870912)!==0?t=!1:(yn=t=!0,(u===2||u===9||u===3||u===6)&&(u=nr.current,u!==null&&u.tag===13&&(u.flags|=16384))),Sx(r,t)):Rc(r)}function Rc(t){var r=t;do{if((r.flags&32768)!==0){Sx(r,yn);return}t=r.return;var l=vv(r.alternate,r,Zr);if(l!==null){ht=l;return}if(r=r.sibling,r!==null){ht=r;return}ht=r=t}while(r!==null);Vt===0&&(Vt=5)}function Sx(t,r){do{var l=bv(t.alternate,t);if(l!==null){l.flags&=32767,ht=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(t=t.sibling,t!==null)){ht=t;return}ht=t=l}while(t!==null);Vt=6,ht=null}function Ax(t,r,l,u,h,g,T,C,G){t.cancelPendingCommit=null;do jc();while(xa!==0);if((St&6)!==0)throw Error(s(327));if(r!==null){if(r===t.current)throw Error(s(177));if(g=r.lanes|r.childLanes,g|=Ko,ln(t,l,g,T,C,G),t===Lt&&(ht=Lt=null,gt=0),Zs=r,wn=t,Qs=l,J0=g,eu=h,px=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Ov(je,function(){return Ox(),null})):(t.callbackNode=null,t.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Z.T,Z.T=null,h=ue.p,ue.p=2,T=St,St|=4;try{yv(t,r,l)}finally{St=T,ue.p=h,Z.T=u}}xa=1,Nx(),Cx(),kx()}}function Nx(){if(xa===1){xa=0;var t=wn,r=Zs,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Z.T,Z.T=null;var u=ue.p;ue.p=2;var h=St;St|=4;try{ox(r,t);var g=pu,T=md(t.containerInfo),C=g.focusedElem,G=g.selectionRange;if(T!==C&&C&&C.ownerDocument&&xd(C.ownerDocument.documentElement,C)){if(G!==null&&Vo(C)){var le=G.start,Ee=G.end;if(Ee===void 0&&(Ee=le),"selectionStart"in C)C.selectionStart=le,C.selectionEnd=Math.min(Ee,C.value.length);else{var Ae=C.ownerDocument||document,de=Ae&&Ae.defaultView||window;if(de.getSelection){var me=de.getSelection(),Ze=C.textContent.length,qe=Math.min(G.start,Ze),Rt=G.end===void 0?qe:Math.min(G.end,Ze);!me.extend&&qe>Rt&&(T=Rt,Rt=qe,qe=T);var ae=hd(C,qe),J=hd(C,Rt);if(ae&&J&&(me.rangeCount!==1||me.anchorNode!==ae.node||me.anchorOffset!==ae.offset||me.focusNode!==J.node||me.focusOffset!==J.offset)){var ie=Ae.createRange();ie.setStart(ae.node,ae.offset),me.removeAllRanges(),qe>Rt?(me.addRange(ie),me.extend(J.node,J.offset)):(ie.setEnd(J.node,J.offset),me.addRange(ie))}}}}for(Ae=[],me=C;me=me.parentNode;)me.nodeType===1&&Ae.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<Ae.length;C++){var Te=Ae[C];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}Yc=!!mu,pu=mu=null}finally{St=h,ue.p=u,Z.T=l}}t.current=r,xa=2}}function Cx(){if(xa===2){xa=0;var t=wn,r=Zs,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Z.T,Z.T=null;var u=ue.p;ue.p=2;var h=St;St|=4;try{sx(t,r.alternate,r)}finally{St=h,ue.p=u,Z.T=l}}xa=3}}function kx(){if(xa===4||xa===3){xa=0,Ve();var t=wn,r=Zs,l=Qs,u=px;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?xa=5:(xa=0,Zs=wn=null,Dx(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(_n=null),Ht(l),r=r.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(ct,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=Z.T,h=ue.p,ue.p=2,Z.T=null;try{for(var g=t.onRecoverableError,T=0;T<u.length;T++){var C=u[T];g(C.value,{componentStack:C.stack})}}finally{Z.T=r,ue.p=h}}(Qs&3)!==0&&jc(),Dr(t),h=t.pendingLanes,(l&4194090)!==0&&(h&42)!==0?t===tu?Ji++:(Ji=0,tu=t):Ji=0,el(0)}}function Dx(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,ji(r)))}function jc(t){return Nx(),Cx(),kx(),Ox()}function Ox(){if(xa!==5)return!1;var t=wn,r=J0;J0=0;var l=Ht(Qs),u=Z.T,h=ue.p;try{ue.p=32>l?32:l,Z.T=null,l=eu,eu=null;var g=wn,T=Qs;if(xa=0,Zs=wn=null,Qs=0,(St&6)!==0)throw Error(s(331));var C=St;if(St|=4,xx(g.current),fx(g,g.current,T,l),St=C,el(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(ct,g)}catch{}return!0}finally{ue.p=h,Z.T=u,Dx(t,r)}}function Rx(t,r,l){r=er(l,r),r=j0(t.stateNode,r,2),t=hn(t,r,2),t!==null&&(Sr(t,2),Dr(t))}function jt(t,r,l){if(t.tag===3)Rx(t,t,l);else for(;r!==null;){if(r.tag===3){Rx(r,t,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(_n===null||!_n.has(u))){t=er(l,t),l=Fh(2),u=hn(r,l,2),u!==null&&(Ih(l,u,r,t),Sr(u,2),Dr(u));break}}r=r.return}}function su(t,r,l){var u=t.pingCache;if(u===null){u=t.pingCache=new wv;var h=new Set;u.set(r,h)}else h=u.get(r),h===void 0&&(h=new Set,u.set(r,h));h.has(l)||(W0=!0,h.add(l),t=Cv.bind(null,t,r,l),r.then(t,t))}function Cv(t,r,l){var u=t.pingCache;u!==null&&u.delete(r),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,Lt===t&&(gt&l)===l&&(Vt===4||Vt===3&&(gt&62914560)===gt&&300>ge()-Q0?(St&2)===0&&Js(t,0):$0|=l,$s===gt&&($s=0)),Dr(t)}function jx(t,r){r===0&&(r=Hn()),t=Ls(t,r),t!==null&&(Sr(t,r),Dr(t))}function kv(t){var r=t.memoizedState,l=0;r!==null&&(l=r.retryLane),jx(t,l)}function Dv(t,r){var l=0;switch(t.tag){case 13:var u=t.stateNode,h=t.memoizedState;h!==null&&(l=h.retryLane);break;case 19:u=t.stateNode;break;case 22:u=t.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(r),jx(t,l)}function Ov(t,r){return Pe(t,r)}var Mc=null,ti=null,iu=!1,Lc=!1,lu=!1,is=0;function Dr(t){t!==ti&&t.next===null&&(ti===null?Mc=ti=t:ti=ti.next=t),Lc=!0,iu||(iu=!0,jv())}function el(t,r){if(!lu&&Lc){lu=!0;do for(var l=!1,u=Mc;u!==null;){if(t!==0){var h=u.pendingLanes;if(h===0)var g=0;else{var T=u.suspendedLanes,C=u.pingedLanes;g=(1<<31-Je(42|t)+1)-1,g&=h&~(T&~C),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Ix(u,g))}else g=gt,g=sn(u,u===Lt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Ir(u,g)||(l=!0,Ix(u,g));u=u.next}while(l);lu=!1}}function Rv(){Mx()}function Mx(){Lc=iu=!1;var t=0;is!==0&&(Hv()&&(t=is),is=0);for(var r=ge(),l=null,u=Mc;u!==null;){var h=u.next,g=Lx(u,r);g===0?(u.next=null,l===null?Mc=h:l.next=h,h===null&&(ti=l)):(l=u,(t!==0||(g&3)!==0)&&(Lc=!0)),u=h}el(t)}function Lx(t,r){for(var l=t.suspendedLanes,u=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var T=31-Je(g),C=1<<T,G=h[T];G===-1?((C&l)===0||(C&u)!==0)&&(h[T]=_s(C,r)):G<=r&&(t.expiredLanes|=C),g&=~C}if(r=Lt,l=gt,l=sn(t,t===r?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),u=t.callbackNode,l===0||t===r&&(At===2||At===9)||t.cancelPendingCommit!==null)return u!==null&&u!==null&&Ue(u),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||Ir(t,l)){if(r=l&-l,r===t.callbackPriority)return r;switch(u!==null&&Ue(u),Ht(l)){case 2:case 8:l=ye;break;case 32:l=je;break;case 268435456:l=Ge;break;default:l=je}return u=Fx.bind(null,t),l=Pe(l,u),t.callbackPriority=r,t.callbackNode=l,r}return u!==null&&u!==null&&Ue(u),t.callbackPriority=2,t.callbackNode=null,2}function Fx(t,r){if(xa!==0&&xa!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(jc()&&t.callbackNode!==l)return null;var u=gt;return u=sn(t,t===Lt?u:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),u===0?null:(vx(t,u,r),Lx(t,ge()),t.callbackNode!=null&&t.callbackNode===l?Fx.bind(null,t):null)}function Ix(t,r){if(jc())return null;vx(t,r,!0)}function jv(){Vv(function(){(St&6)!==0?Pe(pt,Rv):Mx()})}function cu(){return is===0&&(is=Pn()),is}function Bx(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Xl(""+t)}function Ux(t,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,t.id&&l.setAttribute("form",t.id),r.parentNode.insertBefore(l,r),t=new FormData(t),l.parentNode.removeChild(l),t}function Mv(t,r,l,u,h){if(r==="submit"&&l&&l.stateNode===h){var g=Bx((h[$t]||null).action),T=u.submitter;T&&(r=(r=T[$t]||null)?Bx(r.formAction):T.getAttribute("formAction"),r!==null&&(g=r,T=null));var C=new $l("action","action",null,u,h);t.push({event:C,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(is!==0){var G=T?Ux(h,T):new FormData(h);C0(l,{pending:!0,data:G,method:h.method,action:g},null,G)}}else typeof g=="function"&&(C.preventDefault(),G=T?Ux(h,T):new FormData(h),C0(l,{pending:!0,data:G,method:h.method,action:g},g,G))},currentTarget:h}]})}}for(var ou=0;ou<qo.length;ou++){var uu=qo[ou],Lv=uu.toLowerCase(),Fv=uu[0].toUpperCase()+uu.slice(1);pr(Lv,"on"+Fv)}pr(vd,"onAnimationEnd"),pr(bd,"onAnimationIteration"),pr(yd,"onAnimationStart"),pr("dblclick","onDoubleClick"),pr("focusin","onFocus"),pr("focusout","onBlur"),pr(J2,"onTransitionRun"),pr(ev,"onTransitionStart"),pr(tv,"onTransitionCancel"),pr(Ed,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),Ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tl));function Px(t,r){r=(r&4)!==0;for(var l=0;l<t.length;l++){var u=t[l],h=u.event;u=u.listeners;e:{var g=void 0;if(r)for(var T=u.length-1;0<=T;T--){var C=u[T],G=C.instance,le=C.currentTarget;if(C=C.listener,G!==g&&h.isPropagationStopped())break e;g=C,h.currentTarget=le;try{g(h)}catch(Ee){_c(Ee)}h.currentTarget=null,g=G}else for(T=0;T<u.length;T++){if(C=u[T],G=C.instance,le=C.currentTarget,C=C.listener,G!==g&&h.isPropagationStopped())break e;g=C,h.currentTarget=le;try{g(h)}catch(Ee){_c(Ee)}h.currentTarget=null,g=G}}}}function xt(t,r){var l=r[Ye];l===void 0&&(l=r[Ye]=new Set);var u=t+"__bubble";l.has(u)||(Hx(r,t,2,!1),l.add(u))}function fu(t,r,l){var u=0;r&&(u|=4),Hx(l,t,u,r)}var Fc="_reactListening"+Math.random().toString(36).slice(2);function du(t){if(!t[Fc]){t[Fc]=!0,fe.forEach(function(l){l!=="selectionchange"&&(Iv.has(l)||fu(l,!1,t),fu(l,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Fc]||(r[Fc]=!0,fu("selectionchange",!1,r))}}function Hx(t,r,l,u){switch(f1(r)){case 2:var h=ub;break;case 8:h=fb;break;default:h=Au}l=h.bind(null,r,l,t),h=void 0,!Mo||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),u?h!==void 0?t.addEventListener(r,l,{capture:!0,passive:h}):t.addEventListener(r,l,!0):h!==void 0?t.addEventListener(r,l,{passive:h}):t.addEventListener(r,l,!1)}function hu(t,r,l,u,h){var g=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var C=u.stateNode.containerInfo;if(C===h)break;if(T===4)for(T=u.return;T!==null;){var G=T.tag;if((G===3||G===4)&&T.stateNode.containerInfo===h)return;T=T.return}for(;C!==null;){if(T=F(C),T===null)return;if(G=T.tag,G===5||G===6||G===26||G===27){u=g=T;continue e}C=C.parentNode}}u=u.return}Kf(function(){var le=g,Ee=Ro(l),Ae=[];e:{var de=_d.get(t);if(de!==void 0){var me=$l,Ze=t;switch(t){case"keypress":if(Kl(l)===0)break e;case"keydown":case"keyup":me=O2;break;case"focusin":Ze="focus",me=Bo;break;case"focusout":Ze="blur",me=Bo;break;case"beforeblur":case"afterblur":me=Bo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Zf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=b2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=M2;break;case vd:case bd:case yd:me=_2;break;case Ed:me=F2;break;case"scroll":case"scrollend":me=g2;break;case"wheel":me=B2;break;case"copy":case"cut":case"paste":me=T2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Jf;break;case"toggle":case"beforetoggle":me=P2}var qe=(r&4)!==0,Rt=!qe&&(t==="scroll"||t==="scrollend"),ae=qe?de!==null?de+"Capture":null:de;qe=[];for(var J=le,ie;J!==null;){var Te=J;if(ie=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||ie===null||ae===null||(Te=yi(J,ae),Te!=null&&qe.push(al(J,Te,ie))),Rt)break;J=J.return}0<qe.length&&(de=new me(de,Ze,null,l,Ee),Ae.push({event:de,listeners:qe}))}}if((r&7)===0){e:{if(de=t==="mouseover"||t==="pointerover",me=t==="mouseout"||t==="pointerout",de&&l!==Oo&&(Ze=l.relatedTarget||l.fromElement)&&(F(Ze)||Ze[hr]))break e;if((me||de)&&(de=Ee.window===Ee?Ee:(de=Ee.ownerDocument)?de.defaultView||de.parentWindow:window,me?(Ze=l.relatedTarget||l.toElement,me=le,Ze=Ze?F(Ze):null,Ze!==null&&(Rt=o(Ze),qe=Ze.tag,Ze!==Rt||qe!==5&&qe!==27&&qe!==6)&&(Ze=null)):(me=null,Ze=le),me!==Ze)){if(qe=Zf,Te="onMouseLeave",ae="onMouseEnter",J="mouse",(t==="pointerout"||t==="pointerover")&&(qe=Jf,Te="onPointerLeave",ae="onPointerEnter",J="pointer"),Rt=me==null?de:ce(me),ie=Ze==null?de:ce(Ze),de=new qe(Te,J+"leave",me,l,Ee),de.target=Rt,de.relatedTarget=ie,Te=null,F(Ee)===le&&(qe=new qe(ae,J+"enter",Ze,l,Ee),qe.target=ie,qe.relatedTarget=Rt,Te=qe),Rt=Te,me&&Ze)t:{for(qe=me,ae=Ze,J=0,ie=qe;ie;ie=ai(ie))J++;for(ie=0,Te=ae;Te;Te=ai(Te))ie++;for(;0<J-ie;)qe=ai(qe),J--;for(;0<ie-J;)ae=ai(ae),ie--;for(;J--;){if(qe===ae||ae!==null&&qe===ae.alternate)break t;qe=ai(qe),ae=ai(ae)}qe=null}else qe=null;me!==null&&zx(Ae,de,me,qe,!1),Ze!==null&&Rt!==null&&zx(Ae,Rt,Ze,qe,!0)}}e:{if(de=le?ce(le):window,me=de.nodeName&&de.nodeName.toLowerCase(),me==="select"||me==="input"&&de.type==="file")var Fe=ld;else if(sd(de))if(cd)Fe=$2;else{Fe=K2;var ft=q2}else me=de.nodeName,!me||me.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?le&&Do(le.elementType)&&(Fe=ld):Fe=W2;if(Fe&&(Fe=Fe(t,le))){id(Ae,Fe,l,Ee);break e}ft&&ft(t,de,le),t==="focusout"&&le&&de.type==="number"&&le.memoizedProps.value!=null&&ko(de,"number",de.value)}switch(ft=le?ce(le):window,t){case"focusin":(sd(ft)||ft.contentEditable==="true")&&(Rs=ft,Go=le,Ci=null);break;case"focusout":Ci=Go=Rs=null;break;case"mousedown":Yo=!0;break;case"contextmenu":case"mouseup":case"dragend":Yo=!1,pd(Ae,l,Ee);break;case"selectionchange":if(Q2)break;case"keydown":case"keyup":pd(Ae,l,Ee)}var He;if(Po)e:{switch(t){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Os?rd(t,l)&&(Ke="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(Ke="onCompositionStart");Ke&&(ed&&l.locale!=="ko"&&(Os||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Os&&(He=Wf()):(on=Ee,Lo="value"in on?on.value:on.textContent,Os=!0)),ft=Ic(le,Ke),0<ft.length&&(Ke=new Qf(Ke,t,null,l,Ee),Ae.push({event:Ke,listeners:ft}),He?Ke.data=He:(He=nd(l),He!==null&&(Ke.data=He)))),(He=z2?V2(t,l):G2(t,l))&&(Ke=Ic(le,"onBeforeInput"),0<Ke.length&&(ft=new Qf("onBeforeInput","beforeinput",null,l,Ee),Ae.push({event:ft,listeners:Ke}),ft.data=He)),Mv(Ae,t,le,l,Ee)}Px(Ae,r)})}function al(t,r,l){return{instance:t,listener:r,currentTarget:l}}function Ic(t,r){for(var l=r+"Capture",u=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=yi(t,l),h!=null&&u.unshift(al(t,h,g)),h=yi(t,r),h!=null&&u.push(al(t,h,g))),t.tag===3)return u;t=t.return}return[]}function ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function zx(t,r,l,u,h){for(var g=r._reactName,T=[];l!==null&&l!==u;){var C=l,G=C.alternate,le=C.stateNode;if(C=C.tag,G!==null&&G===u)break;C!==5&&C!==26&&C!==27||le===null||(G=le,h?(le=yi(l,g),le!=null&&T.unshift(al(l,le,G))):h||(le=yi(l,g),le!=null&&T.push(al(l,le,G)))),l=l.return}T.length!==0&&t.push({event:r,listeners:T})}var Bv=/\r\n?/g,Uv=/\u0000|\uFFFD/g;function Vx(t){return(typeof t=="string"?t:""+t).replace(Bv,`
`).replace(Uv,"")}function Gx(t,r){return r=Vx(r),Vx(t)===r}function Bc(){}function Ot(t,r,l,u,h,g){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Cs(t,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Cs(t,""+u);break;case"className":kt(t,"class",u);break;case"tabIndex":kt(t,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":kt(t,l,u);break;case"style":Xf(t,u,g);break;case"data":if(r!=="object"){kt(t,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){t.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){t.removeAttribute(l);break}u=Xl(""+u),t.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(r!=="input"&&Ot(t,r,"name",h.name,h,null),Ot(t,r,"formEncType",h.formEncType,h,null),Ot(t,r,"formMethod",h.formMethod,h,null),Ot(t,r,"formTarget",h.formTarget,h,null)):(Ot(t,r,"encType",h.encType,h,null),Ot(t,r,"method",h.method,h,null),Ot(t,r,"target",h.target,h,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){t.removeAttribute(l);break}u=Xl(""+u),t.setAttribute(l,u);break;case"onClick":u!=null&&(t.onclick=Bc);break;case"onScroll":u!=null&&xt("scroll",t);break;case"onScrollEnd":u!=null&&xt("scrollend",t);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=l}}break;case"multiple":t.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":t.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){t.removeAttribute("xlink:href");break}l=Xl(""+u),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(l,""+u):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":u===!0?t.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(l,u):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?t.setAttribute(l,u):t.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?t.removeAttribute(l):t.setAttribute(l,u);break;case"popover":xt("beforetoggle",t),xt("toggle",t),Ct(t,"popover",u);break;case"xlinkActuate":Mt(t,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Mt(t,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Mt(t,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Mt(t,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Mt(t,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Mt(t,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Mt(t,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Mt(t,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Mt(t,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ct(t,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=m2.get(l)||l,Ct(t,l,u))}}function xu(t,r,l,u,h,g){switch(l){case"style":Xf(t,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=l}}break;case"children":typeof u=="string"?Cs(t,u):(typeof u=="number"||typeof u=="bigint")&&Cs(t,""+u);break;case"onScroll":u!=null&&xt("scroll",t);break;case"onScrollEnd":u!=null&&xt("scrollend",t);break;case"onClick":u!=null&&(t.onclick=Bc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(h=l.endsWith("Capture"),r=l.slice(2,h?l.length-7:void 0),g=t[$t]||null,g=g!=null?g[l]:null,typeof g=="function"&&t.removeEventListener(r,g,h),typeof u=="function")){typeof g!="function"&&g!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(r,u,h);break e}l in t?t[l]=u:u===!0?t.setAttribute(l,""):Ct(t,l,u)}}}function ma(t,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",t),xt("load",t);var u=!1,h=!1,g;for(g in l)if(l.hasOwnProperty(g)){var T=l[g];if(T!=null)switch(g){case"src":u=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Ot(t,r,g,T,l,null)}}h&&Ot(t,r,"srcSet",l.srcSet,l,null),u&&Ot(t,r,"src",l.src,l,null);return;case"input":xt("invalid",t);var C=g=T=h=null,G=null,le=null;for(u in l)if(l.hasOwnProperty(u)){var Ee=l[u];if(Ee!=null)switch(u){case"name":h=Ee;break;case"type":T=Ee;break;case"checked":G=Ee;break;case"defaultChecked":le=Ee;break;case"value":g=Ee;break;case"defaultValue":C=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(s(137,r));break;default:Ot(t,r,u,Ee,l,null)}}zf(t,g,C,G,le,T,h,!1),Gl(t);return;case"select":xt("invalid",t),u=T=g=null;for(h in l)if(l.hasOwnProperty(h)&&(C=l[h],C!=null))switch(h){case"value":g=C;break;case"defaultValue":T=C;break;case"multiple":u=C;default:Ot(t,r,h,C,l,null)}r=g,l=T,t.multiple=!!u,r!=null?Ns(t,!!u,r,!1):l!=null&&Ns(t,!!u,l,!0);return;case"textarea":xt("invalid",t),g=h=u=null;for(T in l)if(l.hasOwnProperty(T)&&(C=l[T],C!=null))switch(T){case"value":u=C;break;case"defaultValue":h=C;break;case"children":g=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:Ot(t,r,T,C,l,null)}Gf(t,u,h,g),Gl(t);return;case"option":for(G in l)if(l.hasOwnProperty(G)&&(u=l[G],u!=null))switch(G){case"selected":t.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ot(t,r,G,u,l,null)}return;case"dialog":xt("beforetoggle",t),xt("toggle",t),xt("cancel",t),xt("close",t);break;case"iframe":case"object":xt("load",t);break;case"video":case"audio":for(u=0;u<tl.length;u++)xt(tl[u],t);break;case"image":xt("error",t),xt("load",t);break;case"details":xt("toggle",t);break;case"embed":case"source":case"link":xt("error",t),xt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in l)if(l.hasOwnProperty(le)&&(u=l[le],u!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Ot(t,r,le,u,l,null)}return;default:if(Do(r)){for(Ee in l)l.hasOwnProperty(Ee)&&(u=l[Ee],u!==void 0&&xu(t,r,Ee,u,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(u=l[C],u!=null&&Ot(t,r,C,u,l,null))}function Pv(t,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,T=null,C=null,G=null,le=null,Ee=null;for(me in l){var Ae=l[me];if(l.hasOwnProperty(me)&&Ae!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":G=Ae;default:u.hasOwnProperty(me)||Ot(t,r,me,null,u,Ae)}}for(var de in u){var me=u[de];if(Ae=l[de],u.hasOwnProperty(de)&&(me!=null||Ae!=null))switch(de){case"type":g=me;break;case"name":h=me;break;case"checked":le=me;break;case"defaultChecked":Ee=me;break;case"value":T=me;break;case"defaultValue":C=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(s(137,r));break;default:me!==Ae&&Ot(t,r,de,me,u,Ae)}}Co(t,T,C,G,le,Ee,g,h);return;case"select":me=T=C=de=null;for(g in l)if(G=l[g],l.hasOwnProperty(g)&&G!=null)switch(g){case"value":break;case"multiple":me=G;default:u.hasOwnProperty(g)||Ot(t,r,g,null,u,G)}for(h in u)if(g=u[h],G=l[h],u.hasOwnProperty(h)&&(g!=null||G!=null))switch(h){case"value":de=g;break;case"defaultValue":C=g;break;case"multiple":T=g;default:g!==G&&Ot(t,r,h,g,u,G)}r=C,l=T,u=me,de!=null?Ns(t,!!l,de,!1):!!u!=!!l&&(r!=null?Ns(t,!!l,r,!0):Ns(t,!!l,l?[]:"",!1));return;case"textarea":me=de=null;for(C in l)if(h=l[C],l.hasOwnProperty(C)&&h!=null&&!u.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Ot(t,r,C,null,u,h)}for(T in u)if(h=u[T],g=l[T],u.hasOwnProperty(T)&&(h!=null||g!=null))switch(T){case"value":de=h;break;case"defaultValue":me=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==g&&Ot(t,r,T,h,u,g)}Vf(t,de,me);return;case"option":for(var Ze in l)if(de=l[Ze],l.hasOwnProperty(Ze)&&de!=null&&!u.hasOwnProperty(Ze))switch(Ze){case"selected":t.selected=!1;break;default:Ot(t,r,Ze,null,u,de)}for(G in u)if(de=u[G],me=l[G],u.hasOwnProperty(G)&&de!==me&&(de!=null||me!=null))switch(G){case"selected":t.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:Ot(t,r,G,de,u,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qe in l)de=l[qe],l.hasOwnProperty(qe)&&de!=null&&!u.hasOwnProperty(qe)&&Ot(t,r,qe,null,u,de);for(le in u)if(de=u[le],me=l[le],u.hasOwnProperty(le)&&de!==me&&(de!=null||me!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(s(137,r));break;default:Ot(t,r,le,de,u,me)}return;default:if(Do(r)){for(var Rt in l)de=l[Rt],l.hasOwnProperty(Rt)&&de!==void 0&&!u.hasOwnProperty(Rt)&&xu(t,r,Rt,void 0,u,de);for(Ee in u)de=u[Ee],me=l[Ee],!u.hasOwnProperty(Ee)||de===me||de===void 0&&me===void 0||xu(t,r,Ee,de,u,me);return}}for(var ae in l)de=l[ae],l.hasOwnProperty(ae)&&de!=null&&!u.hasOwnProperty(ae)&&Ot(t,r,ae,null,u,de);for(Ae in u)de=u[Ae],me=l[Ae],!u.hasOwnProperty(Ae)||de===me||de==null&&me==null||Ot(t,r,Ae,de,u,me)}var mu=null,pu=null;function Uc(t){return t.nodeType===9?t:t.ownerDocument}function Yx(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xx(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function gu(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var vu=null;function Hv(){var t=window.event;return t&&t.type==="popstate"?t===vu?!1:(vu=t,!0):(vu=null,!1)}var qx=typeof setTimeout=="function"?setTimeout:void 0,zv=typeof clearTimeout=="function"?clearTimeout:void 0,Kx=typeof Promise=="function"?Promise:void 0,Vv=typeof queueMicrotask=="function"?queueMicrotask:typeof Kx<"u"?function(t){return Kx.resolve(null).then(t).catch(Gv)}:qx;function Gv(t){setTimeout(function(){throw t})}function Sn(t){return t==="head"}function Wx(t,r){var l=r,u=0,h=0;do{var g=l.nextSibling;if(t.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var T=t.ownerDocument;if(l&1&&rl(T.documentElement),l&2&&rl(T.body),l&4)for(l=T.head,rl(l),T=l.firstChild;T;){var C=T.nextSibling,G=T.nodeName;T[O]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=C}}if(h===0){t.removeChild(g),fl(r);return}h--}else l==="$"||l==="$?"||l==="$!"?h++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);fl(r)}function bu(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":bu(l),M(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function Yv(t,r,l,u){for(;t.nodeType===1;){var h=l;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(u){if(!t[O])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=vr(t.nextSibling),t===null)break}return null}function Xv(t,r,l){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=vr(t.nextSibling),t===null))return null;return t}function yu(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function qv(t,r){var l=t.ownerDocument;if(t.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),t._reactRetry=u}}function vr(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return t}var Eu=null;function $x(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return t;r--}else l==="/$"&&r++}t=t.previousSibling}return null}function Zx(t,r,l){switch(r=Uc(l),t){case"html":if(t=r.documentElement,!t)throw Error(s(452));return t;case"head":if(t=r.head,!t)throw Error(s(453));return t;case"body":if(t=r.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function rl(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);M(t)}var ir=new Map,Qx=new Set;function Pc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Qr=ue.d;ue.d={f:Kv,r:Wv,D:$v,C:Zv,L:Qv,m:Jv,X:tb,S:eb,M:ab};function Kv(){var t=Qr.f(),r=Oc();return t||r}function Wv(t){var r=P(t);r!==null&&r.tag===5&&r.type==="form"?vh(r):Qr.r(t)}var ri=typeof document>"u"?null:document;function Jx(t,r,l){var u=ri;if(u&&typeof r=="string"&&r){var h=Ja(r);h='link[rel="'+t+'"][href="'+h+'"]',typeof l=="string"&&(h+='[crossorigin="'+l+'"]'),Qx.has(h)||(Qx.add(h),t={rel:t,crossOrigin:l,href:r},u.querySelector(h)===null&&(r=u.createElement("link"),ma(r,"link",t),re(r),u.head.appendChild(r)))}}function $v(t){Qr.D(t),Jx("dns-prefetch",t,null)}function Zv(t,r){Qr.C(t,r),Jx("preconnect",t,r)}function Qv(t,r,l){Qr.L(t,r,l);var u=ri;if(u&&t&&r){var h='link[rel="preload"][as="'+Ja(r)+'"]';r==="image"&&l&&l.imageSrcSet?(h+='[imagesrcset="'+Ja(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(h+='[imagesizes="'+Ja(l.imageSizes)+'"]')):h+='[href="'+Ja(t)+'"]';var g=h;switch(r){case"style":g=ni(t);break;case"script":g=si(t)}ir.has(g)||(t=p({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:t,as:r},l),ir.set(g,t),u.querySelector(h)!==null||r==="style"&&u.querySelector(nl(g))||r==="script"&&u.querySelector(sl(g))||(r=u.createElement("link"),ma(r,"link",t),re(r),u.head.appendChild(r)))}}function Jv(t,r){Qr.m(t,r);var l=ri;if(l&&t){var u=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+Ja(u)+'"][href="'+Ja(t)+'"]',g=h;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=si(t)}if(!ir.has(g)&&(t=p({rel:"modulepreload",href:t},r),ir.set(g,t),l.querySelector(h)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(sl(g)))return}u=l.createElement("link"),ma(u,"link",t),re(u),l.head.appendChild(u)}}}function eb(t,r,l){Qr.S(t,r,l);var u=ri;if(u&&t){var h=be(u).hoistableStyles,g=ni(t);r=r||"default";var T=h.get(g);if(!T){var C={loading:0,preload:null};if(T=u.querySelector(nl(g)))C.loading=5;else{t=p({rel:"stylesheet",href:t,"data-precedence":r},l),(l=ir.get(g))&&_u(t,l);var G=T=u.createElement("link");re(G),ma(G,"link",t),G._p=new Promise(function(le,Ee){G.onload=le,G.onerror=Ee}),G.addEventListener("load",function(){C.loading|=1}),G.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Hc(T,r,u)}T={type:"stylesheet",instance:T,count:1,state:C},h.set(g,T)}}}function tb(t,r){Qr.X(t,r);var l=ri;if(l&&t){var u=be(l).hoistableScripts,h=si(t),g=u.get(h);g||(g=l.querySelector(sl(h)),g||(t=p({src:t,async:!0},r),(r=ir.get(h))&&wu(t,r),g=l.createElement("script"),re(g),ma(g,"link",t),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(h,g))}}function ab(t,r){Qr.M(t,r);var l=ri;if(l&&t){var u=be(l).hoistableScripts,h=si(t),g=u.get(h);g||(g=l.querySelector(sl(h)),g||(t=p({src:t,async:!0,type:"module"},r),(r=ir.get(h))&&wu(t,r),g=l.createElement("script"),re(g),ma(g,"link",t),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(h,g))}}function e1(t,r,l,u){var h=(h=W.current)?Pc(h):null;if(!h)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=ni(l.href),l=be(h).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=ni(l.href);var g=be(h).hoistableStyles,T=g.get(t);if(T||(h=h.ownerDocument||h,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,T),(g=h.querySelector(nl(t)))&&!g._p&&(T.instance=g,T.state.loading=5),ir.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ir.set(t,l),g||rb(h,t,l,T.state))),r&&u===null)throw Error(s(528,""));return T}if(r&&u!==null)throw Error(s(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=si(l),l=be(h).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function ni(t){return'href="'+Ja(t)+'"'}function nl(t){return'link[rel="stylesheet"]['+t+"]"}function t1(t){return p({},t,{"data-precedence":t.precedence,precedence:null})}function rb(t,r,l,u){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=t.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),ma(r,"link",l),re(r),t.head.appendChild(r))}function si(t){return'[src="'+Ja(t)+'"]'}function sl(t){return"script[async]"+t}function a1(t,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=t.querySelector('style[data-href~="'+Ja(l.href)+'"]');if(u)return r.instance=u,re(u),u;var h=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(t.ownerDocument||t).createElement("style"),re(u),ma(u,"style",h),Hc(u,l.precedence,t),r.instance=u;case"stylesheet":h=ni(l.href);var g=t.querySelector(nl(h));if(g)return r.state.loading|=4,r.instance=g,re(g),g;u=t1(l),(h=ir.get(h))&&_u(u,h),g=(t.ownerDocument||t).createElement("link"),re(g);var T=g;return T._p=new Promise(function(C,G){T.onload=C,T.onerror=G}),ma(g,"link",u),r.state.loading|=4,Hc(g,l.precedence,t),r.instance=g;case"script":return g=si(l.src),(h=t.querySelector(sl(g)))?(r.instance=h,re(h),h):(u=l,(h=ir.get(g))&&(u=p({},l),wu(u,h)),t=t.ownerDocument||t,h=t.createElement("script"),re(h),ma(h,"link",u),t.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Hc(u,l.precedence,t));return r.instance}function Hc(t,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=u.length?u[u.length-1]:null,g=h,T=0;T<u.length;T++){var C=u[T];if(C.dataset.precedence===r)g=C;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(t,r.firstChild))}function _u(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function wu(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var zc=null;function r1(t,r,l){if(zc===null){var u=new Map,h=zc=new Map;h.set(l,u)}else h=zc,u=h.get(l),u||(u=new Map,h.set(l,u));if(u.has(t))return u;for(u.set(t,null),l=l.getElementsByTagName(t),h=0;h<l.length;h++){var g=l[h];if(!(g[O]||g[Xt]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(r)||"";T=t+T;var C=u.get(T);C?C.push(g):u.set(T,[g])}}return u}function n1(t,r,l){t=t.ownerDocument||t,t.head.insertBefore(l,r==="title"?t.querySelector("head > title"):null)}function nb(t,r,l){if(l===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function s1(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var il=null;function sb(){}function ib(t,r,l){if(il===null)throw Error(s(475));var u=il;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var h=ni(l.href),g=t.querySelector(nl(h));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(u.count++,u=Vc.bind(u),t.then(u,u)),r.state.loading|=4,r.instance=g,re(g);return}g=t.ownerDocument||t,l=t1(l),(h=ir.get(h))&&_u(l,h),g=g.createElement("link"),re(g);var T=g;T._p=new Promise(function(C,G){T.onload=C,T.onerror=G}),ma(g,"link",l),r.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=Vc.bind(u),t.addEventListener("load",r),t.addEventListener("error",r))}}function lb(){if(il===null)throw Error(s(475));var t=il;return t.stylesheets&&t.count===0&&Tu(t,t.stylesheets),0<t.count?function(r){var l=setTimeout(function(){if(t.stylesheets&&Tu(t,t.stylesheets),t.unsuspend){var u=t.unsuspend;t.unsuspend=null,u()}},6e4);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(l)}}:null}function Vc(){if(this.count--,this.count===0){if(this.stylesheets)Tu(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Gc=null;function Tu(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Gc=new Map,r.forEach(cb,t),Gc=null,Vc.call(t))}function cb(t,r){if(!(r.state.loading&4)){var l=Gc.get(t);if(l)var u=l.get(null);else{l=new Map,Gc.set(t,l);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var T=h[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),u=T)}u&&l.set(null,u)}h=r.instance,T=h.getAttribute("data-precedence"),g=l.get(T)||u,g===u&&l.set(null,h),l.set(T,h),this.count++,u=Vc.bind(this),h.addEventListener("load",u),h.addEventListener("error",u),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),r.state.loading|=4}}var ll={$$typeof:A,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function ob(t,r,l,u,h,g,T,C){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zn(0),this.hiddenUpdates=zn(null),this.identifierPrefix=u,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function i1(t,r,l,u,h,g,T,C,G,le,Ee,Ae){return t=new ob(t,r,l,T,C,G,le,Ae),r=1,g===!0&&(r|=24),g=Pa(3,null,null,r),t.current=g,g.stateNode=t,r=s0(),r.refCount++,t.pooledCache=r,r.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:r},o0(g),t}function l1(t){return t?(t=Fs,t):Fs}function c1(t,r,l,u,h,g){h=l1(h),u.context===null?u.context=h:u.pendingContext=h,u=dn(r),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=hn(t,u,r),l!==null&&(Ya(l,t,r),Ii(l,t,r))}function o1(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<r?l:r}}function Su(t,r){o1(t,r),(t=t.alternate)&&o1(t,r)}function u1(t){if(t.tag===13){var r=Ls(t,67108864);r!==null&&Ya(r,t,67108864),Su(t,67108864)}}var Yc=!0;function ub(t,r,l,u){var h=Z.T;Z.T=null;var g=ue.p;try{ue.p=2,Au(t,r,l,u)}finally{ue.p=g,Z.T=h}}function fb(t,r,l,u){var h=Z.T;Z.T=null;var g=ue.p;try{ue.p=8,Au(t,r,l,u)}finally{ue.p=g,Z.T=h}}function Au(t,r,l,u){if(Yc){var h=Nu(u);if(h===null)hu(t,r,u,Xc,l),d1(t,u);else if(hb(h,t,r,l,u))u.stopPropagation();else if(d1(t,u),r&4&&-1<db.indexOf(t)){for(;h!==null;){var g=P(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=$a(g.pendingLanes);if(T!==0){var C=g;for(C.pendingLanes|=2,C.entangledLanes|=2;T;){var G=1<<31-Je(T);C.entanglements[1]|=G,T&=~G}Dr(g),(St&6)===0&&(kc=ge()+500,el(0))}}break;case 13:C=Ls(g,2),C!==null&&Ya(C,g,2),Oc(),Su(g,2)}if(g=Nu(u),g===null&&hu(t,r,u,Xc,l),g===h)break;h=g}h!==null&&u.stopPropagation()}else hu(t,r,u,null,l)}}function Nu(t){return t=Ro(t),Cu(t)}var Xc=null;function Cu(t){if(Xc=null,t=F(t),t!==null){var r=o(t);if(r===null)t=null;else{var l=r.tag;if(l===13){if(t=f(r),t!==null)return t;t=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return Xc=t,null}function f1(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case pt:return 2;case ye:return 8;case je:case lt:return 32;case Ge:return 268435456;default:return 32}default:return 32}}var ku=!1,An=null,Nn=null,Cn=null,cl=new Map,ol=new Map,kn=[],db="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function d1(t,r){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":Cn=null;break;case"pointerover":case"pointerout":cl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ol.delete(r.pointerId)}}function ul(t,r,l,u,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[h]},r!==null&&(r=P(r),r!==null&&u1(r)),t):(t.eventSystemFlags|=u,r=t.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),t)}function hb(t,r,l,u,h){switch(r){case"focusin":return An=ul(An,t,r,l,u,h),!0;case"dragenter":return Nn=ul(Nn,t,r,l,u,h),!0;case"mouseover":return Cn=ul(Cn,t,r,l,u,h),!0;case"pointerover":var g=h.pointerId;return cl.set(g,ul(cl.get(g)||null,t,r,l,u,h)),!0;case"gotpointercapture":return g=h.pointerId,ol.set(g,ul(ol.get(g)||null,t,r,l,u,h)),!0}return!1}function h1(t){var r=F(t.target);if(r!==null){var l=o(r);if(l!==null){if(r=l.tag,r===13){if(r=f(l),r!==null){t.blockedOn=r,As(t.priority,function(){if(l.tag===13){var u=Ga();u=Vn(u);var h=Ls(l,u);h!==null&&Ya(h,l,u),Su(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function qc(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var l=Nu(t.nativeEvent);if(l===null){l=t.nativeEvent;var u=new l.constructor(l.type,l);Oo=u,l.target.dispatchEvent(u),Oo=null}else return r=P(l),r!==null&&u1(r),t.blockedOn=l,!1;r.shift()}return!0}function x1(t,r,l){qc(t)&&l.delete(r)}function xb(){ku=!1,An!==null&&qc(An)&&(An=null),Nn!==null&&qc(Nn)&&(Nn=null),Cn!==null&&qc(Cn)&&(Cn=null),cl.forEach(x1),ol.forEach(x1)}function Kc(t,r){t.blockedOn===r&&(t.blockedOn=null,ku||(ku=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,xb)))}var Wc=null;function m1(t){Wc!==t&&(Wc=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Wc===t&&(Wc=null);for(var r=0;r<t.length;r+=3){var l=t[r],u=t[r+1],h=t[r+2];if(typeof u!="function"){if(Cu(u||l)===null)continue;break}var g=P(l);g!==null&&(t.splice(r,3),r-=3,C0(g,{pending:!0,data:h,method:l.method,action:u},u,h))}}))}function fl(t){function r(G){return Kc(G,t)}An!==null&&Kc(An,t),Nn!==null&&Kc(Nn,t),Cn!==null&&Kc(Cn,t),cl.forEach(r),ol.forEach(r);for(var l=0;l<kn.length;l++){var u=kn[l];u.blockedOn===t&&(u.blockedOn=null)}for(;0<kn.length&&(l=kn[0],l.blockedOn===null);)h1(l),l.blockedOn===null&&kn.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var h=l[u],g=l[u+1],T=h[$t]||null;if(typeof g=="function")T||m1(l);else if(T){var C=null;if(g&&g.hasAttribute("formAction")){if(h=g,T=g[$t]||null)C=T.formAction;else if(Cu(h)!==null)continue}else C=T.action;typeof C=="function"?l[u+1]=C:(l.splice(u,3),u-=3),m1(l)}}}function Du(t){this._internalRoot=t}$c.prototype.render=Du.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(s(409));var l=r.current,u=Ga();c1(l,u,t,r,null,null)},$c.prototype.unmount=Du.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;c1(t.current,2,null,t,null,null),Oc(),r[hr]=null}};function $c(t){this._internalRoot=t}$c.prototype.unstable_scheduleHydration=function(t){if(t){var r=Ss();t={blockedOn:null,target:t,priority:r};for(var l=0;l<kn.length&&r!==0&&r<kn[l].priority;l++);kn.splice(l,0,t),l===0&&h1(t)}};var p1=n.version;if(p1!=="19.1.1")throw Error(s(527,p1,"19.1.1"));ue.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=x(r),t=t!==null?m(t):null,t=t===null?null:t.stateNode,t};var mb={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zc.isDisabled&&Zc.supportsFiber)try{ct=Zc.inject(mb),nt=Zc}catch{}}return hl.createRoot=function(t,r){if(!i(t))throw Error(s(299));var l=!1,u="",h=Rh,g=jh,T=Mh,C=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(C=r.unstable_transitionCallbacks)),r=i1(t,1,!1,null,null,l,u,h,g,T,C,null),t[hr]=r.current,du(t),new Du(r)},hl.hydrateRoot=function(t,r,l){if(!i(t))throw Error(s(299));var u=!1,h="",g=Rh,T=jh,C=Mh,G=null,le=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(G=l.unstable_transitionCallbacks),l.formState!==void 0&&(le=l.formState)),r=i1(t,1,!0,r,l??null,u,h,g,T,C,G,le),r.context=l1(null),l=r.current,u=Ga(),u=Vn(u),h=dn(u),h.callback=null,hn(l,h,u),l=u,r.current.lanes=l,Sr(r,l),Dr(r),t[hr]=r.current,du(t),new $c(r)},hl.version="19.1.1",hl}var A1;function Ab(){if(A1)return ju.exports;A1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),ju.exports=Sb(),ju.exports}var Nb=Ab();const Cb=kp(Nb);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var N1;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(N1||(N1={}));var C1;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(C1||(C1={}));var k1;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(k1||(k1={}));var D1;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(D1||(D1={}));var O1;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(O1||(O1={}));var R1;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(R1||(R1={}));var j1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(j1||(j1={}));var M1;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(M1||(M1={}));var L1;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(L1||(L1={}));var F1;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(F1||(F1={}));var I1;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(I1||(I1={}));var B1;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(B1||(B1={}));var U1;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(U1||(U1={}));var P1;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(P1||(P1={}));var H1;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(H1||(H1={}));var z1;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(z1||(z1={}));var V1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(V1||(V1={}));var G1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(G1||(G1={}));var Y1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Y1||(Y1={}));var X1;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(X1||(X1={}));var q1;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(q1||(q1={}));var K1;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(K1||(K1={}));var W1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(W1||(W1={}));var $1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})($1||($1={}));var Z1;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Z1||(Z1={}));var Q1;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(Q1||(Q1={}));var J1;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(J1||(J1={}));var em;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(em||(em={}));var tm;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(tm||(tm={}));var am;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(am||(am={}));var rm;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(rm||(rm={}));var nm;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(nm||(nm={}));var sm;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(sm||(sm={}));var im;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(im||(im={}));var lm;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(lm||(lm={}));var cm;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(cm||(cm={}));var om;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(om||(om={}));var um;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(um||(um={}));var fm;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(fm||(fm={}));var dm;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(dm||(dm={}));var hm;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(hm||(hm={}));var xm;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(xm||(xm={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var mm;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(mm||(mm={}));var Xa=(e=>(e[e.FB_FEED=0]="FB_FEED",e[e.FB_VIDEO_FEED=1]="FB_VIDEO_FEED",e[e.FB_STORIES=2]="FB_STORIES",e[e.FB_MARKETPLACE=3]="FB_MARKETPLACE",e[e.FB_REELS=4]="FB_REELS",e[e.IG_FEED=5]="IG_FEED",e[e.IG_STORIES=6]="IG_STORIES",e[e.IG_REELS=7]="IG_REELS",e[e.IG_EXPLORE=8]="IG_EXPLORE",e[e.MESSENGER_INBOX=9]="MESSENGER_INBOX",e[e.MESSENGER_STORIES=10]="MESSENGER_STORIES",e[e.AUDIENCE_NETWORK=11]="AUDIENCE_NETWORK",e[e.MASTER_VIEW=12]="MASTER_VIEW",e))(Xa||{});const kb=[{id:Xa.FB_FEED,platform:"Facebook",name:"Feed (Noticias)",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1","4:5"],recommendedResolution:"1080x1080 / 1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.FB_VIDEO_FEED,platform:"Facebook",name:"Video Feed",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["4:5","1:1"],recommendedResolution:"1080x1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.FB_STORIES,platform:"Facebook",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xa.FB_REELS,platform:"Facebook",name:"Reels",uiType:"REELS",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xa.FB_MARKETPLACE,platform:"Facebook",name:"Marketplace",uiType:"MARKETPLACE",group:"SQUARE_LIKE",aspectRatios:["1:1"],recommendedResolution:"1080x1080 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.IG_FEED,platform:"Instagram",name:"Feed",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1","4:5"],recommendedResolution:"1080x1080 / 1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.IG_STORIES,platform:"Instagram",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xa.IG_REELS,platform:"Instagram",name:"Reels",uiType:"REELS",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xa.IG_EXPLORE,platform:"Instagram",name:"Explore",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1"],recommendedResolution:"1080x1080 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.MESSENGER_INBOX,platform:"Messenger",name:"Inbox",uiType:"MESSENGER_INBOX",group:"SQUARE_LIKE",aspectRatios:["1.91:1"],recommendedResolution:"1200x628 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xa.MESSENGER_STORIES,platform:"Messenger",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xa.AUDIENCE_NETWORK,platform:"Audience Network",name:"Nativo/Intersticial",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16","1:1","1.91:1"],recommendedResolution:"1080x1920 px",safeZone:{top:"15%",bottom:"20%"}}],Db=({currentView:e,onNavigate:n,currentUser:a,onLogout:s,onOpenDiagnostics:i})=>{const[o,f]=se.useState(!1),d=[{view:"creative_analysis",label:"Anlisis IA",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),adminOnly:!1,description:"Anlisis de creativos con IA",color:"text-purple-400"},{view:"performance",label:"Performance",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),adminOnly:!1,description:"Mtricas y rendimiento",color:"text-green-400"},{view:"strategies",label:"Estrategias",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a1 1 0 01-1-1V9a1 1 0 011-1h1a2 2 0 100-4H4a1 1 0 01-1-1V4a1 1 0 011-1h3a1 1 0 011 1v1z"})}),adminOnly:!1,description:"Optimizacin de campaas",color:"text-blue-400"},{view:"strategic_analysis",label:"Plan Estratgico",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),adminOnly:!1,description:"Anlisis estratgico integral",color:"text-indigo-400"},{view:"reports",label:"Reportes",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),adminOnly:!1,description:"Informes detallados",color:"text-orange-400"}],x=[{view:"clients",label:"Clientes",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),adminOnly:!1,description:"Gestin de clientes"},{view:"import",label:"Importar",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),adminOnly:!0,description:"Importar datos"}],m=[{view:"users",label:"Usuarios",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),adminOnly:!0,description:"Gestin de usuarios"},{view:"control_panel",label:"Panel Admin",icon:c.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),adminOnly:!0,description:"Panel de control"},{view:"logs",label:"Logs",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),adminOnly:!0,description:"Logs del sistema"}],p=({item:v,isActive:b})=>c.jsxs("button",{onClick:()=>n(v.view),className:`group relative flex items-center gap-3 px-3 py-2 rounded-xl font-medium transition-all duration-200 ${b?"bg-white/10 text-white shadow-lg ring-1 ring-white/20":"text-gray-300 hover:text-white hover:bg-white/5"}`,title:v.description,children:[c.jsx("span",{className:`transition-colors ${b?"text-white":v.color||"text-gray-400"}`,children:v.icon}),c.jsx("span",{className:"text-sm",children:v.label}),b&&c.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/20 to-purple-500/20 -z-10"})]});return c.jsxs(c.Fragment,{children:[c.jsx("nav",{className:"hidden lg:flex fixed top-6 left-6 right-6 z-50 bg-gray-900/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl",children:c.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),c.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg blur opacity-30 group-hover:opacity-100 transition duration-1000"})]}),c.jsx("div",{children:c.jsx("h1",{className:"text-white font-bold text-lg",children:"Creative AI"})})]}),c.jsx("div",{className:"flex items-center gap-1",children:d.map(v=>c.jsx(p,{item:v,isActive:e===v.view},v.view))}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:x.map(v=>v.adminOnly&&a.role!=="admin"?null:c.jsx(p,{item:v,isActive:e===v.view},v.view))}),a.role==="admin"&&c.jsx("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:m.map(v=>c.jsx("button",{onClick:()=>n(v.view),className:`p-2 rounded-lg transition-all duration-200 ${e===v.view?"bg-red-500/20 text-red-400 ring-1 ring-red-500/30":"text-gray-400 hover:text-red-400 hover:bg-red-500/10"}`,title:v.description,children:v.icon},v.view))}),c.jsxs("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:[c.jsx("button",{onClick:()=>n("settings"),className:`p-2 rounded-lg transition-all duration-200 ${e==="settings"?"bg-white/10 text-white ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"}`,title:"Configuracin",children:c.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),c.jsx("button",{onClick:()=>n("help"),className:`p-2 rounded-lg transition-all duration-200 ${e==="help"?"bg-white/10 text-white ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"}`,title:"Ayuda",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),c.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-gray-700",children:[a.role==="admin"&&i&&c.jsx("button",{onClick:i,className:"p-2 rounded-lg text-gray-400 hover:text-orange-400 hover:bg-orange-500/10 transition-all duration-200",title:"Diagnstico de Datos",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white text-sm font-medium",children:a.username.charAt(0).toUpperCase()})}),c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"text-white font-medium",children:a.username}),c.jsx("div",{className:"text-gray-400 text-xs capitalize",children:a.role})]})]}),c.jsx("button",{onClick:s,className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all duration-200",title:"Cerrar Sesin",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})]})}),c.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-xl border-b border-gray-700/50",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),c.jsx("span",{className:"text-white font-bold",children:"Creative AI"})]}),c.jsx("button",{onClick:()=>f(!o),className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),o&&c.jsx("div",{className:"border-t border-gray-700/50 bg-gray-900/95 backdrop-blur-xl",children:c.jsxs("div",{className:"px-4 py-3 space-y-1",children:[c.jsx("div",{className:"space-y-1",children:d.map(v=>c.jsxs("button",{onClick:()=>{n(v.view),f(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[c.jsx("span",{className:v.color||"text-gray-400",children:v.icon}),c.jsx("span",{children:v.label})]},v.view))}),c.jsx("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:x.map(v=>v.adminOnly&&a.role!=="admin"?null:c.jsxs("button",{onClick:()=>{n(v.view),f(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[c.jsx("span",{className:"text-gray-400",children:v.icon}),c.jsx("span",{children:v.label})]},v.view))}),a.role==="admin"&&c.jsx("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:m.map(v=>c.jsxs("button",{onClick:()=>{n(v.view),f(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-red-500/20 text-red-400":"text-gray-300 hover:text-red-400 hover:bg-red-500/10"}`,children:[c.jsx("span",{className:"text-red-400",children:v.icon}),c.jsx("span",{children:v.label})]},v.view))}),c.jsxs("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:[c.jsxs("button",{onClick:()=>{n("settings"),f(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e==="settings"?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[c.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),c.jsx("span",{children:"Configuracin"})]}),c.jsxs("button",{onClick:()=>{n("help"),f(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e==="help"?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[c.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("span",{children:"Ayuda"})]}),a.role==="admin"&&i&&c.jsxs("button",{onClick:()=>{i(),f(!1)},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:text-orange-400 hover:bg-orange-500/10 transition-all",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),c.jsx("span",{children:"Diagnstico"})]})]}),c.jsxs("div",{className:"pt-3 border-t border-gray-700/50",children:[c.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-gray-300",children:[c.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white text-sm font-medium",children:a.username.charAt(0).toUpperCase()})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-white font-medium",children:a.username}),c.jsx("div",{className:"text-gray-400 text-xs capitalize",children:a.role})]})]}),c.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:text-red-400 hover:bg-red-500/10 transition-all",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Cerrar Sesin"})]})]})]})})]})]})};class ci{constructor(){this.logs=[],this.subscribers=[]}static getInstance(){return ci.instance||(ci.instance=new ci),ci.instance}addLog(n,a,s){const i={timestamp:new Date,level:n,message:a,context:s};this.logs.push(i),this.logs.length>200&&this.logs.shift(),this.subscribers.forEach(f=>f(i));const o=[`[${n}] ${a}`];switch(s&&o.push(s),n){case"ERROR":console.error(...o);break;case"WARNING":console.warn(...o);break;default:console.log(...o)}}info(n,a){this.addLog("INFO",n,a)}success(n,a){this.addLog("SUCCESS",n,a)}warn(n,a){this.addLog("WARNING",n,a)}error(n,a){this.addLog("ERROR",n,a)}debug(n,a){this.addLog("DEBUG",n,a)}getLogs(){return this.logs}subscribe(n){return this.subscribers.push(n),()=>{this.subscribers=this.subscribers.filter(a=>a!==n)}}clear(){this.logs=[],this.info("Logs cleared by user.")}}const et=ci.getInstance();class oi{constructor(){this.config=null,this.loadConfig()}static getInstance(){return oi.instance||(oi.instance=new oi),oi.instance}loadConfig(){try{const n=localStorage.getItem("db_mcp_config");n&&(this.config=JSON.parse(n))}catch(n){console.error("[MCP] Error loading config:",n)}}saveConfig(n){try{this.config=n,localStorage.setItem("db_mcp_config",JSON.stringify(n)),console.log("[MCP] Configuration saved")}catch(a){console.error("[MCP] Error saving config:",a)}}getConfig(){return this.config}async sendExcelData(n){if(console.log("[MCP] ========== INICIO ENVO AL MCP =========="),console.log("[MCP] Config presente:",!!this.config),console.log("[MCP] Config actual:",this.config),!this.config)return console.warn("[MCP] No configuration found, skipping MCP sync"),!1;try{console.log("[MCP] Preparing Excel data for MCP server..."),console.log("[MCP] ProcessResult recibido:",{client:n.client.name,recordsCount:n.records.length,newRecordsCount:n.newRecordsCount});const a=n.records,s=a.reduce((y,E)=>y+E.spend,0),i=a.reduce((y,E)=>y+E.purchaseValue,0),o=a.reduce((y,E)=>y+E.impressions,0),f=a.reduce((y,E)=>y+E.purchases,0),d=s>0?i/s:0;console.log("[MCP] Mtricas calculadas:",{totalSpend:s,totalRevenue:i,totalImpressions:o,totalPurchases:f,overallROAS:d});const x=new Map;a.forEach(y=>{const E=x.get(y.adName)||{spend:0,revenue:0,purchases:0};x.set(y.adName,{spend:E.spend+y.spend,revenue:E.revenue+y.purchaseValue,purchases:E.purchases+y.purchases})});const m=Array.from(x.entries()).map(([y,E])=>({adName:y,spend:E.spend,roas:E.spend>0?E.revenue/E.spend:0,purchases:E.purchases})).sort((y,E)=>E.roas-y.roas).slice(0,10),p={source:"ver6_excel_import",timestamp:new Date().toISOString(),client:{id:n.client.id,name:n.client.name,currency:n.client.currency,metaAccountName:n.client.metaAccountName},data:{totalRecords:a.length,newRecords:n.newRecordsCount,periodStart:n.periodStart,periodEnd:n.periodEnd,daysDetected:n.daysDetected,performanceData:a},summary:{totalSpend:s,totalRevenue:i,totalImpressions:o,totalPurchases:f,overallROAS:d,topPerformingAds:m}};console.log("[MCP] Payload preparado:",{source:p.source,timestamp:p.timestamp,client:p.client,dataSize:JSON.stringify(p).length+" bytes",recordsCount:p.data.performanceData.length});const v=this.constructUrl(this.config.testUrl,this.config.path);console.log("[MCP] URL final construida:",v),console.log("[MCP] Headers que se envan:",{"Content-Type":"application/json",Authorization:this.config.authentication?"***configurado***":"no configurado"}),console.log("[MCP] ========== INICIANDO FETCH =========="),console.log("[MCP] Intentando envo directo con CORS...");const b=await fetch(v,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(p)});if(console.log("[MCP] Response status:",b.status),console.log("[MCP] Response ok:",b.ok),console.log("[MCP] Response headers:",Object.fromEntries(b.headers.entries())),b.ok){const y=await b.text();return console.log("[MCP]  SUCCESS - Response data:",y),console.log("[MCP] ========== ENVO EXITOSO =========="),!0}else{console.error("[MCP]  FAILED - Status:",b.status,b.statusText);const y=await b.text();return console.error("[MCP] Error response body:",y),console.log("[MCP] ========== ENVO FALLIDO =========="),!1}}catch(a){console.error("[MCP]  EXCEPTION durante el envo:",a),console.error("[MCP] Error stack:",a instanceof Error?a.stack:"No stack available"),console.log("[MCP] ========== ERROR EN ENVO =========="),console.log("[MCP] MCP fall, intentando con Supabase...");try{if(await this.sendToSupabase(n))return console.log("[MCP]  Datos guardados en Supabase como respaldo"),!0}catch(s){console.error("[MCP] Supabase tambin fall:",s)}return!1}console.log("[MCP] ========== ENVIANDO TAMBIN A SUPABASE ==========");try{await this.sendToSupabase(n),console.log("[MCP]  Datos tambin guardados en Supabase")}catch(a){console.error("[MCP]  Supabase backup failed:",a)}return!0}constructUrl(n,a){if(!a)return n;const s=n.replace(/\/$/,""),i=a.replace(/^\//,"");return`${s}/${i}`}async testConnection(){if(console.log("[MCP] ========== INICIO TEST DE CONEXIN =========="),console.log("[MCP] Config presente:",!!this.config),console.log("[MCP] Config completa:",this.config),!this.config)return{success:!1,message:"No MCP configuration found"};const n=this.constructUrl(this.config.testUrl,this.config.path);console.log("[MCP] URL de test construida:",n);const a={source:"ver6_connection_test",timestamp:new Date().toISOString(),message:"Test connection from Ver6 Creative Assistant"};console.log("[MCP] Payload de test:",a);try{console.log("[MCP] ========== INTENTANDO CORS DIRECTO ==========");const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(console.log("[MCP] Response status:",s.status),console.log("[MCP] Response ok:",s.ok),console.log("[MCP] Response headers:",Object.fromEntries(s.headers.entries())),s.ok){const i=await s.text();return console.log("[MCP]  TEST EXITOSO - Response:",i),{success:!0,message:` Connection successful! Response: ${i}`}}else{const i=await s.text();return console.error("[MCP]  TEST FALLIDO - Status:",s.status,s.statusText),console.error("[MCP] Error response:",i),{success:!1,message:` HTTP Error ${s.status}: ${s.statusText}. Response: ${i}`}}}catch(s){return console.error("[MCP]  EXCEPTION en test:",s),console.error("[MCP] Error tipo:",s.constructor.name),console.error("[MCP] Error message:",s instanceof Error?s.message:"Unknown"),s instanceof TypeError&&(s.message.includes("Failed to fetch")||s.message.includes("NetworkError"))?{success:!1,message:` CORS/Network Error: Cannot reach n8n server. Check if:
1. The URL is correct
2. n8n server is running
3. CORS is enabled on n8n webhook
4. No firewall blocking the connection`}:{success:!1,message:` Connection error: ${s instanceof Error?s.message:"Unknown error"}`}}}getSupabaseConfig(){return{host:"aws-0-us-east-1.pooler.supabase.com",port:6543,database:"postgres",user:"postgres.rqdahffythodugjlxsz",password:"Cataclismoss",poolMode:"transaction"}}async sendToSupabase(n){console.log("[SUPABASE] ========== INICIO ENVO A SUPABASE ==========");try{const a={source:"ver6_excel_import",timestamp:new Date().toISOString(),client_id:n.client.id,client_name:n.client.name,client_currency:n.client.currency,meta_account_name:n.client.metaAccountName,total_records:n.records.length,new_records:n.newRecordsCount,period_start:n.periodStart,period_end:n.periodEnd,days_detected:n.daysDetected,total_spend:n.records.reduce((f,d)=>f+d.spend,0),total_revenue:n.records.reduce((f,d)=>f+d.purchaseValue,0),total_impressions:n.records.reduce((f,d)=>f+d.impressions,0),total_purchases:n.records.reduce((f,d)=>f+d.purchases,0),performance_data:JSON.stringify(n.records)};console.log("[SUPABASE] Payload preparado:",{source:a.source,client:a.client_name,records:a.total_records,dataSize:JSON.stringify(a).length+" bytes"});const s="https://rqdahffythodugjlxsz.supabase.co/rest/v1/excel_imports",i="sb_secret_OXLvWnnDiWEkwC2AuyR4aA_6s171714";console.log("[SUPABASE] Enviando a:",s),console.log("[SUPABASE] Payload size:",JSON.stringify(a).length,"bytes"),console.log("[SUPABASE] Headers:",{"Content-Type":"application/json",apikey:i.substring(0,20)+"...",Authorization:"Bearer "+i.substring(0,20)+"...",Prefer:"return=minimal"}),console.log("[SUPABASE] ========== INICIANDO FETCH REAL A SUPABASE ==========");const o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",apikey:i,Authorization:`Bearer ${i}`,Prefer:"return=minimal"},body:JSON.stringify(a)});if(console.log("[SUPABASE] Response status:",o.status),console.log("[SUPABASE] Response statusText:",o.statusText),console.log("[SUPABASE] Response ok:",o.ok),console.log("[SUPABASE] Response headers:",Object.fromEntries(o.headers.entries())),o.ok){const f=await o.text();return console.log("[SUPABASE]  SUCCESS - Data sent to Supabase"),console.log("[SUPABASE] Response body:",f),!0}else{const f=await o.text();console.error("[SUPABASE]  FAILED - Status:",o.status,o.statusText),console.error("[SUPABASE] Error response:",f),console.error("[SUPABASE] Error response headers:",Object.fromEntries(o.headers.entries()));try{const d=JSON.parse(f);console.error("[SUPABASE] Parsed error:",d)}catch{console.error("[SUPABASE] Raw error (not JSON):",f)}return!1}}catch(a){return console.error("[SUPABASE]  EXCEPTION:",a),console.error("[SUPABASE] Error stack:",a instanceof Error?a.stack:"No stack available"),!1}}async testSupabaseConnection(){var n;console.log("[SUPABASE] ========== INICIO TEST SUPABASE ==========");try{const a={source:"ver6_connection_test",timestamp:new Date().toISOString(),client_id:"test-client",client_name:"Test Client",client_currency:"USD",meta_account_name:"Test Account",total_records:1,new_records:1,period_start:"2025-08-01",period_end:"2025-08-02",days_detected:2,total_spend:100,total_revenue:200,total_impressions:1e3,total_purchases:5,performance_data:JSON.stringify([{adName:"Test Ad",spend:100,purchases:5,purchaseValue:200,impressions:1e3}])},s="https://rqdahffythodugjlxsz.supabase.co/rest/v1/excel_imports",i="sb_secret_OXLvWnnDiWEkwC2AuyR4aA_6s171714";console.log("[SUPABASE] Testing connection to:",s),console.log("[SUPABASE] Service Role Key presente:",!!i),console.log("[SUPABASE] Service Role Key length:",i.length),console.log("[SUPABASE] Test payload:",a),console.log("[SUPABASE] Headers:",{"Content-Type":"application/json",apikey:i.substring(0,20)+"...",Authorization:"Bearer "+i.substring(0,20)+"...",Prefer:"return=minimal"}),console.log("[SUPABASE] ========== INICIANDO FETCH A SUPABASE ==========");const o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",apikey:i,Authorization:`Bearer ${i}`,Prefer:"return=minimal"},body:JSON.stringify(a)});if(console.log("[SUPABASE] Test response status:",o.status),console.log("[SUPABASE] Test response statusText:",o.statusText),console.log("[SUPABASE] Test response headers:",Object.fromEntries(o.headers.entries())),o.ok){const f=await o.text();return console.log("[SUPABASE]  TEST EXITOSO - Response text:",f),{success:!0,message:` Supabase connection successful! Status: ${o.status}. Response: ${f||"Empty response (normal for minimal return)"}`}}else{const f=await o.text();console.error("[SUPABASE]  TEST FALLIDO - Status:",o.status,o.statusText),console.error("[SUPABASE] Error response body:",f),console.error("[SUPABASE] Error response headers:",Object.fromEntries(o.headers.entries()));let d=f;try{const x=JSON.parse(f);d=`Code: ${x.code||"Unknown"}, Message: ${x.message||f}, Details: ${x.details||"None"}`}catch{}return{success:!1,message:` Supabase Error ${o.status} (${o.statusText}): ${d}`}}}catch(a){console.error("[SUPABASE]  EXCEPTION en test:",a),console.error("[SUPABASE] Exception type:",(n=a==null?void 0:a.constructor)==null?void 0:n.name),console.error("[SUPABASE] Exception message:",a instanceof Error?a.message:"Unknown"),console.error("[SUPABASE] Exception stack:",a instanceof Error?a.stack:"No stack");let s="Unknown error";return a instanceof TypeError?a.message.includes("Failed to fetch")?s="Network error - Cannot reach Supabase servers. Check internet connection or firewall.":a.message.includes("CORS")?s="CORS error - Browser blocking request to Supabase.":s=`Network/Fetch error: ${a.message}`:a instanceof Error&&(s=a.message),{success:!1,message:` Supabase connection error: ${s}`}}}}const ls=oi.getInstance(),Ob=({onConfigSaved:e})=>{const[n,a]=se.useState(""),[s,i]=se.useState(""),[o,f]=se.useState(""),[d,x]=se.useState(""),[m,p]=se.useState(!1),[v,b]=se.useState(!1),[y,E]=se.useState(null),[_,w]=se.useState(null),[S,D]=se.useState([]),[A,z]=se.useState(!1);se.useEffect(()=>{const B=ls.getConfig();B&&(a(B.testUrl||""),i(B.productionUrl||""),f(B.authentication||""),x(B.path||""))},[]);const V=()=>{const B={testUrl:n.trim(),productionUrl:s.trim(),authentication:o.trim()||void 0,path:d.trim()||void 0};ls.saveConfig(B),e==null||e(),alert("Configuracin MCP guardada exitosamente")},Y=async()=>{if(!n.trim()){alert("Por favor ingresa una URL de test vlida");return}p(!0),E(null);try{const B={testUrl:n.trim(),productionUrl:s.trim(),authentication:o.trim()||void 0,path:d.trim()||void 0};ls.saveConfig(B);const ne=await ls.testConnection();E(ne)}catch(B){E({success:!1,message:`Error de conexin: ${B instanceof Error?B.message:"Error desconocido"}`})}finally{p(!1)}},j=async()=>{b(!0),w(null),D([]);const B=console.log,ne=console.error,K=(...ee)=>{const he=ee.map(_e=>typeof _e=="object"?JSON.stringify(_e,null,2):String(_e)).join(" ");he.includes("[SUPABASE]")&&D(_e=>[..._e,`LOG: ${he}`]),B(...ee)},X=(...ee)=>{const he=ee.map(_e=>typeof _e=="object"?JSON.stringify(_e,null,2):String(_e)).join(" ");he.includes("[SUPABASE]")&&D(_e=>[..._e,`ERROR: ${he}`]),ne(...ee)};console.log=K,console.error=X;try{const ee=await ls.testSupabaseConnection();w(ee),z(!0)}catch(ee){w({success:!1,message:`Error de conexin Supabase: ${ee instanceof Error?ee.message:"Error desconocido"}`})}finally{console.log=B,console.error=ne,b(!1)}},Q=n.trim()!=="";return c.jsxs("div",{className:"max-w-3xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-2",children:"Configuracin MCP Server"}),c.jsx("p",{className:"text-brand-text-secondary",children:"Configura la conexin al servidor MCP para enviar automticamente los datos del Excel procesado."})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"testUrl",className:"block text-sm font-medium text-brand-text-secondary mb-2",children:"Test URL *"}),c.jsx("input",{id:"testUrl",type:"url",value:n,onChange:B=>a(B.target.value),placeholder:"https://ads-analists.app.n8n.cloud/mcp-test/...",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary"}),c.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:"URL del servidor MCP para testing (obligatorio)"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"productionUrl",className:"block text-sm font-medium text-brand-text-secondary mb-2",children:"Production URL"}),c.jsx("input",{id:"productionUrl",type:"url",value:s,onChange:B=>i(B.target.value),placeholder:"https://ads-analists.app.n8n.cloud/mcp-prod/...",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary"}),c.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:"URL del servidor MCP para produccin (opcional)"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"path",className:"block text-sm font-medium text-brand-text-secondary mb-2",children:"Path Adicional"}),c.jsx("input",{id:"path",type:"text",value:d,onChange:B=>x(B.target.value),placeholder:"13ad145e-0b6b-4263-8c86-7315492e8863",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary"}),c.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:"Path adicional que se aadir a la URL base (opcional)"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"authentication",className:"block text-sm font-medium text-brand-text-secondary mb-2",children:"Authentication Header"}),c.jsx("input",{id:"authentication",type:"text",value:o,onChange:B=>f(B.target.value),placeholder:"Bearer token123... o Basic auth...",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary"}),c.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:'Header de autorizacin completo (ej: "Bearer token123" o "Basic auth...") - opcional'})]}),y&&c.jsxs("div",{className:`p-4 rounded-lg border ${y.success?"bg-green-500/10 border-green-500/20 text-green-400":"bg-red-500/10 border-red-500/20 text-red-400"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.success?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),c.jsx("span",{className:"font-medium",children:y.success?"Conexin exitosa":"Error de conexin"})]}),c.jsx("p",{className:"text-sm mt-2 opacity-90",children:y.message})]}),_&&c.jsxs("div",{className:`p-4 rounded-lg border ${_.success?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.success?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),c.jsx("span",{className:"font-medium",children:_.success?"Supabase: Conexin exitosa":"Supabase: Error de conexin"})]}),c.jsx("p",{className:"text-sm mt-2 opacity-90",children:_.message})]}),c.jsxs("div",{className:"flex gap-4 pt-4",children:[c.jsx("button",{onClick:Y,disabled:m||!n.trim(),className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Probando..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Probar Conexin"]})}),c.jsx("button",{onClick:j,disabled:v,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Probando Supabase..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),"Test Supabase"]})}),c.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-6 py-3 bg-brand-primary hover:bg-brand-primary-hover text-white rounded-lg font-medium transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Guardar Configuracin"]}),S.length>0&&!A&&c.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors text-sm",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Ver Debug Logs (",S.length,")"]})]}),A&&S.length>0&&c.jsxs("div",{className:"mt-6 p-4 bg-gray-900 rounded-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:"text-sm font-medium text-white",children:"Debug Logs - Supabase"}),c.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-white text-sm",children:"Ocultar"})]}),c.jsx("div",{className:"bg-black rounded p-3 max-h-64 overflow-y-auto",children:S.map((B,ne)=>c.jsx("div",{className:`text-xs font-mono mb-1 ${B.startsWith("ERROR:")?"text-red-400":"text-green-400"}`,children:B},ne))}),c.jsx("div",{className:"mt-2 text-xs text-gray-400",children:" Estos logs te ayudan a ver exactamente qu est pasando con la conexin a Supabase"})]}),c.jsxs("div",{className:"mt-6 p-4 bg-brand-bg rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${Q?y!=null&&y.success?"bg-green-500":"bg-yellow-500":"bg-red-500"}`}),c.jsxs("span",{className:"text-sm font-medium text-brand-text",children:["Estado MCP: ",Q?y!=null&&y.success?"Conectado y funcionando":"Configurado (pendiente test)":"No configurado"]})]}),Q&&c.jsx("p",{className:"text-xs text-brand-text-secondary mt-2",children:"Los datos del Excel se enviarn automticamente al servidor MCP despus de cada importacin."})]}),c.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-blue-400 font-medium mb-1",children:"Qu se enva al MCP?"}),c.jsxs("ul",{className:"text-sm text-blue-300 space-y-1",children:[c.jsx("li",{children:" Datos completos del Excel procesado (mtricas de rendimiento)"}),c.jsx("li",{children:" Informacin del cliente y perodo analizado"}),c.jsx("li",{children:" Resumen de mtricas (ROAS, gasto total, top ads)"}),c.jsx("li",{children:" Timestamp y metadata de la importacin"})]})]})]})})]})]})},Rb=({metaApiConfig:e,setMetaApiConfig:n})=>{const[a,s]=se.useState({appId:"",appSecret:"",accessToken:""}),[i,o]=se.useState(!1),[f,d]=se.useState(null),[x,m]=se.useState("meta");se.useEffect(()=>{e&&(s(e),d(!0))},[e]);const p=y=>{s({...a,[y.target.name]:y.target.value})},v=async()=>{o(!0),et.info("Simulating Meta API connection test..."),await new Promise(E=>setTimeout(E,1e3));const y=!!(a.appId&&a.appSecret&&a.accessToken);d(y),y?(n(a),et.success("Meta API configuration saved."),alert("Configuracin guardada con xito (simulado).")):et.error("Meta API connection test failed."),o(!1)},b=!!(e!=null&&e.appId&&(e!=null&&e.appSecret)&&(e!=null&&e.accessToken));return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[c.jsx("div",{className:"bg-brand-surface rounded-lg p-2 shadow-lg",children:c.jsxs("div",{className:"flex space-x-1",children:[c.jsx("button",{onClick:()=>m("meta"),className:`flex-1 py-3 px-4 text-sm font-medium rounded-lg transition-colors ${x==="meta"?"bg-brand-primary text-white shadow-md":"text-brand-text-secondary hover:text-brand-text hover:bg-brand-bg/50"}`,children:c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"API de Meta"]})}),c.jsx("button",{onClick:()=>m("mcp"),className:`flex-1 py-3 px-4 text-sm font-medium rounded-lg transition-colors ${x==="mcp"?"bg-brand-primary text-white shadow-md":"text-brand-text-secondary hover:text-brand-text hover:bg-brand-bg/50"}`,children:c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12l4-4m-4 4l4 4"})}),"Servidor MCP"]})})]})}),x==="meta"&&c.jsxs("div",{className:"bg-brand-surface rounded-lg p-8 shadow-lg",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:"Conexin API de Meta"}),c.jsxs("p",{className:"text-brand-text-secondary mb-6",children:["Introduce las credenciales de tu aplicacin de Meta para automatizar la importacin de datos. La conexin se realiza a travs de un backend seguro (actualmente simulado).",c.jsx("br",{}),c.jsx("strong",{children:"Estado:"}),c.jsx("span",{className:`ml-2 font-bold ${b?"text-green-400":"text-red-400"}`,children:b?"Configurado":"No Configurado"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(Iu,{label:"App ID",name:"appId",value:a.appId,onChange:p}),c.jsx(Iu,{label:"App Secret",name:"appSecret",value:a.appSecret,onChange:p,type:"password"}),c.jsx(Iu,{label:"Access Token",name:"accessToken",value:a.accessToken,onChange:p,type:"password"})]}),c.jsxs("div",{className:"mt-8 flex items-center justify-between",children:[c.jsx("button",{onClick:v,disabled:i,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Probando...":"Guardar Conexin"}),f!==null&&!i&&c.jsx("div",{className:`text-sm font-semibold px-4 py-2 rounded-md ${f?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"}`,children:f?"Conexin Exitosa":"Fall la Conexin"})]})]}),x==="mcp"&&c.jsx(Ob,{})]})},Iu=({label:e,name:n,value:a,onChange:s,type:i="text"})=>c.jsxs("div",{children:[c.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-brand-text-secondary mb-1",children:e}),c.jsx("input",{type:i,name:n,id:n,value:a,onChange:s,className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary transition-colors",autoComplete:i==="password"?"current-password":"off"})]});let jb=class{constructor(){this.dbName="Ver6Database",this.version=2,this.db=null}async initialize(){return new Promise((n,a)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>a(s.error),s.onsuccess=()=>{this.db=s.result,console.log("[IndexedDB] Database initialized successfully"),n()},s.onupgradeneeded=i=>{const o=i.target.result;Array.from(o.objectStoreNames).forEach(w=>{o.objectStoreNames.contains(w)&&o.deleteObjectStore(w)});const d=o.createObjectStore("clients",{keyPath:"id"});d.createIndex("userId","userId",{unique:!1}),d.createIndex("name","name",{unique:!1}),o.createObjectStore("users",{keyPath:"id"}).createIndex("username","username",{unique:!0});const m=o.createObjectStore("performance_records",{keyPath:"id",autoIncrement:!0});m.createIndex("clientId","clientId",{unique:!1}),m.createIndex("uniqueId","uniqueId",{unique:!0}),m.createIndex("campaignName","campaignName",{unique:!1}),m.createIndex("adName","adName",{unique:!1}),m.createIndex("day","day",{unique:!1}),m.createIndex("clientId_day",["clientId","day"],{unique:!1}),m.createIndex("clientId_campaign",["clientId","campaignName"],{unique:!1}),m.createIndex("importBatchId","importBatchId",{unique:!1});const p=o.createObjectStore("creative_data",{keyPath:"id",autoIncrement:!0});p.createIndex("clientId","clientId",{unique:!1}),p.createIndex("adName","adName",{unique:!1}),p.createIndex("clientId_adName",["clientId","adName"],{unique:!0}),p.createIndex("creativeType","creativeType",{unique:!1});const v=o.createObjectStore("campaign_summaries",{keyPath:"id",autoIncrement:!0});v.createIndex("clientId","clientId",{unique:!1}),v.createIndex("campaignName","campaignName",{unique:!1}),v.createIndex("clientId_campaign",["clientId","campaignName"],{unique:!0});const b=o.createObjectStore("import_batches",{keyPath:"id"});b.createIndex("clientId","clientId",{unique:!1}),b.createIndex("timestamp","timestamp",{unique:!1}),b.createIndex("fileName","fileName",{unique:!1}),o.createObjectStore("system_config",{keyPath:"key"}).createIndex("category","category",{unique:!1}),o.createObjectStore("processed_hashes",{keyPath:"clientId"}),o.createObjectStore("bitacora_reports",{keyPath:"id",autoIncrement:!0}).createIndex("clientId","clientId",{unique:!1});const _=o.createObjectStore("uploaded_videos",{keyPath:"id",autoIncrement:!0});_.createIndex("clientId","clientId",{unique:!1}),_.createIndex("fileName","fileName",{unique:!1}),console.log("[IndexedDB] Database schema created with optimized indexes")}})}async executeTransaction(n,a,s){return this.db||await this.initialize(),new Promise((i,o)=>{try{const f=this.db.transaction(n,a);f.onerror=()=>o(f.error),f.onabort=()=>o(new Error("Transaction aborted")),s(f).then(i).catch(o)}catch(f){o(f)}})}async saveClients(n){return this.executeTransaction("clients","readwrite",async a=>{const s=a.objectStore("clients");let i=0,o=0;for(const f of n)try{await new Promise((x,m)=>{const p=s.get(f.id);p.onsuccess=()=>x(p.result||null),p.onerror=()=>m(p.error)})?o++:i++,await new Promise((x,m)=>{const p=s.put(f);p.onsuccess=()=>x(),p.onerror=()=>m(p.error)})}catch(d){console.warn(`[IndexedDB] Error saving client ${f.id}:`,d)}console.log(`[IndexedDB] Clients processed - New: ${i}, Updated: ${o}`)})}async getClients(){return this.executeTransaction("clients","readonly",async n=>{const a=n.objectStore("clients");return new Promise((s,i)=>{const o=a.getAll();o.onsuccess=()=>s(o.result||[]),o.onerror=()=>i(o.error)})})}async getClientById(n){return this.executeTransaction("clients","readonly",async a=>{const s=a.objectStore("clients");return new Promise((i,o)=>{const f=s.get(n);f.onsuccess=()=>i(f.result||null),f.onerror=()=>o(f.error)})})}async savePerformanceRecords(n,a,s){return console.log(`[IndexedDB] Saving ${a.length} performance records for client ${n}`),this.executeTransaction("performance_records","readwrite",async i=>{const o=i.objectStore("performance_records"),f=o.index("uniqueId"),d=new Date;let x=0,m=0,p=0;for(const v of a)try{const b=await new Promise((y,E)=>{const _=f.get(v.uniqueId);_.onsuccess=()=>y(_.result||null),_.onerror=()=>E(_.error)});if(b){const y={...b,...v,updatedAt:d,importBatchId:s};await new Promise((E,_)=>{const w=o.put(y);w.onsuccess=()=>{m++,E()},w.onerror=()=>_(w.error)})}else{const y={...v,createdAt:d,updatedAt:d,importBatchId:s};await new Promise((E,_)=>{const w=o.add(y);w.onsuccess=()=>{x++,E()},w.onerror=()=>{var S;if(((S=w.error)==null?void 0:S.name)==="ConstraintError"){const D=o.put(y);D.onsuccess=()=>{m++,E()},D.onerror=()=>_(D.error)}else _(w.error)}})}}catch(b){console.warn(`[IndexedDB] Skipping duplicate record ${v.uniqueId}:`,b),p++}console.log(`[IndexedDB] Performance records processed - New: ${x}, Updated: ${m}, Skipped: ${p}`)})}async getPerformanceRecords(n,a){return this.executeTransaction("performance_records","readonly",async s=>{const o=s.objectStore("performance_records").index("clientId");return new Promise((f,d)=>{const x=o.getAll(n);x.onsuccess=()=>{let m=x.result||[];a&&(a.campaignName&&(m=m.filter(p=>p.campaignName===a.campaignName)),a.adName&&(m=m.filter(p=>p.adName===a.adName)),a.startDate&&(m=m.filter(p=>p.day>=a.startDate)),a.endDate&&(m=m.filter(p=>p.day<=a.endDate))),f(m)},x.onerror=()=>d(x.error)})})}async getPerformanceData(){const n=await this.getClients(),a={};for(const s of n){const i=await this.getPerformanceRecords(s.id);a[s.id]=i}return a}async saveCreativeData(n,a){return this.executeTransaction("creative_data","readwrite",async s=>{var m;const i=s.objectStore("creative_data"),o=i.index("clientId_adName"),f=new Date;let d=0,x=0;for(const[p,v]of Object.entries(a))try{const b=await new Promise((E,_)=>{const w=o.get([n,p]);w.onsuccess=()=>E(w.result||null),w.onerror=()=>_(w.error)}),y={clientId:n,adName:p,imageUrl:v.imageUrl,adPreviewLink:v.adPreviewLink,creativeDescription:v.creativeDescription,analysisResult:v.analysisResult,creativeType:(m=v.imageUrl)!=null&&m.includes(".mp4")?"video":"image",createdAt:(b==null?void 0:b.createdAt)||f,updatedAt:f};b?(y.id=b.id,x++):d++,await new Promise((E,_)=>{const w=i.put(y);w.onsuccess=()=>E(),w.onerror=()=>_(w.error)})}catch(b){console.warn(`[IndexedDB] Error saving creative data for ${p}:`,b)}console.log(`[IndexedDB] Creative data processed for client ${n} - New: ${d}, Updated: ${x}`)})}async getCreativeData(n){return this.executeTransaction("creative_data","readonly",async a=>{const i=a.objectStore("creative_data").index("clientId");return new Promise((o,f)=>{const d=i.getAll(n);d.onsuccess=()=>{const x=d.result||[],m={};x.forEach(p=>{m[p.adName]={imageUrl:p.imageUrl||"",adPreviewLink:p.adPreviewLink,creativeDescription:p.creativeDescription,analysisResult:p.analysisResult}}),o(m)},d.onerror=()=>f(d.error)})})}async getAllCreativeData(){return this.executeTransaction("creative_data","readonly",async n=>{const a=n.objectStore("creative_data");return new Promise((s,i)=>{const o=a.getAll();o.onsuccess=()=>{const f=o.result||[],d={};f.forEach(x=>{d[x.clientId]||(d[x.clientId]={}),d[x.clientId][x.adName]={imageUrl:x.imageUrl||"",adPreviewLink:x.adPreviewLink,creativeDescription:x.creativeDescription,analysisResult:x.analysisResult}}),s(d)},o.onerror=()=>i(o.error)})})}async saveConfig(n,a,s="app_config"){return this.executeTransaction("system_config","readwrite",async i=>{const o=i.objectStore("system_config"),f=new Date,d={key:n,value:a,category:s,createdAt:f,updatedAt:f};await new Promise((x,m)=>{const p=o.put(d);p.onsuccess=()=>x(),p.onerror=()=>m(p.error)})})}async getConfig(n){return this.executeTransaction("system_config","readonly",async a=>{const s=a.objectStore("system_config");return new Promise((i,o)=>{const f=s.get(n);f.onsuccess=()=>{const d=f.result;i(d?d.value:null)},f.onerror=()=>o(f.error)})})}async saveImportBatch(n){return this.executeTransaction("import_batches","readwrite",async a=>{const s=a.objectStore("import_batches");await new Promise((i,o)=>{const f=s.put(n);f.onsuccess=()=>i(),f.onerror=()=>o(f.error)})})}async getImportHistory(){return this.executeTransaction("import_batches","readonly",async n=>{const s=n.objectStore("import_batches").index("timestamp");return new Promise((i,o)=>{const f=s.getAll();f.onsuccess=()=>{const d=f.result||[];d.sort((x,m)=>new Date(m.timestamp).getTime()-new Date(x.timestamp).getTime()),i(d)},f.onerror=()=>o(f.error)})})}async generateCampaignSummaries(n){const a=await this.getPerformanceRecords(n),s=new Map;a.forEach(o=>{const f=o.campaignName;s.has(f)||s.set(f,[]),s.get(f).push(o)});const i=[];for(const[o,f]of s){const d=f.reduce((b,y)=>b+y.spend,0),x=f.reduce((b,y)=>b+y.purchaseValue,0),m=f.reduce((b,y)=>b+y.impressions,0),p=f.reduce((b,y)=>b+y.purchases,0),v={clientId:n,campaignName:o,totalSpend:d,totalRevenue:x,totalImpressions:m,totalPurchases:p,roas:d>0?x/d:0,cpm:m>0?d/m*1e3:0,ctr:m>0?f.reduce((b,y)=>b+y.clicksAll,0)/m*100:0,startDate:f.reduce((b,y)=>y.day<b?y.day:b,f[0].day),endDate:f.reduce((b,y)=>y.day>b?y.day:b,f[0].day),adCount:new Set(f.map(b=>b.adName)).size,activeDays:new Set(f.map(b=>b.day)).size,createdAt:new Date,updatedAt:new Date};i.push(v)}await this.executeTransaction("campaign_summaries","readwrite",async o=>{const f=o.objectStore("campaign_summaries"),d=f.index("clientId_campaign");let x=0,m=0;for(const p of i)try{const v=await new Promise((b,y)=>{const E=d.get([n,p.campaignName]);E.onsuccess=()=>b(E.result||null),E.onerror=()=>y(E.error)});v?(p.id=v.id,p.createdAt=v.createdAt,m++):x++,await new Promise((b,y)=>{const E=f.put(p);E.onsuccess=()=>b(),E.onerror=()=>y(E.error)})}catch(v){console.warn(`[IndexedDB] Error saving campaign summary for ${p.campaignName}:`,v)}console.log(`[IndexedDB] Campaign summaries processed for client ${n} - New: ${x}, Updated: ${m}`)})}async getCampaignSummaries(n,a){return this.db||await this.initialize(),await this.executeTransaction("campaign_summaries","readonly",async s=>{const o=s.objectStore("campaign_summaries").index("clientId");return new Promise((f,d)=>{const x=o.getAll(n);x.onsuccess=()=>{let m=x.result;a&&(m=m.filter(p=>p.startDate>=a.start&&p.endDate<=a.end)),f(m)},x.onerror=()=>d(x.error)})})}async clearAllData(){this.db||await this.initialize();const n=["clients","users","performance_records","creative_data","campaign_summaries","import_batches","system_config","processed_hashes","bitacora_reports","uploaded_videos"];return this.executeTransaction(n,"readwrite",async a=>{for(const s of n){const i=a.objectStore(s);await new Promise((o,f)=>{const d=i.clear();d.onsuccess=()=>o(),d.onerror=()=>f(d.error)})}})}async getDatabaseStats(){const n={clients:0,performanceRecords:0,creativeRecords:0,importBatches:0,totalSize:"Unknown"};try{n.clients=(await this.getClients()).length;const a=await this.getPerformanceData();n.performanceRecords=Object.values(a).flat().length;const s=await this.getImportHistory();if(n.importBatches=s.length,"estimate"in navigator.storage){const i=await navigator.storage.estimate();n.totalSize=`${((i.usage||0)/1024/1024).toFixed(2)} MB`}}catch(a){console.warn("[IndexedDB] Error getting database stats:",a)}return n}};const dt=new jb,xi={connected:!1};let oo=!1;const Qc=()=>{if(!xi.connected||!oo){const e="Database not connected. Please check configuration in Settings.";throw console.error(`[DB] ${e}`),new Error(e)}},Xe={async connect(){try{await dt.initialize(),oo=!0,xi.connected=!0,console.log("[DB]  Connected to IndexedDB successfully"),await this.migrateFromLegacyStorage()}catch(e){throw console.error("[DB]  Failed to connect to IndexedDB:",e),oo=!1,xi.connected=!1,e}},async select(e,n){if(e!=="config"&&e!=="import_history"&&e!=="processed_files_hashes"&&Qc(),console.log(`[DB] Executing: SELECT * FROM ${e}`),["users","logged_in_user","config"].includes(e))try{const s=localStorage.getItem(`db_${e}`);if(s){const i=JSON.parse(s);return console.log(`[DB]  Retrieved ${e} from localStorage (critical auth data)`),i}return console.log(`[DB] No critical data found for ${e}, returning default`),n}catch(s){return console.error(`[DB] Error parsing localStorage data for ${e}:`,s),n}try{const s=await this.retrieveFromIndexedDB(e);if(s!==null)return console.log(`[DB]  Retrieved ${e} from IndexedDB`),s}catch(s){throw console.error(`[DB]  IndexedDB retrieval failed for ${e}:`,s),new Error(`Failed to retrieve ${e} from IndexedDB: ${s}`)}return console.log(`[DB] No data found for ${e}, returning default`),n},async update(e,n){if(e!=="config"&&Qc(),console.log(`[DB] Executing: UPDATE ${e} with new data...`),console.log(`[DB] Data size: ${JSON.stringify(n).length} characters`),["users","logged_in_user","config"].includes(e))try{const s=JSON.stringify(n);localStorage.setItem(`db_${e}`,s),console.log(`[DB]  Saved ${e} to localStorage (critical auth data)`);return}catch(s){console.error(`[DB] Failed to save critical data ${e}:`,s);const i=`Error: No se pudieron guardar los datos crticos. ${s}`;throw alert(i),new Error(i)}try{await this.routeToIndexedDB(e,n),console.log(`[DB]  Successfully saved ${e} to IndexedDB`),this.cleanupLegacyStorage(e)}catch(s){console.error(`[DB]  IndexedDB save failed for ${e}:`,s);const i=`Error: No se pudieron guardar los datos en IndexedDB. ${s}`;throw alert(i),new Error(i)}},async routeToIndexedDB(e,n){switch(e){case"clients":await dt.saveClients(Array.isArray(n)?n:[n]);break;case"performance_data":for(const[a,s]of Object.entries(n))if(Array.isArray(s)){const i=`batch_${Date.now()}_${a}`;await dt.savePerformanceRecords(a,s,i),await dt.generateCampaignSummaries(a)}break;case"looker_data":for(const[a,s]of Object.entries(n))await dt.saveCreativeData(a,s);break;case"import_history":if(Array.isArray(n))for(const a of n)await dt.saveImportBatch(a);break;case"bitacora_reports":await dt.saveConfig("bitacora_reports",n,"app_config");break;case"uploaded_videos":await dt.saveConfig("uploaded_videos",n,"app_config");break;case"meta_api_config":await dt.saveConfig("meta_api_config",n,"meta_api");break;case"mcp_config":await dt.saveConfig("mcp_config",n,"mcp_config");break;case"processed_files_hashes":await dt.saveConfig("processed_files_hashes",n,"app_config");break;default:await dt.saveConfig(e,n,"app_config");break}},async retrieveFromIndexedDB(e){switch(e){case"clients":return await dt.getClients();case"performance_data":return await dt.getPerformanceData();case"looker_data":try{const n=await dt.getClients(),a={};if(n.length===0)return console.warn("[DB] No clients found, checking for creative data without client constraint"),await dt.getAllCreativeData();for(const s of n)try{const i=await dt.getCreativeData(s.id);i&&Object.keys(i).length>0&&(a[s.id]=i)}catch(i){console.warn(`[DB] Failed to get creative data for client ${s.id}:`,i)}return console.log(`[DB]  Retrieved creative data for ${Object.keys(a).length} clients from IndexedDB`),a}catch(n){console.error("[DB] Error retrieving looker_data from IndexedDB:",n);try{const a=await dt.getAllCreativeData();return console.log("[DB]  Retrieved creative data using fallback method"),a}catch(a){return console.error("[DB] Fallback also failed:",a),{}}}case"import_history":return await dt.getImportHistory();case"bitacora_reports":return await dt.getConfig("bitacora_reports");case"uploaded_videos":return await dt.getConfig("uploaded_videos");case"meta_api_config":return await dt.getConfig("meta_api_config");case"mcp_config":return await dt.getConfig("mcp_config");case"processed_files_hashes":return await dt.getConfig("processed_files_hashes");default:return await dt.getConfig(e)}},async clearTable(e){Qc(),console.log(`[DB] Executing: DELETE FROM ${e} (clearing table)`);try{e==="clients"?await dt.clearAllData():await dt.clearAllData(),localStorage.removeItem(`db_${e}`),console.log(`[DB]  Cleared table ${e} from IndexedDB`)}catch(n){throw console.error(`[DB] Error clearing table ${e}:`,n),n}},async clearAllData(){Qc(),console.log("[DB] Executing: CLEAR ALL USER DATA");try{await dt.clearAllData(),["db_clients","db_performance_data","db_looker_data","db_bitacora_reports","db_uploaded_videos","db_import_history","db_processed_files_hashes","current_client_id"].forEach(n=>localStorage.removeItem(n)),Object.keys(localStorage).forEach(n=>{n.startsWith("metaAdCreativeAnalysis_")&&localStorage.removeItem(n)}),console.log("[DB]  All user data cleared successfully (auth data preserved)")}catch(e){throw console.error("[DB] Error clearing data:",e),e}},async factoryReset(){console.log("[DB] Executing: FACTORY RESET");try{await dt.clearAllData(),localStorage.clear(),console.log("[DB]  Factory reset completed - all data cleared")}catch(e){console.error("[DB] Error during factory reset:",e),localStorage.clear()}},async migrateFromLegacyStorage(){console.log("[DB] Checking for legacy localStorage migration...");try{const e=["clients","performance_data","looker_data","import_history","bitacora_reports","uploaded_videos"];for(const n of e){const a=localStorage.getItem(`db_${n}`);if(a)try{const s=JSON.parse(a);s&&(Array.isArray(s)?s.length>0:Object.keys(s).length>0)&&(await this.routeToIndexedDB(n,s),console.log(`[DB]  Migrated ${n} from localStorage to IndexedDB`),localStorage.removeItem(`db_${n}`))}catch(s){console.warn(`[DB] Failed to migrate ${n} from localStorage:`,s)}}}catch(e){console.warn("[DB] Migration check failed:",e)}},cleanupLegacyStorage(e){try{localStorage.removeItem(`db_${e}`),localStorage.removeItem(`db_${e}_storage`)}catch(n){console.warn(`[DB] Legacy cleanup failed for ${e}:`,n)}},getLocalStorageUsage(){try{dt.getDatabaseStats().then(s=>{console.log("[DB] IndexedDB Stats:",s)});let e=0,n=0;for(let s in localStorage)if(localStorage.hasOwnProperty(s)){const i=localStorage.getItem(s);i&&(e+=s.length+i.length,n++)}return{used:(e/(1024*1024)).toFixed(2)+"MB (localStorage) + IndexedDB Storage",quota:"IndexedDB (Several GB Available)",items:n}}catch(e){return console.warn("[DB] Error getting storage usage:",e),{used:"Unknown",quota:"Unknown",items:0}}},async clearOldData(){console.log("[DB] Clearing old data to optimize storage...");try{console.log("[DB]  Old data cleanup completed")}catch(e){console.warn("[DB] Error during cleanup:",e)}},async healthCheck(){const e=[];let n=!1,a=null;try{await dt.initialize(),n=!0,a=await dt.getDatabaseStats()}catch(s){e.push(`IndexedDB initialization failed: ${s}`)}return{connected:oo,indexedDBAvailable:n,storageStats:a,issues:e}},async getUsers(){return await this.select("users",[])},async saveUsers(e){await this.update("users",e)},async getClients(){return await this.select("clients",[])},async saveClients(e){await this.update("clients",e)},async getPerformanceData(){return await this.select("performance_data",{})},async savePerformanceData(e){await this.update("performance_data",e)},async getLookerData(){return await this.select("looker_data",{})},async saveLookerData(e){await this.update("looker_data",e)},async getBitacoraReports(){return await this.select("bitacora_reports",[])},async saveBitacoraReports(e){await this.update("bitacora_reports",e)},async getUploadedVideos(){return await this.select("uploaded_videos",[])},async saveUploadedVideos(e){await this.update("uploaded_videos",e)},async getImportHistory(){return await this.select("import_history",[])},async saveImportHistory(e){await this.update("import_history",e)},async getLoggedInUser(){return await this.select("logged_in_user",null)},async saveLoggedInUser(e){await this.update("logged_in_user",e)},async getMetaApiConfig(){return await this.select("config",null)},async saveMetaApiConfig(e){await this.update("config",e)},async getProcessedHashes(){return await this.select("processed_files_hashes",{})},async saveProcessedHashes(e){await this.update("processed_files_hashes",e)},async getPerformanceDataByClient(e){try{return await dt.getPerformanceRecords(e)}catch(n){return console.warn(`[DB] Failed to get performance data for client ${e}:`,n),[]}},async getCreativeDataByClient(e){try{return await dt.getCreativeData(e)}catch(n){return console.warn(`[DB] Failed to get creative data for client ${e}:`,n),null}},async getCampaignSummaries(e,n){try{return await dt.getCampaignSummaries(e,n)}catch(a){return console.warn(`[DB] Failed to get campaign summaries for client ${e}:`,a),[]}},async getDatabaseStats(){try{return await dt.getDatabaseStats()}catch(e){return console.warn("[DB] Failed to get database stats:",e),{error:"Stats unavailable"}}},async debugCreativeData(){try{const[e,n]=await Promise.all([dt.getClients(),dt.getAllCreativeData()]),a=Object.keys(n),s={};let i=0;for(const[f,d]of Object.entries(n)){const x=Object.keys(d).length;s[f]=x,i+=x}const o={totalClients:e.length,totalCreativeRecords:i,clientsWithCreatives:a,creativeDataByClient:s};return console.log("[DB]  Creative Data Debug:",o),o}catch(e){return console.error("[DB] Failed to debug creative data:",e),{totalClients:0,totalCreativeRecords:0,clientsWithCreatives:[],creativeDataByClient:{}}}}},Mb=()=>{const[e,n]=se.useState({}),[a,s]=se.useState({}),[i,o]=se.useState(!1),[f,d]=se.useState(["> Log de produccin inicializado. Esperando comandos..."]),x=b=>{const y=new Date().toLocaleTimeString();d(E=>[...E.slice(-100),`[${y}] ${b}`])},m=[{key:"clients",name:"Tabla de Clientes",description:"Almacena perfiles de clientes."},{key:"users",name:"Tabla de Usuarios",description:"Almacena credenciales y roles de usuarios."},{key:"performance_data",name:"Tabla de Rendimiento (Meta)",description:"Almacena datos de reportes XLSX."},{key:"looker_data",name:"Tabla de Creativos (Looker)",description:"Almacena URLs de creativos por anuncio."},{key:"bitacora_reports",name:"Tabla de Reportes (TXT)",description:"Almacena los reportes de bitcora parseados."},{key:"uploaded_videos",name:"Tabla de Videos Subidos",description:"Almacena los archivos de video para anlisis."},{key:"import_history",name:"Tabla de Historial de Importacin",description:"Registra todas las operaciones de subida."},{key:"processed_files_hashes",name:"Tabla de Hashes de Archivos",description:"Previene la subida de archivos duplicados."}],p=se.useCallback(async()=>{o(!0),x("> Ejecutando: CHECK DATABASE STATUS..."),await new Promise(E=>setTimeout(E,500));const b=E=>localStorage.getItem(E)!==null,y=m.reduce((E,_)=>(E[_.key]=b(`db_${_.key}`),E),{});n(y),x(" Status de tablas verificado desde el almacenamiento."),o(!1)},[]);se.useEffect(()=>{p()},[p]);const v=async()=>{if(window.confirm("ESTS SEGURO? Esta accin eliminar TODA la informacin de la aplicacin (clientes, historial, reportes, usuarios) de forma permanente. Esta accin no se puede deshacer.")&&window.confirm("CONFIRMACIN FINAL: Realmente quieres borrar toda la base de datos (excepto la configuracin)?"))try{x(" Iniciando protocolo de limpieza de datos de la base de datos..."),await Xe.clearAllData(),x(" Base de datos limpiada con xito. La aplicacin se reiniciar."),alert("Base de datos limpiada. La aplicacin se recargar."),window.location.reload()}catch(b){console.error("Error al limpiar la base de datos:",b);const y=b instanceof Error?b.message:String(b);x(` Error durante la limpieza: ${y}`),alert("Ocurri un error al intentar limpiar la base de datos.")}};return c.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in space-y-8",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-2",children:"Panel de Control de la Base de Datos"}),c.jsx("p",{className:"text-brand-text-secondary",children:'Gestiona las "tablas" de la base de datos simulada de la aplicacin.'})]}),c.jsxs("button",{onClick:p,disabled:i,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center sm:justify-start gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${i?"animate-spin":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"})}),c.jsx("span",{children:i?"Verificando...":"Refrescar Estado"})]})]}),c.jsx("div",{className:"space-y-4",children:m.map(b=>c.jsxs("div",{className:"bg-brand-border/50 p-4 rounded-md flex justify-between items-center transition-colors",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-brand-text",children:b.name}),c.jsx("p",{className:"text-sm text-brand-text-secondary",children:b.description})]}),e[b.key]?c.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-bold bg-green-500/20 px-3 py-1 rounded-full text-sm",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"ONLINE"]}):c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"text-yellow-400 font-bold bg-yellow-500/20 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"OFFLINE"]}),c.jsx("button",{className:"ml-2 px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30 font-bold",disabled:!!a[b.key],onClick:async()=>{s(y=>({...y,[b.key]:!0})),x(`> Intentando crear la tabla '${b.name}'...`);try{b.key==="performance_data"?await Xe.update("performance_data",{}):b.key==="clients"?await Xe.update("clients",[]):b.key==="users"?await Xe.update("users",[]):b.key==="looker_data"?await Xe.update("looker_data",{}):b.key==="bitacora_reports"?await Xe.update("bitacora_reports",[]):b.key==="uploaded_videos"?await Xe.update("uploaded_videos",[]):b.key==="import_history"?await Xe.update("import_history",[]):b.key==="processed_files_hashes"&&await Xe.update("processed_files_hashes",{}),x(` Tabla '${b.name}' creada correctamente.`),await p()}catch(y){x(` Error creando la tabla '${b.name}': ${y instanceof Error?y.message:String(y)}`),alert("Error creando la tabla. Ver log.")}s(y=>({...y,[b.key]:!1}))},children:"Crear tabla"})]})]},b.key))}),c.jsxs("div",{className:"mt-6",children:[c.jsx("h3",{className:"text-sm font-semibold text-brand-text-secondary mb-2",children:"LOG DE OPERACIONES DE PRODUCCIN"}),c.jsx("pre",{className:"bg-brand-bg p-4 rounded-md font-mono text-xs text-brand-text-secondary h-40 overflow-y-auto w-full",children:f.map((b,y)=>c.jsx("p",{className:`whitespace-pre-wrap ${b.includes("")?"text-green-400":b.includes("")?"text-yellow-400":b.includes("")||b.includes("")?"text-red-400":""}`,children:b},y))})]})]}),c.jsxs("div",{className:"border-t-2 border-red-500/30 pt-6 space-y-4",children:[c.jsx("h3",{className:"text-xl font-bold text-red-400",children:"Zona de Peligro"}),c.jsxs("div",{className:"bg-red-600/10 p-4 rounded-md flex flex-col sm:flex-row justify-between items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-red-400",children:"Limpiar Todos los Datos"}),c.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:"Elimina permanentemente todos los clientes, anlisis, reportes, usuarios, etc. La aplicacin volver a su estado inicial."})]}),c.jsx("button",{onClick:v,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex-shrink-0",children:"Limpiar Datos"})]})]})]})},rn=({isOpen:e,onClose:n,children:a})=>(se.useEffect(()=>{const s=i=>{i.key==="Escape"&&n()};return e&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}},[e,n]),e?c.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:n,children:c.jsx("div",{className:"relative",onClick:s=>s.stopPropagation(),children:a})}):null),Lb=e=>new Promise((n,a)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>n(s.result),s.onerror=i=>a(i)}),Fb=({isOpen:e,onClose:n,onSave:a,initialData:s,currentUser:i})=>{const[o,f]=se.useState(""),[d,x]=se.useState("USD"),[m,p]=se.useState(null),[v,b]=se.useState(null),[y,E]=se.useState(""),_=se.useRef(null);se.useEffect(()=>{e&&(s?(f(s.name),x(s.currency),b(s.logo),E(s.metaAccountName||""),p(null)):(f(""),x("EUR"),b(null),E(""),p(null)))},[e,s]);const w=D=>{if(D.target.files&&D.target.files[0]){const A=D.target.files[0];p(A),b(URL.createObjectURL(A))}},S=async D=>{if(D.preventDefault(),!o.trim()||!d.trim())return;let A=(s==null?void 0:s.logo)||`https://avatar.vercel.sh/${encodeURIComponent(o.trim())}.png?text=${encodeURIComponent(o.trim().charAt(0))}`;m&&(A=await Lb(m));const z={id:(s==null?void 0:s.id)||crypto.randomUUID(),name:o.trim(),logo:A,currency:d.trim().toUpperCase(),userId:(s==null?void 0:s.userId)||i.id,metaAccountName:y.trim()?y.trim():void 0};a(z),n()};return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:s?"Editar Cliente":"Aadir Nuevo Cliente"}),c.jsxs("form",{onSubmit:S,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"clientName",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre del Cliente"}),c.jsx("input",{id:"clientName",type:"text",value:o,onChange:D=>f(D.target.value),placeholder:"Ej: Muto Longevity",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"clientCurrency",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Moneda (3 letras)"}),c.jsx("input",{id:"clientCurrency",type:"text",value:d,onChange:D=>x(D.target.value),placeholder:"Ej: EUR",maxLength:3,className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"metaAccountName",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre de Cuenta de Meta (Opcional)"}),c.jsxs("p",{className:"text-xs text-brand-text-secondary/70 mb-1",children:['Este es el "Nombre de la cuenta" exacto que aparece en tus reportes. Es ',c.jsx("span",{className:"font-bold text-brand-text-secondary",children:"crucial"})," para vincular los datos automticamente."]}),c.jsx("input",{id:"metaAccountName",type:"text",value:y,onChange:D=>E(D.target.value),placeholder:"Ej: MiCliente - Ventas (ES)",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Logo del Cliente (Opcional)"}),c.jsxs("div",{className:"mt-1 flex items-center gap-4 bg-brand-bg border border-brand-border rounded-md p-2",children:[c.jsx("span",{className:"h-12 w-12 rounded-full overflow-hidden bg-brand-border flex-shrink-0",children:v?c.jsx("img",{src:v,alt:"Logo Preview",className:"h-full w-full object-cover"}):c.jsx("svg",{className:"h-full w-full text-brand-text-secondary p-2",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M24 20.993V24H0v-2.997A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})}),c.jsx("input",{id:"clientLogo",type:"file",ref:_,onChange:w,className:"block w-full text-sm text-brand-text-secondary file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary/10 file:text-brand-primary hover:file:bg-brand-primary/20 cursor-pointer",accept:"image/png, image/jpeg, image/gif"})]})]}),c.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),c.jsx("button",{type:"submit",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:"Guardar"})]})]}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},Ib=({client:e,onEdit:n,onDelete:a})=>c.jsxs("li",{className:"bg-brand-border/50 p-4 rounded-md flex items-center gap-4 transition-all hover:shadow-lg hover:bg-brand-border/70 relative",children:[c.jsx("img",{src:e.logo,alt:e.name,className:"h-12 w-12 rounded-full bg-brand-border object-cover flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-semibold text-brand-text",children:e.name}),c.jsxs("p",{className:"text-sm text-brand-text-secondary",children:["Moneda: ",e.currency]}),e.metaAccountName&&c.jsxs("p",{className:"text-xs text-brand-primary/80 font-mono",children:["Cuenta Meta: ",e.metaAccountName]})]}),c.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-shrink-0",children:[c.jsx("button",{onClick:n,className:"p-2 rounded-full text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-colors","aria-label":`Editar cliente ${e.name}`,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),c.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]})}),c.jsx("button",{onClick:a,className:"p-2 rounded-full text-brand-text-secondary hover:bg-red-500 hover:text-white transition-colors","aria-label":`Eliminar cliente ${e.name}`,children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]}),Bb=({clients:e,setClients:n,currentUser:a})=>{const[s,i]=se.useState(!1),[o,f]=se.useState(null),d=a.role==="admin",x=se.useMemo(()=>d?e:e.filter(y=>y.userId===a.id),[e,d,a]),m=()=>{f(null),i(!0)},p=y=>{f(y),i(!0)},v=y=>{const _=e.some(w=>w.id===y.id)?e.map(w=>w.id===y.id?y:w):[...e,y];n(_),i(!1)},b=y=>{window.confirm("Seguro que quieres eliminar este cliente? Esta accin tambin eliminar todos sus datos asociados (rendimiento, reportes, etc.) y no se puede deshacer.")&&n(e.filter(E=>E.id!==y))};return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text",children:[d?"Todos los Clientes":"Mis Clientes"," (",x.length,")"]}),c.jsxs("button",{onClick:m,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Aadir Cliente"]})]}),x.length>0?c.jsx("ul",{className:"space-y-4",children:x.map(y=>c.jsx(Ib,{client:y,onEdit:()=>p(y),onDelete:()=>b(y.id)},y.id))}):c.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-brand-border rounded-lg",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),c.jsx("p",{className:"mt-4 text-brand-text-secondary",children:"No se han encontrado clientes."}),c.jsx("p",{className:"text-sm text-brand-text-secondary/70",children:"Aade uno nuevo para empezar."})]})]}),c.jsx(Fb,{isOpen:s,onClose:()=>i(!1),onSave:v,initialData:o,currentUser:a})]})},Ub=({ad:e,onShowMetricsDetail:n,onShowAnalysisDetail:a,onUpdateAnalysis:s,onUploadVideo:i,generatingAnalysis:o})=>{const f=[{label:"ROAS",value:e.roas.toFixed(2),highlight:!0},{label:"Gasto",value:e.spend.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"Ventas",value:e.purchases.toLocaleString("es-ES")},{label:"CPA",value:e.cpa.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"CTR (Link)",value:`${e.ctrLink.toFixed(2)}%`},{label:"CPM",value:e.cpm.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"Frecuencia",value:e.frequency.toFixed(2)}],d=()=>{e.creativeType==="video"&&e.isMatched&&i()},x=()=>e.isMatched&&e.imageUrl?c.jsxs("button",{onClick:d,className:"relative w-full h-full group","aria-label":e.creativeType==="video"?"Subir video para este anuncio":"Vista previa del creativo",disabled:e.creativeType!=="video",children:[c.jsx("img",{src:e.imageUrl,alt:e.adName,className:"w-full h-full object-cover"}),e.creativeType==="video"&&c.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none group-hover:bg-black/50 transition-colors",children:c.jsx("svg",{className:"h-10 w-10 text-white/80",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):c.jsxs("div",{className:"text-brand-text-secondary text-center p-4 flex flex-col items-center justify-center h-full",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("p",{className:"text-xs mt-2",children:e.isMatched?"Error al cargar":"Creativo no vinculado"})]}),m=e.creativeType==="video"&&!e.isVideoUploaded;return c.jsxs("div",{className:"bg-brand-border/50 rounded-lg overflow-hidden shadow-lg transform transition-all duration-300 hover:shadow-brand-primary/20 hover:-translate-y-1 flex flex-col",children:[c.jsx("div",{className:"w-full aspect-square bg-brand-bg flex items-center justify-center overflow-hidden",children:x()}),c.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[c.jsx("p",{className:"text-sm font-semibold text-brand-text truncate",title:e.adName,children:e.adName}),e.inMultipleAdSets&&c.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:"En mltiples Ad-Sets"}),c.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 mt-4 flex-grow",children:f.map(p=>c.jsxs("div",{className:p.highlight?"col-span-2 bg-brand-primary/20 p-2 rounded-md text-center":"",children:[c.jsx("p",{className:`text-xs uppercase tracking-wider ${p.highlight?"text-brand-primary":"text-brand-text-secondary"}`,children:p.label}),c.jsx("p",{className:`font-bold ${p.highlight?"text-brand-primary text-2xl":"text-brand-text text-base"}`,children:p.value})]},p.label))}),c.jsxs("div",{className:"mt-4 pt-3 border-t border-brand-border/50 flex items-center gap-2",children:[e.adPreviewLink&&c.jsx("a",{href:e.adPreviewLink,target:"_blank",rel:"noopener noreferrer",title:"Ver vista previa en Meta",className:"p-2 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),c.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),c.jsx("button",{onClick:n,title:"Ver todas las mtricas",className:"p-2 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 110 2H3a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2H8a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"}),c.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm0 2h12v12H4V4z",clipRule:"evenodd"})]})}),e.isMatched&&e.imageUrl&&(e.creativeDescription?c.jsx("button",{onClick:a,className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text text-sm font-bold py-2 px-3 rounded-md transition-colors",children:"Mostrar Anlisis"}):c.jsx("button",{onClick:s,disabled:o||m,title:m?"Sube el archivo de video para poder analizarlo.":"",className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white text-sm font-bold py-2 px-3 rounded-md transition-colors disabled:opacity-50 disabled:cursor-wait",children:o?"Analizando...":"Generar Anlisis IA"}))]})]})]})},Pb=({data:e,onShowMetricsDetail:n,onShowAnalysisDetail:a,onUpdateAnalysis:s,onUploadVideo:i,generatingAnalysis:o})=>{if(e.length===0)return c.jsx("p",{className:"text-brand-text-secondary text-center py-8",children:"No hay datos de rendimiento para el rango de fechas y filtro seleccionado."});const f=["Creativo","Anuncio","Gasto","ROAS","Ventas","CPA","CPM","Frecuencia","CTR (Link)","Impresiones","Accin"];return c.jsx("div",{className:"overflow-x-auto bg-brand-bg rounded-lg",children:c.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[c.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-surface",children:c.jsx("tr",{children:f.map(d=>c.jsx("th",{scope:"col",className:"px-4 py-3 whitespace-nowrap",children:d},d))})}),c.jsx("tbody",{children:e.map(d=>c.jsxs("tr",{className:"bg-brand-surface border-b border-brand-border hover:bg-brand-border/50",children:[c.jsx("td",{className:"px-4 py-3",children:c.jsx("button",{onClick:()=>d.creativeType==="video"?i(d):void 0,className:"w-16 h-16 bg-brand-bg rounded-md flex items-center justify-center overflow-hidden relative group",children:d.imageUrl?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:d.imageUrl,alt:d.adName,className:"w-full h-full object-cover"}),d.creativeType==="video"&&c.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none group-hover:bg-black/50 transition-colors",children:c.jsx("svg",{className:"h-6 w-6 text-white/80",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-brand-border",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),c.jsx("td",{className:"px-4 py-3 truncate max-w-xs font-medium text-brand-text",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{title:d.adName,children:d.adName}),d.inMultipleAdSets&&c.jsx("span",{title:"Este anuncio se encuentra en mltiples conjuntos de anuncios.",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-brand-text-secondary",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"})})})]})}),c.jsx("td",{className:"px-4 py-3",children:d.spend.toLocaleString("es-ES",{style:"currency",currency:d.currency})}),c.jsx("td",{className:"px-4 py-3 font-semibold text-brand-text",children:d.roas.toFixed(2)}),c.jsx("td",{className:"px-4 py-3",children:d.purchases.toLocaleString("es-ES")}),c.jsx("td",{className:"px-4 py-3",children:d.cpa.toLocaleString("es-ES",{style:"currency",currency:d.currency})}),c.jsx("td",{className:"px-4 py-3",children:d.cpm.toLocaleString("es-ES",{style:"currency",currency:d.currency})}),c.jsx("td",{className:"px-4 py-3",children:d.frequency.toFixed(2)}),c.jsx("td",{className:"px-4 py-3",children:`${d.ctrLink.toFixed(2)}%`}),c.jsx("td",{className:"px-4 py-3",children:d.impressions.toLocaleString("es-ES")}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center gap-2",children:[d.adPreviewLink&&c.jsx("a",{href:d.adPreviewLink,target:"_blank",rel:"noopener noreferrer",title:"Ver vista previa en Meta",className:"p-1.5 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),c.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),c.jsx("button",{onClick:()=>n(d),title:"Ver todas las mtricas",className:"p-1.5 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 110 2H3a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2H8a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"}),c.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm0 2h12v12H4V4z",clipRule:"evenodd"})]})}),d.isMatched&&d.imageUrl&&c.jsx(c.Fragment,{children:d.creativeDescription?c.jsx("button",{onClick:()=>a(d),className:"bg-brand-border hover:bg-brand-border/70 text-brand-text text-xs font-bold py-1 px-2 rounded-md transition-colors",children:"Anlisis"}):c.jsx("button",{onClick:()=>s(d),disabled:o[d.adName]||d.creativeType==="video"&&!d.isVideoUploaded,title:d.creativeType==="video"&&!d.isVideoUploaded?"Sube el video para analizar.":"",className:"bg-brand-primary/20 text-brand-primary hover:bg-brand-primary/40 text-xs font-bold py-1 px-2 rounded-md transition-colors disabled:opacity-50 disabled:cursor-wait",children:o[d.adName]?"Analizando...":"Generar IA"})})]})})]},d.adName))})]})})},uo=({onDateChange:e,startDate:n,endDate:a})=>{const[s,i]=se.useState(n),[o,f]=se.useState(a),[d,x]=se.useState("");se.useEffect(()=>{i(n),f(a)},[n,a]);const m=()=>{e(s,o)},p=(b,y)=>{const E=new Date,_=new Date;_.setDate(E.getDate()-b);const w=_.toISOString().split("T")[0],S=E.toISOString().split("T")[0];i(w),f(S),x(y),e(w,S)},v=()=>{x("")};return c.jsxs("div",{className:"flex flex-col items-stretch gap-2 bg-brand-border/30 p-2 rounded-lg",children:[c.jsxs("div",{className:"flex items-center justify-around gap-1",children:[c.jsx("button",{onClick:()=>p(7,"7d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${d==="7d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"7 das"}),c.jsx("button",{onClick:()=>p(15,"15d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${d==="15d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"15 das"}),c.jsx("button",{onClick:()=>p(30,"30d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${d==="30d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"30 das"})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 w-full",children:[c.jsx("input",{type:"date",id:"startDate",value:s,onChange:b=>{i(b.target.value),v()},className:"bg-brand-bg border border-brand-border text-brand-text rounded-md p-1.5 text-sm w-full focus:ring-brand-primary focus:border-brand-primary"}),c.jsx("span",{className:"text-brand-text-secondary",children:"-"}),c.jsx("input",{type:"date",id:"endDate",value:o,onChange:b=>{f(b.target.value),v()},className:"bg-brand-bg border border-brand-border text-brand-text rounded-md p-1.5 text-sm w-full focus:ring-brand-primary focus:border-brand-primary"})]}),c.jsx("button",{onClick:m,className:"w-full sm:w-auto bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors text-sm",children:"Aplicar"})]})]})},Hb=()=>c.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[c.jsxs("svg",{className:"animate-spin h-10 w-10 text-brand-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c.jsx("p",{className:"text-lg font-semibold text-brand-text",children:"Generando conclusin estratgica..."})]}),zb=({text:e})=>{const n=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`([^`]+)`/g,'<code class="bg-brand-bg px-1 py-0.5 rounded-sm font-mono text-sm text-yellow-300">$1</code>').replace(/^- (.*$)/gm,'<li class="ml-4 list-disc">$1</li>').replace(/^(#+) (.*$)/gm,(a,s,i)=>{const o=s.length;return`<h${o} class="${o===1?"text-xl":o===2?"text-lg":"text-md"} font-bold mt-4 mb-2 text-brand-text">${i}</h${o}>`}).replace(/\n/g,"<br />");return c.jsx("div",{className:"prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:n.replace(/<br \/><(h[1-6]|li|strong|em)/g,"<$1")}})},Vb=({isOpen:e,onClose:n,isLoading:a,analysisText:s})=>c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-2xl max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Conclusin Estratgica de la IA"}),c.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow",children:a?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx(Hb,{})}):c.jsx("div",{className:"text-brand-text-secondary space-y-4 whitespace-pre-wrap",children:c.jsx(zb,{text:s})})})]})}),Gb={ACTIVATE:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),CAUTION:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})},pm=({score:e,label:n,colorClass:a,justification:s})=>{const o=2*Math.PI*35,f=o-e/100*o;return c.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[c.jsxs("div",{className:"relative h-24 w-24",children:[c.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[c.jsx("circle",{className:"text-brand-surface",strokeWidth:"10",stroke:"currentColor",fill:"transparent",r:35,cx:"50",cy:"50"}),c.jsx("circle",{className:a,strokeWidth:"10",strokeDasharray:o,strokeDashoffset:f,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:35,cx:"50",cy:"50",style:{transition:"stroke-dashoffset 0.5s ease-in-out"}})]}),c.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-4xl font-bold text-brand-text",children:[Math.round(e),c.jsx("span",{className:"text-xl",children:"%"})]})]}),c.jsx("span",{className:"block mt-4 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:n}),c.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:s})]})},Yb=({score:e,justification:n})=>{let a="text-green-400",s=c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});return e>35?(a="text-red-400",s=c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})):e>20&&(a="text-yellow-400",s=c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})),c.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[s,c.jsxs("p",{className:`text-4xl font-bold mt-3 ${a}`,children:[e,"%"]}),c.jsx("span",{className:"block mt-3 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:"Texto en Imagen"}),c.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:n})]})},Xb=({stage:e,justification:n})=>c.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})}),c.jsx("p",{className:"text-4xl font-bold mt-3",children:e}),c.jsx("span",{className:"block mt-3 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:"Etapa del Embudo"}),c.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:n})]}),qb=({item:e})=>{const[n,a]=se.useState(!1),s=e.applicable==="CAUTION";return c.jsxs("div",{className:`rounded-md ${s?"bg-yellow-500/10":"bg-green-500/10"}`,children:[c.jsxs("button",{className:"flex items-center w-full text-left gap-3 p-3",onClick:()=>a(!n),children:[c.jsx("div",{className:"flex-shrink-0",children:Gb[e.applicable]}),c.jsx("p",{className:`flex-1 font-semibold ${s?"text-yellow-300":"text-green-300"}`,children:e.enhancement}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-brand-text-secondary transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&c.jsx("div",{className:"px-3 pb-3 pl-11",children:c.jsx("p",{className:"text-brand-text-secondary text-sm",children:e.justification})})]})},Kb=({description:e})=>{const[n,a]=se.useState(!1);return c.jsxs("div",{className:"pt-6 border-t border-brand-border",children:[c.jsxs("button",{className:"flex justify-between items-center w-full text-left",onClick:()=>a(!n),children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text",children:"Descripcin del Creativo (Contexto IA)"}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-brand-text-secondary transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&c.jsx("div",{className:"mt-3 p-4 rounded-md bg-brand-border/30",children:c.jsx("p",{className:"text-brand-text-secondary text-sm whitespace-pre-wrap",children:e})})]})},Wb=()=>c.jsxs("div",{className:"space-y-6 animate-pulse",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),c.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),c.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),c.jsx("div",{className:"h-48 bg-brand-border rounded-lg"})]}),c.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[c.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),c.jsxs("div",{className:"space-y-2 p-3 bg-brand-border/50 rounded-md",children:[c.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),c.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),c.jsx("div",{className:"h-3 bg-brand-border rounded w-5/6"})]})]}),c.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[c.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),[...Array(2)].map((e,n)=>c.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-brand-border/50 rounded-md",children:[c.jsx("div",{className:"h-4 bg-brand-border rounded w-1/2"}),c.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),c.jsx("div",{className:"h-3 bg-brand-border rounded w-5/6"})]},n))]}),c.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[c.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),[...Array(3)].map((e,n)=>c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-brand-border/50 rounded-md",children:[c.jsx("div",{className:"w-5 h-5 bg-brand-border rounded-full mt-1"}),c.jsxs("div",{className:"flex-1 space-y-2",children:[c.jsx("div",{className:"h-4 bg-brand-border rounded w-1/4"}),c.jsx("div",{className:"h-3 bg-brand-border rounded w-full"})]})]},n))]})]}),ff=({analysisResult:e,isLoading:n})=>c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg min-h-[200px]",children:[c.jsxs("h2",{className:"text-xl font-semibold text-brand-text mb-6 flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-brand-primary",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Anlisis Estratgico de IA"]}),n&&c.jsx(Wb,{}),e&&!n&&c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx(pm,{score:e.effectivenessScore,label:"EFECTIVIDAD",colorClass:"text-green-400",justification:e.effectivenessJustification}),c.jsx(pm,{score:e.clarityScore,label:"CLARIDAD",colorClass:"text-blue-400",justification:e.clarityJustification}),c.jsx(Yb,{score:e.textToImageRatio,justification:e.textToImageRatioJustification}),c.jsx(Xb,{stage:e.funnelStage,justification:e.funnelStageJustification})]}),e.creativeDescription&&c.jsx(Kb,{description:e.creativeDescription}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3 pt-6 border-t border-brand-border",children:"Recomendaciones Clave"}),c.jsx("div",{className:"space-y-4",children:e.recommendations.map((a,s)=>c.jsxs("div",{className:"p-4 rounded-md bg-brand-border/30",children:[c.jsx("h4",{className:"font-bold text-brand-text mb-2",children:a.headline}),c.jsx("ul",{className:"list-disc list-inside space-y-1 text-brand-text-secondary text-sm",children:a.points.map((i,o)=>c.jsx("li",{children:i},o))})]},s))})]}),c.jsxs("div",{className:"pt-6 border-t border-brand-border",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"Anlisis de Mejoras Advantage+"}),c.jsx("div",{className:"space-y-3",children:e.advantagePlusAnalysis.map((a,s)=>c.jsx(qb,{item:a},s))})]})]})]}),$b=({isOpen:e,onClose:n,adData:a})=>{if(!a)return null;const s=a.analysisResult;return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-4xl max-h-[90vh] flex flex-col relative",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0 border-b border-brand-border pb-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Anlisis Detallado del Creativo"}),c.jsx("p",{className:"text-brand-text-secondary truncate max-w-lg",children:a.adName})]}),c.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow",children:s?c.jsx(ff,{analysisResult:s,isLoading:!1}):c.jsx("div",{className:"text-center py-16 text-brand-text-secondary",children:c.jsx("p",{children:"No se encontr un resultado de anlisis para este creativo."})})})]})})},Zb=({isOpen:e,onClose:n,adData:a,onSave:s})=>{const[i,o]=se.useState(null),[f,d]=se.useState(!1),x=se.useRef(null),m=v=>{v.target.files&&v.target.files[0]&&o(v.target.files[0])},p=()=>{i&&s(a.adName,i)};return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:"Subir Video para Anlisis"}),c.jsx("p",{className:"text-brand-text-secondary mb-2",children:"Sube el archivo de video para el anuncio:"}),c.jsx("p",{className:"font-mono text-sm bg-brand-bg p-2 rounded-md text-brand-primary mb-6 truncate",children:a.adName}),c.jsxs("div",{className:"space-y-4",children:[!f&&c.jsxs("div",{className:"bg-brand-border/30 p-4 rounded-md text-center",children:[c.jsx("p",{className:"text-brand-text-secondary text-sm",children:"El sistema espera un archivo con el nombre:"}),c.jsx("p",{className:"font-semibold text-brand-text mt-1",children:a.videoFileName||"Nombre no especificado"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"video-upload",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:f?"Selecciona el archivo de video":"Selecciona el archivo correspondiente"}),c.jsx("input",{id:"video-upload",type:"file",ref:x,onChange:m,className:"block w-full text-sm text-brand-text-secondary file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary/10 file:text-brand-primary hover:file:bg-brand-primary/20 cursor-pointer bg-brand-bg border border-brand-border rounded-lg p-2",accept:"video/*"}),i&&c.jsxs("p",{className:"text-xs text-green-400 mt-2",children:["Archivo seleccionado: ",i.name]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{id:"different-name-checkbox",type:"checkbox",checked:f,onChange:v=>d(v.target.checked),className:"h-4 w-4 rounded border-brand-border text-brand-primary focus:ring-brand-primary"}),c.jsx("label",{htmlFor:"different-name-checkbox",className:"ml-2 block text-sm text-brand-text-secondary",children:"El archivo que quiero subir tiene un nombre diferente."})]})]}),c.jsxs("div",{className:"flex justify-end gap-4 pt-6 mt-4 border-t border-brand-border",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),c.jsx("button",{type:"button",onClick:p,disabled:!i,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Guardar Video"})]})]})})},cs=({title:e,children:n,className:a=""})=>c.jsxs("div",{className:`bg-brand-bg/50 rounded-lg p-4 shadow-inner h-full ${a}`,children:[c.jsx("h3",{className:"text-sm font-semibold text-brand-text-secondary uppercase tracking-wider mb-4",children:e}),c.jsx("div",{className:"space-y-4",children:n})]}),na=({label:e,value:n,average:a,isHighlighted:s=!1})=>c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-brand-text-secondary",children:e}),c.jsx("p",{className:`font-bold break-words ${s?"text-brand-primary text-xl":"text-brand-text text-lg"}`,children:n}),a&&c.jsxs("p",{className:"text-xs text-brand-text-secondary/70 mt-0.5",children:["Prom. Cuenta: ",a]})]}),gm=({title:e,items:n,type:a})=>{const[s,i]=se.useState(!1);if(n.length===0)return null;const o=a==="included"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300";return c.jsxs("div",{children:[c.jsxs("button",{onClick:()=>i(!s),className:`w-full text-left flex justify-between items-center p-2 rounded-md hover:bg-brand-border/80 transition-colors ${o}`,"aria-expanded":s,children:[c.jsxs("span",{className:"text-xs font-semibold",children:[e," (",n.length,")"]}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transform transition-transform ${s?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&c.jsx("div",{className:"text-xs font-mono bg-brand-bg rounded p-2 mt-1 max-h-24 overflow-y-auto",children:n.map(f=>c.jsx("div",{className:"truncate",title:f,children:f},f))})]})},Qb=({demographics:e,currency:n})=>{const a=se.useMemo(()=>{if(!e||e.length===0)return[];const i=Math.max(...e.map(d=>d.spend>0?d.purchaseValue/d.spend:0)),o=Math.max(...e.map(d=>d.purchaseValue));return e.map(d=>{const x=d.spend>0?d.purchaseValue/d.spend:0,m=i>0?x/i:0,p=o>0?d.purchaseValue/o:0,v=m*.5+p*.5;return{...d,score:v,roas:x}}).sort((d,x)=>x.score-d.score).slice(0,3)},[e]);if(!e||e.length===0)return c.jsx(cs,{title:"Rendimiento Demogrfico",children:c.jsx("p",{className:"text-xs text-brand-text-secondary",children:"No hay datos demogrficos."})});const s=i=>`${i.gender.toLowerCase()==="female"?"Mujer":i.gender.toLowerCase()==="male"?"Hombre":"Otro"} ${i.ageRange}`;return c.jsx(cs,{title:"Rendimiento Demogrfico",children:c.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.length>0?a.map((i,o)=>c.jsxs("div",{className:"border-b border-brand-border/50 pb-3 last:border-b-0 last:pb-0",children:[c.jsxs("p",{className:"font-bold text-brand-text text-lg flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-mono bg-brand-primary/20 text-brand-primary rounded-full h-6 w-6 flex items-center justify-center",children:o+1}),s(i)]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-brand-text-secondary",children:"Ventas"}),c.jsx("p",{className:"text-sm font-semibold",children:i.purchaseValue.toLocaleString("es-ES",{style:"currency",currency:n})})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-brand-text-secondary",children:"ROAS"}),c.jsx("p",{className:"text-sm font-semibold",children:i.roas.toFixed(2)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-brand-text-secondary",children:"CTR"}),c.jsx("p",{className:"text-sm font-semibold",children:`${(i.impressions>0?i.linkClicks/i.impressions*100:0).toFixed(2)}%`})]})]})]},o)):c.jsx("p",{className:"text-xs text-brand-text-secondary",children:"No hay suficientes datos para mostrar un top."})})})},Jb=({label:e,value:n,prevValue:a,isLast:s})=>{const i=a!==null&&a>0?100-n/a*100:0,f=(d=>d>50?{color:"bg-red-500/20 text-red-300",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})}:d>=30?{color:"bg-yellow-500/20 text-yellow-300",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})}:{color:"bg-green-500/20 text-green-300",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})(i);return c.jsxs("div",{className:"relative group",children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("p",{className:"text-sm font-semibold text-brand-text flex-1 truncate",children:e}),c.jsx("p",{className:"text-sm font-bold text-brand-text",children:n.toLocaleString("es-ES")}),a!==null&&c.jsxs("div",{className:`flex items-center gap-1 text-xs font-mono px-1.5 py-0.5 rounded ${f.color}`,children:[f.icon,c.jsxs("span",{children:["-",i.toFixed(1),"%"]})]})]}),!s&&c.jsx("div",{className:"flex justify-center my-1",children:c.jsx("div",{className:"h-3 w-px bg-brand-border group-hover:bg-brand-primary transition-colors"})})]})},ey=({isOpen:e,onClose:n,currentMetrics:a,previousMetrics:s,currency:i})=>{const o=m=>m.toLocaleString("es-ES",{style:"currency",currency:i}),f=m=>m.toLocaleString("es-ES",{maximumFractionDigits:0}),d=m=>m.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),x=({label:m,current:p,previous:v,format:b,isGoodUp:y})=>{let E="N/A",_="text-brand-text-secondary";if(v!==void 0&&v!==0){const w=(p-v)/v*100,S=w>=0,D=y?S:!S;_=Math.abs(w)<.1?"text-brand-text-secondary":D?"text-green-400":"text-red-400",E=`${S?"+":""}${w.toFixed(1)}%`}else v===0&&p>0&&(E="+%",_=y?"text-green-400":"text-red-400");return c.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center py-2 border-b border-brand-border/50 last:border-b-0",children:[c.jsx("div",{className:"font-semibold text-brand-text",children:m}),c.jsx("div",{className:"text-right font-mono",children:v!==void 0?b(v):"N/A"}),c.jsxs("div",{className:"text-right font-mono flex items-center justify-end gap-2",children:[c.jsx("span",{children:b(p)}),c.jsx("span",{className:`text-xs font-bold w-16 text-center py-0.5 rounded ${_}`,children:E})]})]})};return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-2xl relative",children:[c.jsx("h2",{className:"text-xl font-bold text-brand-text mb-2",children:"Evolucin vs. Semana Anterior"}),c.jsx("p",{className:"text-brand-text-secondary mb-6 text-sm",children:"Comparativa de mtricas clave del perodo actual contra el perodo anterior de igual duracin."}),c.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs font-bold text-brand-text-secondary uppercase tracking-wider mb-2",children:[c.jsx("div",{className:"",children:"Mtrica"}),c.jsx("div",{className:"text-right",children:"Semana Anterior"}),c.jsx("div",{className:"text-right",children:"Semana Actual"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx(x,{label:"ROAS",current:a.roas,previous:s==null?void 0:s.roas,format:d,isGoodUp:!0}),c.jsx(x,{label:"Compras",current:a.purchases,previous:s==null?void 0:s.purchases,format:f,isGoodUp:!0}),c.jsx(x,{label:"CPA",current:a.cpa,previous:s==null?void 0:s.cpa,format:o,isGoodUp:!1}),c.jsx(x,{label:"CPM",current:a.cpm,previous:s==null?void 0:s.cpm,format:o,isGoodUp:!1}),c.jsx(x,{label:"Frecuencia",current:a.frequency,previous:s==null?void 0:s.frequency,format:d,isGoodUp:!1}),c.jsx(x,{label:"Tasa de Compra",current:a.tasaCompra,previous:s==null?void 0:s.tasaCompra,format:m=>`${d(m)}%`,isGoodUp:!0}),c.jsx(x,{label:"CTR (Link)",current:a.ctrLink,previous:s==null?void 0:s.ctrLink,format:m=>`${d(m)}%`,isGoodUp:!0})]})]})})},ty=({isOpen:e,onClose:n,adData:a,accountAverages:s})=>{const[i,o]=se.useState(!1);if(!e||!a)return null;const f=E=>E.toLocaleString("es-ES",{style:"currency",currency:a.currency}),d=E=>E.toLocaleString("es-ES",{maximumFractionDigits:0}),x=E=>E.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),m=E=>`${x(E)}%`,p=[{label:"Impresiones",value:a.impressions},{label:"Alcance",value:a.alcance},{label:"Visitas a Pgina",value:a.visitasLP},{label:"Atencin",value:a.atencion},{label:"Inters",value:a.interes},{label:"Deseo",value:a.deseo},{label:"Aadido al Carrito",value:a.addsToCart},{label:"Pago Iniciado",value:a.checkoutsInitiated},{label:"Compra",value:a.purchases}].filter(E=>E.value>0),v=E=>{var _;return((_=E.split(":").pop())==null?void 0:_.trim())||E},b=[...new Set(a.includedCustomAudiences.map(v))],y=[...new Set(a.excludedCustomAudiences.map(v))];return c.jsxs(c.Fragment,{children:[c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-6xl max-h-[90vh] flex flex-col relative",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4 flex-shrink-0 border-b border-brand-border pb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[a.imageUrl&&c.jsx("img",{src:a.imageUrl,alt:"Creative Thumbnail",className:"w-16 h-16 rounded-md object-cover bg-brand-bg flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Mtricas Detalladas"}),c.jsx("p",{className:"text-brand-text-secondary truncate max-w-md",title:a.adName,children:a.adName})]})]}),c.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-1",children:c.jsx(cs,{title:"Embudo de Conversin",children:c.jsx("div",{className:"space-y-1",children:p.map((E,_)=>c.jsx(Jb,{label:E.label,value:E.value,prevValue:_>0?p[_-1].value:null,isLast:_===p.length-1},E.label))})})}),c.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-6",children:[c.jsx(cs,{title:"Resultados Principales",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[c.jsx(na,{label:"ROAS",value:x(a.roas),average:s?x(s.roas):void 0,isHighlighted:!0}),c.jsx(na,{label:"Ventas",value:f(a.purchaseValue),isHighlighted:!0}),c.jsx(na,{label:"Tasa de Compra",value:m(a.tasaCompra),average:s?m(s.tasaCompra):void 0,isHighlighted:!0}),c.jsx(na,{label:"Compras",value:d(a.purchases)}),c.jsx(na,{label:"Ticket Promedio",value:f(a.ticketPromedio)}),c.jsx(na,{label:"Gasto",value:f(a.spend)})]})}),c.jsx(cs,{title:"Costes y Eficiencia",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[c.jsx(na,{label:"CPA",value:f(a.cpa),average:s?f(s.cpa):void 0}),c.jsx(na,{label:"CPM",value:f(a.cpm),average:s?f(s.cpm):void 0}),c.jsx(na,{label:"CPC (Todo)",value:f(a.cpc)}),c.jsx(na,{label:"Frecuencia",value:x(a.frequency),average:s?x(s.frequency):void 0})]})}),a.previousWeekMetrics&&c.jsx("div",{className:"mt-auto",children:c.jsx("button",{onClick:()=>o(!0),className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg transition-colors",children:"Ver Evolucin Semanal"})})]}),c.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-6",children:[c.jsx(cs,{title:"Interaccin",children:c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[c.jsx(na,{label:"Clics (Enlace)",value:d(a.linkClicks)}),c.jsx(na,{label:"CTR (Enlace)",value:m(a.ctrLink),average:s?m(s.ctrLink):void 0}),c.jsx(na,{label:"Reacciones",value:d(a.postReactions)}),c.jsx(na,{label:"Comentarios",value:d(a.postComments)}),c.jsx(na,{label:"Compartidos",value:d(a.postShares)}),c.jsx(na,{label:"Me Gusta Pgina",value:d(a.pageLikes)}),a.creativeType==="video"&&c.jsxs(c.Fragment,{children:[c.jsx(na,{label:"Tiempo Reprod.",value:`${x(a.videoAveragePlayTime)}s`}),c.jsx(na,{label:"ThruPlays",value:d(a.thruPlays)})]})]})}),c.jsx(Qb,{demographics:a.demographics,currency:a.currency}),c.jsxs(cs,{title:"Contexto y Audiencias",children:[c.jsx(na,{label:"Das Activos (Total)",value:d(a.activeDays)}),c.jsx(gm,{title:"Pblicos Incluidos",items:b,type:"included"}),c.jsx(gm,{title:"Pblicos Excluidos",items:y,type:"excluded"})]})]})]})]})}),a.previousWeekMetrics&&c.jsx(ey,{isOpen:i,onClose:()=>o(!1),currentMetrics:a,previousMetrics:a.previousWeekMetrics,currency:a.currency})]})},ay=e=>new Promise((n,a)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>n(s.result),s.onerror=i=>a(i)}),ry=(e,n)=>new Promise((a,s)=>{const i=e.type.startsWith("image/")?"image":"video",o=(d,x,m)=>{const p=d/x,v={file:e,url:n,type:i,width:d,height:x,format:p>=1?"square":"vertical",hash:m};a(v)},f=async d=>{const x=await d.arrayBuffer(),m=await crypto.subtle.digest("SHA-256",x);return Array.from(new Uint8Array(m)).map(p=>p.toString(16).padStart(2,"0")).join("")};if(i==="image"){const d=new Image;d.onload=async()=>{const x=await f(e);o(d.naturalWidth,d.naturalHeight,x)},d.onerror=x=>{URL.revokeObjectURL(n),s(x)},d.src=n}else{const d=document.createElement("video");d.onloadedmetadata=async()=>{const x=await f(e);o(d.videoWidth,d.videoHeight,x)},d.onerror=x=>{URL.revokeObjectURL(n),s(x)},d.src=n}}),vm=e=>{if(!e)return null;const n=e.split("/");if(n.length===3){const[s,i,o]=n.map(Number);if(!isNaN(s)&&!isNaN(i)&&!isNaN(o))return new Date(o,i-1,s)}const a=new Date(e);return isNaN(a.getTime())?null:a},ny=({clients:e,getPerformanceAnalysis:n,getFormatAnalysis:a,lookerData:s,setLookerData:i,performanceData:o,uploadedVideos:f,setUploadedVideos:d,startDate:x,endDate:m,onDateChange:p})=>{const[v,b]=se.useState("list"),[y,E]=se.useState("all"),[_,w]=se.useState("cards"),[S,D]=se.useState(null),[A,z]=se.useState({active:!1,current:0,total:0}),[V,Y]=se.useState(null),[j,Q]=se.useState({}),[B,ne]=se.useState(!1),[K,X]=se.useState(""),[ee,he]=se.useState(!1),[_e,Z]=se.useState(!1),[ue,Re]=se.useState(null),[te,H]=se.useState(!1),[oe,k]=se.useState(null),[q,U]=se.useState(!1),[R,W]=se.useState(null);se.useEffect(()=>{if(!S||!o[S.id]){Y(null);return}const ye=o[S.id];if(ye.length===0){Y(null);return}const je=ye.reduce((Ge,rt)=>(Ge.spend+=rt.spend,Ge.purchases+=rt.purchases,Ge.purchaseValue+=rt.purchaseValue,Ge.impressions+=rt.impressions,Ge.linkClicks+=rt.linkClicks,Ge.frequencyTotal+=rt.frequency*rt.impressions,Ge.landingPageViews+=rt.landingPageViews,Ge),{spend:0,purchases:0,purchaseValue:0,impressions:0,linkClicks:0,frequencyTotal:0,landingPageViews:0}),lt={roas:je.spend>0?je.purchaseValue/je.spend:0,cpa:je.purchases>0?je.spend/je.purchases:0,ctrLink:je.impressions>0?je.linkClicks/je.impressions*100:0,cpm:je.impressions>0?je.spend/je.impressions*1e3:0,frequency:je.impressions>0?je.frequencyTotal/je.impressions:0,tasaCompra:je.landingPageViews>0?je.purchases/je.landingPageViews*100:0};Y(lt)},[S,o]);const pe=se.useMemo(()=>{const ye=new Date(x);ye.setHours(0,0,0,0);const je=new Date(m);je.setHours(23,59,59,999);const lt={};for(const Ge in o)lt[Ge]=o[Ge].filter(rt=>{const Nt=vm(rt.day);return Nt?Nt>=ye&&Nt<=je:!1});return lt},[o,x,m]),ve=se.useMemo(()=>e.map(ye=>{const je=pe[ye.id]||[],lt=s[ye.id]||{};if(je.length===0)return{...ye,gastoTotal:0,roas:0,totalAds:0,matchedCount:0};const Ge=je.reduce((Ce,Je)=>Ce+(Je.spend||0),0),rt=je.reduce((Ce,Je)=>Ce+(Je.purchaseValue||0),0),Nt=Ge>0?rt/Ge:0,ct=new Set(je.map(Ce=>Ce.adName)),nt=Array.from(ct).filter(Ce=>{var Je;return!!((Je=lt[Ce])!=null&&Je.imageUrl)}).length;return{...ye,gastoTotal:Ge,roas:Nt,totalAds:ct.size,matchedCount:nt}}),[e,pe,s]),Se=se.useMemo(()=>{if(!S)return[];const ye=o[S.id]||[],lt=(pe[S.id]||[]).filter(ct=>{var nt;return((nt=ct.adDelivery)==null?void 0:nt.toLowerCase())==="active"&&ct.impressions>0}),Ge=s[S.id]||{};if(lt.length===0)return[];const rt=lt.reduce((ct,nt)=>(nt.adName&&(ct[nt.adName]||(ct[nt.adName]=[]),ct[nt.adName].push(nt)),ct),{}),Nt=Object.entries(rt).map(([ct,nt])=>{var hr;const Ce=nt.reduce((Ye,ot)=>(Ye.spend+=ot.spend,Ye.purchases+=ot.purchases,Ye.purchaseValue+=ot.purchaseValue,Ye.impressions+=ot.impressions,Ye.reach+=ot.reach,Ye.clicks+=ot.clicksAll,Ye.linkClicks+=ot.linkClicks,Ye.thruPlays+=ot.thruPlays,Ye.frequencyTotal+=ot.frequency*ot.impressions,Ye.landingPageViews+=ot.landingPageViews,Ye.addsToCart+=ot.addsToCart,Ye.checkoutsInitiated+=ot.checkoutsInitiated,Ye.postInteractions+=ot.postInteractions,Ye.postReactions+=ot.postReactions,Ye.postComments+=ot.postComments,Ye.postShares+=ot.postShares,Ye.pageLikes+=ot.pageLikes,Ye.atencion+=ot.attention,Ye.interes+=ot.interest,Ye.deseo+=ot.desire,ot.videoAveragePlayTime>0&&ot.impressions>0&&(Ye.videoAveragePlayTimeWeightedTotal+=ot.videoAveragePlayTime*ot.impressions,Ye.videoImpressions+=ot.impressions),Ye),{spend:0,purchases:0,purchaseValue:0,impressions:0,reach:0,clicks:0,linkClicks:0,thruPlays:0,videoAveragePlayTimeWeightedTotal:0,videoImpressions:0,frequencyTotal:0,landingPageViews:0,addsToCart:0,checkoutsInitiated:0,postInteractions:0,postReactions:0,postComments:0,postShares:0,pageLikes:0,atencion:0,interes:0,deseo:0}),Je=ye.filter(Ye=>Ye.adName===ct),De=new Set;Je.forEach(Ye=>{var ot,N,L;((ot=Ye.adDelivery)==null?void 0:ot.toLowerCase())==="active"&&((N=Ye.adSetDelivery)==null?void 0:N.toLowerCase())==="active"&&((L=Ye.campaignDelivery)==null?void 0:L.toLowerCase())==="active"&&De.add(Ye.day)});const ze=De.size,wt=[...new Set(Je.map(Ye=>Ye.adSetName))],Et=[...new Set(Je.map(Ye=>Ye.campaignName))],Pt=[...new Set(Je.flatMap(Ye=>{var ot;return((ot=Ye.includedCustomAudiences)==null?void 0:ot.split(",").map(N=>N.trim()))||[]}).filter(Boolean))],$a=[...new Set(Je.flatMap(Ye=>{var ot;return((ot=Ye.excludedCustomAudiences)==null?void 0:ot.split(",").map(N=>N.trim()))||[]}).filter(Boolean))],sn=Ce.spend>0?Ce.purchaseValue/Ce.spend:0,Ir=Ce.purchases>0?Ce.spend/Ce.purchases:0,_s=Ce.impressions>0?Ce.spend/Ce.impressions*1e3:0,Pn=Ce.impressions>0?Ce.clicks/Ce.impressions*100:0,Hn=Ce.impressions>0?Ce.linkClicks/Ce.impressions*100:0,zn=Ce.impressions>0?Ce.frequencyTotal/Ce.impressions:1,Sr=Ce.videoImpressions>0?Ce.videoAveragePlayTimeWeightedTotal/Ce.videoImpressions:0,ln=Ce.purchases>0?Ce.purchaseValue/Ce.purchases:0,ws=Ce.clicks>0?Ce.spend/Ce.clicks:0,Ts=Ce.linkClicks>0?Ce.landingPageViews/Ce.linkClicks*100:0,Vn=Ce.landingPageViews>0?Ce.purchases/Ce.landingPageViews*100:0,Ht=Ge[ct],Ss=new Set(nt.map(Ye=>Ye.adSetName)).size>1,As=(hr=nt.find(Ye=>Ye.videoFileName))==null?void 0:hr.videoFileName,Xt=!!As||nt.some(Ye=>Ye.thruPlays>0)&&Sr>1?"video":Ht!=null&&Ht.imageUrl?"image":void 0,$t=Xt==="video"?f.some(Ye=>Ye.clientId===S.id&&Ye.adName===ct):!1;return{adName:ct,adSetNames:wt,campaignNames:Et,includedCustomAudiences:Pt,excludedCustomAudiences:$a,spend:Ce.spend,purchases:Ce.purchases,purchaseValue:Ce.purchaseValue,impressions:Ce.impressions,clicks:Ce.clicks,linkClicks:Ce.linkClicks,roas:sn,cpa:Ir,cpm:_s,ctr:Pn,ctrLink:Hn,frequency:zn,videoAveragePlayTime:Sr,thruPlays:Ce.thruPlays,isMatched:!!Ht,creativeDescription:Ht==null?void 0:Ht.creativeDescription,currency:S.currency,inMultipleAdSets:Ss,imageUrl:Ht==null?void 0:Ht.imageUrl,adPreviewLink:Ht==null?void 0:Ht.adPreviewLink,creativeType:Xt,analysisResult:Ht==null?void 0:Ht.analysisResult,videoFileName:As,isVideoUploaded:$t,ticketPromedio:ln,alcance:Ce.reach,cpc:ws,visitasLP:Ce.landingPageViews,tasaVisitaLP:Ts,tasaCompra:Vn,addsToCart:Ce.addsToCart,checkoutsInitiated:Ce.checkoutsInitiated,postInteractions:Ce.postInteractions,postReactions:Ce.postReactions,postComments:Ce.postComments,postShares:Ce.postShares,pageLikes:Ce.pageLikes,activeDays:ze,atencion:Ce.atencion,interes:Ce.interes,deseo:Ce.deseo,demographics:[]}}).sort((ct,nt)=>nt.roas-ct.roas);return y==="all"?Nt:Nt.filter(ct=>ct.creativeType===y)},[S,pe,o,s,y,f]),we=se.useMemo(()=>Se.some(ye=>ye.isMatched&&ye.creativeDescription),[Se]),Be=se.useMemo(()=>Se.filter(ye=>ye.isMatched&&ye.imageUrl&&!ye.creativeDescription&&(ye.creativeType==="image"||ye.creativeType==="video"&&ye.isVideoUploaded)).length,[Se]),I=ye=>{D(ye),w("cards"),E("all"),b("detail")},Pe=async()=>{if(!S)return;const ye=Se.filter(lt=>lt.isMatched&&lt.creativeDescription);if(ye.length===0){alert("No hay anuncios con anlisis de IA en el perodo y filtro seleccionado. Genere o actualice anlisis para algunos anuncios primero.");return}he(!0),ne(!0),X("");const je=await n(ye,S);X(je),he(!1)},Ue=async ye=>{var je,lt;if(!(!S||!ye.imageUrl)){Q(Ge=>({...Ge,[ye.adName]:!0}));try{const Ge=ye.creativeType==="video";let rt;if(Ge){const De=f.find(Et=>Et.clientId===S.id&&Et.adName===ye.adName);if(!De)throw new Error("No se encontr el archivo de video subido.");const wt=await(await fetch(De.dataUrl)).blob();rt=new File([wt],De.videoFileName,{type:wt.type})}else{const ze=await(await fetch(ye.imageUrl)).blob();rt=new File([ze],ye.adName,{type:ze.type})}const Nt=URL.createObjectURL(rt),ct=Ge?{square:null,vertical:null,videoFile:rt}:await ry(rt,Nt).then(De=>(URL.revokeObjectURL(Nt),{square:De.format==="square"?De:null,vertical:De.format==="vertical"?De:null})),nt=Ge?"VERTICAL":ct.square?"SQUARE_LIKE":"VERTICAL",Ce=`Anlisis del creativo para el anuncio llamado "${ye.adName}" del cliente "${S.name}".`,Je=await a(ct,nt,"es",Ce,Ge);if(Je&&!Je.overallConclusion.headline.toLowerCase().includes("error"))i(De=>{const ze=JSON.parse(JSON.stringify(De));return ze[S.id]||(ze[S.id]={}),ze[S.id][ye.adName]={...ze[S.id][ye.adName],imageUrl:ye.imageUrl,creativeDescription:Je.creativeDescription,analysisResult:Je},ze});else throw new Error(((lt=(je=Je==null?void 0:Je.overallConclusion)==null?void 0:je.checklist[0])==null?void 0:lt.text)||"Unknown analysis error")}catch(Ge){const rt=Ge instanceof Error?Ge.message:"Error desconocido";alert(`Error al analizar creativo para "${ye.adName}": ${rt}`)}finally{Q(Ge=>({...Ge,[ye.adName]:!1}))}}},We=async()=>{const ye=Se.filter(je=>je.isMatched&&je.imageUrl&&!je.creativeDescription&&(je.creativeType==="image"||je.creativeType==="video"&&je.isVideoUploaded));if(ye.length!==0){z({active:!0,current:0,total:ye.length});for(let je=0;je<ye.length;je++){const lt=ye[je];z(Ge=>({...Ge,current:je+1}));try{await Ue(lt)}catch(Ge){et.error(`Bulk analysis failed for ${lt.adName}, continuing...`,Ge)}}z({active:!1,current:0,total:0}),alert("Anlisis en masa completado.")}},Ve=ye=>{Re(ye),Z(!0)},ge=ye=>{if(!S)return;const lt=(o[S.id]||[]).filter(De=>De.adName===ye.adName),Ge=lt.reduce((De,ze)=>{const wt=ze.age||"Unknown",Et=ze.gender||"Unknown",Pt=`${Et}-${wt}`;return De[Pt]||(De[Pt]={ageRange:wt,gender:Et,spend:0,purchases:0,purchaseValue:0,linkClicks:0,impressions:0}),De[Pt].spend+=ze.spend,De[Pt].purchases+=ze.purchases,De[Pt].purchaseValue+=ze.purchaseValue,De[Pt].linkClicks+=ze.linkClicks,De[Pt].impressions+=ze.impressions,De},{}),rt=new Date(x),Nt=new Date(rt.getTime()-1440*60*1e3),ct=new Date(Nt.getTime()-8640*60*1e3),nt=lt.filter(De=>{const ze=vm(De.day);return ze&&ze>=ct&&ze<=Nt});let Ce;if(nt.length>0){const De=nt.reduce((ze,wt)=>(ze.spend+=wt.spend,ze.purchases+=wt.purchases,ze.purchaseValue+=wt.purchaseValue,ze.impressions+=wt.impressions,ze.linkClicks+=wt.linkClicks,ze.landingPageViews+=wt.landingPageViews,ze.frequencyTotal+=wt.frequency*wt.impressions,ze),{spend:0,purchases:0,purchaseValue:0,impressions:0,linkClicks:0,landingPageViews:0,frequencyTotal:0});Ce={spend:De.spend,roas:De.spend>0?De.purchaseValue/De.spend:0,cpa:De.purchases>0?De.spend/De.purchases:0,ctrLink:De.impressions>0?De.linkClicks/De.impressions*100:0,tasaCompra:De.landingPageViews>0?De.purchases/De.landingPageViews*100:0,purchases:De.purchases,cpm:De.impressions>0?De.spend/De.impressions*1e3:0,frequency:De.impressions>0?De.frequencyTotal/De.impressions:0}}const Je={...ye,demographics:Object.values(Ge),previousWeekMetrics:Ce};k(Je),H(!0)},Ie=ye=>{W(ye),U(!0)},pt=async(ye,je)=>{if(S)try{const lt=await ay(je),Ge={id:`${S.id}_${ye}`,clientId:S.id,adName:ye,videoFileName:je.name,dataUrl:lt},rt=[...f.filter(Nt=>Nt.id!==Ge.id),Ge];d(rt)}catch{alert("Ocurri un error al guardar el video.")}finally{U(!1),W(null)}};return v==="list"?c.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Rendimiento por Cliente"}),c.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Selecciona un cliente para ver el detalle de sus anuncios."})]}),c.jsx(uo,{onDateChange:p,startDate:x,endDate:m})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ve.map(ye=>c.jsxs("button",{onClick:()=>I(ye),className:"bg-brand-surface p-4 rounded-lg shadow-md hover:shadow-xl hover:shadow-brand-primary/20 transition-all text-left flex flex-col items-start",children:[c.jsxs("div",{className:"flex items-center gap-3 w-full mb-4",children:[c.jsx("img",{src:ye.logo,alt:ye.name,className:"h-10 w-10 rounded-full bg-brand-border"}),c.jsx("h3",{className:"font-bold text-brand-text flex-1 truncate",children:ye.name})]}),c.jsxs("div",{className:"w-full grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[c.jsx("div",{className:"text-brand-text-secondary",children:"Gasto Total:"}),c.jsx("div",{className:"font-semibold text-brand-text text-right",children:ye.gastoTotal.toLocaleString("es-ES",{style:"currency",currency:ye.currency})}),c.jsx("div",{className:"text-brand-text-secondary",children:"ROAS:"}),c.jsx("div",{className:"font-semibold text-brand-text text-right",children:ye.roas.toFixed(2)}),c.jsx("div",{className:"text-brand-text-secondary",children:"Anuncios:"}),c.jsx("div",{className:"font-semibold text-brand-text text-right",children:ye.totalAds}),c.jsx("div",{className:"text-brand-text-secondary",children:"Creativos Vinculados:"}),c.jsxs("div",{className:"font-semibold text-brand-text text-right",children:[ye.matchedCount," / ",ye.totalAds]})]})]},ye.id))})]}):v==="detail"&&S?c.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in",children:[c.jsxs("header",{children:[c.jsxs("button",{onClick:()=>b("list"),className:"mb-4 flex items-center gap-2 text-sm text-brand-text-secondary hover:text-brand-text",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Volver a la lista de clientes"]}),c.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("img",{src:S.logo,alt:S.name,className:"h-12 w-12 rounded-full bg-brand-border"}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-brand-text",children:["Rendimiento de ",S.name]}),c.jsxs("p",{className:"text-brand-text-secondary",children:["Datos del ",new Date(x).toLocaleDateString("es-ES")," al ",new Date(m).toLocaleDateString("es-ES")]})]})]}),c.jsx(uo,{onDateChange:p,startDate:x,endDate:m})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 p-4 bg-brand-surface rounded-lg shadow-md",children:[c.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-semibold text-brand-text-secondary",children:"Filtro:"}),c.jsxs("div",{className:"flex rounded-lg bg-brand-border p-1",children:[c.jsx("button",{onClick:()=>E("all"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${y==="all"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Todos"}),c.jsx("button",{onClick:()=>E("image"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${y==="image"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Imgenes"}),c.jsx("button",{onClick:()=>E("video"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${y==="video"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Videos"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-semibold text-brand-text-secondary",children:"Vista:"}),c.jsxs("div",{className:"flex rounded-lg bg-brand-border p-1",children:[c.jsx("button",{onClick:()=>w("table"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${_==="table"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Tabla"}),c.jsx("button",{onClick:()=>w("cards"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${_==="cards"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Tarjetas"})]})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 self-end md:self-center",children:[c.jsx("button",{onClick:We,disabled:Be===0||A.active,title:Be===0?"No hay creativos sin analizar":"Generar anlisis para todos los creativos faltantes",className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",children:A.active?`Analizando ${A.current}/${A.total}...`:`Generar ${Be} Faltantes`}),c.jsxs("button",{onClick:Pe,disabled:!we||ee,title:we?"Generar conclusin estratgica de IA":"Se requiere al menos un anuncio con anlisis de IA para generar la conclusin.",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),c.jsx("span",{children:ee?"Analizando...":"Conclusin de IA"})]})]})]}),c.jsx("div",{children:_==="table"?c.jsx(Pb,{data:Se,onShowMetricsDetail:ge,onShowAnalysisDetail:Ve,onUpdateAnalysis:Ue,generatingAnalysis:j,onUploadVideo:Ie}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Se.length>0?Se.map(ye=>c.jsx(Ub,{ad:ye,onShowMetricsDetail:()=>ge(ye),onShowAnalysisDetail:()=>Ve(ye),onUpdateAnalysis:()=>Ue(ye),generatingAnalysis:j[ye.adName],onUploadVideo:()=>Ie(ye)},ye.adName)):c.jsx("p",{className:"text-brand-text-secondary text-center py-8 col-span-full",children:"No hay datos de rendimiento para la seleccin actual."})})}),c.jsx(Vb,{isOpen:B,onClose:()=>ne(!1),isLoading:ee,analysisText:K}),c.jsx($b,{isOpen:_e,onClose:()=>Z(!1),adData:ue}),c.jsx(ty,{isOpen:te,onClose:()=>H(!1),adData:oe,accountAverages:V}),R&&c.jsx(Zb,{isOpen:q,onClose:()=>U(!1),adData:R,onSave:pt})]}):null},sy=({onLogin:e})=>{const[n,a]=se.useState(""),[s,i]=se.useState(""),[o,f]=se.useState(""),[d,x]=se.useState(!1),m=async p=>{p.preventDefault(),f(""),x(!0),console.log("=== LOGIN DEBUG ==="),console.log("Attempting login with:",{username:n,password:s}),await new Promise(v=>setTimeout(v,800)),e(n,s)?console.log("Login successful"):(console.log("Login failed"),f("Usuario o contrasea incorrectos.")),x(!1)};return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-bg via-slate-900 to-brand-bg flex items-center justify-center relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-10",children:c.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.4) 0%, transparent 50%),
                                     radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.4) 0%, transparent 50%)`}})}),c.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-brand-primary/20 rounded-full blur-3xl animate-pulse"}),c.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-brand-accent/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),c.jsx("div",{className:"absolute top-1/2 left-10 w-24 h-24 bg-brand-primary/10 rounded-full blur-2xl animate-pulse",style:{animationDelay:"2s"}}),c.jsx("div",{className:"relative z-10 w-full max-w-md mx-auto p-6",children:c.jsxs("div",{className:"bg-gradient-to-br from-brand-surface/80 to-brand-surface/60 backdrop-blur-xl border border-brand-border/50 rounded-2xl p-8 shadow-2xl animate-scale-in",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-brand-primary to-brand-accent rounded-2xl flex items-center justify-center mx-auto mb-4 animate-glow",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),c.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-brand-primary to-brand-accent bg-clip-text text-transparent",children:"Creative Assistant"}),c.jsx("p",{className:"text-brand-text-secondary mt-2",children:"AI-Powered Marketing Intelligence"}),c.jsx("div",{className:"mt-4 h-px bg-gradient-to-r from-transparent via-brand-border to-transparent"})]}),c.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"group",children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-brand-text-secondary mb-2 group-focus-within:text-brand-primary transition-colors",children:"Usuario"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx("svg",{className:"h-5 w-5 text-brand-text-secondary group-focus-within:text-brand-primary transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),c.jsx("input",{id:"username",type:"text",value:n,onChange:p=>a(p.target.value),className:"w-full bg-brand-bg/50 border border-brand-border text-brand-text rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-primary/50 focus:border-brand-primary transition-all duration-200 placeholder-brand-text-secondary/50",placeholder:"Ingresa tu usuario",required:!0,disabled:d})]})]}),c.jsxs("div",{className:"group",children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-text-secondary mb-2 group-focus-within:text-brand-primary transition-colors",children:"Contrasea"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx("svg",{className:"h-5 w-5 text-brand-text-secondary group-focus-within:text-brand-primary transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),c.jsx("input",{id:"password",type:"password",value:s,onChange:p=>i(p.target.value),className:"w-full bg-brand-bg/50 border border-brand-border text-brand-text rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-primary/50 focus:border-brand-primary transition-all duration-200 placeholder-brand-text-secondary/50",placeholder:"Ingresa tu contrasea",required:!0,disabled:d})]})]})]}),o&&c.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 animate-slide-up",children:c.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[c.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("span",{className:"text-sm font-medium",children:o})]})}),c.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-brand-primary to-brand-accent hover:from-brand-primary-hover hover:to-brand-accent text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:shadow-glow transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98] group",children:d?c.jsxs("div",{className:"flex items-center justify-center gap-3",children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),c.jsx("span",{children:"Iniciando sesin..."})]}):c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{children:"Iniciar Sesin"}),c.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]}),c.jsxs("div",{className:"mt-6 p-4 bg-brand-bg/30 rounded-xl border border-brand-border/30",children:[c.jsx("p",{className:"text-xs text-brand-text-secondary text-center mb-2",children:"Credenciales de demo:"}),c.jsx("div",{className:"text-xs text-brand-text-secondary space-y-1",children:c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Admin:"}),c.jsx("span",{className:"text-brand-primary",children:"Admin / Admin"})]})}),c.jsx("button",{type:"button",onClick:()=>{console.log("=== DEBUG INFO ==="),console.log("localStorage users:",localStorage.getItem("db_users")),console.log("localStorage logged_in_user:",localStorage.getItem("db_logged_in_user")),console.log("All localStorage keys:",Object.keys(localStorage))},className:"w-full mt-3 py-2 px-3 bg-gray-600 hover:bg-gray-500 text-white text-xs rounded-lg transition-colors",children:"Debug: Ver localStorage"})]})]})})]})},iy=({isOpen:e,onClose:n,onSave:a,initialData:s})=>{const[i,o]=se.useState(""),[f,d]=se.useState(""),[x,m]=se.useState("user");se.useEffect(()=>{e&&(s?(o(s.username),d(""),m(s.role)):(o(""),d(""),m("user")))},[e,s]);const p=v=>{if(v.preventDefault(),!i.trim()||!s&&!f.trim()){alert("El nombre de usuario y la contrasea son obligatorios para nuevos usuarios.");return}const b={id:(s==null?void 0:s.id)||crypto.randomUUID(),username:i.trim(),password:f.trim()||s.password,role:x};a(b),n()};return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:s?"Editar Usuario":"Aadir Nuevo Usuario"}),c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre de Usuario"}),c.jsx("input",{id:"username",type:"text",value:i,onChange:v=>o(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:["Contrasea ",s&&"(dejar en blanco para no cambiar)"]}),c.jsx("input",{id:"password",type:"password",value:f,onChange:v=>d(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!s})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Rol"}),c.jsxs("select",{id:"role",value:x,onChange:v=>m(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",children:[c.jsx("option",{value:"user",children:"Usuario"}),c.jsx("option",{value:"admin",children:"Administrador"})]})]}),c.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),c.jsx("button",{type:"submit",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:"Guardar"})]})]}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},ly=({users:e,setUsers:n,currentUser:a})=>{const[s,i]=se.useState(!1),[o,f]=se.useState(null),d=()=>{f(null),i(!0)},x=v=>{f(v),i(!0)},m=v=>{const y=e.some(E=>E.id===v.id)?e.map(E=>E.id===v.id?v:E):[...e,v];n(y),i(!1)},p=v=>{if(v===a.id){alert("No puedes eliminar tu propia cuenta de administrador.");return}if(window.confirm("Seguro que quieres eliminar este usuario? Esta accin es irreversible.")){const b=e.filter(y=>y.id!==v);n(b)}};return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text",children:["Gestin de Usuarios (",e.length,")"]}),c.jsxs("button",{onClick:d,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Aadir Usuario"]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[c.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-border/50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3",children:"Usuario"}),c.jsx("th",{scope:"col",className:"px-6 py-3",children:"Rol"}),c.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID de Usuario"}),c.jsx("th",{scope:"col",className:"px-6 py-3",children:c.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),c.jsx("tbody",{children:e.map(v=>c.jsxs("tr",{className:"bg-brand-surface border-b border-brand-border hover:bg-brand-border/30",children:[c.jsx("td",{className:"px-6 py-4 font-medium text-brand-text whitespace-nowrap",children:v.username}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v.role==="admin"?"bg-blue-500/20 text-blue-300":"bg-gray-500/20 text-gray-300"}`,children:v.role})}),c.jsx("td",{className:"px-6 py-4 font-mono text-xs",children:v.id}),c.jsxs("td",{className:"px-6 py-4 text-right flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>x(v),className:"p-2 rounded-full text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-colors",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),c.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]})}),c.jsx("button",{onClick:()=>p(v.id),disabled:v.id===a.id,className:"p-2 rounded-full text-brand-text-secondary hover:bg-red-500 hover:text-white transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},v.id))})]})})]}),c.jsx(iy,{isOpen:s,onClose:()=>i(!1),onSave:m,initialData:o})]})},cy=({isOpen:e,onClose:n,newAccountNames:a,onConfirm:s})=>e?c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:"Nuevas Cuentas Detectadas"}),c.jsx("p",{className:"text-brand-text-secondary mb-6",children:"Se encontraron las siguientes cuentas en el reporte que no estn vinculadas a ningn cliente existente. Deseas crearlos ahora?"}),c.jsx("div",{className:"bg-brand-bg rounded-md p-4 max-h-60 overflow-y-auto mb-6",children:c.jsx("ul",{className:"space-y-2",children:a.map(i=>c.jsxs("li",{className:"text-brand-text flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-brand-primary",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),i]},i))})}),c.jsxs("div",{className:"flex justify-end gap-4",children:[c.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),c.jsxs("button",{type:"button",onClick:()=>s(a),className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:["Crear ",a.length," Clientes y Continuar"]})]})]})}):null,oy=e=>{if(!e||e.trim()==="-")return e;const n=e.trim(),a=n.match(/^(||\$)?\s*([0-9.,]+)\s*(x|%|s)?\s*(\(([-+]?[0-9.,]+)%\s*(|||||)\))?$/i);if(a){const[,i,o,f,,d,x]=a,m=parseFloat(o.replace(/\./g,"").replace(",","."));if(isNaN(m))return n;const p={value:m};return i&&(p.symbol=i),f?p.symbol=(p.symbol||"")+f:o.includes(","),d&&(p.change=parseFloat(d.replace(",","."))/100,x===""||x===""||x===""||x===""?p.direction="up":x===""||x===""?p.direction="down":p.direction="neutral"),p}const s=n.match(/^([0-9.,]+)%\s*(|)$/);if(s){const[,i,o]=s,f=parseFloat(i.replace(",","."));return isNaN(f)?n:{value:f,symbol:"% "+o,direction:"up"}}return n},bm=(e,n)=>{if(e.length<2)return{title:n,headers:[],rows:[]};const a=e[0].split("|").map(i=>i.trim()).filter(Boolean),s=[];for(let i=2;i<e.length;i++){const o=e[i].split("|").map(d=>d.trim()).filter(Boolean);if(o.length===0||a.length===0)continue;const f={};a.forEach((d,x)=>{f[d]=oy(o[x]||"")}),s.push(f)}return{title:n,headers:a,rows:s}},uy=e=>{const n=e.split(`
`),a={},s=[];let i="",o=[],f=!1;n.forEach(m=>{var y,E,_,w;m.startsWith("Reporte Bitcora")&&(a.reportType=((y=m.split("(")[1])==null?void 0:y.split(")")[0])||"Unknown"),m.startsWith("Moneda Detectada:")&&(a.currency=(E=m.split(":")[1])==null?void 0:E.trim()),m.startsWith("Campaa Filtrada:")&&(a.campaignFilter=(_=m.split(":")[1])==null?void 0:_.trim()),m.startsWith("AdSets Filtrados:")&&(a.adSetFilter=(w=m.split(":")[1])==null?void 0:w.trim());const p=m.match(/^\s*\*{2}\s*(.*?)\s*\*{2}\s*$/)||m.match(/^-{3,}\s*(.*?)\s*-{3,}$/)||m.match(/^={3,}\s*(.*?)\s*={3,}$/)||m.match(/^\s*TABLA:\s*(.*?)\s*$/);p&&p[1]&&(i=p[1].trim());const v=m.trim().match(/^\|-.*-\|$/);m.trim().startsWith("|")&&!v&&!f?(f=!0,o.push(m.trim())):f&&(m.trim().startsWith("|")?o.push(m.trim()):(o.length>1&&s.push(bm(o,i||`Tabla Sin Ttulo ${s.length+1}`)),o=[],i="",f=!1))}),f&&o.length>1&&s.push(bm(o,i||`Tabla Sin Ttulo ${s.length+1}`));const d=m=>s.find(p=>p.title.toLowerCase().includes(m.toLowerCase())),x=m=>s.filter(p=>p.title.toLowerCase().includes(m.toLowerCase()));return{metadata:a,mainSummaryTable:d("cuenta completa"),funnelAnalysisTable:d("anlisis de embudo"),topAdsTables:x("top 20 ads"),topAdSetsTables:x("top 20 adsets"),topCampaignsTables:x("top 10 campaas"),audiencePerformanceTable:d("performance_publico"),ratioTrendsTable:d("tendencia_ratios")}},$u=({isOpen:e,onClose:n,clients:a,onClientSelect:s,title:i="Asignar a Cliente",description:o="Selecciona el cliente para esta operacin."})=>{const[f,d]=se.useState("");if(se.useEffect(()=>{e&&a.length>0&&d(a[0].id)},[e,a]),!e)return null;const x=()=>{f&&s(f)};return c.jsx(rn,{isOpen:e,onClose:n,children:c.jsxs("div",{className:"relative bg-brand-surface rounded-lg shadow-xl p-8 w-full max-w-md",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:i}),c.jsx("p",{className:"text-brand-text-secondary mb-6",children:o}),a.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsx("select",{value:f,onChange:m=>d(m.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",children:a.map(m=>c.jsx("option",{value:m.id,children:m.name},m.id))}),c.jsx("button",{onClick:x,disabled:!f,className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirmar"})]}):c.jsx("p",{className:"text-yellow-400 bg-yellow-500/10 p-4 rounded-md text-center",children:"No tienes clientes asignados. Por favor, crea uno en la pestaa de 'Clientes'."}),c.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors","aria-label":"Cerrar modal",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},fy=({history:e,setHistory:n,setLookerData:a})=>{const s=async i=>{if(!window.confirm("Seguro que quieres deshacer esta importacin? Los datos aadidos sern eliminados."))return;const o=e.find(f=>f.id===i);if(o){et.warn(`Undoing import batch: ${i}`,o);try{const{type:f,keys:d,clientId:x}=o.undoData;if(f==="meta"){const p=await Xe.getPerformanceData();if(p[x]){const v=new Set(d);p[x]=p[x].filter(b=>!v.has(b.uniqueId)),await Xe.savePerformanceData(p)}}else if(f==="looker"){const p=await Xe.getLookerData();p[x]&&(d.forEach(v=>{delete p[x][v]}),await Xe.saveLookerData(p),a(p))}else if(f==="txt"){let p=await Xe.getBitacoraReports();const v=new Set(d);p=p.filter(b=>!v.has(b.id)),await Xe.saveBitacoraReports(p)}const m=e.filter(p=>p.id!==i);n(m),await Xe.saveImportHistory(m),et.success(`Successfully undone import batch: ${i}`),alert("Importacin deshecha con xito.")}catch(f){et.error(`Failed to undo import batch: ${i}`,f),alert("Ocurri un error al deshacer la importacin.")}}};return e.length===0?null:c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg mt-8",children:[c.jsx("h3",{className:"text-xl font-bold text-brand-text mb-4",children:"Historial de Importaciones Recientes"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[c.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-border/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2",children:"Fecha"}),c.jsx("th",{className:"px-4 py-2",children:"Tipo"}),c.jsx("th",{className:"px-4 py-2",children:"Archivo"}),c.jsx("th",{className:"px-4 py-2",children:"Cliente"}),c.jsx("th",{className:"px-4 py-2",children:"Descripcin"}),c.jsx("th",{className:"px-4 py-2",children:"Accin"})]})}),c.jsx("tbody",{children:e.map(i=>c.jsxs("tr",{className:"bg-brand-bg border-b border-brand-border/50 hover:bg-brand-border/20",children:[c.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(i.timestamp).toLocaleString("es-ES")}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("span",{className:"font-semibold uppercase",children:i.source})}),c.jsx("td",{className:"px-4 py-2 truncate max-w-xs",title:i.fileName,children:i.fileName}),c.jsx("td",{className:"px-4 py-2",children:i.clientName}),c.jsx("td",{className:"px-4 py-2",children:i.description}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("button",{onClick:()=>s(i.id),className:"bg-red-600/20 text-red-400 hover:bg-red-600/40 text-xs font-bold py-1 px-2 rounded-md transition-colors",children:"Deshacer"})})]},i.id))})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dp=1252,dy=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],df={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},hf=function(e){dy.indexOf(e)!=-1&&(Dp=df[0]=e)};function hy(){hf(1252)}var _r=function(e){hf(e)};function Op(){_r(1200),hy()}function ym(e){for(var n=[],a=0,s=e.length;a<s;++a)n[a]=e.charCodeAt(a);return n}function xy(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function Rp(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var ml=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?xy(e.slice(2)):n==254&&a==255?Rp(e.slice(2)):n==65279?e.slice(1):e},Jc=function(n){return String.fromCharCode(n)},Em=function(n){return String.fromCharCode(n)},kl,Mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _m(e){for(var n="",a=0,s=0,i=0,o=0,f=0,d=0,x=0,m=0;m<e.length;)a=e.charCodeAt(m++),o=a>>2,s=e.charCodeAt(m++),f=(a&3)<<4|s>>4,i=e.charCodeAt(m++),d=(s&15)<<2|i>>6,x=i&63,isNaN(s)?d=x=64:isNaN(i)&&(x=64),n+=Mn.charAt(o)+Mn.charAt(f)+Mn.charAt(d)+Mn.charAt(x);return n}function Wa(e){var n="",a=0,s=0,i=0,o=0,f=0,d=0,x=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)o=Mn.indexOf(e.charAt(m++)),f=Mn.indexOf(e.charAt(m++)),a=o<<2|f>>4,n+=String.fromCharCode(a),d=Mn.indexOf(e.charAt(m++)),s=(f&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(s)),x=Mn.indexOf(e.charAt(m++)),i=(d&3)<<6|x,x!==64&&(n+=String.fromCharCode(i));return n}var mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ps=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function In(e){return mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wm(e){return mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Er=function(n){return mt?ps(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function gs(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function xf(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return xf(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var jn=mt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ps(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var s=new Uint8Array(a),i=0;for(n=0,a=0;n<e.length;a+=i,++n)if(i=e[n].length,e[n]instanceof Uint8Array)s.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";s.set(new Uint8Array(e[n]),a)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function my(e){for(var n=[],a=0,s=e.length+250,i=In(e.length+255),o=0;o<e.length;++o){var f=e.charCodeAt(o);if(f<128)i[a++]=f;else if(f<2048)i[a++]=192|f>>6&31,i[a++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var d=e.charCodeAt(++o)&1023;i[a++]=240|f>>8&7,i[a++]=128|f>>2&63,i[a++]=128|d>>6&15|(f&3)<<4,i[a++]=128|d&63}else i[a++]=224|f>>12&15,i[a++]=128|f>>6&63,i[a++]=128|f&63;a>s&&(n.push(i.slice(0,a)),a=0,i=In(65535),s=65530)}return n.push(i.slice(0,a)),jn(n)}var Ra=/\u0000/g,pl=/[\u0001-\u0006]/g;function fi(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function wr(e,n){var a=""+e;return a.length>=n?a:Gt("0",n-a.length)+a}function mf(e,n){var a=""+e;return a.length>=n?a:Gt(" ",n-a.length)+a}function fo(e,n){var a=""+e;return a.length>=n?a:a+Gt(" ",n-a.length)}function py(e,n){var a=""+Math.round(e);return a.length>=n?a:Gt("0",n-a.length)+a}function gy(e,n){var a=""+e;return a.length>=n?a:Gt("0",n-a.length)+a}var Tm=Math.pow(2,32);function ii(e,n){if(e>Tm||e<-Tm)return py(e,n);var a=Math.round(e);return gy(a,n)}function ho(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Sm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vy(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Am={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},by={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xo(e,n,a){for(var s=e<0?-1:1,i=e*s,o=0,f=1,d=0,x=1,m=0,p=0,v=Math.floor(i);m<n&&(v=Math.floor(i),d=v*f+o,p=v*m+x,!(i-v<5e-8));)i=1/(i-v),o=f,f=d,x=m,m=p;if(p>n&&(m>n?(p=x,d=o):(p=m,d=f)),!a)return[0,s*d,p];var b=Math.floor(s*d/p);return[b,s*d-b*p,p]}function us(e,n,a){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),o=0,f=[],d={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(s+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++s,++d.D)),s===60)f=a?[1317,10,29]:[1900,2,29],o=3;else if(s===0)f=a?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var x=new Date(1900,0,1);x.setDate(x.getDate()+s-1),f=[x.getFullYear(),x.getMonth()+1,x.getDate()],o=x.getDay(),s<60&&(o=(o+6)%7),a&&(o=Sy(x,f))}return d.y=f[0],d.m=f[1],d.d=f[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=o,d}var jp=new Date(1899,11,31,0,0,0),yy=jp.getTime(),Ey=new Date(1900,2,1,0,0,0);function Mp(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=Ey&&(a+=1440*60*1e3),(a-(yy+(e.getTimezoneOffset()-jp.getTimezoneOffset())*6e4))/(1440*60*1e3)}function pf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _y(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wy(e){var n=e<0?12:11,a=pf(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function Ty(e){var n=pf(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Dl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=wy(e):n===10?a=e.toFixed(10).substr(0,12):a=Ty(e),pf(_y(a.toUpperCase()))}function hs(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Dl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ur(14,Mp(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function Sy(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function Ay(e,n,a,s){var i="",o=0,f=0,d=a.y,x,m=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:x=d%100,m=2;break;default:x=d%1e4,m=4;break}break;case 109:switch(n.length){case 1:case 2:x=a.m,m=n.length;break;case 3:return Bu[a.m-1][1];case 5:return Bu[a.m-1][0];default:return Bu[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:x=a.d,m=n.length;break;case 3:return Sm[a.q][0];default:return Sm[a.q][1]}break;case 104:switch(n.length){case 1:case 2:x=1+(a.H+11)%12,m=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:x=a.H,m=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:x=a.M,m=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?wr(a.S,n.length):(s>=2?f=s===3?1e3:100:f=s===1?10:1,o=Math.round(f*(a.S+a.u)),o>=60*f&&(o=0),n==="s"?o===0?"0":""+o/f:(i=wr(o,2+s),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":x=a.D*24+a.H;break;case"[m]":case"[mm]":x=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":x=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}m=n.length===3?1:2;break;case 101:x=d,m=1;break}var p=m>0?wr(x,m):"";return p}function Ln(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,s=e.substr(0,a);a!=e.length;a+=n)s+=(s.length>0?",":"")+e.substr(a,n);return s}var Lp=/%/g;function Ny(e,n,a){var s=n.replace(Lp,""),i=n.length-s.length;return en(e,s,a*Math.pow(10,2*i))+Gt("%",i)}function Cy(e,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return en(e,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function Fp(e,n){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Fp(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),a=(n/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),a.indexOf("e")===-1){var f=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(f-a.length+o):a+="E+"+(f-o);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,x,m,p){return x+m+p.substr(0,(i+o)%i)+"."+p.substr(o)+"E"})}else a=n.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Ip=/# (\?+)( ?)\/( ?)(\d+)/;function ky(e,n,a){var s=parseInt(e[4],10),i=Math.round(n*s),o=Math.floor(i/s),f=i-o*s,d=s;return a+(o===0?"":""+o)+" "+(f===0?Gt(" ",e[1].length+1+e[4].length):mf(f,e[1].length)+e[2]+"/"+e[3]+wr(d,e[4].length))}function Dy(e,n,a){return a+(n===0?"":""+n)+Gt(" ",e[1].length+2+e[4].length)}var Bp=/^#*0*\.([0#]+)/,Up=/\).*[0#]/,Pp=/\(###\) ###\\?-####/;function ka(e){for(var n="",a,s=0;s!=e.length;++s)switch(a=e.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function Nm(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function Cm(e,n){var a=e-Math.floor(e),s=Math.pow(10,n);return n<(""+Math.round(a*s)).length?0:Math.round(a*s)}function Oy(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function Ry(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Up)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?cr("n",s,a):"("+cr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return Cy(e,n,a);if(n.indexOf("%")!==-1)return Ny(e,n,a);if(n.indexOf("E")!==-1)return Fp(n,a);if(n.charCodeAt(0)===36)return"$"+cr(e,n.substr(n.charAt(1)==" "?2:1),a);var i,o,f,d,x=Math.abs(a),m=a<0?"-":"";if(n.match(/^00+$/))return m+ii(x,n.length);if(n.match(/^[#?]+$/))return i=ii(a,0),i==="0"&&(i=""),i.length>n.length?i:ka(n.substr(0,n.length-i.length))+i;if(o=n.match(Ip))return ky(o,x,m);if(n.match(/^#+0+$/))return m+ii(x,n.length-n.indexOf("0"));if(o=n.match(Bp))return i=Nm(a,o[1].length).replace(/^([^\.]+)$/,"$1."+ka(o[1])).replace(/\.$/,"."+ka(o[1])).replace(/\.(\d*)$/,function(E,_){return"."+_+Gt("0",ka(o[1]).length-_.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return m+Nm(x,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return m+Ln(ii(x,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+cr(e,n,-a):Ln(""+(Math.floor(a)+Oy(a,o[1].length)))+"."+wr(Cm(a,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return cr(e,n.replace(/^#,#*,/,""),a);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fi(cr(e,n.replace(/[\\-]/g,""),a)),f=0,fi(fi(n.replace(/\\/g,"")).replace(/[0#]/g,function(E){return f<i.length?i.charAt(f++):E==="0"?"0":""}));if(n.match(Pp))return i=cr(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(o[4].length,7),d=xo(x,Math.pow(10,f)-1,!1),i=""+m,p=en("n",o[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+o[2]+"/"+o[3],p=fo(d[2],f),p.length<o[4].length&&(p=ka(o[4].substr(o[4].length-p.length))+p),i+=p,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(o[1].length,o[4].length),7),d=xo(x,Math.pow(10,f)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mf(d[1],f)+o[2]+"/"+o[3]+fo(d[2],f):Gt(" ",2*f+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=ii(a,0),n.length<=i.length?i:ka(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),f=i.indexOf(".");var v=n.indexOf(".")-f,b=n.length-i.length-v;return ka(n.substr(0,v)+i+n.substr(n.length-b))}if(o=n.match(/^00,000\.([#0]*0)$/))return f=Cm(a,o[1].length),a<0?"-"+cr(e,n,-a):Ln(Ry(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?wr(0,3-E.length):"")+E})+"."+wr(f,o[1].length);switch(n){case"###,##0.00":return cr(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var y=Ln(ii(x,0));return y!=="0"?m+y:"";case"###,###.00":return cr(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return cr(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function jy(e,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return en(e,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function My(e,n,a){var s=n.replace(Lp,""),i=n.length-s.length;return en(e,s,a*Math.pow(10,2*i))+Gt("%",i)}function Hp(e,n){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Hp(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),a=(n/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),!a.match(/[Ee]/)){var f=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(f-a.length+o):a+="E+"+(f-o),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,x,m,p){return x+m+p.substr(0,(i+o)%i)+"."+p.substr(o)+"E"})}else a=n.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Rr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Up)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Rr("n",s,a):"("+Rr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return jy(e,n,a);if(n.indexOf("%")!==-1)return My(e,n,a);if(n.indexOf("E")!==-1)return Hp(n,a);if(n.charCodeAt(0)===36)return"$"+Rr(e,n.substr(n.charAt(1)==" "?2:1),a);var i,o,f,d,x=Math.abs(a),m=a<0?"-":"";if(n.match(/^00+$/))return m+wr(x,n.length);if(n.match(/^[#?]+$/))return i=""+a,a===0&&(i=""),i.length>n.length?i:ka(n.substr(0,n.length-i.length))+i;if(o=n.match(Ip))return Dy(o,x,m);if(n.match(/^#+0+$/))return m+wr(x,n.length-n.indexOf("0"));if(o=n.match(Bp))return i=(""+a).replace(/^([^\.]+)$/,"$1."+ka(o[1])).replace(/\.$/,"."+ka(o[1])),i=i.replace(/\.(\d*)$/,function(E,_){return"."+_+Gt("0",ka(o[1]).length-_.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return m+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return m+Ln(""+x);if(o=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Rr(e,n,-a):Ln(""+a)+"."+Gt("0",o[1].length);if(o=n.match(/^#,#*,#0/))return Rr(e,n.replace(/^#,#*,/,""),a);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fi(Rr(e,n.replace(/[\\-]/g,""),a)),f=0,fi(fi(n.replace(/\\/g,"")).replace(/[0#]/g,function(E){return f<i.length?i.charAt(f++):E==="0"?"0":""}));if(n.match(Pp))return i=Rr(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(o[4].length,7),d=xo(x,Math.pow(10,f)-1,!1),i=""+m,p=en("n",o[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+o[2]+"/"+o[3],p=fo(d[2],f),p.length<o[4].length&&(p=ka(o[4].substr(o[4].length-p.length))+p),i+=p,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(o[1].length,o[4].length),7),d=xo(x,Math.pow(10,f)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?mf(d[1],f)+o[2]+"/"+o[3]+fo(d[2],f):Gt(" ",2*f+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=""+a,n.length<=i.length?i:ka(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),f=i.indexOf(".");var v=n.indexOf(".")-f,b=n.length-i.length-v;return ka(n.substr(0,v)+i+n.substr(n.length-b))}if(o=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Rr(e,n,-a):Ln(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?wr(0,3-E.length):"")+E})+"."+wr(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=Ln(""+x);return y!=="0"?m+y:"";default:if(n.match(/\.[0#?]*$/))return Rr(e,n.slice(0,n.lastIndexOf(".")),a)+ka(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function en(e,n,a){return(a|0)===a?Rr(e,n,a):cr(e,n,a)}function Ly(e){for(var n=[],a=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=e.substr(i,s-i),i=s+1}if(n[n.length]=e.substr(i),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var zp=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function gi(e){for(var n=0,a="",s="";n<e.length;)switch(a=e.charAt(n)){case"G":ho(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(s=a;e.charAt(n++)!=="]"&&n<e.length;)s+=e.charAt(n);if(s.match(zp))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function Fy(e,n,a,s){for(var i=[],o="",f=0,d="",x="t",m,p,v,b="H";f<e.length;)switch(d=e.charAt(f)){case"G":if(!ho(e,f))throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"G",v:"General"},f+=7;break;case'"':for(o="";(v=e.charCodeAt(++f))!==34&&f<e.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++f;break;case"\\":var y=e.charAt(++f),E=y==="("||y===")"?y:"t";i[i.length]={t:E,v:y},++f;break;case"_":i[i.length]={t:"t",v:" "},f+=2;break;case"@":i[i.length]={t:"T",v:n},++f;break;case"B":case"b":if(e.charAt(f+1)==="1"||e.charAt(f+1)==="2"){if(m==null&&(m=us(n,a,e.charAt(f+1)==="2"),m==null))return"";i[i.length]={t:"X",v:e.substr(f,2)},x=d,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||m==null&&(m=us(n,a),m==null))return"";for(o=d;++f<e.length&&e.charAt(f).toLowerCase()===d;)o+=d;d==="m"&&x.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=b),i[i.length]={t:d,v:o},x=d;break;case"A":case"a":case"":var _={t:d,v:d};if(m==null&&(m=us(n,a)),e.substr(f,3).toUpperCase()==="A/P"?(m!=null&&(_.v=m.H>=12?"P":"A"),_.t="T",b="h",f+=3):e.substr(f,5).toUpperCase()==="AM/PM"?(m!=null&&(_.v=m.H>=12?"PM":"AM"),_.t="T",f+=5,b="h"):e.substr(f,5).toUpperCase()==="/"?(m!=null&&(_.v=m.H>=12?"":""),_.t="T",f+=5,b="h"):(_.t="t",++f),m==null&&_.t==="T")return"";i[i.length]=_,x=d;break;case"[":for(o=d;e.charAt(f++)!=="]"&&f<e.length;)o+=e.charAt(f);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(zp)){if(m==null&&(m=us(n,a),m==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},x=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",gi(e)||(i[i.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=d;++f<e.length&&(d=e.charAt(f))==="0";)o+=d;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++f<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(f))>-1;)o+=d;i[i.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++f)===d;)o+=d;i[i.length]={t:d,v:o},x=d;break;case"*":++f,(e.charAt(f)==" "||e.charAt(f)=="*")&&++f;break;case"(":case")":i[i.length]={t:s===1?"t":d,v:d},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)o+=e.charAt(f);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:d,v:d},++f;break;case"$":i[i.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"t",v:d},++f;break}var w=0,S=0,D;for(f=i.length-1,x="t";f>=0;--f)switch(i[f].t){case"h":case"H":i[f].t=b,x="h",w<1&&(w=1);break;case"s":(D=i[f].v.match(/\.0+$/))&&(S=Math.max(S,D[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":x=i[f].t;break;case"m":x==="s"&&(i[f].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[f].v.match(/[Hh]/)&&(w=1),w<2&&i[f].v.match(/[Mm]/)&&(w=2),w<3&&i[f].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var A="",z;for(f=0;f<i.length;++f)switch(i[f].t){case"t":case"T":case" ":case"D":break;case"X":i[f].v="",i[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[f].v=Ay(i[f].t.charCodeAt(0),i[f].v,m,S),i[f].t="t";break;case"n":case"?":for(z=f+1;i[z]!=null&&((d=i[z].t)==="?"||d==="D"||(d===" "||d==="t")&&i[z+1]!=null&&(i[z+1].t==="?"||i[z+1].t==="t"&&i[z+1].v==="/")||i[f].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[z].v==="/"||i[z].v===" "&&i[z+1]!=null&&i[z+1].t=="?"));)i[f].v+=i[z].v,i[z]={v:"",t:";"},++z;A+=i[f].v,f=z-1;break;case"G":i[f].t="t",i[f].v=hs(n,a);break}var V="",Y,j;if(A.length>0){A.charCodeAt(0)==40?(Y=n<0&&A.charCodeAt(0)===45?-n:n,j=en("n",A,Y)):(Y=n<0&&s>1?-n:n,j=en("n",A,Y),Y<0&&i[0]&&i[0].t=="t"&&(j=j.substr(1),i[0].v="-"+i[0].v)),z=j.length-1;var Q=i.length;for(f=0;f<i.length;++f)if(i[f]!=null&&i[f].t!="t"&&i[f].v.indexOf(".")>-1){Q=f;break}var B=i.length;if(Q===i.length&&j.indexOf("E")===-1){for(f=i.length-1;f>=0;--f)i[f]==null||"n?".indexOf(i[f].t)===-1||(z>=i[f].v.length-1?(z-=i[f].v.length,i[f].v=j.substr(z+1,i[f].v.length)):z<0?i[f].v="":(i[f].v=j.substr(0,z+1),z=-1),i[f].t="t",B=f);z>=0&&B<i.length&&(i[B].v=j.substr(0,z+1)+i[B].v)}else if(Q!==i.length&&j.indexOf("E")===-1){for(z=j.indexOf(".")-1,f=Q;f>=0;--f)if(!(i[f]==null||"n?".indexOf(i[f].t)===-1)){for(p=i[f].v.indexOf(".")>-1&&f===Q?i[f].v.indexOf(".")-1:i[f].v.length-1,V=i[f].v.substr(p+1);p>=0;--p)z>=0&&(i[f].v.charAt(p)==="0"||i[f].v.charAt(p)==="#")&&(V=j.charAt(z--)+V);i[f].v=V,i[f].t="t",B=f}for(z>=0&&B<i.length&&(i[B].v=j.substr(0,z+1)+i[B].v),z=j.indexOf(".")+1,f=Q;f<i.length;++f)if(!(i[f]==null||"n?(".indexOf(i[f].t)===-1&&f!==Q)){for(p=i[f].v.indexOf(".")>-1&&f===Q?i[f].v.indexOf(".")+1:0,V=i[f].v.substr(0,p);p<i[f].v.length;++p)z<j.length&&(V+=j.charAt(z++));i[f].v=V,i[f].t="t",B=f}}}for(f=0;f<i.length;++f)i[f]!=null&&"n?".indexOf(i[f].t)>-1&&(Y=s>1&&n<0&&f>0&&i[f-1].v==="-"?-n:n,i[f].v=en(i[f].t,i[f].v,Y),i[f].t="t");var ne="";for(f=0;f!==i.length;++f)i[f]!=null&&(ne+=i[f].v);return ne}var km=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dm(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function Iy(e,n){var a=Ly(e),s=a.length,i=a[s-1].indexOf("@");if(s<4&&i>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||i>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=i>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=i>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=i>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var o=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,o];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var f=a[0].match(km),d=a[1].match(km);return Dm(n,f)?[s,a[0]]:Dm(n,d)?[s,a[1]]:[s,a[f!=null&&d!=null?2:1]]}return[s,o]}function ur(e,n,a){a==null&&(a={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?s=a.dateNF:s=e;break;case"number":e==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:st)[e],s==null&&(s=a.table&&a.table[Am[e]]||st[Am[e]]),s==null&&(s=by[e]||"General");break}if(ho(s,0))return hs(n,a);n instanceof Date&&(n=Mp(n,a.date1904));var i=Iy(s,n);if(ho(i[1]))return hs(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return Fy(i[1],n,a,i[0])}function fs(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(st[a]==null){n<0&&(n=a);continue}if(st[a]==e){n=a;break}}n<0&&(n=391)}return st[n]=e,n}function Vp(){st=vy()}var By={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Gp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Uy(e){var n=typeof e=="number"?st[e]:e;return n=n.replace(Gp,"(\\d+)"),new RegExp("^"+n+"$")}function Py(e,n,a){var s=-1,i=-1,o=-1,f=-1,d=-1,x=-1;(n.match(Gp)||[]).forEach(function(v,b){var y=parseInt(a[b+1],10);switch(v.toLowerCase().charAt(0)){case"y":s=y;break;case"d":o=y;break;case"h":f=y;break;case"s":x=y;break;case"m":f>=0?d=y:i=y;break}}),x>=0&&d==-1&&i>=0&&(d=i,i=-1);var m=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2);return f==-1&&d==-1&&x==-1?m:s==-1&&i==-1&&o==-1?p:m+"T"+p}var Hy=function(){var e={};e.version="1.2.0";function n(){for(var j=0,Q=new Array(256),B=0;B!=256;++B)j=B,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,Q[B]=j;return typeof Int32Array<"u"?new Int32Array(Q):Q}var a=n();function s(j){var Q=0,B=0,ne=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)K[ne]=j[ne];for(ne=0;ne!=256;++ne)for(B=j[ne],Q=256+ne;Q<4096;Q+=256)B=K[Q]=B>>>8^j[B&255];var X=[];for(ne=1;ne!=16;++ne)X[ne-1]=typeof Int32Array<"u"?K.subarray(ne*256,ne*256+256):K.slice(ne*256,ne*256+256);return X}var i=s(a),o=i[0],f=i[1],d=i[2],x=i[3],m=i[4],p=i[5],v=i[6],b=i[7],y=i[8],E=i[9],_=i[10],w=i[11],S=i[12],D=i[13],A=i[14];function z(j,Q){for(var B=Q^-1,ne=0,K=j.length;ne<K;)B=B>>>8^a[(B^j.charCodeAt(ne++))&255];return~B}function V(j,Q){for(var B=Q^-1,ne=j.length-15,K=0;K<ne;)B=A[j[K++]^B&255]^D[j[K++]^B>>8&255]^S[j[K++]^B>>16&255]^w[j[K++]^B>>>24]^_[j[K++]]^E[j[K++]]^y[j[K++]]^b[j[K++]]^v[j[K++]]^p[j[K++]]^m[j[K++]]^x[j[K++]]^d[j[K++]]^f[j[K++]]^o[j[K++]]^a[j[K++]];for(ne+=15;K<ne;)B=B>>>8^a[(B^j[K++])&255];return~B}function Y(j,Q){for(var B=Q^-1,ne=0,K=j.length,X=0,ee=0;ne<K;)X=j.charCodeAt(ne++),X<128?B=B>>>8^a[(B^X)&255]:X<2048?(B=B>>>8^a[(B^(192|X>>6&31))&255],B=B>>>8^a[(B^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,ee=j.charCodeAt(ne++)&1023,B=B>>>8^a[(B^(240|X>>8&7))&255],B=B>>>8^a[(B^(128|X>>2&63))&255],B=B>>>8^a[(B^(128|ee>>6&15|(X&3)<<4))&255],B=B>>>8^a[(B^(128|ee&63))&255]):(B=B>>>8^a[(B^(224|X>>12&15))&255],B=B>>>8^a[(B^(128|X>>6&63))&255],B=B>>>8^a[(B^(128|X&63))&255]);return~B}return e.table=a,e.bstr=z,e.buf=V,e.str=Y,e}(),vt=function(){var n={};n.version="1.2.1";function a(N,L){for(var O=N.split("/"),M=L.split("/"),F=0,P=0,ce=Math.min(O.length,M.length);F<ce;++F){if(P=O[F].length-M[F].length)return P;if(O[F]!=M[F])return O[F]<M[F]?-1:1}return O.length-M.length}function s(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:s(N.slice(0,-1));var L=N.lastIndexOf("/");return L===-1?N:N.slice(0,L+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var L=N.lastIndexOf("/");return L===-1?N:N.slice(L+1)}function o(N,L){typeof L=="string"&&(L=new Date(L));var O=L.getHours();O=O<<6|L.getMinutes(),O=O<<5|L.getSeconds()>>>1,N.write_shift(2,O);var M=L.getFullYear()-1980;M=M<<4|L.getMonth()+1,M=M<<5|L.getDate(),N.write_shift(2,M)}function f(N){var L=N.read_shift(2)&65535,O=N.read_shift(2)&65535,M=new Date,F=O&31;O>>>=5;var P=O&15;O>>>=4,M.setMilliseconds(0),M.setFullYear(O+1980),M.setMonth(P-1),M.setDate(F);var ce=L&31;L>>>=5;var be=L&63;return L>>>=6,M.setHours(L),M.setMinutes(be),M.setSeconds(ce<<1),M}function d(N){pa(N,0);for(var L={},O=0;N.l<=N.length-4;){var M=N.read_shift(2),F=N.read_shift(2),P=N.l+F,ce={};switch(M){case 21589:O=N.read_shift(1),O&1&&(ce.mtime=N.read_shift(4)),F>5&&(O&2&&(ce.atime=N.read_shift(4)),O&4&&(ce.ctime=N.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}N.l=P,L[M]=ce}return L}var x;function m(){return x||(x={})}function p(N,L){if(N[0]==80&&N[1]==75)return Hn(N,L);if((N[0]|32)==109&&(N[1]|32)==105)return As(N,L);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var O=3,M=512,F=0,P=0,ce=0,be=0,re=0,fe=[],xe=N.slice(0,512);pa(xe,0);var Ne=v(xe);switch(O=Ne[0],O){case 3:M=512;break;case 4:M=4096;break;case 0:if(Ne[1]==0)return Hn(N,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}M!==512&&(xe=N.slice(0,M),pa(xe,28));var Oe=N.slice(0,M);b(xe,O);var Le=xe.read_shift(4,"i");if(O===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);xe.l+=4,ce=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),be=xe.read_shift(4,"i"),F=xe.read_shift(4,"i"),re=xe.read_shift(4,"i"),P=xe.read_shift(4,"i");for(var ke=-1,Me=0;Me<109&&(ke=xe.read_shift(4,"i"),!(ke<0));++Me)fe[Me]=ke;var tt=y(N,M);w(re,P,tt,M,fe);var Ct=D(tt,ce,fe,M);Ct[ce].name="!Directory",F>0&&be!==ee&&(Ct[be].name="!MiniFAT"),Ct[fe[0]].name="!FAT",Ct.fat_addrs=fe,Ct.ssz=M;var kt={},Mt=[],Br=[],cn=[];A(ce,Ct,tt,Mt,F,kt,Br,be),E(Br,cn,Mt),Mt.shift();var Za={FileIndex:Br,FullPaths:cn};return L&&L.raw&&(Za.raw={header:Oe,sectors:tt}),Za}function v(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(he,"Header Signature: "),N.l+=16;var L=N.read_shift(2,"u");return[N.read_shift(2,"u"),L]}function b(N,L){var O=9;switch(N.l+=2,O=N.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function y(N,L){for(var O=Math.ceil(N.length/L)-1,M=[],F=1;F<O;++F)M[F-1]=N.slice(F*L,(F+1)*L);return M[O-1]=N.slice(O*L),M}function E(N,L,O){for(var M=0,F=0,P=0,ce=0,be=0,re=O.length,fe=[],xe=[];M<re;++M)fe[M]=xe[M]=M,L[M]=O[M];for(;be<xe.length;++be)M=xe[be],F=N[M].L,P=N[M].R,ce=N[M].C,fe[M]===M&&(F!==-1&&fe[F]!==F&&(fe[M]=fe[F]),P!==-1&&fe[P]!==P&&(fe[M]=fe[P])),ce!==-1&&(fe[ce]=M),F!==-1&&M!=fe[M]&&(fe[F]=fe[M],xe.lastIndexOf(F)<be&&xe.push(F)),P!==-1&&M!=fe[M]&&(fe[P]=fe[M],xe.lastIndexOf(P)<be&&xe.push(P));for(M=1;M<re;++M)fe[M]===M&&(P!==-1&&fe[P]!==P?fe[M]=fe[P]:F!==-1&&fe[F]!==F&&(fe[M]=fe[F]));for(M=1;M<re;++M)if(N[M].type!==0){if(be=M,be!=fe[be])do be=fe[be],L[M]=L[be]+"/"+L[M];while(be!==0&&fe[be]!==-1&&be!=fe[be]);fe[M]=-1}for(L[0]+="/",M=1;M<re;++M)N[M].type!==2&&(L[M]+="/")}function _(N,L,O){for(var M=N.start,F=N.size,P=[],ce=M;O&&F>0&&ce>=0;)P.push(L.slice(ce*X,ce*X+X)),F-=X,ce=os(O,ce*4);return P.length===0?sa(0):jn(P).slice(0,N.size)}function w(N,L,O,M,F){var P=ee;if(N===ee){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ce=O[N],be=(M>>>2)-1;if(!ce)return;for(var re=0;re<be&&(P=os(ce,re*4))!==ee;++re)F.push(P);w(os(ce,M-4),L-1,O,M,F)}}function S(N,L,O,M,F){var P=[],ce=[];F||(F=[]);var be=M-1,re=0,fe=0;for(re=L;re>=0;){F[re]=!0,P[P.length]=re,ce.push(N[re]);var xe=O[Math.floor(re*4/M)];if(fe=re*4&be,M<4+fe)throw new Error("FAT boundary crossed: "+re+" 4 "+M);if(!N[xe])break;re=os(N[xe],fe)}return{nodes:P,data:Pm([ce])}}function D(N,L,O,M){var F=N.length,P=[],ce=[],be=[],re=[],fe=M-1,xe=0,Ne=0,Oe=0,Le=0;for(xe=0;xe<F;++xe)if(be=[],Oe=xe+L,Oe>=F&&(Oe-=F),!ce[Oe]){re=[];var ke=[];for(Ne=Oe;Ne>=0;){ke[Ne]=!0,ce[Ne]=!0,be[be.length]=Ne,re.push(N[Ne]);var Me=O[Math.floor(Ne*4/M)];if(Le=Ne*4&fe,M<4+Le)throw new Error("FAT boundary crossed: "+Ne+" 4 "+M);if(!N[Me]||(Ne=os(N[Me],Le),ke[Ne]))break}P[Oe]={nodes:be,data:Pm([re])}}return P}function A(N,L,O,M,F,P,ce,be){for(var re=0,fe=M.length?2:0,xe=L[N].data,Ne=0,Oe=0,Le;Ne<xe.length;Ne+=128){var ke=xe.slice(Ne,Ne+128);pa(ke,64),Oe=ke.read_shift(2),Le=Ef(ke,0,Oe-fe),M.push(Le);var Me={name:Le,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},tt=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);tt!==0&&(Me.ct=z(ke,ke.l-8));var Ct=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Ct!==0&&(Me.mt=z(ke,ke.l-8)),Me.start=ke.read_shift(4,"i"),Me.size=ke.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ee,Me.name=""),Me.type===5?(re=Me.start,F>0&&re!==ee&&(L[re].name="!StreamData")):Me.size>=4096?(Me.storage="fat",L[Me.start]===void 0&&(L[Me.start]=S(O,Me.start,L.fat_addrs,L.ssz)),L[Me.start].name=Me.name,Me.content=L[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:re!==ee&&Me.start!==ee&&L[re]&&(Me.content=_(Me,L[re].data,(L[be]||{}).data))),Me.content&&pa(Me.content,0),P[Le]=Me,ce.push(Me)}}function z(N,L){return new Date((qa(N,L+4)/1e7*Math.pow(2,32)+qa(N,L)/1e7-11644473600)*1e3)}function V(N,L){return m(),p(x.readFileSync(N),L)}function Y(N,L){var O=L&&L.type;switch(O||mt&&Buffer.isBuffer(N)&&(O="buffer"),O||"base64"){case"file":return V(N,L);case"base64":return p(Er(Wa(N)),L);case"binary":return p(Er(N),L)}return p(N,L)}function j(N,L){var O=L||{},M=O.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=M+"/",N.FileIndex[0]={name:M,type:5}),O.CLSID&&(N.FileIndex[0].clsid=O.CLSID),Q(N)}function Q(N){var L="Sh33tJ5";if(!vt.find(N,"/"+L)){var O=sa(4);O[0]=55,O[1]=O[3]=50,O[2]=54,N.FileIndex.push({name:L,type:2,content:O,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+L),B(N)}}function B(N,L){j(N);for(var O=!1,M=!1,F=N.FullPaths.length-1;F>=0;--F){var P=N.FileIndex[F];switch(P.type){case 0:M?O=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(P.R*P.L*P.C)&&(O=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!L)){var ce=new Date(1987,1,19),be=0,re=Object.create?Object.create(null):{},fe=[];for(F=0;F<N.FullPaths.length;++F)re[N.FullPaths[F]]=!0,N.FileIndex[F].type!==0&&fe.push([N.FullPaths[F],N.FileIndex[F]]);for(F=0;F<fe.length;++F){var xe=s(fe[F][0]);M=re[xe],M||(fe.push([xe,{name:i(xe).replace("/",""),type:1,clsid:Z,ct:ce,mt:ce,content:null}]),re[xe]=!0)}for(fe.sort(function(Le,ke){return a(Le[0],ke[0])}),N.FullPaths=[],N.FileIndex=[],F=0;F<fe.length;++F)N.FullPaths[F]=fe[F][0],N.FileIndex[F]=fe[F][1];for(F=0;F<fe.length;++F){var Ne=N.FileIndex[F],Oe=N.FullPaths[F];if(Ne.name=i(Oe).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Z,F===0)Ne.C=fe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Oe.slice(-1)=="/"){for(be=F+1;be<fe.length&&s(N.FullPaths[be])!=Oe;++be);for(Ne.C=be>=fe.length?-1:be,be=F+1;be<fe.length&&s(N.FullPaths[be])!=s(Oe);++be);Ne.R=be>=fe.length?-1:be,Ne.type=1}else s(N.FullPaths[F+1]||"")==s(Oe)&&(Ne.R=F+1),Ne.type=2}}}function ne(N,L){var O=L||{};if(O.fileType=="mad")return dr(N,O);switch(B(N),O.fileType){case"zip":return Sr(N,O)}var M=function(Le){for(var ke=0,Me=0,tt=0;tt<Le.FileIndex.length;++tt){var Ct=Le.FileIndex[tt];if(Ct.content){var kt=Ct.content.length;kt>0&&(kt<4096?ke+=kt+63>>6:Me+=kt+511>>9)}}for(var Mt=Le.FullPaths.length+3>>2,Br=ke+7>>3,cn=ke+127>>7,Za=Br+Me+Mt+cn,xr=Za+127>>7,Gn=xr<=109?0:Math.ceil((xr-109)/127);Za+xr+Gn+127>>7>xr;)Gn=++xr<=109?0:Math.ceil((xr-109)/127);var mr=[1,Gn,xr,cn,Mt,Me,ke,0];return Le.FileIndex[0].size=ke<<6,mr[7]=(Le.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr}(N),F=sa(M[7]<<9),P=0,ce=0;{for(P=0;P<8;++P)F.write_shift(1,_e[P]);for(P=0;P<8;++P)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),P=0;P<3;++P)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,M[2]),F.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:ee),F.write_shift(4,M[3]),F.write_shift(-4,M[1]?M[0]-1:ee),F.write_shift(4,M[1]),P=0;P<109;++P)F.write_shift(-4,P<M[2]?M[1]+P:-1)}if(M[1])for(ce=0;ce<M[1];++ce){for(;P<236+ce*127;++P)F.write_shift(-4,P<M[2]?M[1]+P:-1);F.write_shift(-4,ce===M[1]-1?ee:ce+1)}var be=function(Le){for(ce+=Le;P<ce-1;++P)F.write_shift(-4,P+1);Le&&(++P,F.write_shift(-4,ee))};for(ce=P=0,ce+=M[1];P<ce;++P)F.write_shift(-4,ue.DIFSECT);for(ce+=M[2];P<ce;++P)F.write_shift(-4,ue.FATSECT);be(M[3]),be(M[4]);for(var re=0,fe=0,xe=N.FileIndex[0];re<N.FileIndex.length;++re)xe=N.FileIndex[re],xe.content&&(fe=xe.content.length,!(fe<4096)&&(xe.start=ce,be(fe+511>>9)));for(be(M[6]+7>>3);F.l&511;)F.write_shift(-4,ue.ENDOFCHAIN);for(ce=P=0,re=0;re<N.FileIndex.length;++re)xe=N.FileIndex[re],xe.content&&(fe=xe.content.length,!(!fe||fe>=4096)&&(xe.start=ce,be(fe+63>>6)));for(;F.l&511;)F.write_shift(-4,ue.ENDOFCHAIN);for(P=0;P<M[4]<<2;++P){var Ne=N.FullPaths[P];if(!Ne||Ne.length===0){for(re=0;re<17;++re)F.write_shift(4,0);for(re=0;re<3;++re)F.write_shift(4,-1);for(re=0;re<12;++re)F.write_shift(4,0);continue}xe=N.FileIndex[P],P===0&&(xe.start=xe.size?xe.start-1:ee);var Oe=P===0&&O.root||xe.name;if(fe=2*(Oe.length+1),F.write_shift(64,Oe,"utf16le"),F.write_shift(2,fe),F.write_shift(1,xe.type),F.write_shift(1,xe.color),F.write_shift(-4,xe.L),F.write_shift(-4,xe.R),F.write_shift(-4,xe.C),xe.clsid)F.write_shift(16,xe.clsid,"hex");else for(re=0;re<4;++re)F.write_shift(4,0);F.write_shift(4,xe.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,xe.start),F.write_shift(4,xe.size),F.write_shift(4,0)}for(P=1;P<N.FileIndex.length;++P)if(xe=N.FileIndex[P],xe.size>=4096)if(F.l=xe.start+1<<9,mt&&Buffer.isBuffer(xe.content))xe.content.copy(F,F.l,0,xe.size),F.l+=xe.size+511&-512;else{for(re=0;re<xe.size;++re)F.write_shift(1,xe.content[re]);for(;re&511;++re)F.write_shift(1,0)}for(P=1;P<N.FileIndex.length;++P)if(xe=N.FileIndex[P],xe.size>0&&xe.size<4096)if(mt&&Buffer.isBuffer(xe.content))xe.content.copy(F,F.l,0,xe.size),F.l+=xe.size+63&-64;else{for(re=0;re<xe.size;++re)F.write_shift(1,xe.content[re]);for(;re&63;++re)F.write_shift(1,0)}if(mt)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function K(N,L){var O=N.FullPaths.map(function(re){return re.toUpperCase()}),M=O.map(function(re){var fe=re.split("/");return fe[fe.length-(re.slice(-1)=="/"?2:1)]}),F=!1;L.charCodeAt(0)===47?(F=!0,L=O[0].slice(0,-1)+L):F=L.indexOf("/")!==-1;var P=L.toUpperCase(),ce=F===!0?O.indexOf(P):M.indexOf(P);if(ce!==-1)return N.FileIndex[ce];var be=!P.match(pl);for(P=P.replace(Ra,""),be&&(P=P.replace(pl,"!")),ce=0;ce<O.length;++ce)if((be?O[ce].replace(pl,"!"):O[ce]).replace(Ra,"")==P||(be?M[ce].replace(pl,"!"):M[ce]).replace(Ra,"")==P)return N.FileIndex[ce];return null}var X=64,ee=-2,he="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(N,L,O){m();var M=ne(N,O);x.writeFileSync(L,M)}function te(N){for(var L=new Array(N.length),O=0;O<N.length;++O)L[O]=String.fromCharCode(N[O]);return L.join("")}function H(N,L){var O=ne(N,L);switch(L&&L.type||"buffer"){case"file":return m(),x.writeFileSync(L.filename,O),O;case"binary":return typeof O=="string"?O:te(O);case"base64":return _m(typeof O=="string"?O:te(O));case"buffer":if(mt)return Buffer.isBuffer(O)?O:ps(O);case"array":return typeof O=="string"?Er(O):O}return O}var oe;function k(N){try{var L=N.InflateRaw,O=new L;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)oe=N;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function q(N,L){if(!oe)return _s(N,L);var O=oe.InflateRaw,M=new O,F=M._processChunk(N.slice(N.l),M._finishFlushFlag);return N.l+=M.bytesRead,F}function U(N){return oe?oe.deflateRawSync(N):De(N)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(N){var L=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(L>>16|L>>8|L)&255}for(var Se=typeof Uint8Array<"u",we=Se?new Uint8Array(256):[],Be=0;Be<256;++Be)we[Be]=ve(Be);function I(N,L){var O=we[N&255];return L<=8?O>>>8-L:(O=O<<8|we[N>>8&255],L<=16?O>>>16-L:(O=O<<8|we[N>>16&255],O>>>24-L))}function Pe(N,L){var O=L&7,M=L>>>3;return(N[M]|(O<=6?0:N[M+1]<<8))>>>O&3}function Ue(N,L){var O=L&7,M=L>>>3;return(N[M]|(O<=5?0:N[M+1]<<8))>>>O&7}function We(N,L){var O=L&7,M=L>>>3;return(N[M]|(O<=4?0:N[M+1]<<8))>>>O&15}function Ve(N,L){var O=L&7,M=L>>>3;return(N[M]|(O<=3?0:N[M+1]<<8))>>>O&31}function ge(N,L){var O=L&7,M=L>>>3;return(N[M]|(O<=1?0:N[M+1]<<8))>>>O&127}function Ie(N,L,O){var M=L&7,F=L>>>3,P=(1<<O)-1,ce=N[F]>>>M;return O<8-M||(ce|=N[F+1]<<8-M,O<16-M)||(ce|=N[F+2]<<16-M,O<24-M)||(ce|=N[F+3]<<24-M),ce&P}function pt(N,L,O){var M=L&7,F=L>>>3;return M<=5?N[F]|=(O&7)<<M:(N[F]|=O<<M&255,N[F+1]=(O&7)>>8-M),L+3}function ye(N,L,O){var M=L&7,F=L>>>3;return O=(O&1)<<M,N[F]|=O,L+1}function je(N,L,O){var M=L&7,F=L>>>3;return O<<=M,N[F]|=O&255,O>>>=8,N[F+1]=O,L+8}function lt(N,L,O){var M=L&7,F=L>>>3;return O<<=M,N[F]|=O&255,O>>>=8,N[F+1]=O&255,N[F+2]=O>>>8,L+16}function Ge(N,L){var O=N.length,M=2*O>L?2*O:L+5,F=0;if(O>=L)return N;if(mt){var P=wm(M);if(N.copy)N.copy(P);else for(;F<N.length;++F)P[F]=N[F];return P}else if(Se){var ce=new Uint8Array(M);if(ce.set)ce.set(N);else for(;F<O;++F)ce[F]=N[F];return ce}return N.length=M,N}function rt(N){for(var L=new Array(N),O=0;O<N;++O)L[O]=0;return L}function Nt(N,L,O){var M=1,F=0,P=0,ce=0,be=0,re=N.length,fe=Se?new Uint16Array(32):rt(32);for(P=0;P<32;++P)fe[P]=0;for(P=re;P<O;++P)N[P]=0;re=N.length;var xe=Se?new Uint16Array(re):rt(re);for(P=0;P<re;++P)fe[F=N[P]]++,M<F&&(M=F),xe[P]=0;for(fe[0]=0,P=1;P<=M;++P)fe[P+16]=be=be+fe[P-1]<<1;for(P=0;P<re;++P)be=N[P],be!=0&&(xe[P]=fe[be+16]++);var Ne=0;for(P=0;P<re;++P)if(Ne=N[P],Ne!=0)for(be=I(xe[P],M)>>M-Ne,ce=(1<<M+4-Ne)-1;ce>=0;--ce)L[be|ce<<Ne]=Ne&15|P<<4;return M}var ct=Se?new Uint16Array(512):rt(512),nt=Se?new Uint16Array(32):rt(32);if(!Se){for(var Ce=0;Ce<512;++Ce)ct[Ce]=0;for(Ce=0;Ce<32;++Ce)nt[Ce]=0}(function(){for(var N=[],L=0;L<32;L++)N.push(5);Nt(N,nt,32);var O=[];for(L=0;L<=143;L++)O.push(8);for(;L<=255;L++)O.push(9);for(;L<=279;L++)O.push(7);for(;L<=287;L++)O.push(8);Nt(O,ct,288)})();var Je=function(){for(var L=Se?new Uint8Array(32768):[],O=0,M=0;O<pe.length-1;++O)for(;M<pe[O+1];++M)L[M]=O;for(;M<32768;++M)L[M]=29;var F=Se?new Uint8Array(259):[];for(O=0,M=0;O<W.length-1;++O)for(;M<W[O+1];++M)F[M]=O;function P(be,re){for(var fe=0;fe<be.length;){var xe=Math.min(65535,be.length-fe),Ne=fe+xe==be.length;for(re.write_shift(1,+Ne),re.write_shift(2,xe),re.write_shift(2,~xe&65535);xe-- >0;)re[re.l++]=be[fe++]}return re.l}function ce(be,re){for(var fe=0,xe=0,Ne=Se?new Uint16Array(32768):[];xe<be.length;){var Oe=Math.min(65535,be.length-xe);if(Oe<10){for(fe=pt(re,fe,+(xe+Oe==be.length)),fe&7&&(fe+=8-(fe&7)),re.l=fe/8|0,re.write_shift(2,Oe),re.write_shift(2,~Oe&65535);Oe-- >0;)re[re.l++]=be[xe++];fe=re.l*8;continue}fe=pt(re,fe,+(xe+Oe==be.length)+2);for(var Le=0;Oe-- >0;){var ke=be[xe];Le=(Le<<5^ke)&32767;var Me=-1,tt=0;if((Me=Ne[Le])&&(Me|=xe&-32768,Me>xe&&(Me-=32768),Me<xe))for(;be[Me+tt]==be[xe+tt]&&tt<250;)++tt;if(tt>2){ke=F[tt],ke<=22?fe=je(re,fe,we[ke+1]>>1)-1:(je(re,fe,3),fe+=5,je(re,fe,we[ke-23]>>5),fe+=3);var Ct=ke<8?0:ke-4>>2;Ct>0&&(lt(re,fe,tt-W[ke]),fe+=Ct),ke=L[xe-Me],fe=je(re,fe,we[ke]>>3),fe-=3;var kt=ke<4?0:ke-2>>1;kt>0&&(lt(re,fe,xe-Me-pe[ke]),fe+=kt);for(var Mt=0;Mt<tt;++Mt)Ne[Le]=xe&32767,Le=(Le<<5^be[xe])&32767,++xe;Oe-=tt-1}else ke<=143?ke=ke+48:fe=ye(re,fe,1),fe=je(re,fe,we[ke]),Ne[Le]=xe&32767,++xe}fe=je(re,fe,0)-1}return re.l=(fe+7)/8|0,re.l}return function(re,fe){return re.length<8?P(re,fe):ce(re,fe)}}();function De(N){var L=sa(50+Math.floor(N.length*1.1)),O=Je(N,L);return L.slice(0,O)}var ze=Se?new Uint16Array(32768):rt(32768),wt=Se?new Uint16Array(32768):rt(32768),Et=Se?new Uint16Array(128):rt(128),Pt=1,$a=1;function sn(N,L){var O=Ve(N,L)+257;L+=5;var M=Ve(N,L)+1;L+=5;var F=We(N,L)+4;L+=4;for(var P=0,ce=Se?new Uint8Array(19):rt(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,fe=Se?new Uint8Array(8):rt(8),xe=Se?new Uint8Array(8):rt(8),Ne=ce.length,Oe=0;Oe<F;++Oe)ce[R[Oe]]=P=Ue(N,L),re<P&&(re=P),fe[P]++,L+=3;var Le=0;for(fe[0]=0,Oe=1;Oe<=re;++Oe)xe[Oe]=Le=Le+fe[Oe-1]<<1;for(Oe=0;Oe<Ne;++Oe)(Le=ce[Oe])!=0&&(be[Oe]=xe[Le]++);var ke=0;for(Oe=0;Oe<Ne;++Oe)if(ke=ce[Oe],ke!=0){Le=we[be[Oe]]>>8-ke;for(var Me=(1<<7-ke)-1;Me>=0;--Me)Et[Le|Me<<ke]=ke&7|Oe<<3}var tt=[];for(re=1;tt.length<O+M;)switch(Le=Et[ge(N,L)],L+=Le&7,Le>>>=3){case 16:for(P=3+Pe(N,L),L+=2,Le=tt[tt.length-1];P-- >0;)tt.push(Le);break;case 17:for(P=3+Ue(N,L),L+=3;P-- >0;)tt.push(0);break;case 18:for(P=11+ge(N,L),L+=7;P-- >0;)tt.push(0);break;default:tt.push(Le),re<Le&&(re=Le);break}var Ct=tt.slice(0,O),kt=tt.slice(O);for(Oe=O;Oe<286;++Oe)Ct[Oe]=0;for(Oe=M;Oe<30;++Oe)kt[Oe]=0;return Pt=Nt(Ct,ze,286),$a=Nt(kt,wt,30),L}function Ir(N,L){if(N[0]==3&&!(N[1]&3))return[In(L),2];for(var O=0,M=0,F=wm(L||1<<18),P=0,ce=F.length>>>0,be=0,re=0;(M&1)==0;){if(M=Ue(N,O),O+=3,M>>>1)M>>1==1?(be=9,re=5):(O=sn(N,O),be=Pt,re=$a);else{O&7&&(O+=8-(O&7));var fe=N[O>>>3]|N[(O>>>3)+1]<<8;if(O+=32,fe>0)for(!L&&ce<P+fe&&(F=Ge(F,P+fe),ce=F.length);fe-- >0;)F[P++]=N[O>>>3],O+=8;continue}for(;;){!L&&ce<P+32767&&(F=Ge(F,P+32767),ce=F.length);var xe=Ie(N,O,be),Ne=M>>>1==1?ct[xe]:ze[xe];if(O+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)F[P++]=Ne;else{if(Ne==256)break;Ne-=257;var Oe=Ne<8?0:Ne-4>>2;Oe>5&&(Oe=0);var Le=P+W[Ne];Oe>0&&(Le+=Ie(N,O,Oe),O+=Oe),xe=Ie(N,O,re),Ne=M>>>1==1?nt[xe]:wt[xe],O+=Ne&15,Ne>>>=4;var ke=Ne<4?0:Ne-2>>1,Me=pe[Ne];for(ke>0&&(Me+=Ie(N,O,ke),O+=ke),!L&&ce<Le&&(F=Ge(F,Le+100),ce=F.length);P<Le;)F[P]=F[P-Me],++P}}}return L?[F,O+7>>>3]:[F.slice(0,P),O+7>>>3]}function _s(N,L){var O=N.slice(N.l||0),M=Ir(O,L);return N.l+=M[1],M[0]}function Pn(N,L){if(N)typeof console<"u"&&console.error(L);else throw new Error(L)}function Hn(N,L){var O=N;pa(O,0);var M=[],F=[],P={FileIndex:M,FullPaths:F};j(P,{root:L.root});for(var ce=O.length-4;(O[ce]!=80||O[ce+1]!=75||O[ce+2]!=5||O[ce+3]!=6)&&ce>=0;)--ce;O.l=ce+4,O.l+=4;var be=O.read_shift(2);O.l+=6;var re=O.read_shift(4);for(O.l=re,ce=0;ce<be;++ce){O.l+=20;var fe=O.read_shift(4),xe=O.read_shift(4),Ne=O.read_shift(2),Oe=O.read_shift(2),Le=O.read_shift(2);O.l+=8;var ke=O.read_shift(4),Me=d(O.slice(O.l+Ne,O.l+Ne+Oe));O.l+=Ne+Oe+Le;var tt=O.l;O.l=ke+4,zn(O,fe,xe,P,Me),O.l=tt}return P}function zn(N,L,O,M,F){N.l+=2;var P=N.read_shift(2),ce=N.read_shift(2),be=f(N);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var re=N.read_shift(4),fe=N.read_shift(4),xe=N.read_shift(4),Ne=N.read_shift(2),Oe=N.read_shift(2),Le="",ke=0;ke<Ne;++ke)Le+=String.fromCharCode(N[N.l++]);if(Oe){var Me=d(N.slice(N.l,N.l+Oe));(Me[21589]||{}).mt&&(be=Me[21589].mt),((F||{})[21589]||{}).mt&&(be=F[21589].mt)}N.l+=Oe;var tt=N.slice(N.l,N.l+fe);switch(ce){case 8:tt=q(N,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Ct=!1;P&8&&(re=N.read_shift(4),re==134695760&&(re=N.read_shift(4),Ct=!0),fe=N.read_shift(4),xe=N.read_shift(4)),fe!=L&&Pn(Ct,"Bad compressed size: "+L+" != "+fe),xe!=O&&Pn(Ct,"Bad uncompressed size: "+O+" != "+xe),$t(M,Le,tt,{unsafe:!0,mt:be})}function Sr(N,L){var O=L||{},M=[],F=[],P=sa(1),ce=O.compression?8:0,be=0,re=0,fe=0,xe=0,Ne=0,Oe=N.FullPaths[0],Le=Oe,ke=N.FileIndex[0],Me=[],tt=0;for(re=1;re<N.FullPaths.length;++re)if(Le=N.FullPaths[re].slice(Oe.length),ke=N.FileIndex[re],!(!ke.size||!ke.content||Le=="Sh33tJ5")){var Ct=xe,kt=sa(Le.length);for(fe=0;fe<Le.length;++fe)kt.write_shift(1,Le.charCodeAt(fe)&127);kt=kt.slice(0,kt.l),Me[Ne]=Hy.buf(ke.content,0);var Mt=ke.content;ce==8&&(Mt=U(Mt)),P=sa(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,be),P.write_shift(2,ce),ke.mt?o(P,ke.mt):P.write_shift(4,0),P.write_shift(-4,Me[Ne]),P.write_shift(4,Mt.length),P.write_shift(4,ke.content.length),P.write_shift(2,kt.length),P.write_shift(2,0),xe+=P.length,M.push(P),xe+=kt.length,M.push(kt),xe+=Mt.length,M.push(Mt),P=sa(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,be),P.write_shift(2,ce),P.write_shift(4,0),P.write_shift(-4,Me[Ne]),P.write_shift(4,Mt.length),P.write_shift(4,ke.content.length),P.write_shift(2,kt.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,Ct),tt+=P.l,F.push(P),tt+=kt.length,F.push(kt),++Ne}return P=sa(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,Ne),P.write_shift(2,Ne),P.write_shift(4,tt),P.write_shift(4,xe),P.write_shift(2,0),jn([jn(M),jn(F),P])}var ln={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ws(N,L){if(N.ctype)return N.ctype;var O=N.name||"",M=O.match(/\.([^\.]+)$/);return M&&ln[M[1]]||L&&(M=(O=L).match(/[\.\\]([^\.\\])+$/),M&&ln[M[1]])?ln[M[1]]:"application/octet-stream"}function Ts(N){for(var L=_m(N),O=[],M=0;M<L.length;M+=76)O.push(L.slice(M,M+76));return O.join(`\r
`)+`\r
`}function Vn(N){var L=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var xe=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],M=L.split(`\r
`),F=0;F<M.length;++F){var P=M[F];if(P.length==0){O.push("");continue}for(var ce=0;ce<P.length;){var be=76,re=P.slice(ce,ce+be);re.charAt(be-1)=="="?be--:re.charAt(be-2)=="="?be-=2:re.charAt(be-3)=="="&&(be-=3),re=P.slice(ce,ce+be),ce+=be,ce<P.length&&(re+="="),O.push(re)}}return O.join(`\r
`)}function Ht(N){for(var L=[],O=0;O<N.length;++O){for(var M=N[O];O<=N.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+N[++O];L.push(M)}for(var F=0;F<L.length;++F)L[F]=L[F].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return Er(L.join(`\r
`))}function Ss(N,L,O){for(var M="",F="",P="",ce,be=0;be<10;++be){var re=L[be];if(!re||re.match(/^\s*$/))break;var fe=re.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":M=fe[2].trim();break;case"content-type":P=fe[2].trim();break;case"content-transfer-encoding":F=fe[2].trim();break}}switch(++be,F.toLowerCase()){case"base64":ce=Er(Wa(L.slice(be).join("")));break;case"quoted-printable":ce=Ht(L.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var xe=$t(N,M.slice(O.length),ce,{unsafe:!0});P&&(xe.ctype=P)}function As(N,L){if(te(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=L&&L.root||"",M=(mt&&Buffer.isBuffer(N)?N.toString("binary"):te(N)).split(`\r
`),F=0,P="";for(F=0;F<M.length;++F)if(P=M[F],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),O||(O=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),P.slice(0,O.length)!=O););var ce=(M[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var be="--"+(ce[1]||""),re=[],fe=[],xe={FileIndex:re,FullPaths:fe};j(xe);var Ne,Oe=0;for(F=0;F<M.length;++F){var Le=M[F];Le!==be&&Le!==be+"--"||(Oe++&&Ss(xe,M.slice(Ne,F),O),Ne=F)}return xe}function dr(N,L){var O=L||{},M=O.boundary||"SheetJS";M="------="+M;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],P=N.FullPaths[0],ce=P,be=N.FileIndex[0],re=1;re<N.FullPaths.length;++re)if(ce=N.FullPaths[re].slice(P.length),be=N.FileIndex[re],!(!be.size||!be.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var fe=be.content,xe=mt&&Buffer.isBuffer(fe)?fe.toString("binary"):te(fe),Ne=0,Oe=Math.min(1024,xe.length),Le=0,ke=0;ke<=Oe;++ke)(Le=xe.charCodeAt(ke))>=32&&Le<128&&++Ne;var Me=Ne>=Oe*4/5;F.push(M),F.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ce),F.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),F.push("Content-Type: "+ws(be,ce)),F.push(""),F.push(Me?Vn(xe):Ts(xe))}return F.push(M+`--\r
`),F.join(`\r
`)}function Xt(N){var L={};return j(L,N),L}function $t(N,L,O,M){var F=M&&M.unsafe;F||j(N);var P=!F&&vt.find(N,L);if(!P){var ce=N.FullPaths[0];L.slice(0,ce.length)==ce?ce=L:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+L).replace("//","/")),P={name:i(L),type:2},N.FileIndex.push(P),N.FullPaths.push(ce),F||vt.utils.cfb_gc(N)}return P.content=O,P.size=O?O.length:0,M&&(M.CLSID&&(P.clsid=M.CLSID),M.mt&&(P.mt=M.mt),M.ct&&(P.ct=M.ct)),P}function hr(N,L){j(N);var O=vt.find(N,L);if(O){for(var M=0;M<N.FileIndex.length;++M)if(N.FileIndex[M]==O)return N.FileIndex.splice(M,1),N.FullPaths.splice(M,1),!0}return!1}function Ye(N,L,O){j(N);var M=vt.find(N,L);if(M){for(var F=0;F<N.FileIndex.length;++F)if(N.FileIndex[F]==M)return N.FileIndex[F].name=i(O),N.FullPaths[F]=O,!0}return!1}function ot(N){B(N,!0)}return n.find=K,n.read=Y,n.parse=p,n.write=H,n.writeFile=Re,n.utils={cfb_new:Xt,cfb_add:$t,cfb_del:hr,cfb_mov:Ye,cfb_gc:ot,ReadShift:bl,CheckField:dg,prep_blob:pa,bconcat:jn,use_zlib:k,_deflateRaw:De,_inflateRaw:_s,consts:ue},n}();function zy(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Mr(e){for(var n=Object.keys(e),a=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e,n[s])&&a.push(n[s]);return a}function gf(e){for(var n=[],a=Mr(e),s=0;s!==a.length;++s)n[e[a[s]]]=a[s];return n}var mo=new Date(1899,11,30,0,0,0);function ja(e,n){var a=e.getTime(),s=mo.getTime()+(e.getTimezoneOffset()-mo.getTimezoneOffset())*6e4;return(a-s)/(1440*60*1e3)}var Yp=new Date,Vy=mo.getTime()+(Yp.getTimezoneOffset()-mo.getTimezoneOffset())*6e4,Om=Yp.getTimezoneOffset();function To(e){var n=new Date;return n.setTime(e*24*60*60*1e3+Vy),n.getTimezoneOffset()!==Om&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Om)*6e4),n}function Gy(e){var n=0,a=0,s=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(a=1,o>3&&(s=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":a*=24;case"H":a*=60;case"M":if(s)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(i[o],10)}return n}var Rm=new Date("2017-02-19T19:06:09.000Z"),Xp=isNaN(Rm.getFullYear())?new Date("2/19/17"):Rm,Yy=Xp.getFullYear()==2017;function da(e,n){var a=new Date(e);if(Yy)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Xp.getFullYear()==1917&&!isNaN(a.getFullYear())){var s=a.getFullYear();return e.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function xs(e,n){if(mt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return vl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return vl(Rp(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return vl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return vl(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return a[o]||o})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function ga(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=ga(e[a]));return n}function Gt(e,n){for(var a="";a.length<n;)a+=e;return a}function Tr(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,o){return a=-a,o}),!isNaN(n=Number(s)))?n/a:n}var Xy=["january","february","march","april","may","june","july","august","september","october","november","december"];function mi(e){var n=new Date(e),a=new Date(NaN),s=n.getYear(),i=n.getMonth(),o=n.getDate();if(isNaN(o))return a;var f=e.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&Xy.indexOf(f)==-1)return a}else if(f.match(/[a-z]/))return a;return s<0||s>8099?a:(i>0||o>1)&&s!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var qy=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,s,i){if(e||typeof s=="string")return a.split(s);for(var o=a.split(s),f=[o[0]],d=1;d<o.length;++d)f.push(i),f.push(o[d]);return f}}();function qp(e){return e?e.content&&e.type?xs(e.content,!0):e.data?ml(e.data):e.asNodeBuffer&&mt?ml(e.asNodeBuffer().toString("binary")):e.asBinary?ml(e.asBinary()):e._data&&e._data.getContent?ml(xs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Kp(e){if(!e)return null;if(e.data)return ym(e.data);if(e.asNodeBuffer&&mt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?ym(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function Ky(e){return e&&e.name.slice(-4)===".bin"?Kp(e):qp(e)}function or(e,n){for(var a=e.FullPaths||Mr(e.files),s=n.toLowerCase().replace(/[\/]/g,"\\"),i=s.replace(/\\/g,"/"),o=0;o<a.length;++o){var f=a[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==f||i==f)return e.files?e.files[a[o]]:e.FileIndex[o]}return null}function vf(e,n){var a=or(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function ea(e,n,a){if(!a)return Ky(vf(e,n));if(!n)return null;try{return ea(e,n)}catch{return null}}function Ka(e,n,a){if(!a)return qp(vf(e,n));if(!n)return null;try{return Ka(e,n)}catch{return null}}function Wy(e,n,a){return Kp(vf(e,n))}function jm(e){for(var n=e.FullPaths||Mr(e.files),a=[],s=0;s<n.length;++s)n[s].slice(-1)!="/"&&a.push(n[s].replace(/^Root Entry[\/]/,""));return a.sort()}function $y(e,n,a){if(e.FullPaths){if(typeof a=="string"){var s;return mt?s=ps(a):s=my(a),vt.utils.cfb_add(e,n,s)}vt.utils.cfb_add(e,n,a)}else e.file(n,a)}function Wp(e,n){switch(n.type){case"base64":return vt.read(e,{type:"base64"});case"binary":return vt.read(e,{type:"binary"});case"buffer":case"array":return vt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function gl(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var s=e.split("/");s.length!==0;){var i=s.shift();i===".."?a.pop():i!=="."&&a.push(i)}return a.join("/")}var $p=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Zy=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Mm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Qy=/<[^>]*>/g,Na=$p.match(Mm)?Mm:Qy,Jy=/<\w*:/,eE=/<(\/?)\w+:/;function Qe(e,n,a){for(var s={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(n||(s[0]=e.slice(0,i)),i===e.length)return s;var f=e.match(Zy),d=0,x="",m=0,p="",v="",b=1;if(f)for(m=0;m!=f.length;++m){for(v=f[m],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(b=(i=v.charCodeAt(o+1))==34||i==39?1:0,x=v.slice(o+1+b,v.length-b),d=0;d!=p.length&&p.charCodeAt(d)!==58;++d);if(d===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),s[p]=x,s[p.toLowerCase()]=x;else{var y=(d===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(d+1);if(s[y]&&p.slice(d-3,d)=="ext")continue;s[y]=x,s[y.toLowerCase()]=x}}return s}function Lr(e){return e.replace(eE,"<$1")}var Zp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tE=gf(Zp),yt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(s){var i=s+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(e,function(d,x){return Zp[d]||String.fromCharCode(parseInt(x,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,x){return String.fromCharCode(parseInt(x,16))});var f=i.indexOf("]]>");return a(i.slice(0,o))+i.slice(o+9,f)+a(i.slice(f+3))}}(),aE=/[&<>'"]/g,rE=/[\u0000-\u001f]/g;function bf(e){var n=e+"";return n.replace(aE,function(a){return tE[a]}).replace(/\n/g,"<br/>").replace(rE,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var Lm=function(){var e=/&#(\d+);/g;function n(a,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,n)}}();function Bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Uu(e){for(var n="",a=0,s=0,i=0,o=0,f=0,d=0;a<e.length;){if(s=e.charCodeAt(a++),s<128){n+=String.fromCharCode(s);continue}if(i=e.charCodeAt(a++),s>191&&s<224){f=(s&31)<<6,f|=i&63,n+=String.fromCharCode(f);continue}if(o=e.charCodeAt(a++),s<240){n+=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63);continue}f=e.charCodeAt(a++),d=((s&7)<<18|(i&63)<<12|(o&63)<<6|f&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function Fm(e){var n=In(2*e.length),a,s,i=1,o=0,f=0,d;for(s=0;s<e.length;s+=i)i=1,(d=e.charCodeAt(s))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(s+1)&63),i=2):d<240?(a=(d&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,a=(d&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),a-=65536,f=55296+(a>>>10&1023),a=56320+(a&1023)),f!==0&&(n[o++]=f&255,n[o++]=f>>>8,f=0),n[o++]=a%256,n[o++]=a>>>8;return n.slice(0,o).toString("ucs2")}function Im(e){return ps(e,"binary").toString("utf8")}var eo="foo bar baz",Ft=mt&&(Im(eo)==Uu(eo)&&Im||Fm(eo)==Uu(eo)&&Fm)||Uu,vl=mt?function(e){return ps(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,s=0,i=0;a<e.length;)switch(s=e.charCodeAt(a++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(a++)-56320+(s<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},Ol=function(){var e={};return function(a,s){var i=a+"|"+(s||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",s||"")}}(),Qp=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),nE=function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),sE=/<\/?(?:vt:)?variant>/g,iE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Bm(e,n){var a=Qe(e),s=e.match(nE(a.baseType))||[],i=[];if(s.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+s.length+" != "+a.size);return i}return s.forEach(function(o){var f=o.replace(sE,"").match(iE);f&&i.push({v:Ft(f[2]),t:f[1]})}),i}var lE=/(^\s|\s$|\n)/;function cE(e){return Mr(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function oE(e,n,a){return"<"+e+(a!=null?cE(a):"")+(n!=null?(n.match(lE)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function yf(e){if(mt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ft(gs(xf(e)));throw new Error("Bad input format: expected Buffer or string")}var Rl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,uE={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},fE=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function dE(e,n){for(var a=1-2*(e[n+7]>>>7),s=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),i=e[n+6]&15,o=5;o>=0;--o)i=i*256+e[n+o];return s==2047?i==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),a*Math.pow(2,s-52)*i)}function hE(e,n,a){var s=(n<0||1/n==-1/0?1:0)<<7,i=0,o=0,f=s?-n:n;isFinite(f)?f==0?i=o=0:(i=Math.floor(Math.log(f)/Math.LN2),o=f*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(n)?26985:0);for(var d=0;d<=5;++d,o/=256)e[a+d]=o&255;e[a+6]=(i&15)<<4|o&15,e[a+7]=i>>4|s}var Um=function(e){for(var n=[],a=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,o=e[0][s].length;i<o;i+=a)n.push.apply(n,e[0][s].slice(i,i+a));return n},Pm=mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ps(n)})):Um(e)}:Um,Hm=function(e,n,a){for(var s=[],i=n;i<a;i+=2)s.push(String.fromCharCode(Jr(e,i)));return s.join("").replace(Ra,"")},Ef=mt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(Ra,""):Hm(e,n,a)}:Hm,zm=function(e,n,a){for(var s=[],i=n;i<n+a;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},Jp=mt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):zm(e,n,a)}:zm,Vm=function(e,n,a){for(var s=[],i=n;i<a;i++)s.push(String.fromCharCode(li(e,i)));return s.join("")},Bl=mt?function(n,a,s){return Buffer.isBuffer(n)?n.toString("utf8",a,s):Vm(n,a,s)}:Vm,eg=function(e,n){var a=qa(e,n);return a>0?Bl(e,n+4,n+4+a-1):""},tg=eg,ag=function(e,n){var a=qa(e,n);return a>0?Bl(e,n+4,n+4+a-1):""},rg=ag,ng=function(e,n){var a=2*qa(e,n);return a>0?Bl(e,n+4,n+4+a-1):""},sg=ng,ig=function(n,a){var s=qa(n,a);return s>0?Ef(n,a+4,a+4+s):""},lg=ig,cg=function(e,n){var a=qa(e,n);return a>0?Bl(e,n+4,n+4+a):""},og=cg,ug=function(e,n){return dE(e,n)},po=ug,fg=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};mt&&(tg=function(n,a){if(!Buffer.isBuffer(n))return eg(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},rg=function(n,a){if(!Buffer.isBuffer(n))return ag(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},sg=function(n,a){if(!Buffer.isBuffer(n))return ng(n,a);var s=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s-1)},lg=function(n,a){if(!Buffer.isBuffer(n))return ig(n,a);var s=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s)},og=function(n,a){if(!Buffer.isBuffer(n))return cg(n,a);var s=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+s)},po=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):ug(n,a)},fg=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var li=function(e,n){return e[n]},Jr=function(e,n){return e[n+1]*256+e[n]},xE=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},qa=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},os=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},mE=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function bl(e,n){var a="",s,i,o=[],f,d,x,m;switch(n){case"dbcs":if(m=this.l,mt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(x=0;x<e;++x)a+=String.fromCharCode(Jr(this,m)),m+=2;e*=2;break;case"utf8":a=Bl(this,this.l,this.l+e);break;case"utf16le":e*=2,a=Ef(this,this.l,this.l+e);break;case"wstr":return bl.call(this,e,"dbcs");case"lpstr-ansi":a=tg(this,this.l),e=4+qa(this,this.l);break;case"lpstr-cp":a=rg(this,this.l),e=4+qa(this,this.l);break;case"lpwstr":a=sg(this,this.l),e=4+2*qa(this,this.l);break;case"lpp4":e=4+qa(this,this.l),a=lg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qa(this,this.l),a=og(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(f=li(this,this.l+e++))!==0;)o.push(Jc(f));a=o.join("");break;case"_wstr":for(e=0,a="";(f=Jr(this,this.l+e))!==0;)o.push(Jc(f)),e+=2;e+=2,a=o.join("");break;case"dbcs-cont":for(a="",m=this.l,x=0;x<e;++x){if(this.lens&&this.lens.indexOf(m)!==-1)return f=li(this,m),this.l=m+1,d=bl.call(this,e-x,f?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Jc(Jr(this,m))),m+=2}a=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",m=this.l,x=0;x!=e;++x){if(this.lens&&this.lens.indexOf(m)!==-1)return f=li(this,m),this.l=m+1,d=bl.call(this,e-x,f?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Jc(li(this,m))),m+=1}a=o.join("");break;default:switch(e){case 1:return s=li(this,this.l),this.l++,s;case 2:return s=(n==="i"?xE:Jr)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(e>0?os:mE)(this,this.l),this.l+=4,s):(i=qa(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return e==8?i=po(this,this.l):i=po([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:a=Jp(this,this.l,e);break}}return this.l+=e,a}var pE=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},gE=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},vE=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function bE(e,n,a){var s=0,i=0;if(a==="dbcs"){for(i=0;i!=n.length;++i)vE(this,n.charCodeAt(i),this.l+2*i);s=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;s=n.length}else if(a==="hex"){for(;i<e;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(a==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(n.length,e);++i){var f=n.charCodeAt(i);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,pE(this,n,this.l);break;case 8:if(s=8,a==="f"){hE(this,n,this.l);break}case 16:break;case-4:s=4,gE(this,n,this.l);break}return this.l+=s,this}function dg(e,n){var a=Jp(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function pa(e,n){e.l=n,e.read_shift=bl,e.chk=dg,e.write_shift=bE}function Aa(e,n){e.l+=n}function sa(e){var n=In(e);return pa(n,0),n}function nn(e,n,a){if(e){var s,i,o;pa(e,e.l||0);for(var f=e.length,d=0,x=0;e.l<f;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var m=_o[d]||_o[65535];for(s=e.read_shift(1),o=s&127,i=1;i<4&&s&128;++i)o+=((s=e.read_shift(1))&127)<<7*i;x=e.l+o;var p=m.f&&m.f(e,o,a);if(e.l=x,n(p,m,d))return}}}function Zu(){var e=[],n=mt?256:2048,a=function(m){var p=sa(m);return pa(p,0),p},s=a(n),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(m){return s&&m<s.length-s.l?s:(i(),s=a(Math.max(m+1,n)))},f=function(){return i(),jn(e)},d=function(m){i(),s=m,s.l==null&&(s.l=s.length),o(n)};return{next:o,push:d,end:f,_bufs:e}}function yl(e,n,a){var s=ga(e);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Gm(e,n,a){var s=ga(e);return s.s=yl(s.s,n.s,a),s.e=yl(s.e,n.s,a),s}function El(e,n){if(e.cRel&&e.c<0)for(e=ga(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=ga(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=at(e);return!e.cRel&&e.cRel!=null&&(a=_E(a)),!e.rRel&&e.rRel!=null&&(a=yE(a)),a}function Pu(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ia(e.s.c)+":"+(e.e.cRel?"":"$")+ia(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+va(e.s.r)+":"+(e.e.rRel?"":"$")+va(e.e.r):El(e.s,n.biff)+":"+El(e.e,n.biff)}function _f(e){return parseInt(EE(e),10)-1}function va(e){return""+(e+1)}function yE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function EE(e){return e.replace(/\$(\d+)$/,"$1")}function wf(e){for(var n=wE(e),a=0,s=0;s!==n.length;++s)a=26*a+n.charCodeAt(s)-64;return a-1}function ia(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function _E(e){return e.replace(/^([A-Z])/,"$$$1")}function wE(e){return e.replace(/^\$([A-Z])/,"$1")}function TE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Oa(e){for(var n=0,a=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(a=26*a+(i-64))}return{c:a-1,r:n-1}}function at(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function vi(e){var n=e.indexOf(":");return n==-1?{s:Oa(e),e:Oa(e)}:{s:Oa(e.slice(0,n)),e:Oa(e.slice(n+1))}}function bt(e,n){return typeof n>"u"||typeof n=="number"?bt(e.s,e.e):(typeof e!="string"&&(e=at(e)),typeof n!="string"&&(n=at(n)),e==n?e:e+":"+n)}function Yt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,i=0,o=e.length;for(a=0;s<o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)a=26*a+i;for(n.s.c=--a,a=0;s<o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)a=10*a+i;if(n.s.r=--a,s===o||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,a=0;s!=o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)a=26*a+i;for(n.e.c=--a,a=0;s!=o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)a=10*a+i;return n.e.r=--a,n}function Ym(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=ur(e.z,a?ja(n):n)}catch{}try{return e.w=ur((e.XF||{}).numFmtId||(a?14:0),a?ja(n):n)}catch{return""+n}}function an(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?ys[e.v]||e.v:n==null?Ym(e,e.v):Ym(e,n))}function Un(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",s={};return s[a]=e,{SheetNames:[a],Sheets:s}}function hg(e,n,a){var s=a||{},i=e?Array.isArray(e):s.dense,o=e||(i?[]:{}),f=0,d=0;if(o&&s.origin!=null){if(typeof s.origin=="number")f=s.origin;else{var x=typeof s.origin=="string"?Oa(s.origin):s.origin;f=x.r,d=x.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Yt(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),f==-1&&(m.e.r=f=p.e.r+1)}for(var v=0;v!=n.length;++v)if(n[v]){if(!Array.isArray(n[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=n[v].length;++b)if(!(typeof n[v][b]>"u")){var y={v:n[v][b]},E=f+v,_=d+b;if(m.s.r>E&&(m.s.r=E),m.s.c>_&&(m.s.c=_),m.e.r<E&&(m.e.r=E),m.e.c<_&&(m.e.c=_),n[v][b]&&typeof n[v][b]=="object"&&!Array.isArray(n[v][b])&&!(n[v][b]instanceof Date))y=n[v][b];else if(Array.isArray(y.v)&&(y.f=n[v][b][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(s.nullError)y.t="e",y.v=0;else if(s.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=s.dateNF||st[14],s.cellDates?(y.t="d",y.w=ur(y.z,ja(y.v))):(y.t="n",y.v=ja(y.v),y.w=ur(y.z,y.v))):y.t="s";if(i)o[E]||(o[E]=[]),o[E][_]&&o[E][_].z&&(y.z=o[E][_].z),o[E][_]=y;else{var w=at({c:_,r:E});o[w]&&o[w].z&&(y.z=o[w].z),o[w]=y}}}return m.s.c<1e7&&(o["!ref"]=bt(m)),o}function bi(e,n){return hg(null,e,n)}function SE(e){return e.read_shift(4,"i")}function Sa(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function AE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Tf(e,n){var a=e.l,s=e.read_shift(1),i=Sa(e),o=[],f={t:i,h:i};if((s&1)!==0){for(var d=e.read_shift(4),x=0;x!=d;++x)o.push(AE(e));f.r=o}else f.r=[{ich:0,ifnt:0}];return e.l=a+n,f}var NE=Tf;function fr(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function vs(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var CE=Sa;function Sf(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var kE=Sa,Qu=Sf;function Af(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,s=n[0]&2;e.l+=4;var i=s===0?po([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):os(n,0)>>2;return a?i/100:i}function xg(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var bs=xg;function wa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function DE(e){var n={},a=e.read_shift(1),s=a>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),f=e.read_shift(1),d=e.read_shift(1),x=e.read_shift(1);switch(e.l++,s){case 0:n.auto=1;break;case 1:n.index=i;var m=ds[i];m&&(n.rgb=Ml(m));break;case 2:n.rgb=Ml([f,d,x]);break;case 3:n.theme=i;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function OE(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function mg(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function RE(e){return mg(e,1)}function jE(e){return mg(e,2)}var Nf=2,Ba=3,to=11,Xm=12,go=19,ao=64,ME=65,LE=71,FE=4108,IE=4126,fa=80,pg=81,BE=[fa,pg],UE={1:{n:"CodePage",t:Nf},2:{n:"Category",t:fa},3:{n:"PresentationFormat",t:fa},4:{n:"ByteCount",t:Ba},5:{n:"LineCount",t:Ba},6:{n:"ParagraphCount",t:Ba},7:{n:"SlideCount",t:Ba},8:{n:"NoteCount",t:Ba},9:{n:"HiddenCount",t:Ba},10:{n:"MultimediaClipCount",t:Ba},11:{n:"ScaleCrop",t:to},12:{n:"HeadingPairs",t:FE},13:{n:"TitlesOfParts",t:IE},14:{n:"Manager",t:fa},15:{n:"Company",t:fa},16:{n:"LinksUpToDate",t:to},17:{n:"CharacterCount",t:Ba},19:{n:"SharedDoc",t:to},22:{n:"HyperlinksChanged",t:to},23:{n:"AppVersion",t:Ba,p:"version"},24:{n:"DigSig",t:ME},26:{n:"ContentType",t:fa},27:{n:"ContentStatus",t:fa},28:{n:"Language",t:fa},29:{n:"Version",t:fa},255:{},2147483648:{n:"Locale",t:go},2147483651:{n:"Behavior",t:go},1919054434:{}},PE={1:{n:"CodePage",t:Nf},2:{n:"Title",t:fa},3:{n:"Subject",t:fa},4:{n:"Author",t:fa},5:{n:"Keywords",t:fa},6:{n:"Comments",t:fa},7:{n:"Template",t:fa},8:{n:"LastAuthor",t:fa},9:{n:"RevNumber",t:fa},10:{n:"EditTime",t:ao},11:{n:"LastPrinted",t:ao},12:{n:"CreatedDate",t:ao},13:{n:"ModifiedDate",t:ao},14:{n:"PageCount",t:Ba},15:{n:"WordCount",t:Ba},16:{n:"CharCount",t:Ba},17:{n:"Thumbnail",t:LE},18:{n:"Application",t:fa},19:{n:"DocSecurity",t:Ba},255:{},2147483648:{n:"Locale",t:go},2147483651:{n:"Behavior",t:go},1919054434:{}},qm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},HE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function zE(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var VE=zE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ds=ga(VE),ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},gg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Km={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function GE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YE(e){var n=GE();if(!e||!e.match)return n;var a={};if((e.match(Na)||[]).forEach(function(s){var i=Qe(s);switch(i[0].replace(Jy,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[i.Extension]=i.ContentType;break;case"<Override":n[Km[i.ContentType]]!==void 0&&n[Km[i.ContentType]].push(i.PartName);break}}),n.xmlns!==uE.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}var ui={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ju(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function _l(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var s={};return(e.match(Na)||[]).forEach(function(i){var o=Qe(i);if(o[0]==="<Relationship"){var f={};f.Type=o.Type,f.Target=o.Target,f.Id=o.Id,o.TargetMode&&(f.TargetMode=o.TargetMode);var d=o.TargetMode==="External"?o.Target:gl(o.Target,n);a[d]=f,s[o.Id]=f}}),a["!id"]=s,a}var XE="application/vnd.oasis.opendocument.spreadsheet";function qE(e,n){for(var a=yf(e),s,i;s=Rl.exec(a);)switch(s[3]){case"manifest":break;case"file-entry":if(i=Qe(s[0],!1),i.path=="/"&&i.type!==XE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw s}}var wl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],KE=function(){for(var e=new Array(wl.length),n=0;n<wl.length;++n){var a=wl[n],s="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function vg(e){var n={};e=Ft(e);for(var a=0;a<wl.length;++a){var s=wl[a],i=e.match(KE[a]);i!=null&&i.length>0&&(n[s[1]]=yt(i[1])),s[2]==="date"&&n[s[1]]&&(n[s[1]]=da(n[s[1]]))}return n}var WE=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function bg(e,n,a,s){var i=[];if(typeof e=="string")i=Bm(e,s);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(p){return{v:p}}));var f=typeof n=="string"?Bm(n,s).map(function(p){return p.v}):n,d=0,x=0;if(f.length>0)for(var m=0;m!==i.length;m+=2){switch(x=+i[m+1].v,i[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=x,a.SheetNames=f.slice(d,d+x);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=x,a.DefinedNames=f.slice(d,d+x);break;case"Charts":case"Diagramme":a.Chartsheets=x,a.ChartNames=f.slice(d,d+x);break}d+=x}}function $E(e,n,a){var s={};return n||(n={}),e=Ft(e),WE.forEach(function(i){var o=(e.match(Ol(i[0]))||[])[1];switch(i[2]){case"string":o&&(n[i[1]]=yt(o));break;case"bool":n[i[1]]=o==="true";break;case"raw":var f=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));f&&f.length>0&&(s[i[1]]=f[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&bg(s.HeadingPairs,s.TitlesOfParts,n,a),n}var ZE=/<[^>]+>[^<]*/g;function QE(e,n){var a={},s="",i=e.match(ZE);if(i)for(var o=0;o!=i.length;++o){var f=i[o],d=Qe(f);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":s=yt(d.name);break;case"</property>":s=null;break;default:if(f.indexOf("<vt:")===0){var x=f.split(">"),m=x[0].slice(4),p=x[1];switch(m){case"lpstr":case"bstr":case"lpwstr":a[s]=yt(p);break;case"bool":a[s]=Bt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[s]=parseInt(p,10);break;case"r4":case"r8":case"decimal":a[s]=parseFloat(p);break;case"filetime":case"date":a[s]=da(p);break;case"cy":case"error":a[s]=yt(p);break;default:if(m.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",f,m,x)}}else if(f.slice(0,2)!=="</"){if(n.WTF)throw new Error(f)}}}return a}var JE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hu;function e4(e,n,a){Hu||(Hu=gf(JE)),n=Hu[n]||n,e[n]=a}function Cf(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function yg(e,n,a){var s=e.l,i=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-s&3;)++e.l;return i}function Eg(e,n,a){var s=e.read_shift(0,"lpwstr");return s}function _g(e,n,a){return n===31?Eg(e):yg(e,n,a)}function ef(e,n,a){return _g(e,n,a===!1?0:4)}function t4(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return _g(e,n,0)}function a4(e){for(var n=e.read_shift(4),a=[],s=0;s!=n;++s){var i=e.l;a[s]=e.read_shift(0,"lpwstr").replace(Ra,""),e.l-i&2&&(e.l+=2)}return a}function r4(e){for(var n=e.read_shift(4),a=[],s=0;s!=n;++s)a[s]=e.read_shift(0,"lpstr-cp").replace(Ra,"");return a}function n4(e){var n=e.l,a=vo(e,pg);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var s=vo(e,Ba);return[a,s]}function s4(e){for(var n=e.read_shift(4),a=[],s=0;s<n/2;++s)a.push(n4(e));return a}function Wm(e,n){for(var a=e.read_shift(4),s={},i=0;i!=a;++i){var o=e.read_shift(4),f=e.read_shift(4);s[o]=e.read_shift(f,n===1200?"utf16le":"utf8").replace(Ra,"").replace(pl,"!"),n===1200&&f%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function wg(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function i4(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function vo(e,n,a){var s=e.read_shift(2),i,o=a||{};if(e.l+=2,n!==Xm&&s!==n&&BE.indexOf(n)===-1&&!((n&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+n+" saw "+s);switch(n===Xm?s:n){case 2:return i=e.read_shift(2,"i"),o.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return yg(e,s,4).replace(Ra,"");case 31:return Eg(e);case 64:return Cf(e);case 65:return wg(e);case 71:return i4(e);case 80:return ef(e,s,!o.raw).replace(Ra,"");case 81:return t4(e,s).replace(Ra,"");case 4108:return s4(e);case 4126:case 4127:return s==4127?a4(e):r4(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+s)}}function $m(e,n){var a=e.l,s=e.read_shift(4),i=e.read_shift(4),o=[],f=0,d=0,x=-1,m={};for(f=0;f!=i;++f){var p=e.read_shift(4),v=e.read_shift(4);o[f]=[p,v+a]}o.sort(function(D,A){return D[1]-A[1]});var b={};for(f=0;f!=i;++f){if(e.l!==o[f][1]){var y=!0;if(f>0&&n)switch(n[o[f-1][0]].t){case 2:e.l+2===o[f][1]&&(e.l+=2,y=!1);break;case 80:e.l<=o[f][1]&&(e.l=o[f][1],y=!1);break;case 4108:e.l<=o[f][1]&&(e.l=o[f][1],y=!1);break}if((!n||f==0)&&e.l<=o[f][1]&&(y=!1,e.l=o[f][1]),y)throw new Error("Read Error: Expected address "+o[f][1]+" at "+e.l+" :"+f)}if(n){var E=n[o[f][0]];if(b[E.n]=vo(e,E.t,{raw:!0}),E.p==="version"&&(b[E.n]=String(b[E.n]>>16)+"."+("0000"+String(b[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(b[E.n]){case 0:b[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:_r(d=b[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+b[E.n])}}else if(o[f][0]===1){if(d=b.CodePage=vo(e,Nf),_r(d),x!==-1){var _=e.l;e.l=o[x][1],m=Wm(e,d),e.l=_}}else if(o[f][0]===0){if(d===0){x=f,e.l=o[f+1][1];continue}m=Wm(e,d)}else{var w=m[o[f][0]],S;switch(e[e.l]){case 65:e.l+=4,S=wg(e);break;case 30:e.l+=4,S=ef(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=ef(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=Wt(e,4);break;case 64:e.l+=4,S=da(Cf(e));break;default:throw new Error("unparsed value: "+e[e.l])}b[w]=S}}return e.l=a+s,b}function Zm(e,n,a){var s=e.content;if(!s)return{};pa(s,0);var i,o,f,d,x=0;s.chk("feff","Byte Order: "),s.read_shift(2);var m=s.read_shift(4),p=s.read_shift(16);if(p!==vt.utils.consts.HEADER_CLSID&&p!==a)throw new Error("Bad PropertySet CLSID "+p);if(i=s.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=s.read_shift(16),d=s.read_shift(4),i===1&&d!==s.l)throw new Error("Length mismatch: "+d+" !== "+s.l);i===2&&(f=s.read_shift(16),x=s.read_shift(4));var v=$m(s,n),b={SystemIdentifier:m};for(var y in v)b[y]=v[y];if(b.FMTID=o,i===1)return b;if(x-s.l==2&&(s.l+=2),s.l!==x)throw new Error("Length mismatch 2: "+s.l+" !== "+x);var E;try{E=$m(s,null)}catch{}for(y in E)b[y]=E[y];return b.FMTID=[o,f],b}function On(e,n){return e.read_shift(n),null}function l4(e,n,a){for(var s=[],i=e.l+n;e.l<i;)s.push(a(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return s}function Wt(e,n){return e.read_shift(n)===1}function ta(e){return e.read_shift(2,"u")}function Tg(e,n){return l4(e,n,ta)}function c4(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function Ul(e,n,a){var s=e.read_shift(a&&a.biff>=12?2:1),i="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else a.biff==12&&(i="wstr");a.biff>=2&&a.biff<=5&&(i="cpstr");var f=s?e.read_shift(s,i):"";return f}function o4(e){var n=e.read_shift(2),a=e.read_shift(1),s=a&4,i=a&8,o=1+(a&1),f=0,d,x={};i&&(f=e.read_shift(2)),s&&(d=e.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,m);return i&&(e.l+=4*f),s&&(e.l+=d),x.t=p,i||(x.raw="<t>"+x.t+"</t>",x.r=x.t),x}function ms(e,n,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(n,"sbcs-cont"):s=e.read_shift(n,"dbcs-cont"),s}function Pl(e,n,a){var s=e.read_shift(a&&a.biff==2?1:2);return s===0?(e.l++,""):ms(e,s,a)}function Es(e,n,a){if(a.biff>5)return Pl(e,n,a);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function u4(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function f4(e){var n=e.read_shift(4),a=e.l,s=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=a);var i=e.read_shift((s?n-24:n)>>1,"utf16le").replace(Ra,"");return s&&(e.l+=24),i}function d4(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return a+s.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var f=e.read_shift(o>>1,"utf16le").replace(Ra,"");return a+f}function h4(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return f4(e);case"0303000000000000c000000000000046":return d4(e);default:throw new Error("Unsupported Moniker "+a)}}function ro(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(Ra,""):"";return a}function x4(e,n){var a=e.l+n,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var i=e.read_shift(2);e.l+=2;var o,f,d,x,m="",p,v;i&16&&(o=ro(e,a-e.l)),i&128&&(f=ro(e,a-e.l)),(i&257)===257&&(d=ro(e,a-e.l)),(i&257)===1&&(x=h4(e,a-e.l)),i&8&&(m=ro(e,a-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(v=Cf(e)),e.l=a;var b=f||d||x||"";b&&m&&(b+="#"+m),b||(b="#"+m),i&2&&b.charAt(0)=="/"&&b.charAt(1)!="/"&&(b="file://"+b);var y={Target:b};return p&&(y.guid=p),v&&(y.time=v),o&&(y.Tooltip=o),y}function Sg(e){var n=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1),i=e.read_shift(1);return[n,a,s,i]}function Ag(e,n){var a=Sg(e);return a[3]=0,a}function Fr(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{r:n,c:a,ixfe:s}}function m4(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function p4(e,n,a){return n===0?"":Es(e,n,a)}function g4(e,n,a){var s=a.biff>8?4:2,i=e.read_shift(s),o=e.read_shift(s,"i"),f=e.read_shift(s,"i");return[i,o,f]}function Ng(e){var n=e.read_shift(2),a=Af(e);return[n,a]}function v4(e,n,a){e.l+=4,n-=4;var s=e.l+n,i=Ul(e,n,a),o=e.read_shift(2);if(s-=e.l,o!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+o);return e.l+=o,i}function So(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:n},e:{c:i,r:a}}}function Cg(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1);return{s:{c:s,r:n},e:{c:i,r:a}}}var b4=Cg;function kg(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[a,n,s]}function y4(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function E4(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Ea(e){e.l+=2,e.l+=e.read_shift(2)}var _4={0:Ea,4:Ea,5:Ea,6:Ea,7:E4,8:Ea,9:Ea,10:Ea,11:Ea,12:Ea,13:y4,14:Ea,15:Ea,16:Ea,17:Ea,18:Ea,19:Ea,20:Ea,21:kg};function w4(e,n){for(var a=e.l+n,s=[];e.l<a;){var i=e.read_shift(2);e.l-=2;try{s.push(_4[i](e,a-e.l))}catch{return e.l=a,s}}return e.l!=a&&(e.l=a),s}function no(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function T4(e,n){return n===0||e.read_shift(2),1200}function S4(e,n,a){if(a.enc)return e.l+=n,"";var s=e.l,i=Es(e,0,a);return e.read_shift(n+s-e.l),i}function A4(e,n,a){var s=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function N4(e,n,a){var s=e.read_shift(4),i=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var f=Ul(e,0,a);return f.length===0&&(f="Sheet1"),{pos:s,hs:i,dt:o,name:f}}function C4(e,n){for(var a=e.l+n,s=e.read_shift(4),i=e.read_shift(4),o=[],f=0;f!=i&&e.l<a;++f)o.push(o4(e));return o.Count=s,o.Unique=i,o}function k4(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function D4(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(n.level=s&7),s&32&&(n.hidden=!0),s&64&&(n.hpt=a/20),n}function O4(e){var n=m4(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function R4(e){return e.read_shift(2),e.read_shift(4)}function Qm(e,n,a){var s=0;a&&a.biff==2||(s=e.read_shift(2));var i=e.read_shift(2);a&&a.biff==2&&(s=1-(i>>15),i&=32767);var o={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[o,i]}function j4(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),x=e.read_shift(2),m=e.read_shift(2);return{Pos:[n,a],Dim:[s,i],Flags:o,CurTab:f,FirstTab:d,Selected:x,TabRatio:m}}function M4(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function L4(){}function F4(e,n,a){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Ul(e,0,a),s}function I4(e){var n=Fr(e);return n.isst=e.read_shift(4),n}function B4(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=e.l+n,i=Fr(e);a.biff==2&&e.l++;var o=Pl(e,s-e.l,a);return i.val=o,i}function U4(e,n,a){var s=e.read_shift(2),i=Es(e,0,a);return[s,i]}var P4=Es;function Jm(e,n,a){var s=e.l+n,i=a.biff==8||!a.biff?4:2,o=e.read_shift(i),f=e.read_shift(i),d=e.read_shift(2),x=e.read_shift(2);return e.l=s,{s:{r:o,c:d},e:{r:f,c:x}}}function H4(e){var n=e.read_shift(2),a=e.read_shift(2),s=Ng(e);return{r:n,c:a,ixfe:s[0],rknum:s[1]}}function z4(e,n){for(var a=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),o=[];e.l<a;)o.push(Ng(e));if(e.l!==a)throw new Error("MulRK read error");var f=e.read_shift(2);if(o.length!=f-i+1)throw new Error("MulRK length mismatch");return{r:s,c:i,C:f,rkrec:o}}function V4(e,n){for(var a=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),o=[];e.l<a;)o.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var f=e.read_shift(2);if(o.length!=f-i+1)throw new Error("MulBlank length mismatch");return{r:s,c:i,C:f,ixfe:o}}function G4(e,n,a,s){var i={},o=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(4),x=e.read_shift(2);return i.patternType=HE[d>>26],s.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=f&15,i.dgRight=f>>4&15,i.dgTop=f>>8&15,i.dgBottom=f>>12&15,i.icvLeft=f>>16&127,i.icvRight=f>>23&127,i.grbitDiag=f>>30&3,i.icvTop=d&127,i.icvBottom=d>>7&127,i.icvDiag=d>>14&127,i.dgDiag=d>>21&15,i.icvFore=x&127,i.icvBack=x>>7&127,i.fsxButton=x>>14&1),i}function Y4(e,n,a){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,n-=6,s.data=G4(e,n,s.fStyle,a),s}function X4(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function ep(e,n,a){var s=Fr(e);(a.biff==2||n==9)&&++e.l;var i=c4(e);return s.val=i,s.t=i===!0||i===!1?"b":"e",s}function q4(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=Fr(e),i=wa(e);return s.val=i,s}var tp=p4;function K4(e,n,a){var s=e.l+n,i=e.read_shift(2),o=e.read_shift(2);if(a.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var f=ms(e,o),d=[];s>e.l;)d.push(Pl(e));return[o,i,f,d]}function ap(e,n,a){var s=e.read_shift(2),i,o={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return a.sbcch===14849&&(i=v4(e,n-2,a)),o.body=i||e.read_shift(n-2),typeof i=="string"&&(o.Name=i),o}var W4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rp(e,n,a){var s=e.l+n,i=e.read_shift(2),o=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),x=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),x=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var m=ms(e,f,a);i&32&&(m=W4[m.charCodeAt(0)]);var p=s-e.l;a&&a.biff==2&&--p;var v=s==e.l||d===0||!(p>0)?[]:DS(e,p,a,d);return{chKey:o,Name:m,itab:x,rgce:v}}function Dg(e,n,a){if(a.biff<8)return $4(e,n,a);for(var s=[],i=e.l+n,o=e.read_shift(a.biff>8?4:2);o--!==0;)s.push(g4(e,a.biff>8?12:6,a));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function $4(e,n,a){e[e.l+1]==3&&e[e.l]++;var s=Ul(e,n,a);return s.charCodeAt(0)==3?s.slice(1):s}function Z4(e,n,a){if(a.biff<8){e.l+=n;return}var s=e.read_shift(2),i=e.read_shift(2),o=ms(e,s,a),f=ms(e,i,a);return[o,f]}function Q4(e,n,a){var s=Cg(e);e.l++;var i=e.read_shift(1);return n-=8,[OS(e,n,a),i,s]}function np(e,n,a){var s=b4(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[s,CS(e,n,a)]}function J4(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,s=e.read_shift(4);return[n,a,s]}function e_(e,n,a){if(!(a.biff<8)){var s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),d=Es(e,0,a);return a.biff<8&&e.read_shift(1),[{r:s,c:i},d,f,o]}}function t_(e,n,a){return e_(e,n,a)}function a_(e,n){for(var a=[],s=e.read_shift(2);s--;)a.push(So(e));return a}function r_(e,n,a){if(a&&a.biff<8)return s_(e,n,a);var s=kg(e),i=w4(e,n-22,s[1]);return{cmo:s,ft:i}}var n_={8:function(e,n){var a=e.l+n;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=a,{fmt:s}}};function s_(e,n,a){e.l+=4;var s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var f=[];return f.push((n_[s]||Aa)(e,n,a)),{cmo:[i,s,o],ft:f}}function i_(e,n,a){var s=e.l,i="";try{e.l+=4;var o=(a.lastobj||{cmo:[0,0]}).cmo[1],f;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:f=u4(e,6,a);var d=e.read_shift(2);e.read_shift(2),ta(e,2);var x=e.read_shift(2);e.l+=x;for(var m=1;m<e.lens.length-1;++m){if(e.l-s!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],v=ms(e,e.lens[m+1]-e.lens[m]-1);if(i+=v,i.length>=(p?d:2*d))break}if(i.length!==d&&i.length!==d*2)throw new Error("cchText: "+d+" != "+i.length);return e.l=s+n,{t:i}}catch{return e.l=s+n,{t:i}}}function l_(e,n){var a=So(e);e.l+=16;var s=x4(e,n-24);return[a,s]}function c_(e,n){e.read_shift(2);var a=So(e),s=e.read_shift((n-10)/2,"dbcs-cont");return s=s.replace(Ra,""),[a,s]}function o_(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=qm[a]||a,a=e.read_shift(2),n[1]=qm[a]||a,n}function u_(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Ag(e));return a}function f_(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Ag(e));return a}function d_(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Og(e,n,a){if(!a.cellStyles)return Aa(e,n);var s=a&&a.biff>=12?4:2,i=e.read_shift(s),o=e.read_shift(s),f=e.read_shift(s),d=e.read_shift(s),x=e.read_shift(2);s==2&&(e.l+=2);var m={s:i,e:o,w:f,ixfe:d,flags:x};return(a.biff>=5||!a.biff)&&(m.level=x>>8&7),m}function h_(e,n){var a={};return n<32||(e.l+=16,a.header=wa(e),a.footer=wa(e),e.l+=2),a}function x_(e,n,a){var s={area:!1};if(a.biff!=5)return e.l+=n,s;var i=e.read_shift(1);return e.l+=3,i&16&&(s.area=!0),s}var m_=Fr,p_=Tg,g_=Pl;function v_(e){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),i={fmt:n,env:a,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,i}function b_(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var s=Fr(e);++e.l;var i=Es(e,n-7,a);return s.t="str",s.val=i,s}function y_(e){var n=Fr(e);++e.l;var a=wa(e);return n.t="n",n.val=a,n}function E_(e){var n=Fr(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function __(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function w_(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function T_(e,n,a){var s=e.l+n,i=Fr(e),o=e.read_shift(2),f=ms(e,o,a);return e.l=s,i.t="str",i.val=f,i}var S_=[2,3,48,49,131,139,140,245],sp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=gf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,x){var m=[],p=In(1);switch(x.type){case"base64":p=Er(Wa(d));break;case"binary":p=Er(d);break;case"buffer":case"array":p=d;break}pa(p,0);var v=p.read_shift(1),b=!!(v&136),y=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,b=!0;break;case 49:y=!0,b=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,w=521;v==2&&(_=p.read_shift(2)),p.l+=3,v!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(w=p.read_shift(2));var S=p.read_shift(2),D=x.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(D=e[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var A=[],z={},V=Math.min(p.length,v==2?521:w-10-(y?264:0)),Y=E?32:11;p.l<V&&p[p.l]!=13;)switch(z={},z.name=kl.utils.decode(D,p.slice(p.l,p.l+Y)).replace(/[\u0000\r\n].*$/g,""),p.l+=Y,z.type=String.fromCharCode(p.read_shift(1)),v!=2&&!E&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),v==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&A.push(z),v!=2&&(p.l+=E?13:14),z.type){case"B":(!y||z.len!=8)&&x.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":x.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var j=0,Q=0;for(m[0]=[],Q=0;Q!=A.length;++Q)m[0][Q]=A[Q].name;for(;_-- >0;){if(p[p.l]===42){p.l+=S;continue}for(++p.l,m[++j]=[],Q=0,Q=0;Q!=A.length;++Q){var B=p.slice(p.l,p.l+A[Q].len);p.l+=A[Q].len,pa(B,0);var ne=kl.utils.decode(D,B);switch(A[Q].type){case"C":ne.trim().length&&(m[j][Q]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?m[j][Q]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):m[j][Q]=ne;break;case"F":m[j][Q]=parseFloat(ne.trim());break;case"+":case"I":m[j][Q]=E?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":m[j][Q]=!0;break;case"N":case"F":m[j][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[j][Q]="##MEMO##"+(E?parseInt(ne.trim(),10):B.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(m[j][Q]=+ne||0);break;case"@":m[j][Q]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":m[j][Q]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":m[j][Q]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[j][Q]=-B.read_shift(-8,"f");break;case"B":if(y&&A[Q].len==8){m[j][Q]=B.read_shift(8,"f");break}case"G":case"P":B.l+=A[Q].len;break;case"0":if(A[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[Q].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return x&&x.sheetRows&&(m=m.slice(0,x.sheetRows)),x.DBF=A,m}function s(d,x){var m=x||{};m.dateNF||(m.dateNF="yyyymmdd");var p=bi(a(d,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function i(d,x){try{return Un(s(d,x),x)}catch(m){if(x&&x.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function f(d,x){var m=x||{};if(+m.codepage>=0&&_r(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Zu(),v=lf(d,{header:1,raw:!0,cellDates:!0}),b=v[0],y=v.slice(1),E=d["!cols"]||[],_=0,w=0,S=0,D=1;for(_=0;_<b.length;++_){if(((E[_]||{}).DBF||{}).name){b[_]=E[_].DBF.name,++S;continue}if(b[_]!=null){if(++S,typeof b[_]=="number"&&(b[_]=b[_].toString(10)),typeof b[_]!="string")throw new Error("DBF Invalid column name "+b[_]+" |"+typeof b[_]+"|");if(b.indexOf(b[_])!==_){for(w=0;w<1024;++w)if(b.indexOf(b[_]+"_"+w)==-1){b[_]+="_"+w;break}}}}var A=Yt(d["!ref"]),z=[],V=[],Y=[];for(_=0;_<=A.e.c-A.s.c;++_){var j="",Q="",B=0,ne=[];for(w=0;w<y.length;++w)y[w][_]!=null&&ne.push(y[w][_]);if(ne.length==0||b[_]==null){z[_]="?";continue}for(w=0;w<ne.length;++w){switch(typeof ne[w]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=ne[w]instanceof Date?"D":"C";break;default:Q="C"}B=Math.max(B,String(ne[w]).length),j=j&&j!=Q?"C":Q}B>250&&(B=250),Q=((E[_]||{}).DBF||{}).type,Q=="C"&&E[_].DBF.len>B&&(B=E[_].DBF.len),j=="B"&&Q=="N"&&(j="N",Y[_]=E[_].DBF.dec,B=E[_].DBF.len),V[_]=j=="C"||Q=="N"?B:o[j]||0,D+=V[_],z[_]=j}var K=p.next(32);for(K.write_shift(4,318902576),K.write_shift(4,y.length),K.write_shift(2,296+32*S),K.write_shift(2,D),_=0;_<4;++_)K.write_shift(4,0);for(K.write_shift(4,0|(+n[Dp]||3)<<8),_=0,w=0;_<b.length;++_)if(b[_]!=null){var X=p.next(32),ee=(b[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,ee,"sbcs"),X.write_shift(1,z[_]=="?"?"C":z[_],"sbcs"),X.write_shift(4,w),X.write_shift(1,V[_]||o[z[_]]||0),X.write_shift(1,Y[_]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),w+=V[_]||o[z[_]]||0}var he=p.next(264);for(he.write_shift(4,13),_=0;_<65;++_)he.write_shift(4,0);for(_=0;_<y.length;++_){var _e=p.next(D);for(_e.write_shift(1,0),w=0;w<b.length;++w)if(b[w]!=null)switch(z[w]){case"L":_e.write_shift(1,y[_][w]==null?63:y[_][w]?84:70);break;case"B":_e.write_shift(8,y[_][w]||0,"f");break;case"N":var Z="0";for(typeof y[_][w]=="number"&&(Z=y[_][w].toFixed(Y[w]||0)),S=0;S<V[w]-Z.length;++S)_e.write_shift(1,32);_e.write_shift(1,Z,"sbcs");break;case"D":y[_][w]?(_e.write_shift(4,("0000"+y[_][w].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(y[_][w].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+y[_][w].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(y[_][w]!=null?y[_][w]:"").slice(0,V[w]);for(_e.write_shift(1,ue,"sbcs"),S=0;S<V[w]-ue.length;++S)_e.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:s,from_sheet:f}}(),A_=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Mr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(b,y){var E=e[y];return typeof E=="number"?Em(E):E},s=function(b,y,E){var _=y.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return _==59?b:Em(_)};e["|"]=254;function i(b,y){switch(y.type){case"base64":return o(Wa(b),y);case"binary":return o(b,y);case"buffer":return o(mt&&Buffer.isBuffer(b)?b.toString("binary"):gs(b),y);case"array":return o(xs(b),y)}throw new Error("Unrecognized type "+y.type)}function o(b,y){var E=b.split(/[\n\r]+/),_=-1,w=-1,S=0,D=0,A=[],z=[],V=null,Y={},j=[],Q=[],B=[],ne=0,K;for(+y.codepage>=0&&_r(+y.codepage);S!==E.length;++S){ne=0;var X=E[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,a),ee=X.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),he=ee[0],_e;if(X.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&z.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ue=!1,Re=!1,te=!1,H=-1,oe=-1;for(D=1;D<ee.length;++D)switch(ee[D].charAt(0)){case"A":break;case"X":w=parseInt(ee[D].slice(1))-1,ue=!0;break;case"Y":for(_=parseInt(ee[D].slice(1))-1,ue||(w=0),K=A.length;K<=_;++K)A[K]=[];break;case"K":_e=ee[D].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Tr(_e))?isNaN(mi(_e).getDate())||(_e=da(_e)):(_e=Tr(_e),V!==null&&gi(V)&&(_e=To(_e))),Z=!0;break;case"E":te=!0;var k=di(ee[D].slice(1),{r:_,c:w});A[_][w]=[A[_][w],k];break;case"S":Re=!0,A[_][w]=[A[_][w],"S5S"];break;case"G":break;case"R":H=parseInt(ee[D].slice(1))-1;break;case"C":oe=parseInt(ee[D].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}if(Z&&(A[_][w]&&A[_][w].length==2?A[_][w][0]=_e:A[_][w]=_e,V=null),Re){if(te)throw new Error("SYLK shared formula cannot have own formula");var q=H>-1&&A[H][oe];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");A[_][w][1]=Hg(q[1],{r:_-H,c:w-oe})}break;case"F":var U=0;for(D=1;D<ee.length;++D)switch(ee[D].charAt(0)){case"X":w=parseInt(ee[D].slice(1))-1,++U;break;case"Y":for(_=parseInt(ee[D].slice(1))-1,K=A.length;K<=_;++K)A[K]=[];break;case"M":ne=parseInt(ee[D].slice(1))/20;break;case"F":break;case"G":break;case"P":V=z[parseInt(ee[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=ee[D].slice(1).split(" "),K=parseInt(B[0],10);K<=parseInt(B[1],10);++K)ne=parseInt(B[2],10),Q[K-1]=ne===0?{hidden:!0}:{wch:ne},pi(Q[K-1]);break;case"C":w=parseInt(ee[D].slice(1))-1,Q[w]||(Q[w]={});break;case"R":_=parseInt(ee[D].slice(1))-1,j[_]||(j[_]={}),ne>0?(j[_].hpt=ne,j[_].hpx=Ll(ne)):ne===0&&(j[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}U<1&&(V=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}}return j.length>0&&(Y["!rows"]=j),Q.length>0&&(Y["!cols"]=Q),y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),[A,Y]}function f(b,y){var E=i(b,y),_=E[0],w=E[1],S=bi(_,y);return Mr(w).forEach(function(D){S[D]=w[D]}),S}function d(b,y){return Un(f(b,y),y)}function x(b,y,E,_){var w="C;Y"+(E+1)+";X"+(_+1)+";K";switch(b.t){case"n":w+=b.v||0,b.f&&!b.F&&(w+=";E"+dT(b.f,{r:E,c:_}));break;case"b":w+=b.v?"TRUE":"FALSE";break;case"e":w+=b.w||b.v;break;case"d":w+='"'+(b.w||b.v)+'"';break;case"s":w+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function m(b,y){y.forEach(function(E,_){var w="F;W"+(_+1)+" "+(_+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=yo(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Eo(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&b.push(w)})}function p(b,y){y.forEach(function(E,_){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*Bg(E.hpx)+";"),w.length>2&&b.push(w+"R"+(_+1))})}function v(b,y){var E=["ID;PWXL;N;E"],_=[],w=Yt(b["!ref"]),S,D=Array.isArray(b),A=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),b["!cols"]&&m(E,b["!cols"]),b["!rows"]&&p(E,b["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var z=w.s.r;z<=w.e.r;++z)for(var V=w.s.c;V<=w.e.c;++V){var Y=at({r:z,c:V});S=D?(b[z]||[])[V]:b[Y],!(!S||S.v==null&&(!S.f||S.F))&&_.push(x(S,b,z,V))}return E.join(A)+A+_.join(A)+A+"E"+A}return{to_workbook:d,to_sheet:f,from_sheet:v}}(),N_=function(){function e(o,f){switch(f.type){case"base64":return n(Wa(o),f);case"binary":return n(o,f);case"buffer":return n(mt&&Buffer.isBuffer(o)?o.toString("binary"):gs(o),f);case"array":return n(xs(o),f)}throw new Error("Unrecognized type "+f.type)}function n(o,f){for(var d=o.split(`
`),x=-1,m=-1,p=0,v=[];p!==d.length;++p){if(d[p].trim()==="BOT"){v[++x]=[],m=0;continue}if(!(x<0)){var b=d[p].trim().split(","),y=b[0],E=b[1];++p;for(var _=d[p]||"";(_.match(/["]/g)||[]).length&1&&p<d.length-1;)_+=`
`+d[++p];switch(_=_.trim(),+y){case-1:if(_==="BOT"){v[++x]=[],m=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[x][m]=!0:_==="FALSE"?v[x][m]=!1:isNaN(Tr(E))?isNaN(mi(E).getDate())?v[x][m]=E:v[x][m]=da(E):v[x][m]=Tr(E),++m;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[x][m++]=_!==""?_:null;break}if(_==="EOD")break}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function a(o,f){return bi(e(o,f),f)}function s(o,f){return Un(a(o,f),f)}var i=function(){var o=function(x,m,p,v,b){x.push(m),x.push(p+","+v),x.push('"'+b.replace(/"/g,'""')+'"')},f=function(x,m,p,v){x.push(m+","+p),x.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(x){var m=[],p=Yt(x["!ref"]),v,b=Array.isArray(x);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){f(m,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var _=at({r:y,c:E});if(v=b?(x[y]||[])[E]:x[_],!v){f(m,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?f(m,1,0,"="+v.f):f(m,1,0,""):f(m,0,w,"V");break;case"b":f(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":f(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=ur(v.z||st[14],ja(da(v.v)))),f(m,0,v.w,"V");break;default:f(m,1,0,"")}}}f(m,-1,0,"EOD");var S=`\r
`,D=m.join(S);return D}}();return{to_workbook:s,to_sheet:a,from_sheet:i}}(),C_=function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(v,b){for(var y=v.split(`
`),E=-1,_=-1,w=0,S=[];w!==y.length;++w){var D=y[w].trim().split(":");if(D[0]==="cell"){var A=Oa(D[1]);if(S.length<=A.r)for(E=S.length;E<=A.r;++E)S[E]||(S[E]=[]);switch(E=A.r,_=A.c,D[2]){case"t":S[E][_]=e(D[3]);break;case"v":S[E][_]=+D[3];break;case"vtf":var z=D[D.length-1];case"vtc":switch(D[3]){case"nl":S[E][_]=!!+D[4];break;default:S[E][_]=+D[4];break}D[2]=="vtf"&&(S[E][_]=[S[E][_],z])}}}return b&&b.sheetRows&&(S=S.slice(0,b.sheetRows)),S}function s(v,b){return bi(a(v,b),b)}function i(v,b){return Un(s(v,b),b)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),x="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var b=[],y=[],E,_="",w=vi(v["!ref"]),S=Array.isArray(v),D=w.s.r;D<=w.e.r;++D)for(var A=w.s.c;A<=w.e.c;++A)if(_=at({r:D,c:A}),E=S?(v[D]||[])[A]:v[_],!(!E||E.v==null||E.t==="z")){switch(y=["cell",_,"t"],E.t){case"s":case"str":y.push(n(E.v));break;case"n":E.f?(y[2]="vtf",y[3]="n",y[4]=E.v,y[5]=n(E.f)):(y[2]="v",y[3]=E.v);break;case"b":y[2]="vt"+(E.f?"f":"c"),y[3]="nl",y[4]=E.v?"1":"0",y[5]=n(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var z=ja(da(E.v));y[2]="vtc",y[3]="nd",y[4]=""+z,y[5]=E.w||ur(E.z||st[14],z);break;case"e":continue}b.push(y.join(":"))}return b.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function p(v){return[o,f,d,f,m(v),x].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:p}}(),jl=function(){function e(p,v,b,y,E){E.raw?v[b][y]=p:p===""||(p==="TRUE"?v[b][y]=!0:p==="FALSE"?v[b][y]=!1:isNaN(Tr(p))?isNaN(mi(p).getDate())?v[b][y]=p:v[b][y]=da(p):v[b][y]=Tr(p))}function n(p,v){var b=v||{},y=[];if(!p||p.length===0)return y;for(var E=p.split(/[\r\n]/),_=E.length-1;_>=0&&E[_].length===0;)--_;for(var w=10,S=0,D=0;D<=_;++D)S=E[D].indexOf(" "),S==-1?S=E[D].length:S++,w=Math.max(w,S);for(D=0;D<=_;++D){y[D]=[];var A=0;for(e(E[D].slice(0,w).trim(),y,D,A,b),A=1;A<=(E[D].length-w)/10+1;++A)e(E[D].slice(w+(A-1)*10,w+A*10).trim(),y,D,A,b)}return b.sheetRows&&(y=y.slice(0,b.sheetRows)),y}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(p){for(var v={},b=!1,y=0,E=0;y<p.length;++y)(E=p.charCodeAt(y))==34?b=!b:!b&&E in a&&(v[E]=(v[E]||0)+1);E=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&E.push([v[y],y]);if(!E.length){v=s;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&E.push([v[y],y])}return E.sort(function(_,w){return _[0]-w[0]||s[_[1]]-s[w[1]]}),a[E.pop()[1]]||44}function o(p,v){var b=v||{},y="",E=b.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=i(p.slice(0,1024)):b&&b.FS?y=b.FS:y=i(p.slice(0,1024));var w=0,S=0,D=0,A=0,z=0,V=y.charCodeAt(0),Y=!1,j=0,Q=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var B=b.dateNF!=null?Uy(b.dateNF):null;function ne(){var K=p.slice(A,z),X={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)X.t="z";else if(b.raw)X.t="s",X.v=K;else if(K.trim().length===0)X.t="s",X.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(X.t="s",X.v=K.slice(2,-1).replace(/""/g,'"')):xT(K)?(X.t="n",X.f=K.slice(1)):(X.t="s",X.v=K);else if(K=="TRUE")X.t="b",X.v=!0;else if(K=="FALSE")X.t="b",X.v=!1;else if(!isNaN(D=Tr(K)))X.t="n",b.cellText!==!1&&(X.w=K),X.v=D;else if(!isNaN(mi(K).getDate())||B&&K.match(B)){X.z=b.dateNF||st[14];var ee=0;B&&K.match(B)&&(K=Py(K,b.dateNF,K.match(B)||[]),ee=1),b.cellDates?(X.t="d",X.v=da(K,ee)):(X.t="n",X.v=ja(da(K,ee))),b.cellText!==!1&&(X.w=ur(X.z,X.v instanceof Date?ja(X.v):X.v)),b.cellNF||delete X.z}else X.t="s",X.v=K;if(X.t=="z"||(b.dense?(E[w]||(E[w]=[]),E[w][S]=X):E[at({c:S,r:w})]=X),A=z+1,Q=p.charCodeAt(A),_.e.c<S&&(_.e.c=S),_.e.r<w&&(_.e.r=w),j==V)++S;else if(S=0,++w,b.sheetRows&&b.sheetRows<=w)return!0}e:for(;z<p.length;++z)switch(j=p.charCodeAt(z)){case 34:Q===34&&(Y=!Y);break;case V:case 10:case 13:if(!Y&&ne())break e;break}return z-A>0&&ne(),E["!ref"]=bt(_),E}function f(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):bi(n(p,v),v)}function d(p,v){var b="",y=v.type=="string"?[0,0,0,0]:Ff(p,v);switch(v.type){case"base64":b=Wa(p);break;case"binary":b=p;break;case"buffer":v.codepage==65001?b=p.toString("utf8"):v.codepage&&typeof kl<"u"||(b=mt&&Buffer.isBuffer(p)?p.toString("binary"):gs(p));break;case"array":b=xs(p);break;case"string":b=p;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?b=Ft(b.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?b=Ft(b):v.type=="binary"&&typeof kl<"u",b.slice(0,19)=="socialcalc:version:"?C_.to_sheet(v.type=="string"?b:Ft(b),v):f(b,v)}function x(p,v){return Un(d(p,v),v)}function m(p){for(var v=[],b=Yt(p["!ref"]),y,E=Array.isArray(p),_=b.s.r;_<=b.e.r;++_){for(var w=[],S=b.s.c;S<=b.e.c;++S){var D=at({r:_,c:S});if(y=E?(p[_]||[])[S]:p[D],!y||y.v==null){w.push("          ");continue}for(var A=(y.w||(an(y),y.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(S===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:x,to_sheet:d,from_sheet:m}}();function k_(e,n){var a=n||{},s=!!a.WTF;a.WTF=!0;try{var i=A_.to_workbook(e,a);return a.WTF=s,i}catch(o){if(a.WTF=s,!o.message.match(/SYLK bad record ID/)&&s)throw o;return jl.to_workbook(e,n)}}var Tl=function(){function e(k,q,U){if(k){pa(k,k.l||0);for(var R=U.Enum||H;k.l<k.length;){var W=k.read_shift(2),pe=R[W]||R[65535],ve=k.read_shift(2),Se=k.l+ve,we=pe.f&&pe.f(k,ve,U);if(k.l=Se,q(we,pe,W))return}}}function n(k,q){switch(q.type){case"base64":return a(Er(Wa(k)),q);case"binary":return a(Er(k),q);case"buffer":case"array":return a(k,q)}throw"Unsupported type "+q.type}function a(k,q){if(!k)return k;var U=q||{},R=U.dense?[]:{},W="Sheet1",pe="",ve=0,Se={},we=[],Be=[],I={s:{r:0,c:0},e:{r:0,c:0}},Pe=U.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)U.Enum=H,e(k,function(ge,Ie,pt){switch(pt){case 0:U.vers=ge,ge>=4096&&(U.qpro=!0);break;case 6:I=ge;break;case 204:ge&&(pe=ge);break;case 222:pe=ge;break;case 15:case 51:U.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:pt==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=U.dateNF||st[14],U.cellDates&&(ge[1].t="d",ge[1].v=To(ge[1].v))),U.qpro&&ge[3]>ve&&(R["!ref"]=bt(I),Se[W]=R,we.push(W),R=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=ge[3],W=pe||"Sheet"+(ve+1),pe="");var ye=U.dense?(R[ge[0].r]||[])[ge[0].c]:R[at(ge[0])];if(ye){ye.t=ge[1].t,ye.v=ge[1].v,ge[1].z!=null&&(ye.z=ge[1].z),ge[1].f!=null&&(ye.f=ge[1].f);break}U.dense?(R[ge[0].r]||(R[ge[0].r]=[]),R[ge[0].r][ge[0].c]=ge[1]):R[at(ge[0])]=ge[1];break}},U);else if(k[2]==26||k[2]==14)U.Enum=oe,k[2]==14&&(U.qpro=!0,k.l=0),e(k,function(ge,Ie,pt){switch(pt){case 204:W=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ve&&(R["!ref"]=bt(I),Se[W]=R,we.push(W),R=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=ge[3],W="Sheet"+(ve+1)),Pe>0&&ge[0].r>=Pe)break;U.dense?(R[ge[0].r]||(R[ge[0].r]=[]),R[ge[0].r][ge[0].c]=ge[1]):R[at(ge[0])]=ge[1],I.e.c<ge[0].c&&(I.e.c=ge[0].c),I.e.r<ge[0].r&&(I.e.r=ge[0].r);break;case 27:ge[14e3]&&(Be[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Be[ge[0]]=ge[1],ge[0]==ve&&(W=ge[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(R["!ref"]=bt(I),Se[pe||W]=R,we.push(pe||W),!Be.length)return{SheetNames:we,Sheets:Se};for(var Ue={},We=[],Ve=0;Ve<Be.length;++Ve)Se[we[Ve]]?(We.push(Be[Ve]||we[Ve]),Ue[Be[Ve]]=Se[Be[Ve]]||Se[we[Ve]]):(We.push(Be[Ve]),Ue[Be[Ve]]={"!ref":"A1"});return{SheetNames:We,Sheets:Ue}}function s(k,q){var U=q||{};if(+U.codepage>=0&&_r(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Zu(),W=Yt(k["!ref"]),pe=Array.isArray(k),ve=[];yr(R,0,o(1030)),yr(R,6,x(W));for(var Se=Math.min(W.e.r,8191),we=W.s.r;we<=Se;++we)for(var Be=va(we),I=W.s.c;I<=W.e.c;++I){we===W.s.r&&(ve[I]=ia(I));var Pe=ve[I]+Be,Ue=pe?(k[we]||[])[I]:k[Pe];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?yr(R,13,y(we,I,Ue.v)):yr(R,14,_(we,I,Ue.v));else{var We=an(Ue);yr(R,15,v(we,I,We.slice(0,239)))}}return yr(R,1),R.end()}function i(k,q){var U=q||{};if(+U.codepage>=0&&_r(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Zu();yr(R,0,f(k));for(var W=0,pe=0;W<k.SheetNames.length;++W)(k.Sheets[k.SheetNames[W]]||{})["!ref"]&&yr(R,27,te(k.SheetNames[W],pe++));var ve=0;for(W=0;W<k.SheetNames.length;++W){var Se=k.Sheets[k.SheetNames[W]];if(!(!Se||!Se["!ref"])){for(var we=Yt(Se["!ref"]),Be=Array.isArray(Se),I=[],Pe=Math.min(we.e.r,8191),Ue=we.s.r;Ue<=Pe;++Ue)for(var We=va(Ue),Ve=we.s.c;Ve<=we.e.c;++Ve){Ue===we.s.r&&(I[Ve]=ia(Ve));var ge=I[Ve]+We,Ie=Be?(Se[Ue]||[])[Ve]:Se[ge];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")yr(R,23,ne(Ue,Ve,ve,Ie.v));else{var pt=an(Ie);yr(R,22,j(Ue,Ve,ve,pt.slice(0,239)))}}++ve}}return yr(R,1),R.end()}function o(k){var q=sa(2);return q.write_shift(2,k),q}function f(k){var q=sa(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var U=0,R=0,W=0,pe=0;pe<k.SheetNames.length;++pe){var ve=k.SheetNames[pe],Se=k.Sheets[ve];if(!(!Se||!Se["!ref"])){++W;var we=vi(Se["!ref"]);U<we.e.r&&(U=we.e.r),R<we.e.c&&(R=we.e.c)}}return U>8191&&(U=8191),q.write_shift(2,U),q.write_shift(1,W),q.write_shift(1,R),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function d(k,q,U){var R={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&U.qpro?(R.s.c=k.read_shift(1),k.l++,R.s.r=k.read_shift(2),R.e.c=k.read_shift(1),k.l++,R.e.r=k.read_shift(2),R):(R.s.c=k.read_shift(2),R.s.r=k.read_shift(2),q==12&&U.qpro&&(k.l+=2),R.e.c=k.read_shift(2),R.e.r=k.read_shift(2),q==12&&U.qpro&&(k.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function x(k){var q=sa(8);return q.write_shift(2,k.s.c),q.write_shift(2,k.s.r),q.write_shift(2,k.e.c),q.write_shift(2,k.e.r),q}function m(k,q,U){var R=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(R[0].c=k.read_shift(1),R[3]=k.read_shift(1),R[0].r=k.read_shift(2),k.l+=2):(R[2]=k.read_shift(1),R[0].c=k.read_shift(2),R[0].r=k.read_shift(2)),R}function p(k,q,U){var R=k.l+q,W=m(k,q,U);if(W[1].t="s",U.vers==20768){k.l++;var pe=k.read_shift(1);return W[1].v=k.read_shift(pe,"utf8"),W}return U.qpro&&k.l++,W[1].v=k.read_shift(R-k.l,"cstr"),W}function v(k,q,U){var R=sa(7+U.length);R.write_shift(1,255),R.write_shift(2,q),R.write_shift(2,k),R.write_shift(1,39);for(var W=0;W<R.length;++W){var pe=U.charCodeAt(W);R.write_shift(1,pe>=128?95:pe)}return R.write_shift(1,0),R}function b(k,q,U){var R=m(k,q,U);return R[1].v=k.read_shift(2,"i"),R}function y(k,q,U){var R=sa(7);return R.write_shift(1,255),R.write_shift(2,q),R.write_shift(2,k),R.write_shift(2,U,"i"),R}function E(k,q,U){var R=m(k,q,U);return R[1].v=k.read_shift(8,"f"),R}function _(k,q,U){var R=sa(13);return R.write_shift(1,255),R.write_shift(2,q),R.write_shift(2,k),R.write_shift(8,U,"f"),R}function w(k,q,U){var R=k.l+q,W=m(k,q,U);if(W[1].v=k.read_shift(8,"f"),U.qpro)k.l=R;else{var pe=k.read_shift(2);z(k.slice(k.l,k.l+pe),W),k.l+=pe}return W}function S(k,q,U){var R=q&32768;return q&=-32769,q=(R?k:0)+(q>=8192?q-16384:q),(R?"":"$")+(U?ia(q):va(q))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(k,q){pa(k,0);for(var U=[],R=0,W="",pe="",ve="",Se="";k.l<k.length;){var we=k[k.l++];switch(we){case 0:U.push(k.read_shift(8,"f"));break;case 1:pe=S(q[0].c,k.read_shift(2),!0),W=S(q[0].r,k.read_shift(2),!1),U.push(pe+W);break;case 2:{var Be=S(q[0].c,k.read_shift(2),!0),I=S(q[0].r,k.read_shift(2),!1);pe=S(q[0].c,k.read_shift(2),!0),W=S(q[0].r,k.read_shift(2),!1),U.push(Be+I+":"+pe+W)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(k.read_shift(2));break;case 6:{for(var Pe="";we=k[k.l++];)Pe+=String.fromCharCode(we);U.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Se=U.pop(),ve=U.pop(),U.push(["AND","OR"][we-20]+"("+ve+","+Se+")");break;default:if(we<32&&A[we])Se=U.pop(),ve=U.pop(),U.push(ve+A[we]+Se);else if(D[we]){if(R=D[we][1],R==69&&(R=k[k.l++]),R>U.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+U.join("|")+"|");return}var Ue=U.slice(-R);U.length-=R,U.push(D[we][0]+"("+Ue.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}U.length==1?q[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function V(k){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=k.read_shift(2),q[3]=k[k.l++],q[0].c=k[k.l++],q}function Y(k,q){var U=V(k);return U[1].t="s",U[1].v=k.read_shift(q-4,"cstr"),U}function j(k,q,U,R){var W=sa(6+R.length);W.write_shift(2,k),W.write_shift(1,U),W.write_shift(1,q),W.write_shift(1,39);for(var pe=0;pe<R.length;++pe){var ve=R.charCodeAt(pe);W.write_shift(1,ve>=128?95:ve)}return W.write_shift(1,0),W}function Q(k,q){var U=V(k);U[1].v=k.read_shift(2);var R=U[1].v>>1;if(U[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return U[1].v=R,U}function B(k,q){var U=V(k),R=k.read_shift(4),W=k.read_shift(4),pe=k.read_shift(2);if(pe==65535)return R===0&&W===3221225472?(U[1].t="e",U[1].v=15):R===0&&W===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ve=pe&32768;return pe=(pe&32767)-16446,U[1].v=(1-ve*2)*(W*Math.pow(2,pe+32)+R*Math.pow(2,pe)),U}function ne(k,q,U,R){var W=sa(14);if(W.write_shift(2,k),W.write_shift(1,U),W.write_shift(1,q),R==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var pe=0,ve=0,Se=0,we=0;return R<0&&(pe=1,R=-R),ve=Math.log2(R)|0,R/=Math.pow(2,ve-31),we=R>>>0,(we&2147483648)==0&&(R/=2,++ve,we=R>>>0),R-=we,we|=2147483648,we>>>=0,R*=Math.pow(2,32),Se=R>>>0,W.write_shift(4,Se),W.write_shift(4,we),ve+=16383+(pe?32768:0),W.write_shift(2,ve),W}function K(k,q){var U=B(k);return k.l+=q-14,U}function X(k,q){var U=V(k),R=k.read_shift(4);return U[1].v=R>>6,U}function ee(k,q){var U=V(k),R=k.read_shift(8,"f");return U[1].v=R,U}function he(k,q){var U=ee(k);return k.l+=q-10,U}function _e(k,q){return k[k.l+q-1]==0?k.read_shift(q,"cstr"):""}function Z(k,q){var U=k[k.l++];U>q-1&&(U=q-1);for(var R="";R.length<U;)R+=String.fromCharCode(k[k.l++]);return R}function ue(k,q,U){if(!(!U.qpro||q<21)){var R=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var W=k.read_shift(q-21,"cstr");return[R,W]}}function Re(k,q){for(var U={},R=k.l+q;k.l<R;){var W=k.read_shift(2);if(W==14e3){for(U[W]=[0,""],U[W][0]=k.read_shift(2);k[k.l];)U[W][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return U}function te(k,q){var U=sa(5+k.length);U.write_shift(2,14e3),U.write_shift(2,q);for(var R=0;R<k.length;++R){var W=k.charCodeAt(R);U[U.l++]=W>127?95:W}return U[U.l++]=0,U}var H={0:{n:"BOF",f:ta},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:n}}();function D_(e){var n={},a=e.match(Na),s=0,i=!1;if(a)for(;s!=a.length;++s){var o=Qe(a[s]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=df[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return n}var O_=function(){var e=Ol("t"),n=Ol("rPr");function a(o){var f=o.match(e);if(!f)return{t:"s",v:""};var d={t:"s",v:yt(f[1])},x=o.match(n);return x&&(d.s=D_(x[1])),d}var s=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(f){return f.replace(s,"").split(i).map(a).filter(function(d){return d.v})}}(),R_=function(){var n=/(\r\n|\n)/g;function a(i,o,f){var d=[];i.u&&d.push("text-decoration: underline;"),i.uval&&d.push("text-underline-style:"+i.uval+";"),i.sz&&d.push("font-size:"+i.sz+"pt;"),i.outline&&d.push("text-effect: outline;"),i.shadow&&d.push("text-shadow: auto;"),o.push('<span style="'+d.join("")+'">'),i.b&&(o.push("<b>"),f.push("</b>")),i.i&&(o.push("<i>"),f.push("</i>")),i.strike&&(o.push("<s>"),f.push("</s>"));var x=i.valign||"";return x=="superscript"||x=="super"?x="sup":x=="subscript"&&(x="sub"),x!=""&&(o.push("<"+x+">"),f.push("</"+x+">")),f.push("</span>"),i}function s(i){var o=[[],i.v,[]];return i.v?(i.s&&a(i.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(s).join("")}}(),j_=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,M_=/<(?:\w+:)?r>/,L_=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function kf(e,n){var a=n?n.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=yt(Ft(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Ft(e),a&&(s.h=bf(s.t))):e.match(M_)&&(s.r=Ft(e),s.t=yt(Ft((e.replace(L_,"").match(j_)||[]).join("").replace(Na,""))),a&&(s.h=R_(O_(s.r)))),s):{t:""}}var F_=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I_=/<(?:\w+:)?(?:si|sstItem)>/g,B_=/<\/(?:\w+:)?(?:si|sstItem)>/;function U_(e,n){var a=[],s="";if(!e)return a;var i=e.match(F_);if(i){s=i[2].replace(I_,"").split(B_);for(var o=0;o!=s.length;++o){var f=kf(s[o].trim(),n);f!=null&&(a[a.length]=f)}i=Qe(i[1]),a.Count=i.count,a.Unique=i.uniqueCount}return a}function P_(e){return[e.read_shift(4),e.read_shift(4)]}function H_(e,n){var a=[],s=!1;return nn(e,function(o,f,d){switch(d){case 159:a.Count=o[0],a.Unique=o[1];break;case 19:a.push(o);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(f.T,!s||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function Rg(e){for(var n=[],a=e.split(""),s=0;s<a.length;++s)n[s]=a[s].charCodeAt(0);return n}function tn(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function z_(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=tn(e,4),n.U=tn(e,4),n.W=tn(e,4),n}function V_(e){for(var n=e.read_shift(4),a=e.l+n-4,s={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=o,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return s}function G_(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(V_(e));return n}function Y_(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function X_(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=tn(e,4),n.U=tn(e,4),n.W=tn(e,4),n}function q_(e){var n=X_(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function jg(e,n){var a=e.l+n,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var i=!1;switch(s.AlgID){case 26126:case 26127:case 26128:i=s.Flags==36;break;case 26625:i=s.Flags==4;break;case 0:i=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,s}function Mg(e,n){var a={},s=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,s),e.l=s,a}function K_(e){var n=tn(e);switch(n.Minor){case 2:return[n.Minor,W_(e)];case 3:return[n.Minor,$_()];case 4:return[n.Minor,Z_(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function W_(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),s=jg(e,a),i=Mg(e,e.length-e.l);return{t:"Std",h:s,v:i}}function $_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Z_(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),s={};return a.replace(Na,function(o){var f=Qe(o);switch(Lr(f[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){s[d]=f[d]});break;case"<dataIntegrity":s.encryptedHmacKey=f.encryptedHmacKey,s.encryptedHmacValue=f.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=f.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(f);break;default:throw f[0]}}),s}function Q_(e,n){var a={},s=a.EncryptionVersionInfo=tn(e,4);if(n-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);a.Flags=e.read_shift(4),n-=4;var i=e.read_shift(4);return n-=4,a.EncryptionHeader=jg(e,i),n-=i,a.EncryptionVerifier=Mg(e,n),a}function J_(e){var n={},a=n.EncryptionVersionInfo=tn(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function ew(e){var n=0,a,s=Rg(e),i=s.length+1,o,f,d,x,m;for(a=In(i),a[0]=s.length,o=1;o!=i;++o)a[o]=s[o-1];for(o=i-1;o>=0;--o)f=a[o],d=(n&16384)===0?0:1,x=n<<1&32767,m=d|x,n=m^f;return n^52811}var Lg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(f){return(f/2|f*128)&255},i=function(f,d){return s(f^d)},o=function(f){for(var d=n[f.length-1],x=104,m=f.length-1;m>=0;--m)for(var p=f[m],v=0;v!=7;++v)p&64&&(d^=a[x]),p*=2,--x;return d};return function(f){for(var d=Rg(f),x=o(d),m=d.length,p=In(16),v=0;v!=16;++v)p[v]=0;var b,y,E;for((m&1)===1&&(b=x>>8,p[m]=i(e[0],b),--m,b=x&255,y=d[d.length-1],p[m]=i(y,b));m>0;)--m,b=x>>8,p[m]=i(d[m],b),--m,b=x&255,p[m]=i(d[m],b);for(m=15,E=15-d.length;E>0;)b=x>>8,p[m]=i(e[E],b),--m,--E,b=x&255,p[m]=i(d[m],b),--m,--E;return p}}(),tw=function(e,n,a,s,i){i||(i=n),s||(s=Lg(e));var o,f;for(o=0;o!=n.length;++o)f=n[o],f^=s[a],f=(f>>5|f<<3)&255,i[o]=f,++a;return[i,a,s]},aw=function(e){var n=0,a=Lg(e);return function(s){var i=tw("",s,n,a);return n=i[1],i[0]}};function rw(e,n,a,s){var i={key:ta(e),verificationBytes:ta(e)};return a.password&&(i.verifier=ew(a.password)),s.valid=i.verificationBytes===i.verifier,s.valid&&(s.insitu=aw(a.password)),i}function nw(e,n,a){var s=a||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=J_(e):s.Data=Q_(e,n),s}function sw(e,n,a){var s={Type:a.biff>=8?e.read_shift(2):0};return s.Type?nw(e,n-2,s):rw(e,a.biff>=8?n:n-2,a,s),s}var iw=function(){function e(i,o){switch(o.type){case"base64":return n(Wa(i),o);case"binary":return n(i,o);case"buffer":return n(mt&&Buffer.isBuffer(i)?i.toString("binary"):gs(i),o);case"array":return n(xs(i),o)}throw new Error("Unrecognized type "+o.type)}function n(i,o){var f=o||{},d=f.dense?[]:{},x=i.match(/\\trowd.*?\\row\b/g);if(!x.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:x.length-1}};return x.forEach(function(p,v){Array.isArray(d)&&(d[v]=[]);for(var b=/\\\w+\b/g,y=0,E,_=-1;E=b.exec(p);){switch(E[0]){case"\\cell":var w=p.slice(y,b.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var S={v:w,t:"s"};Array.isArray(d)?d[v][_]=S:d[at({r:v,c:_})]=S}break}y=b.lastIndex}_>m.e.c&&(m.e.c=_)}),d["!ref"]=bt(m),d}function a(i,o){return Un(e(i,o),o)}function s(i){for(var o=["{\\rtf1\\ansi"],f=Yt(i["!ref"]),d,x=Array.isArray(i),m=f.s.r;m<=f.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=f.s.c;p<=f.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=f.s.c;p<=f.e.c;++p){var v=at({r:m,c:p});d=x?(i[m]||[])[p]:i[v],!(!d||d.v==null&&(!d.f||d.F))&&(o.push(" "+(d.w||(an(d),d.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:s}}();function lw(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Ml(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function cw(e){var n=e[0]/255,a=e[1]/255,s=e[2]/255,i=Math.max(n,a,s),o=Math.min(n,a,s),f=i-o;if(f===0)return[0,0,n];var d=0,x=0,m=i+o;switch(x=f/(m>1?2-m:m),i){case n:d=((a-s)/f+6)%6;break;case a:d=(s-n)/f+2;break;case s:d=(n-a)/f+4;break}return[d/6,x,m/2]}function ow(e){var n=e[0],a=e[1],s=e[2],i=a*2*(s<.5?s:1-s),o=s-i/2,f=[o,o,o],d=6*n,x;if(a!==0)switch(d|0){case 0:case 6:x=i*d,f[0]+=i,f[1]+=x;break;case 1:x=i*(2-d),f[0]+=x,f[1]+=i;break;case 2:x=i*(d-2),f[1]+=i,f[2]+=x;break;case 3:x=i*(4-d),f[1]+=x,f[2]+=i;break;case 4:x=i*(d-4),f[2]+=i,f[0]+=x;break;case 5:x=i*(6-d),f[2]+=x,f[0]+=i;break}for(var m=0;m!=3;++m)f[m]=Math.round(f[m]*255);return f}function bo(e,n){if(n===0)return e;var a=cw(lw(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),Ml(ow(a))}var Fg=6,uw=15,fw=1,Da=Fg;function yo(e){return Math.floor((e+Math.round(128/Da)/256)*Da)}function Eo(e){return Math.floor((e-5)/Da*100+.5)/100}function tf(e){return Math.round((e*Da+5)/Da*256)/256}function zu(e){return tf(Eo(yo(e)))}function Df(e){var n=Math.abs(e-zu(e)),a=Da;if(n>.005)for(Da=fw;Da<uw;++Da)Math.abs(e-zu(e))<=n&&(n=Math.abs(e-zu(e)),a=Da);Da=a}function pi(e){e.width?(e.wpx=yo(e.width),e.wch=Eo(e.wpx),e.MDW=Da):e.wpx?(e.wch=Eo(e.wpx),e.width=tf(e.wch),e.MDW=Da):typeof e.wch=="number"&&(e.width=tf(e.wch),e.wpx=yo(e.width),e.MDW=Da),e.customWidth&&delete e.customWidth}var dw=96,Ig=dw;function Bg(e){return e*96/Ig}function Ll(e){return e*Ig/96}var hw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xw(e,n,a,s){n.Borders=[];var i={},o=!1;(e[0].match(Na)||[]).forEach(function(f){var d=Qe(f);switch(Lr(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},d.diagonalUp&&(i.diagonalUp=Bt(d.diagonalUp)),d.diagonalDown&&(i.diagonalDown=Bt(d.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+d[0]+" in borders")}})}function mw(e,n,a,s){n.Fills=[];var i={},o=!1;(e[0].match(Na)||[]).forEach(function(f){var d=Qe(f);switch(Lr(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":d.patternType&&(i.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),d.indexed&&(i.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(i.bgColor.theme=parseInt(d.theme,10)),d.tint&&(i.bgColor.tint=parseFloat(d.tint)),d.rgb&&(i.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),d.theme&&(i.fgColor.theme=parseInt(d.theme,10)),d.tint&&(i.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(i.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fills")}})}function pw(e,n,a,s){n.Fonts=[];var i={},o=!1;(e[0].match(Na)||[]).forEach(function(f){var d=Qe(f);switch(Lr(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":d.val&&(i.name=Ft(d.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=d.val?Bt(d.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=d.val?Bt(d.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(d.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=d.val?Bt(d.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=d.val?Bt(d.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=d.val?Bt(d.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=d.val?Bt(d.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=d.val?Bt(d.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":d.val&&(i.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(i.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(i.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(i.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=df[parseInt(d.val,10)];break;case"<color":if(i.color||(i.color={}),d.auto&&(i.color.auto=Bt(d.auto)),d.rgb)i.color.rgb=d.rgb.slice(-6);else if(d.indexed){i.color.index=parseInt(d.indexed,10);var x=ds[i.color.index];i.color.index==81&&(x=ds[1]),x||(x=ds[1]),i.color.rgb=x[0].toString(16)+x[1].toString(16)+x[2].toString(16)}else d.theme&&(i.color.theme=parseInt(d.theme,10),d.tint&&(i.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(i.color.rgb=bo(a.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fonts")}})}function gw(e,n,a){n.NumberFmt=[];for(var s=Mr(st),i=0;i<s.length;++i)n.NumberFmt[s[i]]=st[s[i]];var o=e[0].match(Na);if(o)for(i=0;i<o.length;++i){var f=Qe(o[i]);switch(Lr(f[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=yt(Ft(f.formatCode)),x=parseInt(f.numFmtId,10);if(n.NumberFmt[x]=d,x>0){if(x>392){for(x=392;x>60&&n.NumberFmt[x]!=null;--x);n.NumberFmt[x]=d}fs(d,x)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+f[0]+" in numFmts")}}}var so=["numFmtId","fillId","fontId","borderId","xfId"],io=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vw(e,n,a){n.CellXf=[];var s,i=!1;(e[0].match(Na)||[]).forEach(function(o){var f=Qe(o),d=0;switch(Lr(f[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=f,delete s[0],d=0;d<so.length;++d)s[so[d]]&&(s[so[d]]=parseInt(s[so[d]],10));for(d=0;d<io.length;++d)s[io[d]]&&(s[io[d]]=Bt(s[io[d]]));if(n.NumberFmt&&s.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[s.numFmtId]==n.NumberFmt[d]){s.numFmtId=d;break}}n.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var x={};f.vertical&&(x.vertical=f.vertical),f.horizontal&&(x.horizontal=f.horizontal),f.textRotation!=null&&(x.textRotation=f.textRotation),f.indent&&(x.indent=f.indent),f.wrapText&&(x.wrapText=Bt(f.wrapText)),s.alignment=x;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+f[0]+" in cellXfs")}})}var bw=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,x,m){var p={};if(!d)return p;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=d.match(n))&&gw(v,p,m),(v=d.match(i))&&pw(v,p,x,m),(v=d.match(s))&&mw(v,p,x,m),(v=d.match(o))&&xw(v,p,x,m),(v=d.match(a))&&vw(v,p,m),p}}();function yw(e,n){var a=e.read_shift(2),s=Sa(e);return[a,s]}function Ew(e,n,a){var s={};s.sz=e.read_shift(2)/20;var i=OE(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var f=e.read_shift(1);f!=0&&(s.underline=f);var d=e.read_shift(1);d>0&&(s.family=d);var x=e.read_shift(1);switch(x>0&&(s.charset=x),e.l++,s.color=DE(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Sa(e),s}var _w=Aa;function ww(e,n){var a=e.l+n,s=e.read_shift(2),i=e.read_shift(2);return e.l=a,{ixfe:s,numFmtId:i}}var Tw=Aa;function Sw(e,n,a){var s={};s.NumberFmt=[];for(var i in st)s.NumberFmt[i]=st[i];s.CellXf=[],s.Fonts=[];var o=[],f=!1;return nn(e,function(x,m,p){switch(p){case 44:s.NumberFmt[x[0]]=x[1],fs(x[1],x[0]);break;case 43:s.Fonts.push(x),x.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(x.color.rgb=bo(n.themeElements.clrScheme[x.color.theme].rgb,x.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&s.CellXf.push(x);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:o.push(p),f=!0;break;case 38:o.pop(),f=!1;break;default:if(m.T>0)o.push(p);else if(m.T<0)o.pop();else if(!f||a.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),s}var Aw=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Nw(e,n,a){n.themeElements.clrScheme=[];var s={};(e[0].match(Na)||[]).forEach(function(i){var o=Qe(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=o.val;break;case"<a:sysClr":s.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[Aw.indexOf(o[0])]=s,s={}):s.name=o[0].slice(3,o[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function Cw(){}function kw(){}var Dw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ow=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Rw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jw(e,n,a){n.themeElements={};var s;[["clrScheme",Dw,Nw],["fontScheme",Ow,Cw],["fmtScheme",Rw,kw]].forEach(function(i){if(!(s=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](s,n,a)})}var Mw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ug(e,n){(!e||e.length===0)&&(e=Lw());var a,s={};if(!(a=e.match(Mw)))throw new Error("themeElements not found in theme");return jw(a[0],s,n),s.raw=e,s}function Lw(e,n){var a=[$p];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function Fw(e,n,a){var s=e.l+n,i=e.read_shift(4);if(i!==124226){if(!a.cellStyles){e.l=s;return}var o=e.slice(e.l);e.l=s;var f;try{f=Wp(o,{type:"array"})}catch{return}var d=Ka(f,"theme/theme/theme1.xml",!0);if(d)return Ug(d,a)}}function Iw(e){return e.read_shift(4)}function Bw(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=Uw(e,4);break;case 2:n.xclrValue=Sg(e);break;case 3:n.xclrValue=Iw(e);break;case 4:e.l+=4;break}return e.l+=8,n}function Uw(e,n){return Aa(e,n)}function Pw(e,n){return Aa(e,n)}function Hw(e){var n=e.read_shift(2),a=e.read_shift(2)-4,s=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=Bw(e);break;case 6:s[1]=Pw(e,a);break;case 14:case 15:s[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return s}function zw(e,n){var a=e.l+n;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),o=[];i-- >0;)o.push(Hw(e,a-e.l));return{ixfe:s,ext:o}}function Vw(e,n){n.forEach(function(a){a[0]})}function Gw(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sa(e)}}function Yw(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function Xw(e){return e.l+=4,e.read_shift(4)!=0}function qw(e,n,a){var s={Types:[],Cell:[],Value:[]},i=a||{},o=[],f=!1,d=2;return nn(e,function(x,m,p){switch(p){case 335:s.Types.push({name:x.name});break;case 51:x.forEach(function(v){d==1?s.Cell.push({type:s.Types[v[0]-1].name,index:v[1]}):d==0&&s.Value.push({type:s.Types[v[0]-1].name,index:v[1]})});break;case 337:d=x?1:0;break;case 338:d=2;break;case 35:o.push(p),f=!0;break;case 36:o.pop(),f=!1;break;default:if(!m.T){if(!f||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),s}function Kw(e,n,a){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var i=!1,o=2,f;return e.replace(Na,function(d){var x=Qe(d);switch(Lr(x[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:x.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<s.Types.length;++m)s.Types[m].name==x.name&&(f=s.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?s.Cell.push({type:s.Types[x.t-1].name,index:+x.v}):o==0&&s.Value.push({type:s.Types[x.t-1].name,index:+x.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!f)break;f.offsets||(f.offsets=[]),f.offsets.push(+x.i);break;default:if(!i&&a.WTF)throw new Error("unrecognized "+x[0]+" in metadata")}return d}),s}function Ww(e){var n=[];if(!e)return n;var a=1;return(e.match(Na)||[]).forEach(function(s){var i=Qe(s);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?a=i.i:i.i=a,n.push(i);break}}),n}function $w(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=at(a);var s=e.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}function Zw(e,n,a){var s=[];return nn(e,function(o,f,d){switch(d){case 63:s.push(o);break;default:if(!f.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function Qw(e,n,a,s){if(!e)return e;var i=s||{},o=!1;nn(e,function(d,x,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!x.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},i)}function Jw(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}function ip(e,n,a,s){var i=Array.isArray(e),o;n.forEach(function(f){var d=Oa(f.ref);if(i?(e[d.r]||(e[d.r]=[]),o=e[d.r][d.c]):o=e[f.ref],!o){o={t:"z"},i?e[d.r][d.c]=o:e[f.ref]=o;var x=Yt(e["!ref"]||"BDWGO1000001:A1");x.s.r>d.r&&(x.s.r=d.r),x.e.r<d.r&&(x.e.r=d.r),x.s.c>d.c&&(x.s.c=d.c),x.e.c<d.c&&(x.e.c=d.c);var m=bt(x);m!==e["!ref"]&&(e["!ref"]=m)}o.c||(o.c=[]);var p={a:f.author,t:f.t,r:f.r,T:a};f.h&&(p.h=f.h);for(var v=o.c.length-1;v>=0;--v){if(!a&&o.c[v].T)return;a&&!o.c[v].T&&o.c.splice(v,1)}if(a&&s){for(v=0;v<s.length;++v)if(p.a==s[v].id){p.a=s[v].name||p.a;break}}o.c.push(p)})}function eT(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],s=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(f){if(!(f===""||f.trim()==="")){var d=f.match(/<(?:\w+:)?comment[^>]*>/);if(d){var x=Qe(d[0]),m={author:x.authorId&&a[x.authorId]||"sheetjsghost",ref:x.ref,guid:x.guid},p=Oa(x.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var v=f.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),b=!!v&&!!v[1]&&kf(v[1])||{r:"",t:"",h:""};m.r=b.r,b.r=="<t></t>"&&(b.t=b.h=""),m.t=(b.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(m.h=b.h),s.push(m)}}}}),s}function tT(e,n){var a=[],s=!1,i={},o=0;return e.replace(Na,function(d,x){var m=Qe(d);switch(Lr(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":i.t!=null&&a.push(i);break;case"<text>":case"<text":o=x+d.length;break;case"</text>":i.t=e.slice(o,x).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return d}),a}function aT(e,n){var a=[],s=!1;return e.replace(Na,function(o){var f=Qe(o);switch(Lr(f[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:f.displayname,id:f.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),a}function rT(e){var n={};n.iauthor=e.read_shift(4);var a=bs(e);return n.rfx=a.s,n.ref=at(a.s),e.l+=16,n}var nT=Sa;function sT(e,n){var a=[],s=[],i={},o=!1;return nn(e,function(d,x,m){switch(m){case 632:s.push(d);break;case 635:i=d;break;case 637:i.t=d.t,i.h=d.h,i.r=d.r;break;case 636:if(i.author=s[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,a.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!x.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}var iT="application/vnd.ms-office.vbaProject";function lT(e){var n=vt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,s){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var i=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(n,i,e.FileIndex[s].content)}}),vt.write(n)}function cT(){return{"!type":"dialog"}}function oT(){return{"!type":"dialog"}}function uT(){return{"!type":"macro"}}function fT(){return{"!type":"macro"}}var di=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(s,i,o,f){var d=!1,x=!1;o.length==0?x=!0:o.charAt(0)=="["&&(x=!0,o=o.slice(1,-1)),f.length==0?d=!0:f.charAt(0)=="["&&(d=!0,f=f.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=f.length>0?parseInt(f,10)|0:0;return d?p+=n.c:--p,x?m+=n.r:--m,i+(d?"":"$")+ia(p)+(x?"":"$")+va(m)}return function(i,o){return n=o,i.replace(e,a)}}(),Pg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dT=function(){return function(n,a){return n.replace(Pg,function(s,i,o,f,d,x){var m=wf(f)-(o?0:a.c),p=_f(x)-(d?0:a.r),v=p==0?"":d?p+1:"["+p+"]",b=m==0?"":o?m+1:"["+m+"]";return i+"R"+v+"C"+b})}}();function Hg(e,n){return e.replace(Pg,function(a,s,i,o,f,d){return s+(i=="$"?i+o:ia(wf(o)+n.c))+(f=="$"?f+d:va(_f(d)+n.r))})}function hT(e,n,a){var s=vi(n),i=s.s,o=Oa(a),f={r:o.r-i.r,c:o.c-i.c};return Hg(e,f)}function xT(e){return e.length!=1}function lp(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function Bn(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function zg(e,n,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return Vg(e);a.biff==12&&(s=4)}var i=e.read_shift(s),o=e.read_shift(s),f=Bn(e),d=Bn(e);return{s:{r:i,c:f[0],cRel:f[1],rRel:f[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function Vg(e){var n=Bn(e),a=Bn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:a[0],c:i,cRel:a[1],rRel:a[2]}}}function mT(e,n,a){if(a.biff<8)return Vg(e);var s=e.read_shift(a.biff==12?4:2),i=e.read_shift(a.biff==12?4:2),o=Bn(e),f=Bn(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:f[0],cRel:f[1],rRel:f[2]}}}function Gg(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return pT(e);var s=e.read_shift(a&&a.biff==12?4:2),i=Bn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function pT(e){var n=Bn(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function gT(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function vT(e,n,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return bT(e);var i=e.read_shift(s>=12?4:2),o=e.read_shift(2),f=(o&16384)>>14,d=(o&32768)>>15;if(o&=16383,d==1)for(;i>524287;)i-=1048576;if(f==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:f,rRel:d}}function bT(e){var n=e.read_shift(2),a=e.read_shift(1),s=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),i==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:i,rRel:s}}function yT(e,n,a){var s=(e[e.l++]&96)>>5,i=zg(e,a.biff>=2&&a.biff<=5?6:8,a);return[s,i]}function ET(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(a)switch(a.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var f=zg(e,o,a);return[s,i,f]}function _T(e,n,a){var s=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function wT(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(a)switch(a.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,i]}function TT(e,n,a){var s=(e[e.l++]&96)>>5,i=mT(e,n-1,a);return[s,i]}function ST(e,n,a){var s=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[s]}function cp(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function AT(e,n,a){e.l+=2;for(var s=e.read_shift(a&&a.biff==2?1:2),i=[],o=0;o<=s;++o)i.push(e.read_shift(a&&a.biff==2?1:2));return i}function NT(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function CT(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function kT(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function DT(e,n,a){var s=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[s]}function Yg(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function OT(e){return e.read_shift(2),Yg(e)}function RT(e){return e.read_shift(2),Yg(e)}function jT(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=Gg(e,0,a);return[s,i]}function MT(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=vT(e,0,a);return[s,i]}function LT(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var o=Gg(e,0,a);return[s,i,o]}function FT(e,n,a){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(a&&a.biff<=3?1:2);return[IS[i],Kg[i],s]}function IT(e,n,a){var s=e[e.l++],i=e.read_shift(1),o=a&&a.biff<=3?[s==88?-1:0,e.read_shift(1)]:BT(e);return[i,(o[0]===0?Kg:FS)[o[1]]]}function BT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function UT(e,n,a){e.l+=a&&a.biff==2?3:4}function PT(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function HT(e){return e.l++,ys[e.read_shift(1)]}function zT(e){return e.l++,e.read_shift(2)}function VT(e){return e.l++,e.read_shift(1)!==0}function GT(e){return e.l++,wa(e)}function YT(e,n,a){return e.l++,Ul(e,n-1,a)}function XT(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Wt(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=ys[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=wa(e);break;case 2:a[1]=Es(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function qT(e,n,a){for(var s=e.read_shift(a.biff==12?4:2),i=[],o=0;o!=s;++o)i.push((a.biff==12?bs:So)(e));return i}function KT(e,n,a){var s=0,i=0;a.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--i==0&&(i=256));for(var o=0,f=[];o!=s&&(f[o]=[]);++o)for(var d=0;d!=i;++d)f[o][d]=XT(e,a.biff);return f}function WT(e,n,a){var s=e.read_shift(1)>>>5&3,i=!a||a.biff>=8?4:2,o=e.read_shift(i);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function $T(e,n,a){if(a.biff==5)return ZT(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[s,i,o]}function ZT(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[n,a,s]}function QT(e,n,a){var s=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function JT(e,n,a){var s=e.read_shift(1)>>>5&3,i=e.read_shift(a&&a.biff==2?1:2);return[s,i]}function eS(e,n,a){var s=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[s]}function tS(e,n,a){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(a)switch(a.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,i]}var aS=Aa,rS=Aa,nS=Aa;function Hl(e,n,a){return e.l+=2,[gT(e)]}function Of(e){return e.l+=6,[]}var sS=Hl,iS=Of,lS=Of,cS=Hl;function Xg(e){return e.l+=2,[ta(e),e.read_shift(2)&1]}var oS=Hl,uS=Xg,fS=Of,dS=Hl,hS=Hl,xS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mS(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),f=xS[a>>2&31];return{ixti:n,coltype:a&3,rt:f,idx:s,c:i,C:o}}function pS(e){return e.l+=2,[e.read_shift(4)]}function gS(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function vS(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function bS(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function yS(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function ES(e){return e.l+=4,[0,0]}var op={1:{n:"PtgExp",f:PT},2:{n:"PtgTbl",f:nS},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:YT},26:{n:"PtgSheet",f:gS},27:{n:"PtgEndSheet",f:vS},28:{n:"PtgErr",f:HT},29:{n:"PtgBool",f:VT},30:{n:"PtgInt",f:zT},31:{n:"PtgNum",f:GT},32:{n:"PtgArray",f:ST},33:{n:"PtgFunc",f:FT},34:{n:"PtgFuncVar",f:IT},35:{n:"PtgName",f:WT},36:{n:"PtgRef",f:jT},37:{n:"PtgArea",f:yT},38:{n:"PtgMemArea",f:QT},39:{n:"PtgMemErr",f:aS},40:{n:"PtgMemNoMem",f:rS},41:{n:"PtgMemFunc",f:JT},42:{n:"PtgRefErr",f:eS},43:{n:"PtgAreaErr",f:_T},44:{n:"PtgRefN",f:MT},45:{n:"PtgAreaN",f:TT},46:{n:"PtgMemAreaN",f:bS},47:{n:"PtgMemNoMemN",f:yS},57:{n:"PtgNameX",f:$T},58:{n:"PtgRef3d",f:LT},59:{n:"PtgArea3d",f:ET},60:{n:"PtgRefErr3d",f:tS},61:{n:"PtgAreaErr3d",f:wT},255:{}},_S={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wS={1:{n:"PtgElfLel",f:Xg},2:{n:"PtgElfRw",f:dS},3:{n:"PtgElfCol",f:sS},6:{n:"PtgElfRwV",f:hS},7:{n:"PtgElfColV",f:cS},10:{n:"PtgElfRadical",f:oS},11:{n:"PtgElfRadicalS",f:fS},13:{n:"PtgElfColS",f:iS},15:{n:"PtgElfColSV",f:lS},16:{n:"PtgElfRadicalLel",f:uS},25:{n:"PtgList",f:mS},29:{n:"PtgSxName",f:pS},255:{}},TS={0:{n:"PtgAttrNoop",f:ES},1:{n:"PtgAttrSemi",f:DT},2:{n:"PtgAttrIf",f:CT},4:{n:"PtgAttrChoose",f:AT},8:{n:"PtgAttrGoto",f:NT},16:{n:"PtgAttrSum",f:UT},32:{n:"PtgAttrBaxcel",f:cp},33:{n:"PtgAttrBaxcel",f:cp},64:{n:"PtgAttrSpace",f:OT},65:{n:"PtgAttrSpaceSemi",f:RT},128:{n:"PtgAttrIfError",f:kT},255:{}};function zl(e,n,a,s){if(s.biff<8)return Aa(e,n);for(var i=e.l+n,o=[],f=0;f!==a.length;++f)switch(a[f][0]){case"PtgArray":a[f][1]=KT(e,0,s),o.push(a[f][1]);break;case"PtgMemArea":a[f][2]=qT(e,a[f][1],s),o.push(a[f][2]);break;case"PtgExp":s&&s.biff==12&&(a[f][1][1]=e.read_shift(4),o.push(a[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[f][0]}return n=i-e.l,n!==0&&o.push(Aa(e,n)),o}function Vl(e,n,a){for(var s=e.l+n,i,o,f=[];s!=e.l;)n=s-e.l,o=e[e.l],i=op[o]||op[_S[o]],(o===24||o===25)&&(i=(o===24?wS:TS)[e[e.l+1]]),!i||!i.f?Aa(e,n):f.push([i.n,i.f(e,n,a)]);return f}function SS(e){for(var n=[],a=0;a<e.length;++a){for(var s=e[a],i=[],o=0;o<s.length;++o){var f=s[o];if(f)switch(f[0]){case 2:i.push('"'+f[1].replace(/"/g,'""')+'"');break;default:i.push(f[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var AS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function NS(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function qg(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!s)return"SH33TJSERR1";var i="";if(a.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function up(e,n,a){var s=qg(e,n,a);return s=="#REF"?s:NS(s,a)}function _a(e,n,a,s,i){var o=i&&i.biff||8,f={s:{c:0,r:0}},d=[],x,m,p,v=0,b=0,y,E="";if(!e[0]||!e[0][0])return"";for(var _=-1,w="",S=0,D=e[0].length;S<D;++S){var A=e[0][S];switch(A[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(x=d.pop(),m=d.pop(),_>=0){switch(e[0][_][1][0]){case 0:w=Gt(" ",e[0][_][1][1]);break;case 1:w=Gt("\r",e[0][_][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}m=m+w,_=-1}d.push(m+AS[A[0]]+x);break;case"PtgIsect":x=d.pop(),m=d.pop(),d.push(m+" "+x);break;case"PtgUnion":x=d.pop(),m=d.pop(),d.push(m+","+x);break;case"PtgRange":x=d.pop(),m=d.pop(),d.push(m+":"+x);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=yl(A[1][1],f,i),d.push(El(p,o));break;case"PtgRefN":p=a?yl(A[1][1],a,i):A[1][1],d.push(El(p,o));break;case"PtgRef3d":v=A[1][1],p=yl(A[1][2],f,i),E=up(s,v,i),d.push(E+"!"+El(p,o));break;case"PtgFunc":case"PtgFuncVar":var z=A[1][0],V=A[1][1];z||(z=0),z&=127;var Y=z==0?[]:d.slice(-z);d.length-=z,V==="User"&&(V=Y.shift()),d.push(V+"("+Y.join(",")+")");break;case"PtgBool":d.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(A[1]);break;case"PtgNum":d.push(String(A[1]));break;case"PtgStr":d.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(A[1]);break;case"PtgAreaN":y=Gm(A[1][1],a?{s:a}:f,i),d.push(Pu(y,i));break;case"PtgArea":y=Gm(A[1][1],f,i),d.push(Pu(y,i));break;case"PtgArea3d":v=A[1][1],y=A[1][2],E=up(s,v,i),d.push(E+"!"+Pu(y,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=A[1][2];var j=(s.names||[])[b-1]||(s[0]||[])[b],Q=j?j.Name:"SH33TJSNAME"+String(b);Q&&Q.slice(0,6)=="_xlfn."&&!i.xlfn&&(Q=Q.slice(6)),d.push(Q);break;case"PtgNameX":var B=A[1][1];b=A[1][2];var ne;if(i.biff<=5)B<0&&(B=-B),s[B]&&(ne=s[B][b]);else{var K="";if(((s[B]||[])[0]||[])[0]==14849||(((s[B]||[])[0]||[])[0]==1025?s[B][b]&&s[B][b].itab>0&&(K=s.SheetNames[s[B][b].itab-1]+"!"):K=s.SheetNames[b-1]+"!"),s[B]&&s[B][b])K+=s[B][b].Name;else if(s[0]&&s[0][b])K+=s[0][b].Name;else{var X=(qg(s,B,i)||"").split(";;");X[b-1]?K=X[b-1]:K+="SH33TJSERRX"}d.push(K);break}ne||(ne={Name:"SH33TJSERRY"}),d.push(ne.Name);break;case"PtgParen":var ee="(",he=")";if(_>=0){switch(w="",e[0][_][1][0]){case 2:ee=Gt(" ",e[0][_][1][1])+ee;break;case 3:ee=Gt("\r",e[0][_][1][1])+ee;break;case 4:he=Gt(" ",e[0][_][1][1])+he;break;case 5:he=Gt("\r",e[0][_][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}d.push(ee+d.pop()+he);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":p={c:A[1][1],r:A[1][0]};var _e={c:a.c,r:a.r};if(s.sharedf[at(p)]){var Z=s.sharedf[at(p)];d.push(_a(Z,f,_e,s,i))}else{var ue=!1;for(x=0;x!=s.arrayf.length;++x)if(m=s.arrayf[x],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){d.push(_a(m[1],f,_e,s,i)),ue=!0;break}ue||d.push(A[1])}break;case"PtgArray":d.push("{"+SS(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&Re.indexOf(e[0][S][0])==-1){A=e[0][_];var te=!0;switch(A[1][0]){case 4:te=!1;case 0:w=Gt(" ",A[1][1]);break;case 5:te=!1;case 1:w=Gt("\r",A[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}d.push((te?w:"")+d.pop()+(te?"":w)),_=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function CS(e,n,a){var s=e.l+n,i=a.biff==2?1:2,o,f=e.read_shift(i);if(f==65535)return[[],Aa(e,n-2)];var d=Vl(e,f,a);return n!==f+i&&(o=zl(e,n-f-i,d,a)),e.l=s,[d,o]}function kS(e,n,a){var s=e.l+n,i=a.biff==2?1:2,o,f=e.read_shift(i);if(f==65535)return[[],Aa(e,n-2)];var d=Vl(e,f,a);return n!==f+i&&(o=zl(e,n-f-i,d,a)),e.l=s,[d,o]}function DS(e,n,a,s){var i=e.l+n,o=Vl(e,s,a),f;return i!==e.l&&(f=zl(e,i-e.l,o,a)),[o,f]}function OS(e,n,a){var s=e.l+n,i,o=e.read_shift(2),f=Vl(e,o,a);return o==65535?[[],Aa(e,n-2)]:(n!==o+2&&(i=zl(e,s-o-2,f,a)),[f,i])}function RS(e){var n;if(Jr(e,e.l+6)!==65535)return[wa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function Vu(e,n,a){var s=e.l+n,i=Fr(e);a.biff==2&&++e.l;var o=RS(e),f=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=kS(e,s-e.l,a);return{cell:i,val:o[0],formula:d,shared:f>>3&1,tt:o[1]}}function Ao(e,n,a){var s=e.read_shift(4),i=Vl(e,s,a),o=e.read_shift(4),f=o>0?zl(e,o,i,a):null;return[i,f]}var jS=Ao,No=Ao,MS=Ao,LS=Ao,FS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Kg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},IS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Gu(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var Sl={},hi={};function Al(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function Wg(e,n,a,s,i,o){try{s.cellNF&&(e.z=st[n])}catch(d){if(s.WTF)throw d}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=da(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(st[n]==null&&fs(By[n]||"General",n),e.t==="e")e.w=e.w||ys[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v);else if(e.t==="d"){var f=ja(e.v);(f|0)===f?e.w=f.toString(10):e.w=Dl(f)}else{if(e.v===void 0)return"";e.w=hs(e.v,hi)}else e.t==="d"?e.w=ur(n,ja(e.v),hi):e.w=ur(n,e.v,hi)}catch(d){if(s.WTF)throw d}if(s.cellStyles&&a!=null)try{e.s=o.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=bo(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=bo(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(s.WTF&&o.Fills)throw d}}}function BS(e,n){var a=Yt(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=bt(a))}var US=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,PS=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,HS=/<(?:\w:)?hyperlink [^>]*>/mg,zS=/"(\w*:\w*)"/,VS=/<(?:\w:)?col\b[^>]*[\/]?>/g,GS=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,YS=/<(?:\w:)?pageMargins[^>]*\/>/g,$g=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,XS=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qS=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KS(e,n,a,s,i,o,f){if(!e)return e;s||(s={"!id":{}});var d=n.dense?[]:{},x={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=e.match(PS);v?(m=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):m=p=e;var b=m.match($g);b?Rf(b[0],d,i,a):(b=m.match(XS))&&WS(b[0],b[1]||"",d,i,a);var y=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var E=m.slice(y,y+50).match(zS);E&&BS(d,E[1])}var _=m.match(qS);_&&_[1]&&t3(_[1],i);var w=[];if(n.cellStyles){var S=m.match(VS);S&&QS(w,S)}v&&a3(v[1],d,n,x,o,f);var D=p.match(GS);D&&(d["!autofilter"]=JS(D[0]));var A=[],z=p.match(US);if(z)for(y=0;y!=z.length;++y)A[y]=Yt(z[y].slice(z[y].indexOf('"')+1));var V=p.match(HS);V&&$S(d,V,s);var Y=p.match(YS);if(Y&&(d["!margins"]=ZS(Qe(Y[0]))),!d["!ref"]&&x.e.c>=x.s.c&&x.e.r>=x.s.r&&(d["!ref"]=bt(x)),n.sheetRows>0&&d["!ref"]){var j=Yt(d["!ref"]);n.sheetRows<=+j.e.r&&(j.e.r=n.sheetRows-1,j.e.r>x.e.r&&(j.e.r=x.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>x.e.c&&(j.e.c=x.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),d["!fullref"]=d["!ref"],d["!ref"]=bt(j))}return w.length>0&&(d["!cols"]=w),A.length>0&&(d["!merges"]=A),d}function Rf(e,n,a,s){var i=Qe(e);a.Sheets[s]||(a.Sheets[s]={}),i.codeName&&(a.Sheets[s].CodeName=yt(Ft(i.codeName)))}function WS(e,n,a,s,i){Rf(e.slice(0,e.indexOf(">")),a,s,i)}function $S(e,n,a){for(var s=Array.isArray(e),i=0;i!=n.length;++i){var o=Qe(Ft(n[i]),!0);if(!o.ref)return;var f=((a||{})["!id"]||[])[o.id];f?(o.Target=f.Target,o.location&&(o.Target+="#"+yt(o.location))):(o.Target="#"+yt(o.location),f={Target:o.Target,TargetMode:"Internal"}),o.Rel=f,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var d=Yt(o.ref),x=d.s.r;x<=d.e.r;++x)for(var m=d.s.c;m<=d.e.c;++m){var p=at({c:m,r:x});s?(e[x]||(e[x]=[]),e[x][m]||(e[x][m]={t:"z",v:void 0}),e[x][m].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function ZS(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function QS(e,n){for(var a=!1,s=0;s!=n.length;++s){var i=Qe(n[s],!0);i.hidden&&(i.hidden=Bt(i.hidden));var o=parseInt(i.min,10)-1,f=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!a&&i.width&&(a=!0,Df(i.width)),pi(i);o<=f;)e[o++]=ga(i)}}function JS(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var e3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function t3(e,n){n.Views||(n.Views=[{}]),(e.match(e3)||[]).forEach(function(a,s){var i=Qe(a);n.Views[s]||(n.Views[s]={}),+i.zoomScale&&(n.Views[s].zoom=+i.zoomScale),Bt(i.rightToLeft)&&(n.Views[s].RTL=!0)})}var a3=function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=Ol("v"),f=Ol("f");return function(x,m,p,v,b,y){for(var E=0,_="",w=[],S=[],D=0,A=0,z=0,V="",Y,j,Q=0,B=0,ne,K,X=0,ee=0,he=Array.isArray(y.CellXf),_e,Z=[],ue=[],Re=Array.isArray(m),te=[],H={},oe=!1,k=!!p.sheetStubs,q=x.split(n),U=0,R=q.length;U!=R;++U){_=q[U].trim();var W=_.length;if(W!==0){var pe=0;e:for(E=0;E<W;++E)switch(_[E]){case">":if(_[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(j=Qe(_.slice(pe,E),!0),Q=j.r!=null?parseInt(j.r,10):Q+1,B=-1,p.sheetRows&&p.sheetRows<Q)continue;H={},oe=!1,j.ht&&(oe=!0,H.hpt=parseFloat(j.ht),H.hpx=Ll(H.hpt)),j.hidden=="1"&&(oe=!0,H.hidden=!0),j.outlineLevel!=null&&(oe=!0,H.level=+j.outlineLevel),oe&&(te[Q-1]=H)}break;case"<":pe=E;break}if(pe>=E)break;if(j=Qe(_.slice(pe,E),!0),Q=j.r!=null?parseInt(j.r,10):Q+1,B=-1,!(p.sheetRows&&p.sheetRows<Q)){v.s.r>Q-1&&(v.s.r=Q-1),v.e.r<Q-1&&(v.e.r=Q-1),p&&p.cellStyles&&(H={},oe=!1,j.ht&&(oe=!0,H.hpt=parseFloat(j.ht),H.hpx=Ll(H.hpt)),j.hidden=="1"&&(oe=!0,H.hidden=!0),j.outlineLevel!=null&&(oe=!0,H.level=+j.outlineLevel),oe&&(te[Q-1]=H)),w=_.slice(E).split(e);for(var ve=0;ve!=w.length&&w[ve].trim().charAt(0)=="<";++ve);for(w=w.slice(ve),E=0;E!=w.length;++E)if(_=w[E].trim(),_.length!==0){if(S=_.match(a),D=E,A=0,z=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,S!=null&&S.length===2){for(D=0,V=S[1],A=0;A!=V.length&&!((z=V.charCodeAt(A)-64)<1||z>26);++A)D=26*D+z;--D,B=D}else++B;for(A=0;A!=_.length&&_.charCodeAt(A)!==62;++A);if(++A,j=Qe(_.slice(0,A),!0),j.r||(j.r=at({r:Q-1,c:B})),V=_.slice(A),Y={t:""},(S=V.match(o))!=null&&S[1]!==""&&(Y.v=yt(S[1])),p.cellFormula){if((S=V.match(f))!=null&&S[1]!==""){if(Y.f=yt(Ft(S[1])).replace(/\r\n/g,`
`),p.xlfn||(Y.f=lp(Y.f)),S[0].indexOf('t="array"')>-1)Y.F=(V.match(i)||[])[1],Y.F.indexOf(":")>-1&&Z.push([Yt(Y.F),Y.F]);else if(S[0].indexOf('t="shared"')>-1){K=Qe(S[0]);var Se=yt(Ft(S[1]));p.xlfn||(Se=lp(Se)),ue[parseInt(K.si,10)]=[K,Se,j.r]}}else(S=V.match(/<f[^>]*\/>/))&&(K=Qe(S[0]),ue[K.si]&&(Y.f=hT(ue[K.si][1],ue[K.si][2],j.r)));var we=Oa(j.r);for(A=0;A<Z.length;++A)we.r>=Z[A][0].s.r&&we.r<=Z[A][0].e.r&&we.c>=Z[A][0].s.c&&we.c<=Z[A][0].e.c&&(Y.F=Z[A][1])}if(j.t==null&&Y.v===void 0)if(Y.f||Y.F)Y.v=0,Y.t="n";else if(k)Y.t="z";else continue;else Y.t=j.t||"n";switch(v.s.c>B&&(v.s.c=B),v.e.c<B&&(v.e.c=B),Y.t){case"n":if(Y.v==""||Y.v==null){if(!k)continue;Y.t="z"}else Y.v=parseFloat(Y.v);break;case"s":if(typeof Y.v>"u"){if(!k)continue;Y.t="z"}else ne=Sl[parseInt(Y.v,10)],Y.v=ne.t,Y.r=ne.r,p.cellHTML&&(Y.h=ne.h);break;case"str":Y.t="s",Y.v=Y.v!=null?Ft(Y.v):"",p.cellHTML&&(Y.h=bf(Y.v));break;case"inlineStr":S=V.match(s),Y.t="s",S!=null&&(ne=kf(S[1]))?(Y.v=ne.t,p.cellHTML&&(Y.h=ne.h)):Y.v="";break;case"b":Y.v=Bt(Y.v);break;case"d":p.cellDates?Y.v=da(Y.v,1):(Y.v=ja(da(Y.v,1)),Y.t="n");break;case"e":(!p||p.cellText!==!1)&&(Y.w=Y.v),Y.v=gg[Y.v];break}if(X=ee=0,_e=null,he&&j.s!==void 0&&(_e=y.CellXf[j.s],_e!=null&&(_e.numFmtId!=null&&(X=_e.numFmtId),p.cellStyles&&_e.fillId!=null&&(ee=_e.fillId))),Wg(Y,X,ee,p,b,y),p.cellDates&&he&&Y.t=="n"&&gi(st[X])&&(Y.t="d",Y.v=To(Y.v)),j.cm&&p.xlmeta){var Be=(p.xlmeta.Cell||[])[+j.cm-1];Be&&Be.type=="XLDAPR"&&(Y.D=!0)}if(Re){var I=Oa(j.r);m[I.r]||(m[I.r]=[]),m[I.r][I.c]=Y}else m[j.r]=Y}}}}te.length>0&&(m["!rows"]=te)}}();function r3(e,n){var a={},s=e.l+n;a.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(a.level=o&7),o&16&&(a.hidden=!0),o&32&&(a.hpt=i/20),a}var n3=bs;function s3(){}function i3(e,n){var a={},s=e[e.l];return++e.l,a.above=!(s&64),a.left=!(s&128),e.l+=18,a.name=CE(e),a}function l3(e){var n=fr(e);return[n]}function c3(e){var n=vs(e);return[n]}function o3(e){var n=fr(e),a=e.read_shift(1);return[n,a,"b"]}function u3(e){var n=vs(e),a=e.read_shift(1);return[n,a,"b"]}function f3(e){var n=fr(e),a=e.read_shift(1);return[n,a,"e"]}function d3(e){var n=vs(e),a=e.read_shift(1);return[n,a,"e"]}function h3(e){var n=fr(e),a=e.read_shift(4);return[n,a,"s"]}function x3(e){var n=vs(e),a=e.read_shift(4);return[n,a,"s"]}function m3(e){var n=fr(e),a=wa(e);return[n,a,"n"]}function Zg(e){var n=vs(e),a=wa(e);return[n,a,"n"]}function p3(e){var n=fr(e),a=Af(e);return[n,a,"n"]}function g3(e){var n=vs(e),a=Af(e);return[n,a,"n"]}function v3(e){var n=fr(e),a=Tf(e);return[n,a,"is"]}function b3(e){var n=fr(e),a=Sa(e);return[n,a,"str"]}function y3(e){var n=vs(e),a=Sa(e);return[n,a,"str"]}function E3(e,n,a){var s=e.l+n,i=fr(e);i.r=a["!row"];var o=e.read_shift(1),f=[i,o,"b"];if(a.cellFormula){e.l+=2;var d=No(e,s-e.l,a);f[3]=_a(d,null,i,a.supbooks,a)}else e.l=s;return f}function _3(e,n,a){var s=e.l+n,i=fr(e);i.r=a["!row"];var o=e.read_shift(1),f=[i,o,"e"];if(a.cellFormula){e.l+=2;var d=No(e,s-e.l,a);f[3]=_a(d,null,i,a.supbooks,a)}else e.l=s;return f}function w3(e,n,a){var s=e.l+n,i=fr(e);i.r=a["!row"];var o=wa(e),f=[i,o,"n"];if(a.cellFormula){e.l+=2;var d=No(e,s-e.l,a);f[3]=_a(d,null,i,a.supbooks,a)}else e.l=s;return f}function T3(e,n,a){var s=e.l+n,i=fr(e);i.r=a["!row"];var o=Sa(e),f=[i,o,"str"];if(a.cellFormula){e.l+=2;var d=No(e,s-e.l,a);f[3]=_a(d,null,i,a.supbooks,a)}else e.l=s;return f}var S3=bs;function A3(e,n){var a=e.l+n,s=bs(e),i=Sf(e),o=Sa(e),f=Sa(e),d=Sa(e);e.l=a;var x={rfx:s,relId:i,loc:o,display:d};return f&&(x.Tooltip=f),x}function N3(){}function C3(e,n,a){var s=e.l+n,i=xg(e),o=e.read_shift(1),f=[i];if(f[2]=o,a.cellFormula){var d=jS(e,s-e.l,a);f[1]=d}else e.l=s;return f}function k3(e,n,a){var s=e.l+n,i=bs(e),o=[i];if(a.cellFormula){var f=LS(e,s-e.l,a);o[1]=f,e.l=s}else e.l=s;return o}var D3=["left","right","top","bottom","header","footer"];function O3(e){var n={};return D3.forEach(function(a){n[a]=wa(e)}),n}function R3(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function j3(){}function M3(){}function L3(e,n,a,s,i,o,f){if(!e)return e;var d=n||{};s||(s={"!id":{}});var x=d.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,b=!1,y,E,_,w,S,D,A,z,V,Y=[];d.biff=12,d["!row"]=0;var j=0,Q=!1,B=[],ne={},K=d.supbooks||i.supbooks||[[]];if(K.sharedf=ne,K.arrayf=B,K.SheetNames=i.SheetNames||i.Sheets.map(function(Re){return Re.name}),!d.supbooks&&(d.supbooks=K,i.Names))for(var X=0;X<i.Names.length;++X)K[0][X+1]=i.Names[X];var ee=[],he=[],_e=!1;_o[16]={n:"BrtShortReal",f:Zg};var Z;if(nn(e,function(te,H,oe){if(!b)switch(oe){case 148:m=te;break;case 0:y=te,d.sheetRows&&d.sheetRows<=y.r&&(b=!0),z=va(w=y.r),d["!row"]=y.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Ll(te.hpt)),he[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:te[2]},te[2]){case"n":E.v=te[1];break;case"s":A=Sl[te[1]],E.v=A.t,E.r=A.r;break;case"b":E.v=!!te[1];break;case"e":E.v=te[1],d.cellText!==!1&&(E.w=ys[E.v]);break;case"str":E.t="s",E.v=te[1];break;case"is":E.t="s",E.v=te[1].t;break}if((_=f.CellXf[te[0].iStyleRef])&&Wg(E,_.numFmtId,null,d,o,f),S=te[0].c==-1?S+1:te[0].c,d.dense?(x[w]||(x[w]=[]),x[w][S]=E):x[ia(S)+z]=E,d.cellFormula){for(Q=!1,j=0;j<B.length;++j){var k=B[j];y.r>=k[0].s.r&&y.r<=k[0].e.r&&S>=k[0].s.c&&S<=k[0].e.c&&(E.F=bt(k[0]),Q=!0)}!Q&&te.length>3&&(E.f=te[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>S&&(p.s.c=S),p.e.r<y.r&&(p.e.r=y.r),p.e.c<S&&(p.e.c=S),d.cellDates&&_&&E.t=="n"&&gi(st[_.numFmtId])){var q=us(E.v);q&&(E.t="d",E.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}Z&&(Z.type=="XLDAPR"&&(E.D=!0),Z=void 0);break;case 1:case 12:if(!d.sheetStubs||v)break;E={t:"z",v:void 0},S=te[0].c==-1?S+1:te[0].c,d.dense?(x[w]||(x[w]=[]),x[w][S]=E):x[ia(S)+z]=E,p.s.r>y.r&&(p.s.r=y.r),p.s.c>S&&(p.s.c=S),p.e.r<y.r&&(p.e.r=y.r),p.e.c<S&&(p.e.c=S),Z&&(Z.type=="XLDAPR"&&(E.D=!0),Z=void 0);break;case 176:Y.push(te);break;case 49:Z=((d.xlmeta||{}).Cell||[])[te-1];break;case 494:var U=s["!id"][te.relId];for(U?(te.Target=U.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=U):te.relId==""&&(te.Target="#"+te.loc),w=te.rfx.s.r;w<=te.rfx.e.r;++w)for(S=te.rfx.s.c;S<=te.rfx.e.c;++S)d.dense?(x[w]||(x[w]=[]),x[w][S]||(x[w][S]={t:"z",v:void 0}),x[w][S].l=te):(D=at({c:S,r:w}),x[D]||(x[D]={t:"z",v:void 0}),x[D].l=te);break;case 426:if(!d.cellFormula)break;B.push(te),V=d.dense?x[w][S]:x[ia(S)+z],V.f=_a(te[1],p,{r:y.r,c:S},K,d),V.F=bt(te[0]);break;case 427:if(!d.cellFormula)break;ne[at(te[0].s)]=te[1],V=d.dense?x[w][S]:x[ia(S)+z],V.f=_a(te[1],p,{r:y.r,c:S},K,d);break;case 60:if(!d.cellStyles)break;for(;te.e>=te.s;)ee[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},_e||(_e=!0,Df(te.w/256)),pi(ee[te.e+1]);break;case 161:x["!autofilter"]={ref:bt(te)};break;case 476:x["!margins"]=te;break;case 147:i.Sheets[a]||(i.Sheets[a]={}),te.name&&(i.Sheets[a].CodeName=te.name),(te.above||te.left)&&(x["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!H.T){if(!v||d.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},d),delete d.supbooks,delete d["!row"],!x["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(x["!ref"]=bt(m||p)),d.sheetRows&&x["!ref"]){var ue=Yt(x["!ref"]);d.sheetRows<=+ue.e.r&&(ue.e.r=d.sheetRows-1,ue.e.r>p.e.r&&(ue.e.r=p.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>p.e.c&&(ue.e.c=p.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),x["!fullref"]=x["!ref"],x["!ref"]=bt(ue))}return Y.length>0&&(x["!merges"]=Y),ee.length>0&&(x["!cols"]=ee),he.length>0&&(x["!rows"]=he),x}function F3(e){var n=[],a=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var f=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);f&&(n[+f[1]]=a?+f[2]:f[2])});var i=yt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){s=o.replace(/<.*?>/g,"")}),[n,i,s]}function I3(e,n,a,s,i,o){var f=o||{"!type":"chart"};if(!e)return o;var d=0,x=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var b=F3(v);p.s.r=p.s.c=0,p.e.c=d,m=ia(d),b[0].forEach(function(y,E){f[m+va(E)]={t:"n",v:y,z:b[1]},x=E}),p.e.r<x&&(p.e.r=x),++d}),d>0&&(f["!ref"]=bt(p)),f}function B3(e,n,a,s,i){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},f,d=e.match($g);return d&&Rf(d[0],o,i,a),(f=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=f[1]),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}function U3(e,n){e.l+=10;var a=Sa(e);return{name:a}}function P3(e,n,a,s,i){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},f=!1;return nn(e,function(x,m,p){switch(p){case 550:o["!rel"]=x;break;case 651:i.Sheets[a]||(i.Sheets[a]={}),x.name&&(i.Sheets[a].CodeName=x.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!f||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}var Qg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],H3=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],z3=[],V3=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function dp(e,n){for(var a=0;a!=e.length;++a)for(var s=e[a],i=0;i!=n.length;++i){var o=n[i];if(s[o[0]]==null)s[o[0]]=o[1];else switch(o[2]){case"bool":typeof s[o[0]]=="string"&&(s[o[0]]=Bt(s[o[0]]));break;case"int":typeof s[o[0]]=="string"&&(s[o[0]]=parseInt(s[o[0]],10));break}}}function hp(e,n){for(var a=0;a!=n.length;++a){var s=n[a];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Bt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function Jg(e){hp(e.WBProps,Qg),hp(e.CalcPr,V3),dp(e.WBView,H3),dp(e.Sheets,z3),hi.date1904=Bt(e.WBProps.date1904)}var G3="][*?/\\".split("");function Y3(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return G3.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}var X3=/<\w+:workbook/;function q3(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,i="xmlns",o={},f=0;if(e.replace(Na,function(x,m){var p=Qe(x);switch(Lr(p[0])){case"<?xml":break;case"<workbook":x.match(X3)&&(i="xmlns"+x.match(/<(\w+):/)[1]),a.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],a.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Qg.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":a.WBProps[v[0]]=Bt(p[v[0]]);break;case"int":a.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:a.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(a.WBProps.CodeName=Ft(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],a.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=yt(Ft(p.name)),delete p[0],a.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":o={},o.Name=Ft(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),Bt(p.hidden||"0")&&(o.Hidden=!0),f=m+x.length;break;case"</definedName>":o.Ref=yt(Ft(e.slice(f,m))),a.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],a.CalcPr=p;break;case"<calcPr/>":delete p[0],a.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return x}),fE.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return Jg(a),a}function K3(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=Qu(e),a.name=Sa(e),a}function W3(e,n){var a={},s=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var i=n>8?Sa(e):"";return i.length>0&&(a.CodeName=i),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function $3(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function Z3(e,n,a){var s=e.l+n;e.l+=4,e.l+=1;var i=e.read_shift(4),o=kE(e),f=MS(e,0,a),d=Sf(e);e.l=s;var x={Name:o,Ptg:f};return i<268435455&&(x.Sheet=i),d&&(x.Comment=d),x}function Q3(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1;n||(n={}),n.biff=12;var o=[],f=[[]];return f.SheetNames=[],f.XTI=[],_o[16]={n:"BrtFRTArchID$",f:$3},nn(e,function(x,m,p){switch(p){case 156:f.SheetNames.push(x.name),a.Sheets.push(x);break;case 153:a.WBProps=x;break;case 39:x.Sheet!=null&&(n.SID=x.Sheet),x.Ref=_a(x.Ptg,null,null,f,n),delete n.SID,delete x.Ptg,o.push(x);break;case 1036:break;case 357:case 358:case 355:case 667:f[0].length?f.push([p,x]):f[0]=[p,x],f[f.length-1].XTI=[];break;case 362:f.length===0&&(f[0]=[],f[0].XTI=[]),f[f.length-1].XTI=f[f.length-1].XTI.concat(x),f.XTI=f.XTI.concat(x);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(p),i=!0;break;case 36:s.pop(),i=!1;break;case 37:s.push(p),i=!0;break;case 38:s.pop(),i=!1;break;case 16:break;default:if(!m.T){if(!i||n.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),Jg(a),a.Names=o,a.supbooks=f,a}function J3(e,n,a){return n.slice(-4)===".bin"?Q3(e,a):q3(e,a)}function eA(e,n,a,s,i,o,f,d){return n.slice(-4)===".bin"?L3(e,s,a,i,o,f,d):KS(e,s,a,i,o,f,d)}function tA(e,n,a,s,i,o,f,d){return n.slice(-4)===".bin"?P3(e,s,a,i,o):B3(e,s,a,i,o)}function aA(e,n,a,s,i,o,f,d){return n.slice(-4)===".bin"?uT():fT()}function rA(e,n,a,s,i,o,f,d){return n.slice(-4)===".bin"?cT():oT()}function nA(e,n,a,s){return n.slice(-4)===".bin"?Sw(e,a,s):bw(e,a,s)}function sA(e,n,a){return Ug(e,a)}function iA(e,n,a){return n.slice(-4)===".bin"?H_(e,a):U_(e,a)}function lA(e,n,a){return n.slice(-4)===".bin"?sT(e,a):eT(e,a)}function cA(e,n,a){return n.slice(-4)===".bin"?Zw(e):Ww(e)}function oA(e,n,a,s){return a.slice(-4)===".bin"?Qw(e,n,a,s):void 0}function uA(e,n,a){return n.slice(-4)===".bin"?qw(e,n,a):Kw(e,n,a)}var e2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,t2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function br(e,n){var a=e.split(/\s+/),s=[];if(s[0]=a[0],a.length===1)return s;var i=e.match(e2),o,f,d,x;if(i)for(x=0;x!=i.length;++x)o=i[x].match(t2),(f=o[1].indexOf(":"))===-1?s[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?d="xmlns"+o[1].slice(6):d=o[1].slice(f+1),s[d]=o[2].slice(1,o[2].length-1));return s}function fA(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var s=e.match(e2),i,o,f,d;if(s)for(d=0;d!=s.length;++d)i=s[d].match(t2),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?f="xmlns"+i[1].slice(6):f=i[1].slice(o+1),a[f]=i[2].slice(1,i[2].length-1));return a}var Nl;function dA(e,n){var a=Nl[e]||yt(e);return a==="General"?hs(n):ur(a,n)}function hA(e,n,a,s){var i=s;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Bt(s);break;case"i2":case"int":i=parseInt(s,10);break;case"r4":case"float":i=parseFloat(s);break;case"date":case"dateTime.tz":i=da(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[yt(n)]=i}function xA(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||ys[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=hs(e.v):e.w=dA(n||"General",e.v)}catch(o){if(a.WTF)throw o}try{var s=Nl[n]||n||"General";if(a.cellNF&&(e.z=s),a.cellDates&&e.t=="n"&&gi(s)){var i=us(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(a.WTF)throw o}}}function mA(e,n,a){if(a.cellStyles&&n.Interior){var s=n.Interior;s.Pattern&&(s.patternType=hw[s.Pattern]||s.Pattern)}e[n.ID]=n}function pA(e,n,a,s,i,o,f,d,x,m){var p="General",v=s.StyleID,b={};m=m||{};var y=[],E=0;for(v===void 0&&d&&(v=d.StyleID),v===void 0&&f&&(v=f.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&y.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(a.Type){case"Boolean":s.t="b",s.v=Bt(e);break;case"String":s.t="s",s.r=Lm(yt(e)),s.v=e.indexOf("<")>-1?yt(n||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(da(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=yt(e):s.v<60&&(s.v=s.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=gg[e],m.cellText!==!1&&(s.w=e);break;default:e==""&&n==""?s.t="z":(s.t="s",s.v=Lm(n||e));break}if(xA(s,p,m),m.cellFormula!==!1)if(s.Formula){var _=yt(s.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),s.f=di(_,i),delete s.Formula,s.ArrayRange=="RC"?s.F=di("RC:RC",i):s.ArrayRange&&(s.F=di(s.ArrayRange,i),x.push([Yt(s.F),s.F]))}else for(E=0;E<x.length;++E)i.r>=x[E][0].s.r&&i.r<=x[E][0].e.r&&i.c>=x[E][0].s.c&&i.c<=x[E][0].e.c&&(s.F=x[E][1]);m.cellStyles&&(y.forEach(function(w){!b.patternType&&w.patternType&&(b.patternType=w.patternType)}),s.s=b),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function gA(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Yu(e,n){var a=n||{};Vp();var s=ml(yf(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(s=Ft(s));var i=s.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var f=ga(a);return f.type="string",jl.to_workbook(s,f)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ie){i.indexOf("<"+Ie)>=0&&(o=!0)}),o)return AA(s,a);Nl={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,x=[],m,p={},v=[],b=a.dense?[]:{},y="",E={},_={},w=br('<Data ss:Type="String">'),S=0,D=0,A=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},Y={},j="",Q=0,B=[],ne={},K={},X=0,ee=[],he=[],_e={},Z=[],ue,Re=!1,te=[],H=[],oe={},k=0,q=0,U={Sheets:[],WBProps:{date1904:!1}},R={};Rl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";d=Rl.exec(s);)switch(d[3]=(W=d[3]).toLowerCase()){case"data":if(W=="data"){if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&x.push([d[3],!0]);break}if(x[x.length-1][1])break;d[1]==="/"?pA(s.slice(S,d.index),j,w,x[x.length-1][0]=="comment"?_e:E,{c:D,r:A},V,Z[D],_,te,a):(j="",w=br(d[0]),S=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(he.length>0&&(E.c=he),(!a.sheetRows||a.sheetRows>A)&&E.v!==void 0&&(a.dense?(b[A]||(b[A]=[]),b[A][D]=E):b[ia(D)+va(A)]=E),E.HRef&&(E.l={Target:yt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(k=D+(parseInt(E.MergeAcross,10)|0),q=A+(parseInt(E.MergeDown,10)|0),B.push({s:{c:D,r:A},e:{c:k,r:q}})),!a.sheetStubs)E.MergeAcross?D=k+1:++D;else if(E.MergeAcross||E.MergeDown){for(var pe=D;pe<=k;++pe)for(var ve=A;ve<=q;++ve)(pe>D||ve>A)&&(a.dense?(b[ve]||(b[ve]=[]),b[ve][pe]={t:"z"}):b[ia(pe)+va(ve)]={t:"z"});D=k+1}else++D;else E=fA(d[0]),E.Index&&(D=+E.Index-1),D<z.s.c&&(z.s.c=D),D>z.e.c&&(z.e.c=D),d[0].slice(-2)==="/>"&&++D,he=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(A<z.s.r&&(z.s.r=A),A>z.e.r&&(z.e.r=A),d[0].slice(-2)==="/>"&&(_=br(d[0]),_.Index&&(A=+_.Index-1)),D=0,++A):(_=br(d[0]),_.Index&&(A=+_.Index-1),oe={},(_.AutoFitHeight=="0"||_.Height)&&(oe.hpx=parseInt(_.Height,10),oe.hpt=Bg(oe.hpx),H[A]=oe),_.Hidden=="1"&&(oe.hidden=!0,H[A]=oe));break;case"worksheet":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));v.push(y),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(b["!ref"]=bt(z),a.sheetRows&&a.sheetRows<=z.e.r&&(b["!fullref"]=b["!ref"],z.e.r=a.sheetRows-1,b["!ref"]=bt(z))),B.length&&(b["!merges"]=B),Z.length>0&&(b["!cols"]=Z),H.length>0&&(b["!rows"]=H),p[y]=b}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=D=0,x.push([d[3],!1]),m=br(d[0]),y=yt(m.Name),b=a.dense?[]:{},B=[],te=[],H=[],R={name:y,Hidden:0},U.Sheets.push(R);break;case"table":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else{if(d[0].slice(-2)=="/>")break;x.push([d[3],!1]),Z=[],Re=!1}break;case"style":d[1]==="/"?mA(V,Y,a):Y=br(d[0]);break;case"numberformat":Y.nf=yt(br(d[0]).Format||"General"),Nl[Y.nf]&&(Y.nf=Nl[Y.nf]);for(var Se=0;Se!=392&&st[Se]!=Y.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(st[Se]==null){fs(Y.nf,Se);break}}break;case"column":if(x[x.length-1][0]!=="table")break;if(ue=br(d[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Re&&ue.wpx>10){Re=!0,Da=Fg;for(var we=0;we<Z.length;++we)Z[we]&&pi(Z[we])}Re&&pi(ue),Z[ue.Index-1||Z.length]=ue;for(var Be=0;Be<+ue.Span;++Be)Z[Z.length]=ga(ue);break;case"namedrange":if(d[1]==="/")break;U.Names||(U.Names=[]);var I=Qe(d[0]),Pe={Name:I.Name,Ref:di(I.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Pe.Sheet=U.Sheets.length-1),U.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?j+=s.slice(Q,d.index):Q=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;Y.Interior=br(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?e4(ne,W,s.slice(X,d.index)):X=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else x.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));gA(_e),he.push(_e)}else x.push([d[3],!1]),m=br(d[0]),_e={a:m.Author};break;case"autofilter":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Ue=br(d[0]);b["!autofilter"]={ref:di(Ue.Range).replace(/\$/g,"")},x.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&x.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((m=x.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&x.push([d[3],!0]);break;case"null":break;default:if(x.length==0&&d[3]=="document"||x.length==0&&d[3]=="uof")return bp(s,a);var We=!0;switch(x[x.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(d[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(s.slice(X,d.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else X=d.index+d[0].length;break;case"header":b["!margins"]||Al(b["!margins"]={},"xlml"),isNaN(+Qe(d[0]).Margin)||(b["!margins"].header=+Qe(d[0]).Margin);break;case"footer":b["!margins"]||Al(b["!margins"]={},"xlml"),isNaN(+Qe(d[0]).Margin)||(b["!margins"].footer=+Qe(d[0]).Margin);break;case"pagemargins":var Ve=Qe(d[0]);b["!margins"]||Al(b["!margins"]={},"xlml"),isNaN(+Ve.Top)||(b["!margins"].top=+Ve.Top),isNaN(+Ve.Left)||(b["!margins"].left=+Ve.Left),isNaN(+Ve.Right)||(b["!margins"].right=+Ve.Right),isNaN(+Ve.Bottom)||(b["!margins"].bottom=+Ve.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||d[3].match(/!\[CDATA/))break;if(!x[x.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+x.join("|");if(x[x.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?hA(K,W,ee,s.slice(X,d.index)):(ee=d,X=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+x.join("|")}var ge={};return!a.bookSheets&&!a.bookProps&&(ge.Sheets=p),ge.SheetNames=v,ge.Workbook=U,ge.SSF=ga(st),ge.Props=ne,ge.Custprops=K,ge}function af(e,n){switch(Lf(n=n||{}),n.type||"base64"){case"base64":return Yu(Wa(e),n);case"binary":case"buffer":case"file":return Yu(e,n);case"array":return Yu(gs(e),n)}}function vA(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=RE(a),a.length-a.l<=4)return n;var s=a.read_shift(4);if(s==0||s>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(s=a.read_shift(4),s!==1907505652)||(n.UnicodeClipboardFormat=jE(a),s=a.read_shift(4),s==0||s>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var bA=[60,1084,2066,2165,2175];function yA(e,n,a,s,i){var o=s,f=[],d=a.slice(a.l,a.l+o);if(i&&i.enc&&i.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(d)}f.push(d),a.l+=o;for(var x=Jr(a,a.l),m=rf[x],p=0;m!=null&&bA.indexOf(x)>-1;)o=Jr(a,a.l+2),p=a.l+4,x==2066?p+=4:(x==2165||x==2175)&&(p+=12),d=a.slice(p,a.l+4+o),f.push(d),a.l+=4+o,m=rf[x=Jr(a,a.l)];var v=jn(f);pa(v,0);var b=0;v.lens=[];for(var y=0;y<f.length;++y)v.lens.push(b),b+=f[y].length;if(v.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+s;return n.f(v,v.length,i)}function Or(e,n,a){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=st[s])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||ys[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=hs(e.v):e.w=ur(s,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&s&&e.t=="n"&&gi(st[s]||String(s))){var i=us(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function lo(e,n,a){return{v:e,ixfe:n,t:a}}function EA(e,n){var a={opts:{}},s={},i=n.dense?[]:{},o={},f={},d=null,x=[],m="",p={},v,b="",y,E,_,w,S={},D=[],A,z,V=[],Y=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},B=function(De){return De<8?ds[De]:De<64&&Y[De-8]||ds[De]},ne=function(De,ze,wt){var Et=ze.XF.data;if(!(!Et||!Et.patternType||!wt||!wt.cellStyles)){ze.s={},ze.s.patternType=Et.patternType;var Pt;(Pt=Ml(B(Et.icvFore)))&&(ze.s.fgColor={rgb:Pt}),(Pt=Ml(B(Et.icvBack)))&&(ze.s.bgColor={rgb:Pt})}},K=function(De,ze,wt){if(!(oe>1)&&!(wt.sheetRows&&De.r>=wt.sheetRows)){if(wt.cellStyles&&ze.XF&&ze.XF.data&&ne(De,ze,wt),delete ze.ixfe,delete ze.XF,v=De,b=at(De),(!f||!f.s||!f.e)&&(f={s:{r:0,c:0},e:{r:0,c:0}}),De.r<f.s.r&&(f.s.r=De.r),De.c<f.s.c&&(f.s.c=De.c),De.r+1>f.e.r&&(f.e.r=De.r+1),De.c+1>f.e.c&&(f.e.c=De.c+1),wt.cellFormula&&ze.f){for(var Et=0;Et<D.length;++Et)if(!(D[Et][0].s.c>De.c||D[Et][0].s.r>De.r)&&!(D[Et][0].e.c<De.c||D[Et][0].e.r<De.r)){ze.F=bt(D[Et][0]),(D[Et][0].s.c!=De.c||D[Et][0].s.r!=De.r)&&delete ze.f,ze.f&&(ze.f=""+_a(D[Et][1],f,De,te,X));break}}wt.dense?(i[De.r]||(i[De.r]=[]),i[De.r][De.c]=ze):i[b]=ze}},X={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(X.password=n.password);var ee,he=[],_e=[],Z=[],ue=[],Re=!1,te=[];te.SheetNames=X.snames,te.sharedf=X.sharedf,te.arrayf=X.arrayf,te.names=[],te.XTI=[];var H=0,oe=0,k=0,q=[],U=[],R;X.codepage=1200,_r(1200);for(var W=!1;e.l<e.length-1;){var pe=e.l,ve=e.read_shift(2);if(ve===0&&H===10)break;var Se=e.l===e.length?0:e.read_shift(2),we=rf[ve];if(we&&we.f){if(n.bookSheets&&H===133&&ve!==133)break;if(H=ve,we.r===2||we.r==12){var Be=e.read_shift(2);if(Se-=2,!X.enc&&Be!==ve&&((Be&255)<<8|Be>>8)!==ve)throw new Error("rt mismatch: "+Be+"!="+ve);we.r==12&&(e.l+=10,Se-=10)}var I={};if(ve===10?I=we.f(e,Se,X):I=yA(ve,we,e,Se,X),oe==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(ve){case 34:a.opts.Date1904=j.WBProps.date1904=I;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=I,!n.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=I;break;case 66:var Pe=Number(I);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}_r(X.codepage=Pe),W=!0;break;case 317:X.rrtabid=I;break;case 25:X.winlocked=I;break;case 439:a.opts.RefreshAll=I;break;case 12:a.opts.CalcCount=I;break;case 16:a.opts.CalcDelta=I;break;case 17:a.opts.CalcIter=I;break;case 13:a.opts.CalcMode=I;break;case 14:a.opts.CalcPrecision=I;break;case 95:a.opts.CalcSaveRecalc=I;break;case 15:X.CalcRefMode=I;break;case 2211:a.opts.FullCalc=I;break;case 129:I.fDialog&&(i["!type"]="dialog"),I.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),I.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(I);break;case 430:te.push([I]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(I);break;case 24:case 536:R={Name:I.Name,Ref:_a(I.rgce,f,null,te,X)},I.itab>0&&(R.Sheet=I.itab-1),te.names.push(R),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(U[I.itab-1]={ref:bt(I.rgce[0][0][1][2])});break;case 22:X.ExternCount=I;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(I),te.XTI=te.XTI.concat(I);break;case 2196:if(X.biff<8)break;R!=null&&(R.Comment=I[1]);break;case 18:i["!protect"]=I;break;case 19:I!==0&&X.WTF&&console.error("Password verifier: "+I);break;case 133:o[I.pos]=I,X.snames.push(I.name);break;case 10:{if(--oe)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,i["!ref"]=bt(f),n.sheetRows&&n.sheetRows<=f.e.r){var Ue=f.e.r;f.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=bt(f),f.e.r=Ue}f.e.r++,f.e.c++}he.length>0&&(i["!merges"]=he),_e.length>0&&(i["!objects"]=_e),Z.length>0&&(i["!cols"]=Z),ue.length>0&&(i["!rows"]=ue),j.Sheets.push(Q)}m===""?p=i:s[m]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),X.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(X.biff=5,W=!0,_r(X.codepage=28591)),X.biff==8&&I.BIFFVer==0&&I.dt==16&&(X.biff=2),oe++)break;if(i=n.dense?[]:{},X.biff<8&&!W&&(W=!0,_r(X.codepage=n.codepage||1252)),X.biff<5||I.BIFFVer==0&&I.dt==4096){m===""&&(m="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:e.l-Se,name:m};o[We.pos]=We,X.snames.push(m)}else m=(o[pe]||{name:""}).name;I.dt==32&&(i["!type"]="chart"),I.dt==64&&(i["!type"]="macro"),he=[],_e=[],X.arrayf=D=[],Z=[],ue=[],Re=!1,Q={Hidden:(o[pe]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[I.r]||[])[I.c]:i[at({c:I.c,r:I.r})])&&++I.c,A={ixfe:I.ixfe,XF:V[I.ixfe]||{},v:I.val,t:"n"},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n);break;case 5:case 517:A={ixfe:I.ixfe,XF:V[I.ixfe],v:I.val,t:I.t},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n);break;case 638:A={ixfe:I.ixfe,XF:V[I.ixfe],v:I.rknum,t:"n"},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n);break;case 189:for(var Ve=I.c;Ve<=I.C;++Ve){var ge=I.rkrec[Ve-I.c][0];A={ixfe:ge,XF:V[ge],v:I.rkrec[Ve-I.c][1],t:"n"},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:Ve,r:I.r},A,n)}break;case 6:case 518:case 1030:{if(I.val=="String"){d=I;break}if(A=lo(I.val,I.cell.ixfe,I.tt),A.XF=V[A.ixfe],n.cellFormula){var Ie=I.formula;if(Ie&&Ie[0]&&Ie[0][0]&&Ie[0][0][0]=="PtgExp"){var pt=Ie[0][0][1][0],ye=Ie[0][0][1][1],je=at({r:pt,c:ye});S[je]?A.f=""+_a(I.formula,f,I.cell,te,X):A.F=((n.dense?(i[pt]||[])[ye]:i[je])||{}).F}else A.f=""+_a(I.formula,f,I.cell,te,X)}k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K(I.cell,A,n),d=I}break;case 7:case 519:if(d)d.val=I,A=lo(I,d.cell.ixfe,"s"),A.XF=V[A.ixfe],n.cellFormula&&(A.f=""+_a(d.formula,f,d.cell,te,X)),k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K(d.cell,A,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(I);var lt=at(I[0].s);if(y=n.dense?(i[I[0].s.r]||[])[I[0].s.c]:i[lt],n.cellFormula&&y){if(!d||!lt||!y)break;y.f=""+_a(I[1],f,I[0],te,X),y.F=bt(I[0])}}break;case 1212:{if(!n.cellFormula)break;if(b){if(!d)break;S[at(d.cell)]=I[0],y=n.dense?(i[d.cell.r]||[])[d.cell.c]:i[at(d.cell)],(y||{}).f=""+_a(I[0],f,v,te,X)}}break;case 253:A=lo(x[I.isst].t,I.ixfe,"s"),x[I.isst].h&&(A.h=x[I.isst].h),A.XF=V[A.ixfe],k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n);break;case 513:n.sheetStubs&&(A={ixfe:I.ixfe,XF:V[I.ixfe],t:"z"},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n));break;case 190:if(n.sheetStubs)for(var Ge=I.c;Ge<=I.C;++Ge){var rt=I.ixfe[Ge-I.c];A={ixfe:rt,XF:V[rt],t:"z"},k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:Ge,r:I.r},A,n)}break;case 214:case 516:case 4:A=lo(I.val,I.ixfe,"s"),A.XF=V[A.ixfe],k>0&&(A.z=q[A.ixfe>>8&63]),Or(A,n,a.opts.Date1904),K({c:I.c,r:I.r},A,n);break;case 0:case 512:oe===1&&(f=I);break;case 252:x=I;break;case 1054:if(X.biff==4){q[k++]=I[1];for(var Nt=0;Nt<k+163&&st[Nt]!=I[1];++Nt);Nt>=163&&fs(I[1],k+163)}else fs(I[1],I[0]);break;case 30:{q[k++]=I;for(var ct=0;ct<k+163&&st[ct]!=I;++ct);ct>=163&&fs(I,k+163)}break;case 229:he=he.concat(I);break;case 93:_e[I.cmo[0]]=X.lastobj=I;break;case 438:X.lastobj.TxO=I;break;case 127:X.lastobj.ImData=I;break;case 440:for(w=I[0].s.r;w<=I[0].e.r;++w)for(_=I[0].s.c;_<=I[0].e.c;++_)y=n.dense?(i[w]||[])[_]:i[at({c:_,r:w})],y&&(y.l=I[1]);break;case 2048:for(w=I[0].s.r;w<=I[0].e.r;++w)for(_=I[0].s.c;_<=I[0].e.c;++_)y=n.dense?(i[w]||[])[_]:i[at({c:_,r:w})],y&&y.l&&(y.l.Tooltip=I[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;y=n.dense?(i[I[0].r]||[])[I[0].c]:i[at(I[0])];var nt=_e[I[2]];y||(n.dense?(i[I[0].r]||(i[I[0].r]=[]),y=i[I[0].r][I[0].c]={t:"z"}):y=i[at(I[0])]={t:"z"},f.e.r=Math.max(f.e.r,I[0].r),f.s.r=Math.min(f.s.r,I[0].r),f.e.c=Math.max(f.e.c,I[0].c),f.s.c=Math.min(f.s.c,I[0].c)),y.c||(y.c=[]),E={a:I[1],t:nt.TxO.t},y.c.push(E)}break;case 2173:Vw(V[I.ixfe],I.ext);break;case 125:{if(!X.cellStyles)break;for(;I.e>=I.s;)Z[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},Re||(Re=!0,Df(I.w/256)),pi(Z[I.e+1])}break;case 520:{var Ce={};I.level!=null&&(ue[I.r]=Ce,Ce.level=I.level),I.hidden&&(ue[I.r]=Ce,Ce.hidden=!0),I.hpt&&(ue[I.r]=Ce,Ce.hpt=I.hpt,Ce.hpx=Ll(I.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Al(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=I;break;case 161:i["!margins"]||Al(i["!margins"]={}),i["!margins"].header=I.header,i["!margins"].footer=I.footer;break;case 574:I.RTL&&(j.Views[0].RTL=!0);break;case 146:Y=I;break;case 2198:ee=I;break;case 140:z=I;break;case 442:m?Q.CodeName=I||Q.name:j.WBProps.CodeName=I||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=Se}return a.SheetNames=Mr(o).sort(function(Je,De){return Number(Je)-Number(De)}).map(function(Je){return o[Je].name}),n.bookSheets||(a.Sheets=s),!a.SheetNames.length&&p["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=p)):a.Preamble=p,a.Sheets&&U.forEach(function(Je,De){a.Sheets[a.SheetNames[De]]["!autofilter"]=Je}),a.Strings=x,a.SSF=ga(st),X.enc&&(a.Encryption=X.enc),ee&&(a.Themes=ee),a.Metadata={},z!==void 0&&(a.Metadata.Country=z),te.names.length>0&&(j.Names=te.names),a.Workbook=j,a}var xp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _A(e,n,a){var s=vt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var i=Zm(s,UE,xp.DSI);for(var o in i)n[o]=i[o]}catch(m){if(a.WTF)throw m}var f=vt.find(e,"/!SummaryInformation");if(f&&f.size>0)try{var d=Zm(f,PE,xp.SI);for(var x in d)n[x]==null&&(n[x]=d[x])}catch(m){if(a.WTF)throw m}n.HeadingPairs&&n.TitlesOfParts&&(bg(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function a2(e,n){n||(n={}),Lf(n),Op(),n.codepage&&hf(n.codepage);var a,s;if(e.FullPaths){if(vt.find(e,"/encryption"))throw new Error("File is password-protected");a=vt.find(e,"!CompObj"),s=vt.find(e,"/Workbook")||vt.find(e,"/Book")}else{switch(n.type){case"base64":e=Er(Wa(e));break;case"binary":e=Er(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pa(e,0),s={content:e}}var i,o;if(a&&vA(a),n.bookProps&&!n.bookSheets)i={};else{var f=mt?"buffer":"array";if(s&&s.content)i=EA(s.content,n);else if((o=vt.find(e,"PerfectOffice_MAIN"))&&o.content)i=Tl.to_workbook(o.content,(n.type=f,n));else if((o=vt.find(e,"NativeContent_MAIN"))&&o.content)i=Tl.to_workbook(o.content,(n.type=f,n));else throw(o=vt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&vt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=lT(e))}var d={};return e.FullPaths&&_A(e,d,n),i.Props=i.Custprops=d,n.bookFiles&&(i.cfb=e),i}var _o={0:{f:r3},1:{f:l3},2:{f:p3},3:{f:f3},4:{f:o3},5:{f:m3},6:{f:b3},7:{f:h3},8:{f:T3},9:{f:w3},10:{f:E3},11:{f:_3},12:{f:c3},13:{f:g3},14:{f:d3},15:{f:u3},16:{f:Zg},17:{f:y3},18:{f:x3},19:{f:Tf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Z3},40:{},42:{},43:{f:Ew},44:{f:yw},45:{f:_w},46:{f:Tw},47:{f:ww},48:{},49:{f:SE},50:{},51:{f:Yw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Og},62:{f:v3},63:{f:$w},64:{f:j3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Aa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:R3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:i3},148:{f:n3,p:16},151:{f:N3},152:{},153:{f:W3},154:{},155:{},156:{f:K3},157:{},158:{},159:{T:1,f:P_},160:{T:-1},161:{T:1,f:bs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Gw},336:{T:-1},337:{f:Xw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Dg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:C3},427:{f:k3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:O3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:s3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:A3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nT},633:{T:1},634:{T:-1},635:{T:1,f:rT},636:{T:-1},637:{f:NE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:U3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:M3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rf={6:{f:Vu},10:{f:On},12:{f:ta},13:{f:ta},14:{f:Wt},15:{f:Wt},16:{f:wa},17:{f:Wt},18:{f:Wt},19:{f:ta},20:{f:tp},21:{f:tp},23:{f:Dg},24:{f:rp},25:{f:Wt},26:{},27:{},28:{f:t_},29:{},34:{f:Wt},35:{f:ap},38:{f:wa},39:{f:wa},40:{f:wa},41:{f:wa},42:{f:Wt},43:{f:Wt},47:{f:sw},49:{f:F4},51:{f:ta},60:{},61:{f:j4},64:{f:Wt},65:{f:L4},66:{f:ta},77:{},80:{},81:{},82:{},85:{f:ta},89:{},90:{},91:{},92:{f:S4},93:{f:r_},94:{},95:{f:Wt},96:{},97:{},99:{f:Wt},125:{f:Og},128:{f:X4},129:{f:A4},130:{f:ta},131:{f:Wt},132:{f:Wt},133:{f:N4},134:{},140:{f:o_},141:{f:ta},144:{},146:{f:f_},151:{},152:{},153:{},154:{},155:{},156:{f:ta},157:{},158:{},160:{f:p_},161:{f:h_},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:z4},190:{f:V4},193:{f:On},197:{},198:{},199:{},200:{},201:{},202:{f:Wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ta},220:{},221:{f:Wt},222:{},224:{f:Y4},225:{f:T4},226:{f:On},227:{},229:{f:a_},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:C4},253:{f:I4},255:{f:k4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Tg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wt},353:{f:On},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:K4},431:{f:Wt},432:{},433:{},434:{},437:{},438:{f:i_},439:{f:Wt},440:{f:l_},441:{},442:{f:Pl},443:{},444:{f:ta},445:{},446:{},448:{f:On},449:{f:R4,r:2},450:{f:On},512:{f:Jm},513:{f:m_},515:{f:q4},516:{f:B4},517:{f:ep},519:{f:g_},520:{f:D4},523:{},545:{f:np},549:{f:Qm},566:{},574:{f:M4},638:{f:H4},659:{},1048:{},1054:{f:U4},1084:{},1212:{f:Q4},2048:{f:c_},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:no},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:On},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:d_,r:12},2173:{f:zw,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Z4,r:12},2197:{},2198:{f:Fw,r:12},2199:{},2200:{},2201:{},2202:{f:J4,r:12},2203:{f:On},2204:{},2205:{},2206:{},2207:{},2211:{f:O4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ta},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:x_},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:u_},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Jm},1:{},2:{f:E_},3:{f:y_},4:{f:b_},5:{f:ep},7:{f:__},8:{},9:{f:no},11:{},22:{f:ta},30:{f:P4},31:{},32:{},33:{f:np},36:{},37:{f:Qm},50:{f:w_},62:{},52:{},67:{},68:{f:ta},69:{},86:{},126:{},127:{f:v_},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:T_},223:{},234:{},354:{},421:{},518:{f:Vu},521:{f:no},536:{f:rp},547:{f:ap},561:{},579:{},1030:{f:Vu},1033:{f:no},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function yr(e,n,a,s){var i=n;if(!isNaN(i)){var o=(a||[]).length||0,f=e.next(4);f.write_shift(2,i),f.write_shift(2,o),o>0&&fg(a)&&e.push(a)}}function mp(e,n){var a=n||{},s=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),f=i.index,d=o&&o.index||e.length,x=qy(e.slice(f,d),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,b=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(f=0;f<x.length;++f){var _=x[f].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++m,a.sheetRows&&a.sheetRows<=m){--m;break}p=0;continue}if(!(w!="<td"&&w!="<th")){var S=_.split(/<\/t[dh]>/i);for(d=0;d<S.length;++d){var D=S[d].trim();if(D.match(/<t[dh]/i)){for(var A=D,z=0;A.charAt(0)=="<"&&(z=A.indexOf(">"))>-1;)A=A.slice(z+1);for(var V=0;V<E.length;++V){var Y=E[V];Y.s.c==p&&Y.s.r<m&&m<=Y.e.r&&(p=Y.e.c+1,V=-1)}var j=Qe(D.slice(0,D.indexOf(">")));b=j.colspan?+j.colspan:1,((v=+j.rowspan)>1||b>1)&&E.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+b-1}});var Q=j.t||j["data-t"]||"";if(!A.length){p+=b;continue}if(A=Qp(A),y.s.r>m&&(y.s.r=m),y.e.r<m&&(y.e.r=m),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!A.length){p+=b;continue}var B={t:"s",v:A};a.raw||!A.trim().length||Q=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(Tr(A))?isNaN(mi(A).getDate())||(B={t:"d",v:da(A)},a.cellDates||(B={t:"n",v:ja(B.v)}),B.z=a.dateNF||st[14]):B={t:"n",v:Tr(A)}),a.dense?(s[m]||(s[m]=[]),s[m][p]=B):s[at({r:m,c:p})]=B,p+=b}}}}return s["!ref"]=bt(y),E.length&&(s["!merges"]=E),s}function wA(e,n,a,s){for(var i=e["!merges"]||[],o=[],f=n.s.c;f<=n.e.c;++f){for(var d=0,x=0,m=0;m<i.length;++m)if(!(i[m].s.r>a||i[m].s.c>f)&&!(i[m].e.r<a||i[m].e.c<f)){if(i[m].s.r<a||i[m].s.c<f){d=-1;break}d=i[m].e.r-i[m].s.r+1,x=i[m].e.c-i[m].s.c+1;break}if(!(d<0)){var p=at({r:a,c:f}),v=s.dense?(e[a]||[])[f]:e[p],b=v&&v.v!=null&&(v.h||bf(v.w||(an(v),v.w)||""))||"",y={};d>1&&(y.rowspan=d),x>1&&(y.colspan=x),s.editable?b='<span contenteditable="true">'+b+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+v.l.Target+'">'+b+"</a>")),y.id=(s.id||"sjs")+"-"+p,o.push(oE("td",b,y))}}var E="<tr>";return E+o.join("")+"</tr>"}var TA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',SA="</body></html>";function AA(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return Un(mp(a[0],n),n);var s=If();return a.forEach(function(i,o){Bf(s,mp(i,n),"Sheet"+(o+1))}),s}function NA(e,n,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function CA(e,n){var a=n||{},s=a.header!=null?a.header:TA,i=a.footer!=null?a.footer:SA,o=[s],f=vi(e["!ref"]);a.dense=Array.isArray(e),o.push(NA(e,f,a));for(var d=f.s.r;d<=f.e.r;++d)o.push(wA(e,f,d,a));return o.push("</table>"+i),o.join("")}function r2(e,n,a){var s=a||{},i=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var f=typeof s.origin=="string"?Oa(s.origin):s.origin;i=f.r,o=f.c}var d=n.getElementsByTagName("tr"),x=Math.min(s.sheetRows||1e7,d.length),m={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var p=vi(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),i==-1&&(m.e.r=i=p.e.r+1)}var v=[],b=0,y=e["!rows"]||(e["!rows"]=[]),E=0,_=0,w=0,S=0,D=0,A=0;for(e["!cols"]||(e["!cols"]=[]);E<d.length&&_<x;++E){var z=d[E];if(pp(z)){if(s.display)continue;y[_]={hidden:!0}}var V=z.children;for(w=S=0;w<V.length;++w){var Y=V[w];if(!(s.display&&pp(Y))){var j=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):Qp(Y.innerHTML),Q=Y.getAttribute("data-z")||Y.getAttribute("z");for(b=0;b<v.length;++b){var B=v[b];B.s.c==S+o&&B.s.r<_+i&&_+i<=B.e.r&&(S=B.e.c+1-o,b=-1)}A=+Y.getAttribute("colspan")||1,((D=+Y.getAttribute("rowspan")||1)>1||A>1)&&v.push({s:{r:_+i,c:S+o},e:{r:_+i+(D||1)-1,c:S+o+(A||1)-1}});var ne={t:"s",v:j},K=Y.getAttribute("data-t")||Y.getAttribute("t")||"";j!=null&&(j.length==0?ne.t=K||"z":s.raw||j.trim().length==0||K=="s"||(j==="TRUE"?ne={t:"b",v:!0}:j==="FALSE"?ne={t:"b",v:!1}:isNaN(Tr(j))?isNaN(mi(j).getDate())||(ne={t:"d",v:da(j)},s.cellDates||(ne={t:"n",v:ja(ne.v)}),ne.z=s.dateNF||st[14]):ne={t:"n",v:Tr(j)})),ne.z===void 0&&Q!=null&&(ne.z=Q);var X="",ee=Y.getElementsByTagName("A");if(ee&&ee.length)for(var he=0;he<ee.length&&!(ee[he].hasAttribute("href")&&(X=ee[he].getAttribute("href"),X.charAt(0)!="#"));++he);X&&X.charAt(0)!="#"&&(ne.l={Target:X}),s.dense?(e[_+i]||(e[_+i]=[]),e[_+i][S+o]=ne):e[at({c:S+o,r:_+i})]=ne,m.e.c<S+o&&(m.e.c=S+o),S+=A}}++_}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,_-1+i),e["!ref"]=bt(m),_>=x&&(e["!fullref"]=bt((m.e.r=d.length-E+_-1+i,m))),e}function n2(e,n){var a=n||{},s=a.dense?[]:{};return r2(s,e,n)}function kA(e,n){return Un(n2(e,n),n)}function pp(e){var n="",a=DA(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function DA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function OA(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=yt(n.replace(/<[^>]*>/g,""));return[a]}var gp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function s2(e,n){var a=n||{},s=yf(e),i=[],o,f,d={name:""},x="",m=0,p,v,b={},y=[],E=a.dense?[]:{},_,w,S={value:""},D="",A=0,z=[],V=-1,Y=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,B={},ne=[],K={},X=0,ee=0,he=[],_e=1,Z=1,ue=[],Re={Names:[]},te={},H=["",""],oe=[],k={},q="",U=0,R=!1,W=!1,pe=0;for(Rl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Rl.exec(s);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?E["!ref"]=bt(j):E["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=j.e.r&&(E["!fullref"]=E["!ref"],j.e.r=a.sheetRows-1,E["!ref"]=bt(j)),ne.length&&(E["!merges"]=ne),he.length&&(E["!rows"]=he),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),b[p.name]=E,W=!1):_[0].charAt(_[0].length-2)!=="/"&&(p=Qe(_[0],!1),V=Y=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,E=a.dense?[]:{},ne=[],he=[],W=!0);break;case"table-row-group":_[1]==="/"?--Q:++Q;break;case"table-row":case"":if(_[1]==="/"){V+=_e,_e=1;break}if(v=Qe(_[0],!1),v.?V=v.-1:V==-1&&(V=0),_e=+v["number-rows-repeated"]||1,_e<10)for(pe=0;pe<_e;++pe)Q>0&&(he[V+pe]={level:Q});Y=-1;break;case"covered-table-cell":_[1]!=="/"&&++Y,a.sheetStubs&&(a.dense?(E[V]||(E[V]=[]),E[V][Y]={t:"z"}):E[at({r:V,c:Y})]={t:"z"}),D="",z=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++Y,S=Qe(_[0],!1),Z=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&a.cellFormula!=!1&&(w.f=fp(yt(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=yt(S["string-value"]||""),a.dense?(E[V]||(E[V]=[]),E[V][Y]=w):E[at({r:V,c:Y})]=w),Y+=Z-1;else if(_[1]!=="/"){++Y,D="",A=0,z=[],Z=1;var ve=_e?V+_e-1:V;if(Y>j.e.c&&(j.e.c=Y),Y<j.s.c&&(j.s.c=Y),V<j.s.r&&(j.s.r=V),ve>j.e.r&&(j.e.r=ve),S=Qe(_[0],!1),oe=[],k={},w={t:S.||S["value-type"],v:null},a.cellFormula)if(S.formula&&(S.formula=yt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(X=parseInt(S["number-matrix-rows-spanned"],10)||0,ee=parseInt(S["number-matrix-columns-spanned"],10)||0,K={s:{r:V,c:Y},e:{r:V+X-1,c:Y+ee-1}},w.F=bt(K),ue.push([K,w.F])),S.formula)w.f=fp(S.formula);else for(pe=0;pe<ue.length;++pe)V>=ue[pe][0].s.r&&V<=ue[pe][0].e.r&&Y>=ue[pe][0].s.c&&Y<=ue[pe][0].e.c&&(w.F=ue[pe][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(X=parseInt(S["number-rows-spanned"],10)||0,ee=parseInt(S["number-columns-spanned"],10)||0,K={s:{r:V,c:Y},e:{r:V+X-1,c:Y+ee-1}},ne.push(K)),S["number-columns-repeated"]&&(Z=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Bt(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=da(S["date-value"]),a.cellDates||(w.t="n",w.v=ja(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Gy(S["time-value"])/86400,a.cellDates&&(w.t="d",w.v=To(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(D=yt(S["string-value"]),z=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(R=!1,w.t==="s"&&(w.v=D||"",z.length&&(w.R=z),R=A==0),te.Target&&(w.l=te),oe.length>0&&(w.c=oe,oe=[]),D&&a.cellText!==!1&&(w.w=D),R&&(w.t="z",delete w.v),(!R||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=V))for(var Se=0;Se<_e;++Se){if(Z=parseInt(S["number-columns-repeated"]||"1",10),a.dense)for(E[V+Se]||(E[V+Se]=[]),E[V+Se][Y]=Se==0?w:ga(w);--Z>0;)E[V+Se][Y+Z]=ga(w);else for(E[at({r:V+Se,c:Y})]=w;--Z>0;)E[at({r:V+Se,c:Y+Z})]=ga(w);j.e.c<=Y&&(j.e.c=Y)}Z=parseInt(S["number-columns-repeated"]||"1",10),Y+=Z-1,Z=0,w={},D="",z=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((o=i.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((o=i.pop())[0]!==_[3])throw"Bad state: "+o;k.t=D,z.length&&(k.R=z),k.a=q,oe.push(k)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);q="",U=0,D="",A=0,z=[];break;case"creator":_[1]==="/"?q=s.slice(U,_.index):U=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((o=i.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);D="",A=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(B[d.name]=x,(o=i.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&(x="",d=Qe(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":f=Qe(_[0],!1),x+=gp[_[3]][f.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":f=Qe(_[0],!1),x+=gp[_[3]][f.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":x+=s.slice(m,_.index);break}else m=_.index+_[0].length;break;case"named-range":f=Qe(_[0],!1),H=Gu(f["cell-range-address"]);var we={Name:f.name,Ref:H[0]+"!"+H[1]};W&&(we.Sheet=y.length),Re.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!S||!S["string-value"])){var Be=OA(s.slice(A,_.index));D=(D.length>0?D+`
`:"")+Be[0]}else Qe(_[0],!1),A=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{H=Gu(Qe(_[0])["target-range-address"]),b[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(te=Qe(_[0],!1),!te.href)break;te.Target=yt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(H=Gu(te.Target.slice(1)),te.Target="#"+H[0]+"!"+H[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(_)}}var I={Sheets:b,SheetNames:y,Workbook:Re};return a.bookSheets&&delete I.Sheets,I}function vp(e,n){n=n||{},or(e,"META-INF/manifest.xml")&&qE(ea(e,"META-INF/manifest.xml"),n);var a=Ka(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=s2(Ft(a),n);return or(e,"meta.xml")&&(s.Props=vg(ea(e,"meta.xml"))),s}function bp(e,n){return s2(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function jf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function nf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ft(gs(e))}function sf(e){var n=e.reduce(function(i,o){return i+o.length},0),a=new Uint8Array(n),s=0;return e.forEach(function(i){a.set(i,s),s+=i.length}),a}function yp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function RA(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,s=e[n+14]&1,i=n+13;i>=n;--i)s=s*256+e[i];return(e[n+15]&128?-s:s)*Math.pow(10,a-6176)}function Fl(e,n){var a=n?n[0]:0,s=e[a]&127;e:if(e[a++]>=128&&(s|=(e[a]&127)<<7,e[a++]<128||(s|=(e[a]&127)<<14,e[a++]<128)||(s|=(e[a]&127)<<21,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),s}function la(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function Ta(e){for(var n=[],a=[0];a[0]<e.length;){var s=a[0],i=Fl(e,a),o=i&7;i=Math.floor(i/8);var f=0,d;if(i==0)break;switch(o){case 0:{for(var x=a[0];e[a[0]++]>=128;);d=e.slice(x,a[0])}break;case 5:f=4,d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 1:f=8,d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 2:f=Fl(e,a),d=e.slice(a[0],a[0]+f),a[0]+=f;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(s))}var m={data:d,type:o};n[i]==null?n[i]=[m]:n[i].push(m)}return n}function Mf(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function jA(e){for(var n,a=[],s=[0];s[0]<e.length;){var i=Fl(e,s),o=Ta(e.slice(s[0],s[0]+i));s[0]+=i;var f={id:la(o[1][0].data),messages:[]};o[2].forEach(function(d){var x=Ta(d.data),m=la(x[3][0].data);f.messages.push({meta:x,data:e.slice(s[0],s[0]+m)}),s[0]+=m}),(n=o[3])!=null&&n[0]&&(f.merge=la(o[3][0].data)>>>0>0),a.push(f)}return a}function MA(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],s=Fl(n,a),i=[];a[0]<n.length;){var o=n[a[0]]&3;if(o==0){var f=n[a[0]++]>>2;if(f<60)++f;else{var d=f-59;f=n[a[0]],d>1&&(f|=n[a[0]+1]<<8),d>2&&(f|=n[a[0]+2]<<16),d>3&&(f|=n[a[0]+3]<<24),f>>>=0,f++,a[0]+=d}i.push(n.slice(a[0],a[0]+f)),a[0]+=f;continue}else{var x=0,m=0;if(o==1?(m=(n[a[0]]>>2&7)+4,x=(n[a[0]++]&224)<<3,x|=n[a[0]++]):(m=(n[a[0]++]>>2)+1,o==2?(x=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(x=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),i=[sf(i)],x==0)throw new Error("Invalid offset 0");if(x>i[0].length)throw new Error("Invalid offset beyond length");if(m>=x)for(i.push(i[0].slice(-x)),m-=x;m>=i[i.length-1].length;)i.push(i[i.length-1]),m-=i[i.length-1].length;i.push(i[0].slice(-x,-x+m))}}var p=sf(i);if(p.length!=s)throw new Error("Unexpected length: ".concat(p.length," != ").concat(s));return p}function LA(e){for(var n=[],a=0;a<e.length;){var s=e[a++],i=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(MA(s,e.slice(a,a+i))),a+=i}if(a!==e.length)throw new Error("data is not a valid framed stream!");return sf(n)}function FA(e,n,a,s){var i=jf(e),o=i.getUint32(4,!0),f=(s>1?12:8)+yp(o&(s>1?3470:398))*4,d=-1,x=-1,m=NaN,p=new Date(2001,0,1);o&512&&(d=i.getUint32(f,!0),f+=4),f+=yp(o&(s>1?12288:4096))*4,o&16&&(x=i.getUint32(f,!0),f+=4),o&32&&(m=i.getFloat64(f,!0),f+=8),o&64&&(p.setTime(p.getTime()+i.getFloat64(f,!0)*1e3),f+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:n[x]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:a[d]};else if(x>-1)v={t:"s",v:n[x]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function IA(e,n,a){var s=jf(e),i=s.getUint32(8,!0),o=12,f=-1,d=-1,x=NaN,m=NaN,p=new Date(2001,0,1);i&1&&(x=RA(e,o),o+=16),i&2&&(m=s.getFloat64(o,!0),o+=8),i&4&&(p.setTime(p.getTime()+s.getFloat64(o,!0)*1e3),o+=8),i&8&&(d=s.getUint32(o,!0),o+=4),i&16&&(f=s.getUint32(o,!0),o+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:n[d]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(f>-1)v={t:"s",v:a[f]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:x};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return v}function BA(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return FA(e,n,a,e[0]);case 5:return IA(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fn(e){var n=Ta(e);return Fl(n[1][0].data)}function Ep(e,n){var a=Ta(n.data),s=la(a[1][0].data),i=a[3],o=[];return(i||[]).forEach(function(f){var d=Ta(f.data),x=la(d[1][0].data)>>>0;switch(s){case 1:o[x]=nf(d[3][0].data);break;case 8:{var m=e[Fn(d[9][0].data)][0],p=Ta(m.data),v=e[Fn(p[1][0].data)][0],b=la(v.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));var y=Ta(v.data);o[x]=y[3].map(function(E){return nf(E.data)}).join("")}break}}),o}function UA(e,n){var a,s,i,o,f,d,x,m,p,v,b,y,E,_,w=Ta(e),S=la(w[1][0].data)>>>0,D=la(w[2][0].data)>>>0,A=((s=(a=w[8])==null?void 0:a[0])==null?void 0:s.data)&&la(w[8][0].data)>0||!1,z,V;if((o=(i=w[7])==null?void 0:i[0])!=null&&o.data&&n!=0)z=(d=(f=w[7])==null?void 0:f[0])==null?void 0:d.data,V=(m=(x=w[6])==null?void 0:x[0])==null?void 0:m.data;else if((v=(p=w[4])==null?void 0:p[0])!=null&&v.data&&n!=1)z=(y=(b=w[4])==null?void 0:b[0])==null?void 0:y.data,V=(_=(E=w[3])==null?void 0:E[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var Y=A?4:1,j=jf(z),Q=[],B=0;B<z.length/2;++B){var ne=j.getUint16(B*2,!0);ne<65535&&Q.push([B,ne])}if(Q.length!=D)throw"Expected ".concat(D," cells, found ").concat(Q.length);var K=[];for(B=0;B<Q.length-1;++B)K[Q[B][0]]=V.subarray(Q[B][1]*Y,Q[B+1][1]*Y);return Q.length>=1&&(K[Q[Q.length-1][0]]=V.subarray(Q[Q.length-1][1]*Y)),{R:S,cells:K}}function PA(e,n){var a,s=Ta(n.data),i=(a=s==null?void 0:s[7])!=null&&a[0]?la(s[7][0].data)>>>0>0?1:0:-1,o=Mf(s[5],function(f){return UA(f,i)});return{nrows:la(s[4][0].data)>>>0,data:o.reduce(function(f,d){return f[d.R]||(f[d.R]=[]),d.cells.forEach(function(x,m){if(f[d.R][m])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(m));f[d.R][m]=x}),f},[])}}function HA(e,n,a){var s,i=Ta(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(la(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(la(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));a["!ref"]=bt(o);var f=Ta(i[4][0].data),d=Ep(e,e[Fn(f[4][0].data)][0]),x=(s=f[17])!=null&&s[0]?Ep(e,e[Fn(f[17][0].data)][0]):[],m=Ta(f[3][0].data),p=0;m[1].forEach(function(v){var b=Ta(v.data),y=e[Fn(b[2][0].data)][0],E=la(y.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var _=PA(e,y);_.data.forEach(function(w,S){w.forEach(function(D,A){var z=at({r:p+S,c:A}),V=BA(D,d,x);V&&(a[z]=V)})}),p+=_.nrows})}function zA(e,n){var a=Ta(n.data),s={"!ref":"A1"},i=e[Fn(a[2][0].data)],o=la(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return HA(e,i[0],s),s}function VA(e,n){var a,s=Ta(n.data),i={name:(a=s[1])!=null&&a[0]?nf(s[1][0].data):"",sheets:[]},o=Mf(s[2],Fn);return o.forEach(function(f){e[f].forEach(function(d){var x=la(d.meta[1][0].data);x==6e3&&i.sheets.push(zA(e,d))})}),i}function GA(e,n){var a=If(),s=Ta(n.data),i=Mf(s[1],Fn);if(i.forEach(function(o){e[o].forEach(function(f){var d=la(f.meta[1][0].data);if(d==2){var x=VA(e,f);x.sheets.forEach(function(m,p){Bf(a,m,p==0?x.name:x.name+"_"+p,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Xu(e){var n,a,s,i,o={},f=[];if(e.FullPaths.forEach(function(x){if(x.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(x){if(x.name.match(/\.iwa$/)){var m;try{m=LA(x.content)}catch(v){return console.log("?? "+x.content.length+" "+(v.message||v))}var p;try{p=jA(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,f.push(v.id)})}}),!f.length)throw new Error("File has no messages");var d=((i=(s=(a=(n=o==null?void 0:o[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:s[1])==null?void 0:i[0].data)&&la(o[1][0].meta[1][0].data)==1&&o[1][0];if(d||f.forEach(function(x){o[x].forEach(function(m){var p=la(m.meta[1][0].data)>>>0;if(p==1)if(!d)d=m;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return GA(o,d)}function YA(e){return function(a){for(var s=0;s!=e.length;++s){var i=e[s];a[i[0]]===void 0&&(a[i[0]]=i[1]),i[2]==="n"&&(a[i[0]]=Number(a[i[0]]))}}}function Lf(e){YA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function XA(e){return ui.WS.indexOf(e)>-1?"sheet":e==ui.CS?"chart":e==ui.DS?"dialog":e==ui.MS?"macro":e&&e.length?e:"sheet"}function qA(e,n){if(!e)return 0;try{e=n.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,XA(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function KA(e,n,a,s,i,o,f,d,x,m,p,v){try{o[s]=_l(Ka(e,a,!0),n);var b=ea(e,n),y;switch(d){case"sheet":y=eA(b,n,i,x,o[s],m,p,v);break;case"chart":if(y=tA(b,n,i,x,o[s],m,p,v),!y||!y["!drawel"])break;var E=gl(y["!drawel"].Target,n),_=Ju(E),w=Jw(Ka(e,E,!0),_l(Ka(e,_,!0),E)),S=gl(w,E),D=Ju(S);y=I3(Ka(e,S,!0),S,x,_l(Ka(e,D,!0),S),m,y);break;case"macro":y=aA(b,n,i,x,o[s],m,p,v);break;case"dialog":y=rA(b,n,i,x,o[s],m,p,v);break;default:throw new Error("Unrecognized sheet type "+d)}f[s]=y;var A=[];o&&o[s]&&Mr(o[s]).forEach(function(z){var V="";if(o[s][z].Type==ui.CMNT){V=gl(o[s][z].Target,n);var Y=lA(ea(e,V,!0),V,x);if(!Y||!Y.length)return;ip(y,Y,!1)}o[s][z].Type==ui.TCMNT&&(V=gl(o[s][z].Target,n),A=A.concat(tT(ea(e,V,!0),x)))}),A&&A.length&&ip(y,A,!0,x.people||[])}catch(z){if(x.WTF)throw z}}function lr(e){return e.charAt(0)=="/"?e.slice(1):e}function WA(e,n){if(Vp(),n=n||{},Lf(n),or(e,"META-INF/manifest.xml")||or(e,"objectdata.xml"))return vp(e,n);if(or(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Xu<"u"){if(e.FileIndex)return Xu(e);var a=vt.utils.cfb_new();return jm(e).forEach(function(he){$y(a,he,Wy(e,he))}),Xu(a)}throw new Error("Unsupported NUMBERS file")}if(!or(e,"[Content_Types].xml"))throw or(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):or(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=jm(e),i=YE(Ka(e,"[Content_Types].xml")),o=!1,f,d;if(i.workbooks.length===0&&(d="xl/workbook.xml",ea(e,d,!0)&&i.workbooks.push(d)),i.workbooks.length===0){if(d="xl/workbook.bin",!ea(e,d,!0))throw new Error("Could not find workbook");i.workbooks.push(d),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var x={},m={};if(!n.bookSheets&&!n.bookProps){if(Sl=[],i.sst)try{Sl=iA(ea(e,lr(i.sst)),i.sst,n)}catch(he){if(n.WTF)throw he}n.cellStyles&&i.themes.length&&(x=sA(Ka(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(m=nA(ea(e,lr(i.style)),i.style,x,n))}i.links.map(function(he){try{var _e=_l(Ka(e,Ju(lr(he))),he);return oA(ea(e,lr(he)),_e,he,n)}catch{}});var p=J3(ea(e,lr(i.workbooks[0])),i.workbooks[0],n),v={},b="";i.coreprops.length&&(b=ea(e,lr(i.coreprops[0]),!0),b&&(v=vg(b)),i.extprops.length!==0&&(b=ea(e,lr(i.extprops[0]),!0),b&&$E(b,v,n)));var y={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(b=Ka(e,lr(i.custprops[0]),!0),b&&(y=QE(b,n)));var E={};if((n.bookSheets||n.bookProps)&&(p.Sheets?f=p.Sheets.map(function(_e){return _e.name}):v.Worksheets&&v.SheetNames.length>0&&(f=v.SheetNames),n.bookProps&&(E.Props=v,E.Custprops=y),n.bookSheets&&typeof f<"u"&&(E.SheetNames=f),n.bookSheets?E.SheetNames:n.bookProps))return E;f={};var _={};n.bookDeps&&i.calcchain&&(_=cA(ea(e,lr(i.calcchain)),i.calcchain));var w=0,S={},D,A;{var z=p.Sheets;v.Worksheets=z.length,v.SheetNames=[];for(var V=0;V!=z.length;++V)v.SheetNames[V]=z[V].name}var Y=o?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),Q=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");or(e,Q)||(Q="xl/_rels/workbook."+Y+".rels");var B=_l(Ka(e,Q,!0),Q.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=uA(ea(e,lr(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=aT(ea(e,lr(i.people[0])),n)),B&&(B=qA(B,p.Sheets));var ne=ea(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var K="sheet";if(B&&B[w]?(D="xl/"+B[w][1].replace(/[\/]?xl\//,""),or(e,D)||(D=B[w][1]),or(e,D)||(D=Q.replace(/_rels\/.*$/,"")+B[w][1]),K=B[w][2]):(D="xl/worksheets/sheet"+(w+1-ne)+"."+Y,D=D.replace(/sheet0\./,"sheet.")),A=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(w!=n.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var X=!1,ee=0;ee!=n.sheets.length;++ee)typeof n.sheets[ee]=="number"&&n.sheets[ee]==w&&(X=1),typeof n.sheets[ee]=="string"&&n.sheets[ee].toLowerCase()==v.SheetNames[w].toLowerCase()&&(X=1);if(!X)continue e}}KA(e,D,A,v.SheetNames[w],w,S,f,K,n,p,x,m)}return E={Directory:i,Workbook:p,Props:v,Custprops:y,Deps:_,Sheets:f,SheetNames:v.SheetNames,Strings:Sl,Styles:m,Themes:x,SSF:ga(st)},n&&n.bookFiles&&(e.files?(E.keys=s,E.files=e.files):(E.keys=[],E.files={},e.FullPaths.forEach(function(he,_e){he=he.replace(/^Root Entry[\/]/,""),E.keys.push(he),E.files[he]=e.FileIndex[_e]}))),n&&n.bookVBA&&(i.vba.length>0?E.vbaraw=ea(e,lr(i.vba[0]),!0):i.defaults&&i.defaults.bin===iT&&(E.vbaraw=ea(e,"xl/vbaProject.bin",!0))),E}function $A(e,n){var a=n||{},s="Workbook",i=vt.find(e,s);try{if(s="/!DataSpaces/Version",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(z_(i.content),s="/!DataSpaces/DataSpaceMap",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=G_(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=Y_(i.content);if(f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);q_(i.content)}catch{}if(s="/EncryptionInfo",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=K_(i.content);if(s="/EncryptedPackage",i=vt.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],i.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],i.content,a.password||"",a);throw new Error("File is password-protected")}function Ff(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=Wa(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function ZA(e,n){return vt.find(e,"EncryptedPackage")?$A(e,n):a2(e,n)}function QA(e,n){var a,s=e,i=n||{};return i.type||(i.type=mt&&Buffer.isBuffer(e)?"buffer":"base64"),a=Wp(s,i),WA(a,i)}function i2(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return af(e.slice(a),n);default:break e}return jl.to_workbook(e,n)}function JA(e,n){var a="",s=Ff(e,n);switch(n.type){case"base64":a=Wa(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=xs(e);break;default:throw new Error("Unrecognized type "+n.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(a=Ft(a)),n.type="binary",i2(a,n)}function eN(e,n){var a=e;return n.type=="base64"&&(a=Wa(a)),a=kl.utils.decode(1200,a.slice(2),"str"),n.type="binary",i2(a,n)}function tN(e){return e.match(/[^\x00-\x7F]/)?vl(e):e}function qu(e,n,a,s){return s?(a.type="string",jl.to_workbook(e,a)):jl.to_workbook(n,a)}function wo(e,n){Op();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return wo(new Uint8Array(e),(a=ga(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var s=e,i=[0,0,0,0],o=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),hi={},a.dateNF&&(hi.dateNF=a.dateNF),a.type||(a.type=mt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=mt?"buffer":"binary",s=zy(e),typeof Uint8Array<"u"&&!mt&&(a.type="array")),a.type=="string"&&(o=!0,a.type="binary",a.codepage=65001,s=tN(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var f=new ArrayBuffer(3),d=new Uint8Array(f);if(d.foo="bar",!d.foo)return a=ga(a),a.type="array",wo(xf(s),a)}switch((i=Ff(s,a))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return ZA(vt.read(s,a),a);break;case 9:if(i[1]<=8)return a2(s,a);break;case 60:return af(s,a);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return k_(s,a);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return N_.to_workbook(s,a);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?QA(s,a):qu(e,s,a,o);case 239:return i[3]===60?af(s,a):qu(e,s,a,o);case 255:if(i[1]===254)return eN(s,a);if(i[1]===0&&i[2]===2&&i[3]===0)return Tl.to_workbook(s,a);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Tl.to_workbook(s,a);break;case 3:case 131:case 139:case 140:return sp.to_workbook(s,a);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return iw.to_workbook(s,a);break;case 10:case 13:case 32:return JA(s,a);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return S_.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?sp.to_workbook(s,a):qu(e,s,a,o)}function aN(e,n,a,s,i,o,f,d){var x=va(a),m=d.defval,p=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),v=!0,b=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:a,enumerable:!1})}catch{b.__rowNum__=a}else b.__rowNum__=a;if(!f||e[a])for(var y=n.s.c;y<=n.e.c;++y){var E=f?e[a][y]:e[s[y]+x];if(E===void 0||E.t===void 0){if(m===void 0)continue;o[y]!=null&&(b[o[y]]=m);continue}var _=E.v;switch(E.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(o[y]!=null){if(_==null)if(E.t=="e"&&_===null)b[o[y]]=null;else if(m!==void 0)b[o[y]]=m;else if(p&&_===null)b[o[y]]=null;else continue;else b[o[y]]=p&&(E.t!=="n"||E.t==="n"&&d.rawNumbers!==!1)?_:an(E,_,d);_!=null&&(v=!1)}}return{row:b,isempty:v}}function lf(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},s=0,i=1,o=[],f=0,d="",x={s:{r:0,c:0},e:{r:0,c:0}},m=n||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?s=1:m.header==="A"?s=2:Array.isArray(m.header)?s=3:m.header==null&&(s=0),typeof p){case"string":x=Yt(p);break;case"number":x=Yt(e["!ref"]),x.s.r=p;break;default:x=p}s>0&&(i=0);var v=va(x.s.r),b=[],y=[],E=0,_=0,w=Array.isArray(e),S=x.s.r,D=0,A={};w&&!e[S]&&(e[S]=[]);var z=m.skipHidden&&e["!cols"]||[],V=m.skipHidden&&e["!rows"]||[];for(D=x.s.c;D<=x.e.c;++D)if(!(z[D]||{}).hidden)switch(b[D]=ia(D),a=w?e[S][D]:e[b[D]+v],s){case 1:o[D]=D-x.s.c;break;case 2:o[D]=b[D];break;case 3:o[D]=m.header[D-x.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=f=an(a,null,m),_=A[f]||0,!_)A[f]=1;else{do d=f+"_"+_++;while(A[d]);A[f]=_,A[d]=1}o[D]=d}for(S=x.s.r+i;S<=x.e.r;++S)if(!(V[S]||{}).hidden){var Y=aN(e,x,S,b,s,o,w,m);(Y.isempty===!1||(s===1?m.blankrows!==!1:m.blankrows))&&(y[E++]=Y.row)}return y.length=E,y}var _p=/"/g;function rN(e,n,a,s,i,o,f,d){for(var x=!0,m=[],p="",v=va(a),b=n.s.c;b<=n.e.c;++b)if(s[b]){var y=d.dense?(e[a]||[])[b]:e[s[b]+v];if(y==null)p="";else if(y.v!=null){x=!1,p=""+(d.rawNumbers&&y.t=="n"?y.v:an(y,null,d));for(var E=0,_=0;E!==p.length;++E)if((_=p.charCodeAt(E))===i||_===o||_===34||d.forceQuotes){p='"'+p.replace(_p,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(x=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(_p,'""')+'"')):p="";m.push(p)}return d.blankrows===!1&&x?null:m.join(f)}function l2(e,n){var a=[],s=n??{};if(e==null||e["!ref"]==null)return"";var i=Yt(e["!ref"]),o=s.FS!==void 0?s.FS:",",f=o.charCodeAt(0),d=s.RS!==void 0?s.RS:`
`,x=d.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];s.dense=Array.isArray(e);for(var b=s.skipHidden&&e["!cols"]||[],y=s.skipHidden&&e["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(b[E]||{}).hidden||(v[E]=ia(E));for(var _=0,w=i.s.r;w<=i.e.r;++w)(y[w]||{}).hidden||(p=rN(e,i,w,v,f,x,o,s),p!=null&&(s.strip&&(p=p.replace(m,"")),(p||s.blankrows!==!1)&&a.push((_++?d:"")+p)));return delete s.dense,a.join("")}function nN(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=l2(e,n);return a}function sN(e){var n="",a,s="";if(e==null||e["!ref"]==null)return[];var i=Yt(e["!ref"]),o="",f=[],d,x=[],m=Array.isArray(e);for(d=i.s.c;d<=i.e.c;++d)f[d]=ia(d);for(var p=i.s.r;p<=i.e.r;++p)for(o=va(p),d=i.s.c;d<=i.e.c;++d)if(n=f[d]+o,a=m?(e[p]||[])[d]:e[n],s="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;s=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}x[x.length]=n+"="+s}return x}function c2(e,n,a){var s=a||{},i=+!s.skipHeader,o=e||{},f=0,d=0;if(o&&s.origin!=null)if(typeof s.origin=="number")f=s.origin;else{var x=typeof s.origin=="string"?Oa(s.origin):s.origin;f=x.r,d=x.c}var m,p={s:{c:0,r:0},e:{c:d,r:f+n.length-1+i}};if(o["!ref"]){var v=Yt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),f==-1&&(f=v.e.r+1,p.e.r=f+n.length-1+i)}else f==-1&&(f=0,p.e.r=n.length-1+i);var b=s.header||[],y=0;n.forEach(function(_,w){Mr(_).forEach(function(S){(y=b.indexOf(S))==-1&&(b[y=b.length]=S);var D=_[S],A="z",z="",V=at({c:d+y,r:f+w+i});m=Il(o,V),D&&typeof D=="object"&&!(D instanceof Date)?o[V]=D:(typeof D=="number"?A="n":typeof D=="boolean"?A="b":typeof D=="string"?A="s":D instanceof Date?(A="d",s.cellDates||(A="n",D=ja(D)),z=s.dateNF||st[14]):D===null&&s.nullError&&(A="e",D=0),m?(m.t=A,m.v=D,delete m.w,delete m.R,z&&(m.z=z)):o[V]=m={t:A,v:D},z&&(m.z=z))})}),p.e.c=Math.max(p.e.c,d+b.length-1);var E=va(f);if(i)for(y=0;y<b.length;++y)o[ia(y+d)+E]={t:"s",v:b[y]};return o["!ref"]=bt(p),o}function iN(e,n){return c2(null,e,n)}function Il(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var s=Oa(n);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Il(e,at(n)):Il(e,at({r:n,c:a||0}))}function lN(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function If(){return{SheetNames:[],Sheets:{}}}function Bf(e,n,a,s){var i=1;if(!a)for(;i<=65535&&e.SheetNames.indexOf(a="Sheet"+i)!=-1;++i,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(a)>=0){var o=a.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var f=o&&o[1]||a;for(++i;i<=65535&&e.SheetNames.indexOf(a=f+i)!=-1;++i);}if(Y3(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function cN(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=lN(e,n);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[s].Hidden=a}function oN(e,n){return e.z=n,e}function o2(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function uN(e,n,a){return o2(e,"#"+n,a)}function fN(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function dN(e,n,a,s){for(var i=typeof n!="string"?n:Yt(n),o=typeof n=="string"?n:bt(n),f=i.s.r;f<=i.e.r;++f)for(var d=i.s.c;d<=i.e.c;++d){var x=Il(e,f,d);x.t="n",x.F=o,delete x.v,f==i.s.r&&d==i.s.c&&(x.f=a,s&&(x.D=!0))}return e}var u2={encode_col:ia,encode_row:va,encode_cell:at,encode_range:bt,decode_col:wf,decode_row:_f,split_cell:TE,decode_cell:Oa,decode_range:vi,format_cell:an,sheet_add_aoa:hg,sheet_add_json:c2,sheet_add_dom:r2,aoa_to_sheet:bi,json_to_sheet:iN,table_to_sheet:n2,table_to_book:kA,sheet_to_csv:l2,sheet_to_txt:nN,sheet_to_json:lf,sheet_to_html:CA,sheet_to_formulae:sN,sheet_to_row_object_array:lf,sheet_get_cell:Il,book_new:If,book_append_sheet:Bf,book_set_sheet_visibility:cN,cell_set_number_format:oN,cell_set_hyperlink:o2,cell_set_internal_link:uN,cell_add_comment:fN,sheet_set_array_formula:dN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const jr=e=>e.toLowerCase().trim(),$e=e=>{if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){const n=e.replace(/[$]/g,"").trim().replace(/\./g,"").replace(/,/g,"."),a=parseFloat(n);return isNaN(a)?0:a}return 0},hN=e=>{if(!e||typeof e!="string")return null;const n=e.split("/");if(n.length===3)return new Date(`${n[2]}-${n[1]}-${n[0]}`);const a=new Date(e);return isNaN(a.getTime())?null:a},xN={"nombre de la campaa":"campaignName","nombre del conjunto de anuncios":"adSetName","nombre del anuncio":"adName",da:"day",edad:"age",sexo:"gender","importe gastado (eur)":"spend","entrega de la campaa":"campaignDelivery","entrega del conjunto de anuncios":"adSetDelivery","entrega del anuncio":"adDelivery",impresiones:"impressions",alcance:"reach",frecuencia:"frequency",compras:"purchases","visitas a la pgina de destino":"landingPageViews","clics (todos)":"clicksAll","cpm (costo por mil impresiones)":"cpm","ctr (todos)":"ctrAll","cpc (todos)":"cpcAll","reproducciones de video de 3 segundos":"videoPlays3s","pagos iniciados":"checkoutsInitiated","me gusta en facebook":"pageLikes","artculos agregados al carrito":"addsToCart","pagos iniciados en el sitio web":"checkoutsInitiatedOnWebsite","presupuesto de la campaa":"campaignBudget","tipo de presupuesto de la campaa":"campaignBudgetType","pblicos personalizados incluidos":"includedCustomAudiences","pblicos personalizados excluidos":"excludedCustomAudiences","clics en el enlace":"linkClicks","informacin de pago agregada":"paymentInfoAdds","interaccin con la pgina":"pageEngagement","comentarios de publicaciones":"postComments","interacciones con la publicacin":"postInteractions","reacciones a publicaciones":"postReactions","veces que se compartieron las publicaciones":"postShares",puja:"bid","tipo de puja":"bidType","url del sitio web":"websiteUrl","ctr (porcentaje de clics en el enlace)":"ctrLink",divisa:"currency","valor de conversin de compras":"purchaseValue",objetivo:"objective","tipo de compra":"purchaseType","inicio del informe":"reportStart","fin del informe":"reportEnd",atencion:"attention",deseo:"desire",interes:"interest","reproducciones de video hasta el 25%":"videoPlays25percent","reproducciones de video hasta el 50%":"videoPlays50percent","reproducciones de video hasta el 75%":"videoPlays75percent","reproducciones de video hasta el 95%":"videoPlays95percent","reproducciones de video hasta el 100%":"videoPlays100percent","porcentaje de reproducciones de video de 3 segundos por impresiones":"videoPlayRate3s",aov:"aov","lp view rate":"lpViewRate","adc  lpv":"adcToLpv","captura de video":"videoCapture","captura video":"videoCapture","tasa de conversin de landing":"landingConversionRate","% compras":"percentPurchases",visualizaciones:"visualizations","cvr(link click)":"cvrLinkClick","retencion video":"videoRetentionProprietary","retencin de video":"videoRetentionMeta","tiempo promedio de reproduccin del video":"videoAveragePlayTime",thruplays:"thruPlays","reproducciones de video":"videoPlays","reproducciones de video continuas de 2 segundos nicas":"videoPlays2sContinuousUnique","ctr nico (porcentaje de clics en el enlace)":"ctrUniqueLink","nombre de la cuenta":"accountName","impresiones/compras":"impressionsPerPurchase","nombre del video":"videoFileName","imagen, video y presentacin":"creativeIdentifier","porcentaje de compras por visitas a la pgina de destino":"purchaseRateFromLandingPageViews","nombre de la imagen":"imageName","campaign name":"campaignName","ad set name":"adSetName","ad name":"adName",day:"day",age:"age",gender:"gender","amount spent (eur)":"spend","campaign delivery":"campaignDelivery","ad set delivery":"adSetDelivery","ad delivery":"adDelivery",impressions:"impressions",reach:"reach",frequency:"frequency",purchases:"purchases","landing page views":"landingPageViews","clicks (all)":"clicksAll","cpm (cost per 1,000 impressions)":"cpm","ctr (all)":"ctrAll","cpc (all)":"cpcAll","3-second video plays":"videoPlays3s","checkouts initiated":"checkoutsInitiated","page likes":"pageLikes","adds to cart":"addsToCart","checkouts initiated on website":"checkoutsInitiatedOnWebsite","campaign budget":"campaignBudget","campaign budget type":"campaignBudgetType","included custom audiences":"includedCustomAudiences","excluded custom audiences":"excludedCustomAudiences","link clicks":"linkClicks","payment info adds":"paymentInfoAdds","page engagement":"pageEngagement","post comments":"postComments","post interactions":"postInteractions","post reactions":"postReactions","post shares":"postShares",bid:"bid","bid type":"bidType","website url":"websiteUrl","ctr (link click-through rate)":"ctrLink",currency:"currency","purchase conversion value":"purchaseValue",objective:"objective","purchase type":"purchaseType","reporting starts":"reportStart","reporting ends":"reportEnd",attention:"attention",desire:"desire",interest:"interest","video plays at 25%":"videoPlays25percent","video plays at 50%":"videoPlays50percent","video plays at 75%":"videoPlays75percent","video plays at 95%":"videoPlays95percent","video plays at 100%":"videoPlays100percent","3-second video play rate":"videoPlayRate3s","video capture":"videoCapture","landing page conversion rate":"landingConversionRate","% purchases":"percentPurchases","cvr (link click)":"cvrLinkClick","video retention (proprietary)":"videoRetentionProprietary","video retention (meta)":"videoRetentionMeta","average video play time":"videoAveragePlayTime","video plays":"videoPlays","2-second continuous video plays (unique)":"videoPlays2sContinuousUnique","unique ctr (link click-through rate)":"ctrUniqueLink","account name":"accountName","impressions/purchases":"impressionsPerPurchase","video file name":"videoFileName","image name":"imageName","creative asset":"creativeIdentifier"},wp=["nombre de la cuenta","account name","nombre del anuncio","ad name","da","day"],mN=["nombre de la cuenta","account name","nombre del anuncio","ad name","ad creative thumbnail url"],Tp=async(e,n,a,s=!1)=>{const i=await e.arrayBuffer(),o=wo(i),f=o.SheetNames[0],d=o.Sheets[f],x=u2.sheet_to_json(d);if(x.length===0)throw new Error("El archivo de Looker est vaco o tiene un formato no vlido.");const m=Object.keys(x[0]).map(jr);if(!mN.some(V=>m.includes(V)))throw new Error("Columnas requeridas para Looker no encontradas. Asegrate de que el reporte es correcto.");const v=m.find(V=>V==="nombre de la cuenta"||V==="account name");if(!v)throw new Error("Columna de nombre de cuenta no encontrada en el archivo de Looker.");const b=Object.keys(x[0]),y=b.find(V=>jr(V)===v),E=[...new Set(x.map(V=>V[y]))].filter(V=>V&&typeof V=="string"&&V.trim()!==""),_=E.filter(V=>!n.some(Y=>Y.metaAccountName===V||Y.name===V));if(s)return{newAccountNames:_};if(_.length>0)throw new Error(`Nuevas cuentas encontradas en archivo de Looker: ${_.join(", ")}. Por favor, cralas primero.`);const w=[],S=E.filter(V=>n.some(Y=>Y.metaAccountName===V||Y.name===V)),D=b.find(V=>jr(V)==="nombre del anuncio"||jr(V)==="ad name"),A=b.find(V=>jr(V)==="ad creative thumbnail url"),z=b.find(V=>jr(V)==="ad preview link");for(const V of S){const Y=n.find(X=>X.metaAccountName===V||X.name===V),j=x.filter(X=>X[y]===V),Q=a[Y.id]||{},B={},ne=[];let K=0;j.forEach(X=>{const ee=X[D],he=X[A];ee&&he&&!Q[ee]&&(B[ee]={imageUrl:he,adPreviewLink:z?X[z]:void 0},ne.push(ee),K++)}),K>0&&w.push({client:Y,lookerDataPatch:B,undoKeys:ne,newRecordsCount:K})}return w},cf=async(e,n,a,s,i=!1)=>{let o;if(e instanceof File){const S=await e.arrayBuffer(),D=wo(S),A=D.SheetNames[0],z=D.Sheets[A];o=u2.sheet_to_json(z)}else o=e;if(o.length===0)throw new Error("El archivo est vaco o tiene un formato no vlido.");const f=Object.keys(o[0]).map(jr);if(!wp.some(S=>f.includes(S)))throw new Error(`Columnas requeridas no encontradas. Asegrate de que el reporte es correcto. Faltan: ${wp.join(", ")}`);const x=f.find(S=>S==="nombre de la cuenta"||S==="account name");if(!x)throw new Error("Columna 'Nombre de la cuenta' o 'Account name' no encontrada.");const m=f.find(S=>S==="da"||S==="day");if(!m)throw new Error("Columna 'Da' o 'Day' no encontrada.");const p=Object.keys(o[0]),v=p.find(S=>jr(S)===x);p.find(S=>jr(S)===m);const b=[...new Set(o.map(S=>S[v]))].filter(S=>S&&typeof S=="string"&&S.trim()!==""),y=b.filter(S=>!n.some(D=>D.metaAccountName===S));if(i)return{newAccountNames:y};if(y.length>0)throw new Error(`Nuevas cuentas encontradas: ${y.join(", ")}. Por favor, cralas primero.`);const E=[],_=b.filter(S=>n.some(D=>D.metaAccountName===S));if(_.length===0)throw new Error("Ninguna de las cuentas en el archivo est registrada en el sistema.");const w=f.reduce((S,D)=>{const A=xN[D];return A&&(S[D]=A),S},{});for(const S of _){const D=n.find(K=>K.metaAccountName===S),A=o.filter(K=>K[v]===S),z=new Set((a[D.id]||[]).map(K=>K.uniqueId)),V=[],Y=[],j=new Set;A.forEach(K=>{const X={clientId:D.id},ee=p.reduce((Z,ue)=>(Z[jr(ue)]=K[ue],Z),{});Object.keys(w).forEach(Z=>{const ue=w[Z];ue&&(X[ue]=ee[Z])});const he=X,_e=`${he.day}_${he.campaignName}_${he.adName}_${he.age}_${he.gender}`;if(!z.has(_e)){const Z={...he,uniqueId:_e,spend:$e(he.spend),impressions:$e(he.impressions),reach:$e(he.reach),frequency:$e(he.frequency),purchases:$e(he.purchases),landingPageViews:$e(he.landingPageViews),clicksAll:$e(he.clicksAll),cpm:$e(he.cpm),ctrAll:$e(he.ctrAll),cpcAll:$e(he.cpcAll),videoPlays3s:$e(he.videoPlays3s),checkoutsInitiated:$e(he.checkoutsInitiated),pageLikes:$e(he.pageLikes),addsToCart:$e(he.addsToCart),checkoutsInitiatedOnWebsite:$e(he.checkoutsInitiatedOnWebsite),linkClicks:$e(he.linkClicks),paymentInfoAdds:$e(he.paymentInfoAdds),pageEngagement:$e(he.pageEngagement),postComments:$e(he.postComments),postInteractions:$e(he.postInteractions),postReactions:$e(he.postReactions),postShares:$e(he.postShares),ctrLink:$e(he.ctrLink),purchaseValue:$e(he.purchaseValue),attention:$e(he.attention),desire:$e(he.desire),interest:$e(he.interest),videoPlays25percent:$e(he.videoPlays25percent),videoPlays50percent:$e(he.videoPlays50percent),videoPlays75percent:$e(he.videoPlays75percent),videoPlays95percent:$e(he.videoPlays95percent),videoPlays100percent:$e(he.videoPlays100percent),videoPlayRate3s:$e(he.videoPlayRate3s),aov:$e(he.aov),lpViewRate:$e(he.lpViewRate),adcToLpv:$e(he.adcToLpv),landingConversionRate:$e(he.landingConversionRate),percentPurchases:$e(he.percentPurchases),visualizations:$e(he.visualizations),cvrLinkClick:$e(he.cvrLinkClick),videoRetentionProprietary:$e(he.videoRetentionProprietary),videoRetentionMeta:$e(he.videoRetentionMeta),videoAveragePlayTime:$e(he.videoAveragePlayTime),thruPlays:$e(he.thruPlays),videoPlays:$e(he.videoPlays),videoPlays2sContinuousUnique:$e(he.videoPlays2sContinuousUnique),ctrUniqueLink:$e(he.ctrUniqueLink),impressionsPerPurchase:$e(he.impressionsPerPurchase),purchaseRateFromLandingPageViews:$e(he.purchaseRateFromLandingPageViews)};V.push(Z),Y.push(_e),j.add(he.day)}});const Q=V.map(K=>hN(K.day)).filter(K=>K!==null),B=Q.length>0?new Date(Math.min(...Q.map(K=>K.getTime()))).toISOString().split("T")[0]:void 0,ne=Q.length>0?new Date(Math.max(...Q.map(K=>K.getTime()))).toISOString().split("T")[0]:void 0;V.length>0&&E.push({client:D,records:V,undoKeys:Y,newRecordsCount:V.length,periodStart:B,periodEnd:ne,daysDetected:j.size})}return E},Ku=async e=>{const n=await e.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(i=>i.toString(16).padStart(2,"0")).join("")},Wu=({title:e,description:n,icon:a,onButtonClick:s,buttonText:i,disabled:o})=>c.jsxs("div",{className:"bg-brand-border/30 rounded-lg p-6 flex flex-col items-start justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[c.jsx("div",{className:"text-brand-primary",children:a}),c.jsx("h3",{className:"text-lg font-bold text-brand-text",children:e})]}),c.jsx("p",{className:"text-sm text-brand-text-secondary mb-4",children:n})]}),c.jsx("button",{onClick:s,disabled:o,className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i})]}),pN=({clients:e,setClients:n,lookerData:a,setLookerData:s,performanceData:i,setPerformanceData:o,bitacoraReports:f,setBitacoraReports:d,onSyncFromMeta:x,metaApiConfig:m,currentUser:p})=>{const[v,b]=se.useState(!1),[y,E]=se.useState(null),[_,w]=se.useState(!1),[S,D]=se.useState(!1),[A,z]=se.useState(!1),[V,Y]=se.useState([]),[j,Q]=se.useState(null),[B,ne]=se.useState(null),[K,X]=se.useState([]),ee=se.useRef(null),he=se.useRef(null),_e=se.useRef(null);se.useEffect(()=>{Xe.getImportHistory().then(R=>{X(R.sort((W,pe)=>new Date(pe.timestamp).getTime()-new Date(W.timestamp).getTime()))})},[]);const Z=async R=>{const W={...R,id:crypto.randomUUID(),timestamp:new Date().toISOString()};X(pe=>[W,...pe]),await Xe.saveImportHistory([W,...K])},ue=async(R,W,pe)=>{const ve=await Ku(R),Se=await Xe.getProcessedHashes();if(Object.values(Se).flat().includes(ve))throw new Error(`Este archivo (${R.name}) ya ha sido importado previamente.`);const we=await cf(R,pe,i,W,!1);o(ye=>{const je={...ye};return we.forEach(({client:lt,records:Ge})=>{je[lt.id]=[...je[lt.id]||[],...Ge],console.log(`[IMPORT] Added ${Ge.length} records for client ${lt.name} (${lt.id})`)}),console.log("[IMPORT] New performance data structure:",Object.keys(je).map(lt=>`${lt}: ${je[lt].length} records`)),je});const Be=we.reduce((ye,je)=>ye+je.newRecordsCount,0);if(Be===0){E({type:"info",message:"Importacin completada. No se encontraron filas nuevas."});return}for(const ye of we)if(ye.newRecordsCount>0)try{console.log(`[MCP] Attempting to send data for client: ${ye.client.name}`),await ls.sendExcelData(ye)?(console.log(`[MCP] Successfully sent data to MCP for client: ${ye.client.name}`),et.success(`Datos enviados al servidor MCP para cliente: ${ye.client.name}`)):console.warn(`[MCP] Failed to send data to MCP for client: ${ye.client.name}`)}catch(je){console.error(`[MCP] Error sending data to MCP for client ${ye.client.name}:`,je)}const I=we.map(ye=>ye.client.name).join(", "),Pe=we.map(ye=>ye.periodStart).filter(Boolean),Ue=we.map(ye=>ye.periodEnd).filter(Boolean),We=we.reduce((ye,je)=>ye+(je.daysDetected||0),0),Ve=Pe.length>0?new Date(Math.min(...Pe.map(ye=>new Date(ye).getTime()))):null,ge=Ue.length>0?new Date(Math.max(...Ue.map(ye=>new Date(ye).getTime()))):null;let Ie="";Ve&&ge&&(Ie=` Perodo detectado: ${Ve.toLocaleDateString("es-ES")} - ${ge.toLocaleDateString("es-ES")} (${We} das).`),E({type:"success",message:`Importacin completada. ${Be} nuevas filas aadidas para: ${I}.${Ie} ${ls.getConfig()?" Datos enviados al MCP":" MCP no configurado"}`});const pt={...Se};for(const ye of we)ye.newRecordsCount>0&&(await Z({source:W,fileName:R.name,fileHash:ve,clientName:ye.client.name,description:`${ye.newRecordsCount} filas de rendimiento aadidas`,undoData:{type:"meta",keys:ye.undoKeys,clientId:ye.client.id}}),pt[ye.client.id]=[...pt[ye.client.id]||[],ve]);await Xe.saveProcessedHashes(pt)},Re=async(R,W)=>{const pe=await Ku(R),ve=await Xe.getProcessedHashes();if(Object.values(ve).flat().includes(pe))throw new Error(`Este archivo (${R.name}) ya ha sido importado previamente.`);const Se=await Tp(R,W,a,!1);s(Pe=>{const Ue=JSON.parse(JSON.stringify(Pe));return Se.forEach(({client:We,lookerDataPatch:Ve})=>{Ue[We.id]||(Ue[We.id]={}),Object.assign(Ue[We.id],Ve)}),Ue});const we=Se.reduce((Pe,Ue)=>Pe+Ue.newRecordsCount,0);if(we===0){E({type:"info",message:"Importacin de Looker completada. No se encontraron creativos nuevos."});return}const Be=Se.map(Pe=>Pe.client.name).join(", ");E({type:"success",message:`Importacin de Looker completada. ${we} nuevos creativos vinculados para: ${Be}.`});const I={...ve};for(const Pe of Se)Pe.newRecordsCount>0&&(await Z({source:"looker",fileName:R.name,fileHash:pe,clientName:Pe.client.name,description:`${Pe.newRecordsCount} creativos vinculados`,undoData:{type:"looker",keys:Pe.undoKeys,clientId:Pe.client.id}}),I[Pe.client.id]=[...I[Pe.client.id]||[],pe]);await Xe.saveProcessedHashes(I)},te=(R,W)=>{var ve;const pe=(ve=R.target.files)==null?void 0:ve[0];pe&&(W==="txt"?oe(pe):H(pe,W),R.target.value="")},H=async(R,W)=>{b(!0),E({type:"info",message:`Procesando reporte de ${W}...`});try{if(W==="looker"){const pe=await Tp(R,e,a,!0);"newAccountNames"in pe&&pe.newAccountNames.length>0?(Y(pe.newAccountNames),Q({file:R,source:W}),w(!0)):await Re(R,e)}else{const pe=await cf(R,e,i,W,!0);"newAccountNames"in pe&&pe.newAccountNames.length>0?(Y(pe.newAccountNames),Q({file:R,source:W}),w(!0)):await ue(R,W,e)}}catch(pe){const ve=pe instanceof Error?pe.message:"Error inesperado.";E({type:"error",message:ve})}finally{b(!1)}},oe=async R=>{try{const W=await R.text();ne({content:W,file:R}),D(!0)}catch{E({type:"error",message:"Error al leer el archivo TXT."})}},k=async R=>{var W;if(B){D(!1),b(!0),E({type:"info",message:"Analizando y guardando reporte Bitcora..."});try{const pe=e.find(Ue=>Ue.id===R);if(!pe)throw new Error("Cliente no encontrado");const ve=await Ku(B.file),Se=await Xe.getProcessedHashes();if((W=Se[R])!=null&&W.includes(ve))throw new Error(`Este archivo (${B.file.name}) ya ha sido importado para este cliente.`);const we=uy(B.content),Be=crypto.randomUUID(),I={...we,id:Be,clientId:R,fileName:B.file.name,importDate:new Date().toISOString()};d([...f,I]),E({type:"success",message:`Reporte "${B.file.name}" importado con xito.`}),await Z({source:"txt",fileName:B.file.name,fileHash:ve,clientName:pe.name,description:"Reporte de bitcora aadido",undoData:{type:"txt",keys:[Be],clientId:R}});const Pe={...Se};Pe[R]=[...Pe[R]||[],ve],await Xe.saveProcessedHashes(Pe)}catch(pe){const ve=pe instanceof Error?pe.message:"Error desconocido.";E({type:"error",message:`Error al procesar el reporte TXT: ${ve}`})}finally{b(!1),ne(null)}}},q=async R=>{const W=R.map(ve=>({id:crypto.randomUUID(),name:ve,logo:`https://avatar.vercel.sh/${encodeURIComponent(ve)}.png?text=${encodeURIComponent(ve.charAt(0))}`,currency:"EUR",userId:p.id,metaAccountName:ve})),pe=[...e,...W];if(n(pe),w(!1),et.info(`Created ${W.length} new clients from import.`),j)try{j.source==="looker"?await Re(j.file,pe):await ue(j.file,j.source,pe)}catch(ve){const Se=ve instanceof Error?ve.message:"Error inesperado.";E({type:"error",message:Se})}finally{Q(null)}},U=R=>{var W;return(W=R.current)==null?void 0:W.click()};return c.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg space-y-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Centro de Importacin de Datos"}),y&&c.jsx("div",{className:`p-4 rounded-md text-sm font-semibold ${y.type==="success"?"bg-green-500/20 text-green-300":y.type==="error"?"bg-red-500/20 text-red-300":"bg-blue-500/20 text-blue-300"}`,children:y.message}),c.jsx("input",{type:"file",ref:ee,onChange:R=>te(R,"looker"),accept:".xlsx",className:"hidden"}),c.jsx("input",{type:"file",ref:he,onChange:R=>te(R,"meta"),accept:".xlsx",className:"hidden"}),c.jsx("input",{type:"file",ref:_e,onChange:R=>te(R,"txt"),accept:".txt",className:"hidden"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsx(Wu,{title:"Rendimiento (Meta)",description:"Sube el XLSX exportado desde Meta Ads para importar los datos de rendimiento de las campaas.",icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M5 11a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z"}),c.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V3zm2 5a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm-1 5a1 1 0 00-1 1v2a1 1 0 001 1h12a1 1 0 001-1v-2a1 1 0 00-1-1H4z",clipRule:"evenodd"})]}),onButtonClick:()=>U(he),buttonText:"Subir XLSX de Meta",disabled:v}),c.jsx(Wu,{title:"Creativos (Looker)",description:"Sube el XLSX de Looker Studio con los nombres de anuncios y las URLs de los creativos para vincularlos.",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),onButtonClick:()=>U(ee),buttonText:"Subir XLSX de Looker",disabled:v}),c.jsx(Wu,{title:"Reporte Bitcora (TXT)",description:"Sube un reporte de bitcora en formato TXT para un anlisis semanal o mensual detallado.",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),onButtonClick:()=>U(_e),buttonText:"Subir TXT de Bitcora",disabled:v})]}),c.jsxs("div",{className:"border-t border-brand-border pt-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-2",children:"Sincronizacin API"}),c.jsx("p",{className:"text-sm text-brand-text-secondary mb-4",children:'Sincroniza datos directamente desde la API de Meta para los clientes que tengan un "Nombre de Cuenta de Meta" configurado.'}),c.jsx("button",{onClick:()=>z(!0),disabled:!m,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:m?"Sincronizar cliente":"Configura la API de Meta en la pestaa de Configuracin",children:"Sincronizar desde Meta API"})]})]}),c.jsx(cy,{isOpen:_,onClose:()=>w(!1),newAccountNames:V,onConfirm:q}),c.jsx($u,{isOpen:S,onClose:()=>D(!1),clients:e,onClientSelect:k,title:"Seleccionar Cliente para Reporte TXT",description:"Elige a qu cliente pertenece este reporte de Bitcora."}),c.jsx($u,{isOpen:A,onClose:()=>z(!1),clients:e.filter(R=>R.metaAccountName),onClientSelect:x,title:"Seleccionar Cliente para Sincronizar",description:"Elige qu cliente quieres sincronizar desde la API de Meta."}),c.jsx(fy,{history:K,setHistory:X,setLookerData:s})]})},xl=({title:e,children:n,defaultOpen:a=!1})=>{const[s,i]=se.useState(a);return c.jsxs("div",{className:"border-b border-brand-border",children:[c.jsxs("button",{className:"flex justify-between items-center w-full py-5 text-left text-brand-text",onClick:()=>i(!s),"aria-expanded":s,children:[c.jsx("span",{className:"text-lg font-semibold",children:e}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transform transition-transform duration-300 ${s?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&c.jsx("div",{className:"pb-5 pr-4 pl-2 text-brand-text-secondary space-y-4 leading-relaxed",children:n})]})},gN=()=>{const e=({children:d})=>c.jsx("p",{children:d}),n=({children:d})=>c.jsx("h3",{className:"text-lg font-semibold text-brand-text mt-4 mb-2",children:d}),a=({children:d})=>c.jsx("ul",{className:"list-disc list-outside ml-5 space-y-2",children:d}),s=({children:d})=>c.jsx("ol",{className:"list-decimal list-outside ml-5 space-y-2",children:d}),i=({children:d})=>c.jsx("li",{children:d}),o=({children:d})=>c.jsx("strong",{className:"font-semibold text-brand-text",children:d}),f=({children:d})=>c.jsx("code",{className:"bg-brand-bg text-yellow-300 font-mono text-sm px-1.5 py-1 rounded-md",children:d});return c.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in",children:[c.jsx("h2",{className:"text-3xl font-bold text-brand-text mb-2",children:"Centro de Ayuda"}),c.jsx("p",{className:"text-brand-text-secondary mb-8",children:"Encuentra respuestas a preguntas comunes y guas para usar la aplicacin."}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs(xl,{title:"1. Primeros Pasos",defaultOpen:!0,children:[c.jsx(e,{children:"Para empezar a usar la aplicacin, sigue estos pasos iniciales:"}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Configurar la Base de Datos:"})," Ve a la pestaa ",c.jsx(f,{children:"Configuracin"}),". La app usa una base de datos simulada en tu navegador (LocalStorage). Los datos de conexin vienen pre-rellenados. Solo tienes que hacer clic en ",c.jsx(o,{children:'"Probar y Guardar Conexin"'}),". Si la conexin es exitosa, el indicador de estado en la barra de navegacin cambiar a verde."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Iniciar Sesin:"})," La primera vez que uses la app, no habr usuarios. Inicia sesin con el usuario por defecto: ",c.jsx(f,{children:"Admin"})," y contrasea ",c.jsx(f,{children:"Admin"}),". Una vez dentro, se recomienda ir a la pestaa ",c.jsx(f,{children:"Usuarios"})," y cambiar la contrasea."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Crear un Cliente:"})," Antes de analizar un creativo, debes tener al menos un cliente. Ve a la pestaa ",c.jsx(f,{children:"Clientes"})," y haz clic en ",c.jsx(o,{children:'"Aadir Cliente"'}),". Rellena el nombre, la moneda de su cuenta publicitaria y, opcionalmente, un logo."]})]})]}),c.jsxs(xl,{title:"2. Cmo Analizar Creativos",children:[c.jsx(e,{children:"El ncleo de la aplicacin es el anlisis de creativos mediante IA. El flujo de trabajo es el siguiente:"}),c.jsxs(s,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Subir Creativo:"})," En la vista principal (",c.jsx(f,{children:"Anlisis de Creativos"}),"), arrastra y suelta una imagen o video, o haz clic para seleccionarlo."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Asignar Cliente:"})," Se te pedir que asignes el creativo a uno de tus clientes. Esto es crucial para mantener los anlisis organizados y usar el historial del cliente como contexto para la IA."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Seleccionar Formato:"})," Una vez asignado, debers elegir un grupo de formatos para el anlisis: ",c.jsx(f,{children:"Formatos Cuadrados/Rectangulares"})," (para Feeds, etc.) o ",c.jsx(f,{children:"Formatos Verticales"})," (para Stories, Reels)."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Interpretar el Anlisis:"})," La IA generar un reporte completo que incluye:",c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Puntuaciones:"})," Efectividad y Claridad para una evaluacin rpida."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Zonas de Riesgo:"})," Una vista previa que muestra las reas donde la interfaz de Meta podra tapar elementos clave de tu creativo."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Recomendaciones:"})," Consejos especficos para mejorar el rendimiento del anuncio."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Anlisis Advantage+:"})," Sugerencias sobre qu mejoras automticas de Meta activar."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Conclusin:"})," Un resumen accionable con los puntos ms importantes."]})]})]})]})]}),c.jsxs(xl,{title:"3. Gestin de Rendimiento (Importar XLSX)",children:[c.jsx(e,{children:"Puedes cruzar los anlisis cualitativos de la IA con datos cuantitativos de tus reportes de Meta Ads."}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Importar Reporte (Admin):"})," En la pestaa ",c.jsx(f,{children:"Importar"}),", sube el archivo XLSX que contiene el rendimiento de todas tus campaas. El sistema procesar los datos y los guardar en la base de datos simulada."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Vinculacin de Datos:"})," La aplicacin intenta vincular cada fila del reporte con un creativo analizado previamente. La vinculacin se realiza mediante una estrategia robusta en varios pasos:",c.jsxs(s,{children:[c.jsxs(i,{children:["Busca si el nombre del archivo original (ej: ",c.jsx(f,{children:"mi_creativo.png"}),") est contenido en el campo ",c.jsx(f,{children:'"Imagen, video y presentacin"'})," del reporte."]}),c.jsxs(i,{children:['Si no hay coincidencia, compara una versin "limpia" del nombre del archivo con el campo ',c.jsx(f,{children:'"Nombre de la imagen"'}),"."]}),c.jsxs(i,{children:["Como ltimo recurso, busca el ",c.jsx(f,{children:'"Identificador de la imagen"'})," del reporte dentro del nombre del archivo original."]})]})]}),c.jsxs(i,{children:[c.jsx(o,{children:"Ver Rendimiento:"})," En la pestaa ",c.jsx(f,{children:"Rendimiento"}),", puedes ver un resumen por cliente. Al hacer clic en un cliente, vers una tabla o tarjetas con el rendimiento de cada anuncio. Los anuncios vinculados a un anlisis de IA se marcarn con un cono especial."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Conclusin de IA:"})," En la vista de detalle de un cliente, puedes solicitar una conclusin estratgica de la IA, que analizar los anuncios vinculados y te dar recomendaciones basadas en los que tuvieron mejor y peor rendimiento."]})]})]}),c.jsxs(xl,{title:"4. Anlisis Estratgico Integral (NUEVO)",children:[c.jsx(e,{children:"La funcionalidad ms avanzada que combina el anlisis de creativos por IA con mtricas de rendimiento para generar un plan de accin estratgico completo."}),c.jsx(n,{children:" Qu es el Anlisis Estratgico Integral?"}),c.jsxs(e,{children:["Esta funcionalidad toma todos los creativos que ya analizaste con IA, los combina con los datos de rendimiento importados, y genera un ",c.jsx(o,{children:"plan estratgico completo"})," usando IA avanzada."]}),c.jsx(n,{children:" Requisitos Previos"}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Creativos Analizados:"}),' Debes tener creativos analizados por IA en la pestaa "Anlisis de Creativos"']}),c.jsxs(i,{children:[c.jsx(o,{children:"Datos de Rendimiento:"})," Debes haber importado datos de rendimiento (archivos XLSX de Meta)"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Datos Vinculados:"})," Los creativos deben estar correctamente vinculados con los datos de rendimiento"]})]}),c.jsx(n,{children:" Cmo Usar"}),c.jsxs(s,{children:[c.jsxs(i,{children:[c.jsx(o,{children:'Ve a "Plan Estratgico"'})," en el men principal"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Selecciona un Cliente:"})," Solo aparecern clientes que tengan creativos analizados Y datos de rendimiento"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Selecciona Perodo:"})," Ajusta las fechas para el anlisis"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Genera Anlisis:"}),' Haz clic en "Generar Anlisis Estratgico"']}),c.jsxs(i,{children:[c.jsx(o,{children:"Revisa el Plan:"})," La IA generar un plan completo con acciones priorizadas"]})]}),c.jsx(n,{children:" Qu Obtienes?"}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Resumen Ejecutivo:"})," Anlisis holstico que conecta calidad de creativos con rendimiento real"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Plan de Accin:"})," 4-6 acciones estratgicas priorizadas (Alta/Media/Baja prioridad) con timelines e impacto esperado"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Insights por Creativo:"})," Conexin especfica entre el anlisis de IA y rendimiento de cada anuncio"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Recomendaciones de Rendimiento:"})," Categorizadas por Presupuesto, Targeting, Creativos, Pujas y Placements"]})]}),c.jsx(n,{children:" Ejemplo de Anlisis"}),c.jsx(e,{children:"La IA podra generar algo como:"}),c.jsx(e,{children:c.jsx(o,{children:`"Los creativos con puntuaciones de efectividad superiores a 70 estn generando un ROAS 40% ms alto. Recomiendo escalar el presupuesto del 'Summer Glow Campaign' en un 50% y optimizar los 2 creativos con problemas en zonas seguras para Stories."`})}),c.jsx(n,{children:" Casos de Uso"}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Reportes para Clientes:"})," Genera reportes ejecutivos completos"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Optimizacin Guiada:"})," Sigue un plan paso a paso basado en datos reales"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Priorizacin:"})," Entiende qu acciones tendrn mayor impacto"]}),c.jsxs(i,{children:[c.jsx(o,{children:"Correlaciones:"})," Descubre patrones entre calidad creativa y rendimiento"]})]})]}),c.jsxs(xl,{title:"5. Funciones de Administrador",children:[c.jsxs(e,{children:["Si tienes rol de ",c.jsx(o,{children:"Admin"}),", tienes acceso a vistas y funciones adicionales:"]}),c.jsxs(a,{children:[c.jsxs(i,{children:[c.jsx(o,{children:"Importar:"})," Permite subir el reporte maestro XLSX con datos de todas las cuentas."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Usuarios:"})," Permite crear, editar y eliminar usuarios de la aplicacin."]}),c.jsxs(i,{children:[c.jsx(o,{children:"Panel de Control:"}),' Ofrece una vista de bajo nivel de la "base de datos". Puedes ver el estado de las "tablas", crearlas si es necesario, y realizar acciones de limpieza, como borrar todo el historial de anlisis o resetear por completo los datos de la aplicacin. ',c.jsx(o,{children:"Usa esta seccin con cuidado."})]}),c.jsxs(i,{children:[c.jsx(o,{children:"Clientes:"})," Un administrador puede ver y gestionar los clientes de todos los usuarios, no solo los propios."]})]})]})]})]})},vN={INFO:"text-brand-text-secondary",SUCCESS:"text-green-400",WARNING:"text-yellow-400",ERROR:"text-red-400",DEBUG:"text-blue-400"},bN=()=>{const[e,n]=se.useState(et.getLogs()),a=se.useRef(null);se.useEffect(()=>{const i=f=>{n(d=>[...d,f])},o=et.subscribe(i);return n(et.getLogs()),()=>o()},[]),se.useEffect(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[e]);const s=()=>{et.clear(),n([])};return c.jsxs("div",{className:"max-w-7xl mx-auto bg-brand-surface rounded-lg p-6 shadow-lg animate-fade-in",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"System Logs"}),c.jsxs("button",{onClick:s,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Clear Logs"]})]}),c.jsx("div",{ref:a,className:"bg-brand-bg p-4 rounded-md font-mono text-xs h-96 overflow-y-auto w-full",children:e.map((i,o)=>c.jsxs("div",{className:`flex gap-4 items-start whitespace-pre-wrap border-b border-brand-border/20 py-1 ${vN[i.level]}`,children:[c.jsx("span",{className:"flex-shrink-0 font-semibold",children:i.timestamp.toLocaleTimeString()}),c.jsx("p",{className:"flex-grow",children:i.message})]},o))})]})},yN=e=>{if(!e)return null;const n=e.split("/");if(n.length===3){const[s,i,o]=n.map(Number);return new Date(o,i-1,s)}const a=new Date(e);return isNaN(a.getTime())?null:a},EN=({card:e})=>{const[n,a]=se.useState(!1);return c.jsxs("div",{className:"bg-brand-border/30 rounded-lg p-5 transition-all duration-300",children:[c.jsxs("div",{className:"flex justify-between items-start gap-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-bold text-brand-text",children:e.title}),c.jsx("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2",children:e.supportingMetrics.map(s=>c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-brand-text-secondary uppercase tracking-wider",children:s.metricName}),c.jsx("p",{className:"text-brand-primary font-bold text-lg",children:s.value})]},s.metricName))})]}),c.jsxs("button",{onClick:()=>a(!n),className:"flex-shrink-0 bg-brand-border hover:bg-brand-bg text-brand-text-secondary font-semibold py-2 px-3 rounded-md text-sm transition-colors flex items-center gap-2",children:[n?"Ocultar":"Ver Explicacin",c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),n&&c.jsxs("div",{className:"mt-4 pt-4 border-t border-brand-border/50 space-y-4 animate-fade-in",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Explicacin del Hallazgo"}),c.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.explanation})]}),e.fatigueAnalysis&&c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Anlisis de Fatiga"}),c.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.fatigueAnalysis})]}),e.demographicInsights&&c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Insights Demogrficos"}),c.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.demographicInsights})]}),c.jsxs("div",{className:"bg-brand-primary/10 p-3 rounded-md",children:[c.jsx("h4",{className:"font-semibold text-brand-primary mb-1",children:"Plan de Accin Recomendado"}),c.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.recommendation})]})]})]})},_N=()=>c.jsx("div",{className:"space-y-4 animate-pulse",children:[...Array(3)].map((e,n)=>c.jsx("div",{className:"bg-brand-border/30 rounded-lg p-5",children:c.jsxs("div",{className:"flex justify-between items-start gap-4",children:[c.jsxs("div",{className:"flex-1 space-y-2",children:[c.jsx("div",{className:"h-5 bg-brand-border rounded-md w-3/4"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-8 bg-brand-border rounded-md w-1/4"}),c.jsx("div",{className:"h-8 bg-brand-border rounded-md w-1/4"})]})]}),c.jsx("div",{className:"h-9 w-32 bg-brand-border rounded-md"})]})},n))}),wN=({clients:e,lookerData:n,getTrendsAnalysis:a,performanceData:s,startDate:i,endDate:o,onDateChange:f})=>{const[d,x]=se.useState(""),[m,p]=se.useState(!1),[v,b]=se.useState(null);se.useEffect(()=>{e.length>0&&!d&&x(e[0].id)},[e,d]);const y=async()=>{if(!d||!i||!o){alert("Por favor, selecciona un cliente y un rango de fechas.");return}p(!0),b(null),et.info("Starting trends analysis",{selectedClientId:d,startDate:i,endDate:o});const E=e.find(K=>K.id===d);if(!E){p(!1);return}const _=n[E.id]||{},w=s[E.id]||[],S=new Date(i);S.setHours(0,0,0,0);const D=new Date(o);D.setHours(23,59,59,999);const A=w.filter(K=>{const X=yN(K.day);return X&&X>=S&&X<=D&&K.adDelivery.toLowerCase()==="active"&&K.impressions>0}),z=A.reduce((K,X)=>(X.adName&&(K[X.adName]||(K[X.adName]=[]),K[X.adName].push(X)),K),{}),Y=Object.entries(z).map(([K,X])=>{var Ve;const ee=X.reduce((ge,Ie)=>{const pt=Ie.impressions||0;return ge.spend+=Ie.spend||0,ge.purchaseValue+=Ie.purchaseValue||0,ge.purchases+=Ie.purchases||0,ge.impressions+=pt,ge.clicks+=Ie.clicksAll||0,ge.linkClicks+=Ie.linkClicks||0,ge.thruPlays+=Ie.thruPlays||0,ge.frequencyTotal+=(Ie.frequency||0)*pt,(Ie.videoAveragePlayTime||0)>0&&pt>0&&(ge.videoAveragePlayTimeWeightedTotal+=(Ie.videoAveragePlayTime||0)*pt,ge.videoImpressions+=pt),ge.reach+=Ie.reach||0,ge.landingPageViews+=Ie.landingPageViews||0,ge.addsToCart+=Ie.addsToCart||0,ge.checkoutsInitiated+=Ie.checkoutsInitiated||0,ge.postInteractions+=Ie.postInteractions||0,ge.postReactions+=Ie.postReactions||0,ge.postComments+=Ie.postComments||0,ge.postShares+=Ie.postShares||0,ge.pageLikes+=Ie.pageLikes||0,ge.atencion+=Ie.attention||0,ge.interes+=Ie.interest||0,ge.deseo+=Ie.desire||0,ge},{spend:0,purchaseValue:0,purchases:0,impressions:0,clicks:0,linkClicks:0,thruPlays:0,videoAveragePlayTimeWeightedTotal:0,videoImpressions:0,frequencyTotal:0,landingPageViews:0,addsToCart:0,checkoutsInitiated:0,postInteractions:0,reach:0,atencion:0,interes:0,deseo:0,postReactions:0,postComments:0,postShares:0,pageLikes:0}),he=w.filter(ge=>ge.adName===K),_e=new Set;he.forEach(ge=>{var Ie,pt,ye;((Ie=ge.adDelivery)==null?void 0:Ie.toLowerCase())==="active"&&((pt=ge.adSetDelivery)==null?void 0:pt.toLowerCase())==="active"&&((ye=ge.campaignDelivery)==null?void 0:ye.toLowerCase())==="active"&&_e.add(ge.day)});const Z=_e.size,ue=[...new Set(he.map(ge=>ge.adSetName))],Re=[...new Set(he.map(ge=>ge.campaignName))],te=[...new Set(he.flatMap(ge=>{var Ie;return((Ie=ge.includedCustomAudiences)==null?void 0:Ie.split(",").map(pt=>pt.trim()))||[]}).filter(Boolean))],H=[...new Set(he.flatMap(ge=>{var Ie;return((Ie=ge.excludedCustomAudiences)==null?void 0:Ie.split(",").map(pt=>pt.trim()))||[]}).filter(Boolean))],oe=ee.spend>0?ee.purchaseValue/ee.spend:0,k=ee.purchases>0?ee.spend/ee.purchases:0,q=ee.impressions>0?ee.spend/ee.impressions*1e3:0,U=ee.impressions>0?ee.clicks/ee.impressions*100:0,R=ee.impressions>0?ee.linkClicks/ee.impressions*100:0,W=ee.impressions>0?ee.frequencyTotal/ee.impressions:0,pe=ee.videoImpressions>0?ee.videoAveragePlayTimeWeightedTotal/ee.videoImpressions:0,ve=ee.purchases>0?ee.purchaseValue/ee.purchases:0,Se=ee.clicks>0?ee.spend/ee.clicks:0,we=ee.linkClicks>0?ee.landingPageViews/ee.linkClicks*100:0,Be=ee.landingPageViews>0?ee.purchases/ee.landingPageViews*100:0,I=_[K],Pe=new Set(X.map(ge=>ge.adSetName)).size>1,Ue=(Ve=X.find(ge=>ge.videoFileName))==null?void 0:Ve.videoFileName,We=!!Ue||X.some(ge=>ge.thruPlays>0)&&pe>1;return{adName:K,adSetNames:ue,campaignNames:Re,includedCustomAudiences:te,excludedCustomAudiences:H,spend:ee.spend,purchases:ee.purchases,purchaseValue:ee.purchaseValue,impressions:ee.impressions,clicks:ee.clicks,linkClicks:ee.linkClicks,roas:oe,cpa:k,cpm:q,ctr:U,ctrLink:R,frequency:W,videoAveragePlayTime:pe,thruPlays:ee.thruPlays,isMatched:!!I,creativeDescription:I==null?void 0:I.creativeDescription,currency:E.currency,inMultipleAdSets:Pe,imageUrl:I==null?void 0:I.imageUrl,adPreviewLink:I==null?void 0:I.adPreviewLink,creativeType:We?"video":"image",analysisResult:I==null?void 0:I.analysisResult,videoFileName:Ue,ticketPromedio:ve,alcance:ee.reach,cpc:Se,visitasLP:ee.landingPageViews,tasaVisitaLP:we,tasaCompra:Be,addsToCart:ee.addsToCart,checkoutsInitiated:ee.checkoutsInitiated,postInteractions:ee.postInteractions,postReactions:ee.postReactions,postComments:ee.postComments,postShares:ee.postShares,pageLikes:ee.pageLikes,activeDays:Z,atencion:ee.atencion,interes:ee.interes,deseo:ee.deseo,isVideoUploaded:!1,demographics:[],previousWeekMetrics:void 0}}).filter(K=>K.creativeDescription&&K.roas>1).sort((K,X)=>X.spend-K.spend).slice(0,7);if(Y.length===0){alert("No hay suficientes anuncios con buen rendimiento y anlisis de IA en este perodo para generar un anlisis de tendencias. Intenta con un rango de fechas ms amplio o analiza ms creativos."),p(!1);return}const j=new Set(Y.map(K=>K.adName)),Q=A.filter(K=>j.has(K.adName)),B=`${new Date(i).toLocaleDateString("es-ES")} - ${new Date(o).toLocaleDateString("es-ES")}`,ne=await a(Y,E,B,Q);b(ne),p(!1)};return c.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("header",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Anlisis de Tendencias y Estrategias"}),c.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Obtn una visin estratgica de la IA sobre qu est funcionando, por qu, y qu hacer a continuacin."})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg flex flex-col md:flex-row items-center gap-6",children:[c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{htmlFor:"client-selector",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Cliente"}),c.jsx("select",{id:"client-selector",value:d,onChange:E=>x(E.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",children:e.map(E=>c.jsx("option",{value:E.id,children:E.name},E.id))})]}),c.jsxs("div",{className:"flex-1 w-full",children:[c.jsx("label",{className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Perodo"}),c.jsx(uo,{onDateChange:f,startDate:i,endDate:o})]}),c.jsx("div",{className:"w-full md:w-auto self-end",children:c.jsxs("button",{onClick:y,disabled:m||!d,className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),c.jsx("span",{children:m?"Analizando...":"Analizar Tendencias"})]})})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg min-h-[20rem]",children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:"Resultados del Anlisis Estratgico"}),m&&c.jsx(_N,{}),!m&&v&&(v.trends.length>0?c.jsx("div",{className:"space-y-4",children:v.trends.map((E,_)=>c.jsx(EN,{card:E},_))}):c.jsxs("div",{className:"text-center py-10",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Anlisis completado sin resultados."}),c.jsx("p",{className:"text-brand-text-secondary",children:"La IA no pudo generar tendencias con los datos actuales. Prueba un rango de fechas diferente o con ms anuncios analizados."})]})),!m&&!v&&c.jsxs("div",{className:"text-center py-10",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),c.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Listo para analizar"}),c.jsx("p",{className:"text-brand-text-secondary",children:'Configura el cliente y el perodo, y presiona "Analizar Tendencias" para empezar.'})]})]})]})},TN=({label:e,data:n,icon:a})=>{var o;if(!n)return null;let s="",i=null;if(typeof n=="object"&&"value"in n){const f={};if((o=n.symbol)!=null&&o.includes("")?(f.style="currency",f.currency="EUR"):(f.minimumFractionDigits=2,f.maximumFractionDigits=2),s=n.value.toLocaleString("es-ES",f),n.symbol&&!n.symbol.includes("")&&(s+=` ${n.symbol}`),n.change!==void 0&&n.direction&&n.direction!=="neutral"){const d=n.direction==="up",x=e.toLowerCase()==="cpa"?!d:d;i=c.jsxs("span",{className:`text-sm font-bold ${x?"text-green-300":"text-red-400"}`,children:[d?"":""," ",(n.change*100).toFixed(1),"% vs sem. ant."]})}}else s=String(n);return c.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 flex flex-col justify-between shadow-lg hover:shadow-cyan-500/10 transition-shadow",children:[c.jsxs("div",{className:"flex items-center justify-between text-cyan-300",children:[c.jsx("p",{className:"text-sm font-semibold uppercase tracking-wider",children:e}),a]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-3xl font-bold text-white my-2",children:s}),c.jsx("div",{className:"h-5",children:i})]})]})},SN=({table:e})=>{const n=e.headers.find(i=>i.includes("Semana actual"))||e.headers[1];if(!n)return null;const a=e.rows.map(i=>{const o=i["Paso del Embudo"],f=i[n],d=typeof f=="object"?f.value:0;return{name:String(o),value:d}}).filter(i=>i.value>0);let s=0;return a.length>0&&(s=a[0].value),c.jsx("div",{className:"space-y-2",children:a.map((i,o)=>{const f=s>0?i.value/s*100:0;return c.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[c.jsx("div",{className:"w-40 text-right truncate text-cyan-200",children:i.name}),c.jsx("div",{className:"flex-1 bg-gray-700/50 rounded-full h-6",children:c.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-6 rounded-full flex items-center justify-end pr-2",style:{width:`${f}%`},children:c.jsx("span",{className:"font-bold text-white text-xs",children:i.value.toLocaleString("es-ES")})})})]},o)})})},Sp=({table:e,clientLookerData:n})=>c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm text-left text-cyan-200",children:[c.jsx("thead",{className:"text-xs text-cyan-100 uppercase bg-white/5",children:c.jsx("tr",{children:e.headers.map(a=>c.jsx("th",{scope:"col",className:"px-4 py-3 whitespace-nowrap",children:a},a))})}),c.jsx("tbody",{children:e.rows.map((a,s)=>c.jsx("tr",{className:"border-b border-white/10 hover:bg-white/5",children:e.headers.map(i=>{const o=a[i],f=a.Anuncio,d=typeof f=="string"?f:String((f==null?void 0:f.value)||""),x=d?n[d]:null;if(i==="Anuncio"&&(x!=null&&x.imageUrl))return c.jsx("td",{className:"px-4 py-3 max-w-xs",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("img",{src:x.imageUrl,alt:d,className:"h-10 w-10 rounded-md object-cover bg-brand-bg flex-shrink-0"}),c.jsx("span",{className:"font-medium text-white truncate",title:d,children:d})]})},i);if(typeof o=="object"&&o!==null&&"value"in o){const m=o;return c.jsxs("td",{className:"px-4 py-3 font-mono",children:[c.jsxs("span",{children:[m.symbol&&!m.symbol.includes("%")?m.symbol:"",m.value.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),m.symbol&&m.symbol.includes("%")?m.symbol:""]}),m.change!==void 0&&c.jsxs("span",{className:`ml-2 text-xs ${m.direction==="up"?"text-green-400":m.direction==="down"?"text-red-400":"text-cyan-200"}`,children:["(",(m.change*100).toFixed(1),"% ",m.direction==="up"?"":"",")"]})]},i)}return c.jsx("td",{className:"px-4 py-3",children:String(o)},i)})},s))})]})}),AN=e=>{const n=e.match(/\((\d{1,2} \w{3,}\.?  \d{1,2} \w{3,}\.? \d{4})\)/);return n&&n[1]?n[1].replace(/[\s.]/g,"").replace("","_"):null},Ap=(e,n)=>{const a=s=>{const i=e.find(o=>typeof o.Mtrica=="string"&&o.Mtrica.toLowerCase()===s.toLowerCase());return i?i[n]:"N/A"};return{roas:a("roas"),inversion:a("inversion"),ventas:a("ventas"),cpa:a("cpa")}},NN={ene:0,feb:1,mar:2,abr:3,may:4,jun:5,jul:6,ago:7,sep:8,oct:9,nov:10,dic:11},Np=e=>{const n=e.match(/ (\d{1,2}) (\w{3,})\.? (\d{4})/);if(n){const[,a,s,i]=n,o=NN[s.toLowerCase().substring(0,3)];if(a&&o!==void 0&&i)return new Date(parseInt(i,10),o,parseInt(a,10))}return null},co=({label:e,data:n})=>{var i;if(!n)return null;let a="",s=null;if(typeof n=="object"&&"value"in n){const o={};if((i=n.symbol)!=null&&i.includes("")?(o.style="currency",o.currency="EUR"):(o.minimumFractionDigits=2,o.maximumFractionDigits=2),a=n.value.toLocaleString("es-ES",o),n.symbol&&!n.symbol.includes("")&&(a+=` ${n.symbol}`),n.change!==void 0&&n.direction&&n.direction!=="neutral"){const f=n.direction==="up",d=e.toLowerCase()==="cpa"?!f:f;s=c.jsxs("span",{className:`ml-1.5 text-xs font-bold ${d?"text-green-400":"text-red-400"}`,children:[f?"":""," ",(n.change*100).toFixed(1),"%"]})}}else a=String(n);return c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-brand-text-secondary uppercase",children:e}),c.jsxs("p",{className:"font-semibold text-brand-text text-lg",children:[a,s]})]})},CN=({clients:e,lookerData:n,bitacoraReports:a})=>{var y,E;const[s,i]=se.useState(""),[o,f]=se.useState(null),[d,x]=se.useState(!1);se.useEffect(()=>{e.length>0&&!s&&i(e[0].id)},[e,s]);const m=se.useMemo(()=>{if(!s)return[];const _=a.filter(S=>S.clientId===s),w=new Map;for(const S of _){if(!S.mainSummaryTable)continue;const D=S.mainSummaryTable;for(const A of D.headers){if(A.toLowerCase()==="mtrica")continue;const z=AN(A);if(!z)continue;const V={weekId:z,reportId:S.id,periodLabel:A,metrics:Ap(D.rows,A),importDate:S.importDate},Y=w.get(z);(!Y||new Date(V.importDate)>new Date(Y.importDate))&&w.set(z,V)}}return Array.from(w.values()).sort((S,D)=>{const A=Np(S.periodLabel),z=Np(D.periodLabel);return A&&z?z.getTime()-A.getTime():new Date(D.importDate).getTime()-new Date(S.importDate).getTime()})},[a,s]),p=se.useMemo(()=>a.find(_=>_.id===o)||null,[a,o]),v=n[s]||{},b=se.useMemo(()=>{if(!p||!p.mainSummaryTable)return[];const _=p.mainSummaryTable,w=_.headers.find(D=>D.includes("Semana actual"))||_.headers[1];if(!w)return[];const S=Ap(_.rows,w);return[{label:"Inversin",data:S.inversion,icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-1.134 0V7.151c.196.062.387.148.567.267zM11.567 7.418c.155-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-1.134 0V7.151c.196.062.387.148.567.267z"}),c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.5 4.5 0 00-1.876.763.5.5 0 00.374.938 3.5 3.5 0 013.704 0 .5.5 0 00.374-.938A4.5 4.5 0 0011 5.092V5zM10 14a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})]})},{label:"Ventas",data:S.ventas,icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4z",clipRule:"evenodd"})})},{label:"ROAS",data:S.roas,icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),c.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]})},{label:"CPA",data:S.cpa,icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}]},[p]);return c.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("header",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Visor de Reportes de Bitcora"}),c.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Selecciona un cliente y un reporte para ver el anlisis detallado de la cuenta."})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[c.jsxs("div",{className:"max-w-sm mb-6",children:[c.jsx("label",{htmlFor:"client-selector-reports",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Cliente"}),c.jsx("select",{id:"client-selector-reports",value:s,onChange:_=>{i(_.target.value),f(null)},className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",disabled:e.length===0,children:e.length>0?e.map(_=>c.jsx("option",{value:_.id,children:_.name},_.id)):c.jsx("option",{children:"No hay clientes"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-8",children:[c.jsxs("aside",{className:"md:col-span-4 lg:col-span-3",children:[c.jsx("h2",{className:"font-bold text-brand-text mb-2",children:"Resmenes Semanales"}),c.jsxs("div",{className:"bg-brand-bg rounded-md p-2 space-y-2 max-h-[70vh] overflow-y-auto",children:[d&&c.jsx("p",{className:"text-sm text-brand-text-secondary p-2",children:"Cargando reportes..."}),!d&&m.length===0&&c.jsx("p",{className:"text-sm text-brand-text-secondary p-2",children:"No hay reportes semanales para este cliente."}),m.map(_=>c.jsxs("div",{className:`w-full text-left p-3 rounded-md transition-all duration-300 ${o===_.reportId?"bg-brand-primary/10 ring-2 ring-brand-primary":"bg-brand-border/30 hover:bg-brand-border/50"}`,children:[c.jsx("button",{onClick:()=>f(_.reportId),className:"w-full text-left font-semibold block text-brand-text mb-3",children:_.periodLabel}),c.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-3",children:[c.jsx(co,{label:"ROAS",data:_.metrics.roas}),c.jsx(co,{label:"Inversin",data:_.metrics.inversion}),c.jsx(co,{label:"Ventas",data:_.metrics.ventas}),c.jsx(co,{label:"CPA",data:_.metrics.cpa})]})]},_.weekId))]})]}),c.jsx("main",{className:"md:col-span-8 lg:col-span-9",children:p?c.jsxs("div",{className:"space-y-8",children:[c.jsxs("h2",{className:"text-3xl font-bold text-cyan-300",children:["Revisin Global: ",(E=(y=p.mainSummaryTable)==null?void 0:y.headers[1].match(/\((.*?)\)/))==null?void 0:E[1]]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:b.map(_=>c.jsx(TN,{..._},_.label))}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[c.jsxs("div",{className:"lg:col-span-3 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[c.jsx("h3",{className:"font-semibold text-cyan-300 mb-4",children:"Embudo de Conversin"}),p.funnelAnalysisTable?c.jsx(SN,{table:p.funnelAnalysisTable}):c.jsx("p",{className:"text-sm text-cyan-200/50",children:"Datos de embudo no disponibles."})]}),c.jsxs("div",{className:"lg:col-span-2 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[c.jsx("h3",{className:"font-semibold text-cyan-300 mb-4",children:"Tendencia de Ratios"}),p.ratioTrendsTable?c.jsx(Sp,{table:p.ratioTrendsTable,clientLookerData:{}}):c.jsx("p",{className:"text-sm text-cyan-200/50",children:"Datos de tendencias no disponibles."})]})]}),p.topAdsTables.map((_,w)=>c.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[c.jsx("h3",{className:"font-semibold text-cyan-300 mb-3",children:_.title}),c.jsx(Sp,{table:_,clientLookerData:v})]},`top-ads-${w}`))]}):c.jsx("div",{className:"flex items-center justify-center h-full bg-brand-bg rounded-lg border-2 border-dashed border-brand-border",children:c.jsxs("div",{className:"text-center p-8",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Selecciona un resumen semanal"}),c.jsx("p",{className:"text-brand-text-secondary",children:"Elige un resumen de la lista de la izquierda para ver su contenido detallado."})]})})})]})]})]})},kN=({clients:e,lookerData:n,performanceData:a,getStrategicAnalysis:s,startDate:i,endDate:o,onDateChange:f})=>{const[d,x]=se.useState(""),[m,p]=se.useState(!1),[v,b]=se.useState(null),[y,E]=se.useState(null),_=se.useMemo(()=>e.filter(A=>{var j;const z=n[A.id]||{},V=Object.values(z).some(Q=>Q.analysisResult),Y=((j=a[A.id])==null?void 0:j.length)>0;return V&&Y}),[e,n,a]),w=se.useMemo(()=>e.find(A=>A.id===d),[e,d]),S=A=>{const z=n[A.id]||{},Y=(a[A.id]||[]).filter(B=>{const ne=new Date(B.day),K=new Date(i),X=new Date(o);return ne>=K&&ne<=X}),j=Object.entries(z).filter(([B,ne])=>ne.analysisResult).map(([B,ne])=>{const K=Y.filter(ee=>ee.adName===B),X=ON(K);return{adName:B,creativeDescription:ne.creativeDescription||"",analysisResult:ne.analysisResult,performanceData:X,keyInsights:RN(ne.analysisResult,X)}}),Q={totalSpend:Y.reduce((B,ne)=>B+ne.spend,0),totalRevenue:Y.reduce((B,ne)=>B+ne.purchaseValue,0),overallROAS:of(Y),bestPerformingAds:jN(j),worstPerformingAds:MN(j),trendAnalysis:LN(Y),demographicInsights:FN()};return{client:A,creativeSummaries:j,performanceMetrics:Q,dateRange:{start:i,end:o}}},D=async()=>{if(w){p(!0),E(null);try{const A=S(w),z=await s(A);b(z)}catch(A){E(A instanceof Error?A.message:"Error en el anlisis estratgico")}finally{p(!1)}}};return c.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[c.jsxs("header",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Anlisis Estratgico Integral"}),c.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Combina anlisis de creativos con mtricas de rendimiento para generar planes de accin estratgicos."})]}),c.jsx(uo,{onDateChange:f,startDate:i,endDate:o})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Seleccionar Cliente para Anlisis"}),_.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsxs("div",{className:"text-brand-text-secondary",children:[c.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("p",{className:"text-lg font-medium",children:"No hay clientes elegibles"}),c.jsxs("p",{className:"mt-2",children:["Para usar esta funcin, necesitas clientes con:",c.jsx("br",{})," Creativos analizados por IA",c.jsx("br",{})," Datos de rendimiento importados"]})]})}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map(A=>{const z=n[A.id]||{},V=Object.values(z).filter(j=>j.analysisResult).length,Y=Object.keys(z).length;return c.jsxs("button",{onClick:()=>x(A.id),className:`p-4 rounded-lg border-2 transition-all text-left ${d===A.id?"border-brand-primary bg-brand-primary/10":"border-brand-border hover:border-brand-primary/50"}`,children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("img",{src:A.logo,alt:A.name,className:"h-10 w-10 rounded-full"}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-brand-text",children:A.name}),c.jsxs("p",{className:"text-sm text-brand-text-secondary",children:[V," de ",Y," creativos analizados"]})]})]}),c.jsxs("div",{className:"text-xs text-brand-text-secondary",children:[" Creativos con anlisis IA",c.jsx("br",{})," Datos de rendimiento disponibles"]})]},A.id)})}),w&&c.jsx("div",{className:"mt-6 flex justify-center",children:c.jsx("button",{onClick:D,disabled:m,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-8 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3",children:m?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Analizando estrategia..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Generar Anlisis Estratgico"]})})})]})]}),y&&c.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[c.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("span",{className:"font-medium",children:"Error en el anlisis:"})]}),c.jsx("p",{className:"mt-1 text-red-300",children:y})]}),v&&w&&c.jsx(DN,{result:v,client:w,dateRange:{start:i,end:o}})]})},DN=({result:e,client:n,dateRange:a})=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[c.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Resumen Ejecutivo - ",n.name]}),c.jsxs("div",{className:"prose prose-invert max-w-none",children:[c.jsxs("p",{className:"text-brand-text-secondary text-sm mb-4",children:["Perodo analizado: ",new Date(a.start).toLocaleDateString()," - ",new Date(a.end).toLocaleDateString()]}),c.jsx("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:c.jsx("p",{className:"text-brand-text leading-relaxed",children:e.executiveSummary})})]})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[c.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Plan de Accin Estratgico"]}),c.jsx("div",{className:"space-y-4",children:e.actionPlan.map((s,i)=>c.jsxs("div",{className:"border-l-4 border-brand-primary pl-4",children:[c.jsx("h4",{className:"font-semibold text-brand-text",children:s.title}),c.jsx("p",{className:"text-brand-text-secondary mt-1",children:s.description}),c.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[c.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.priority==="HIGH"?"bg-red-500/20 text-red-400":s.priority==="MEDIUM"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:["Prioridad ",s.priority]}),c.jsxs("span",{className:"text-xs text-brand-text-secondary",children:["Impacto esperado: ",s.expectedImpact]})]})]},i))})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[c.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Insights de Creativos"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.creativeInsights.map((s,i)=>c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h4",{className:"font-semibold text-brand-text mb-2",children:s.adName}),c.jsx("p",{className:"text-sm text-brand-text-secondary mb-2",children:s.insight}),c.jsx("div",{className:"text-xs text-brand-primary",children:s.recommendation})]},i))})]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[c.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Recomendaciones de Rendimiento"]}),c.jsx("div",{className:"space-y-3",children:e.performanceRecommendations.map((s,i)=>c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-brand-bg/50 rounded-lg",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-primary mt-2 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-brand-text",children:s.recommendation}),c.jsxs("p",{className:"text-sm text-brand-text-secondary mt-1",children:["Impacto esperado: ",s.expectedImpact]})]})]},i))})]})]}),ON=(e,n)=>{var s;if(e.length===0)return{adName:"",spend:0,revenue:0,roas:0,impressions:0,clicks:0,ctr:0,cpc:0,purchases:0};const a=e.reduce((i,o)=>({spend:i.spend+o.spend,revenue:i.revenue+o.purchaseValue,impressions:i.impressions+o.impressions,clicks:i.clicks+o.linkClicks,purchases:i.purchases+o.purchases}),{spend:0,revenue:0,impressions:0,clicks:0,purchases:0});return{adName:((s=e[0])==null?void 0:s.adName)||"",spend:a.spend,revenue:a.revenue,roas:a.spend>0?a.revenue/a.spend:0,impressions:a.impressions,clicks:a.clicks,ctr:a.impressions>0?a.clicks/a.impressions*100:0,cpc:a.clicks>0?a.spend/a.clicks:0,purchases:a.purchases}},RN=(e,n)=>{const a=[];return e.effectivenessScore<50&&a.push(`Efectividad baja (${e.effectivenessScore}/100)`),n.roas<2&&a.push(`ROAS por debajo del promedio (${n.roas.toFixed(2)})`),e.funnelStage==="TOFU"&&n.ctr>2&&a.push("Buen CTR para creative de awareness"),a},of=e=>{const n=e.reduce((s,i)=>s+i.spend,0),a=e.reduce((s,i)=>s+i.purchaseValue,0);return n>0?a/n:0},jN=e=>e.sort((n,a)=>a.performanceData.roas-n.performanceData.roas).slice(0,3).map(n=>n.adName),MN=e=>e.sort((n,a)=>n.performanceData.roas-a.performanceData.roas).slice(0,3).map(n=>n.adName),LN=e=>{if(e.length<2)return"Datos insuficientes para anlisis de tendencias";const n=e.sort((f,d)=>new Date(f.day).getTime()-new Date(d.day).getTime()),a=n.slice(0,Math.floor(n.length/2)),s=n.slice(Math.floor(n.length/2)),i=of(a),o=of(s);return o>i*1.1?"Tendencia positiva en ROAS":o<i*.9?"Tendencia negativa en ROAS":"ROAS estable en el perodo"},FN=e=>"Anlisis demogrfico disponible con ms datos",Rn=(e,n)=>e+(Math.random()-.5)*n*e,IN=(e,n)=>(console.log(`[Meta API Simulator] Fetching data for account: ${n} with App ID: ${e.appId}`),new Promise(a=>{setTimeout(()=>{const s=new Date,i=[],o=["11-07-2025_Summer Sale_Image_TOF_Offer_Choker Iris__Product__V1_Brand_In-house_Studio_Details_(CP)","summer sale 20%off (gorgeous hair) img oferta diseno una imagen o video ninguno 04/07/2025 - copia","Los 5 accesorios de esta primavera | Video | Problema | Actriz | Una imagen o video | Ninguno |  - Copia"];for(let f=0;f<7;f++){const d=new Date(s);d.setDate(s.getDate()-f);const x=`${d.getDate().toString().padStart(2,"0")}/${(d.getMonth()+1).toString().padStart(2,"0")}/${d.getFullYear()}`;o.forEach((m,p)=>{const v=m.toLowerCase().includes("video"),b=Rn(50,.4),y=Rn(1e4,.3),E=Rn(y*.02,.5),_=Rn(b/3,.6),w=_*Rn(80,.2);i.push({accountName:n,adName:m,day:x,spend:b,impressions:y,linkClicks:E,purchases:_,purchaseValue:w,frequency:Rn(1.5,.2),cpm:b/y*1e3,ctrLink:E/y*100,adDelivery:"active",age:"25-34",gender:p%2===0?"female":"male",campaignName:"Simulated API Campaign",adSetName:"Simulated Ad Set",videoFileName:v?`${m.substring(0,20).replace(/\|/g,"_")}.mp4`:void 0,thruPlays:v?Rn(y*.1,.3):0,videoAveragePlayTime:v?Rn(12,.5):0})})}console.log(`[Meta API Simulator] Generated ${i.length} records.`),a(i)},1500)})),BN=({onFileUpload:e})=>{const[n,a]=se.useState(null),[s,i]=se.useState(!1),o=se.useRef(null),f=b=>{var E;const y=(E=b.target.files)==null?void 0:E[0];y&&(a(y.name),e(y))},d=()=>{var b;(b=o.current)==null||b.click()},x=se.useCallback(b=>{if(b.preventDefault(),b.stopPropagation(),i(!1),b.dataTransfer.files&&b.dataTransfer.files[0]){const y=b.dataTransfer.files[0];a(y.name),e(y)}},[e]),m=b=>{b.preventDefault(),b.stopPropagation()},p=b=>{b.preventDefault(),b.stopPropagation(),i(!0)},v=b=>{b.preventDefault(),b.stopPropagation(),i(!1)};return c.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[c.jsx("h2",{className:"text-xl font-semibold text-brand-text mb-4 text-center",children:"Sube tu Creativo"}),c.jsxs("div",{className:`border-2 border-dashed rounded-lg p-10 text-center cursor-pointer transition-colors ${s?"border-brand-primary bg-brand-primary/10":"border-brand-border hover:border-brand-primary bg-brand-bg"}`,onClick:d,onDrop:x,onDragOver:m,onDragEnter:p,onDragLeave:v,children:[c.jsx("input",{type:"file",ref:o,onChange:f,className:"hidden",accept:"image/*,video/*"}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),c.jsx("p",{className:"mt-4 text-lg font-semibold text-brand-text",children:"Arrastra y suelta tu archivo o haz clic para seleccionar"}),c.jsx("p",{className:"mt-2 text-sm text-brand-text-secondary",children:n?c.jsx("span",{className:"text-brand-primary font-medium break-all",children:n}):"Soporta imgenes y videos. El anlisis se adaptar al formato."})]}),c.jsx("p",{className:"text-xs text-brand-text-secondary mt-4 text-center",children:"Al subir tu creativo, te pediremos que lo asignes a un cliente para un mejor seguimiento y cache de resultados."})]})},UN=[{id:"SQUARE_LIKE",name:"Formatos Cuadrados/Rectangulares",description:"Feeds, Marketplace, Explore...",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"VERTICAL",name:"Formatos Verticales",description:"Stories, Reels...",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}],PN=({onSelectFormat:e})=>c.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-6 shadow-lg animate-fade-in",children:[c.jsx("h2",{className:"text-xl font-semibold text-brand-text mb-6 text-center",children:"Selecciona un grupo de formatos para analizar"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:UN.map(n=>c.jsxs("button",{onClick:()=>e(n.id),className:"group flex flex-col items-center justify-center p-6 bg-brand-border/30 rounded-lg text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-all transform hover:scale-105",children:[c.jsx("div",{className:"text-brand-primary group-hover:text-white transition-colors",children:n.icon}),c.jsx("span",{className:"mt-4 text-lg font-bold text-brand-text group-hover:text-white transition-colors",children:n.name}),c.jsx("span",{className:"mt-1 text-sm",children:n.description})]},n.id))})]}),HN=({language:e,onLanguageChange:n})=>{const a=[{id:"es",name:"Espaol"},{id:"en",name:"English"}];return c.jsxs("div",{className:"flex justify-center items-center gap-2 mb-6",children:[c.jsx("span",{className:"text-sm text-brand-text-secondary",children:e==="es"?"Idioma del Anlisis:":"Analysis Language:"}),c.jsx("div",{className:"flex rounded-lg bg-brand-border p-1",children:a.map(s=>c.jsx("button",{onClick:()=>n(s.id),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${e===s.id?"bg-brand-primary text-white":"bg-transparent text-brand-text-secondary hover:bg-brand-surface"}`,children:s.name},s.id))})]})},zN={CRITICAL:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),ACTIONABLE:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),c.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),POSITIVE:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},VN=({safeZone:e})=>c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-500/30 pointer-events-none z-30 rounded-t-md",style:{height:e.top}}),c.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-red-500/30 pointer-events-none z-30 rounded-b-md",style:{height:e.bottom}}),e.left&&c.jsx("div",{className:"absolute top-0 bottom-0 left-0 bg-red-500/30 pointer-events-none z-30",style:{width:e.left}}),e.right&&c.jsx("div",{className:"absolute top-0 bottom-0 right-0 bg-red-500/30 pointer-events-none z-30",style:{width:e.right}})]}),GN=({conclusion:e})=>c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[c.jsx("h2",{className:"text-xl md:text-2xl font-bold text-brand-text mb-4",children:e.headline}),c.jsx("ul",{className:"space-y-3",children:e.checklist.map((n,a)=>c.jsxs("li",{className:"flex items-start gap-3",children:[zN[n.severity],c.jsx("span",{className:"text-brand-text-secondary",children:n.text})]},a))})]}),YN=()=>c.jsxs("div",{className:"animate-pulse flex flex-col gap-8",children:[c.jsx("div",{className:"h-10 bg-brand-border rounded-md w-64"}),c.jsxs("div",{className:"bg-brand-surface rounded-lg p-4 shadow-lg",children:[c.jsx("div",{className:"w-full max-w-lg mx-auto bg-brand-border rounded-md aspect-video"}),c.jsx("div",{className:"h-8 bg-brand-border rounded-md w-48 mx-auto mt-4"})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsx(ff,{analysisResult:null,isLoading:!0}),c.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6 mt-8",children:[c.jsx("div",{className:"h-6 bg-brand-border rounded w-1/3 mb-4"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex gap-3 items-start",children:[c.jsx("div",{className:"w-5 h-5 rounded-full bg-brand-border/50 flex-shrink-0"}),c.jsx("div",{className:"h-4 bg-brand-border rounded w-full"})]}),c.jsxs("div",{className:"flex gap-3 items-start",children:[c.jsx("div",{className:"w-5 h-5 rounded-full bg-brand-border/50 flex-shrink-0"}),c.jsx("div",{className:"h-4 bg-brand-border rounded w-5/6"})]})]})]})]})]}),XN=({creativeSet:e,formatGroup:n,analysisResult:a,isLoading:s,onGoBack:i})=>{const[o,f]=se.useState(!0),d=se.useMemo(()=>kb.find(m=>m.group===n),[n]),x=se.useMemo(()=>e.videoFile?{file:e.videoFile,url:URL.createObjectURL(e.videoFile),type:"video",width:1080,height:1920,format:"vertical",hash:""}:n==="VERTICAL"?e.vertical||e.square:e.square||e.vertical,[e,n]);return s?c.jsx(YN,{}):c.jsxs("div",{className:"animate-fade-in flex flex-col gap-8",children:[c.jsxs("button",{onClick:i,className:"self-start -mb-2 bg-brand-border/50 text-brand-text-secondary hover:bg-brand-border px-4 py-2 rounded-md transition-colors flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Seleccionar otro formato"]}),c.jsxs("div",{className:"bg-brand-surface rounded-lg p-4 shadow-lg",children:[c.jsx("div",{className:"relative w-full max-w-lg mx-auto bg-brand-bg rounded-md",children:x?c.jsxs("div",{className:"relative",children:[x.type==="image"?c.jsx("img",{src:x.url,alt:"Creative Preview",className:"w-full h-auto max-h-[60vh] object-contain rounded-md"}):c.jsx("video",{src:x.url,className:"w-full h-auto max-h-[60vh] object-contain rounded-md",loop:!0,autoPlay:!0,muted:!0,playsInline:!0}),o&&c.jsx(VN,{safeZone:d.safeZone})]}):c.jsx("div",{className:"aspect-video flex items-center justify-center text-brand-text-secondary",children:c.jsx("span",{children:"No creative available"})})}),c.jsxs("div",{className:"mt-4 flex justify-center items-center gap-3",children:[c.jsx("label",{htmlFor:"safe-zone-toggle",className:"text-sm text-brand-text-secondary",children:"Mostrar Zonas Rojas"}),c.jsx("button",{id:"safe-zone-toggle",onClick:()=>f(!o),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${o?"bg-brand-primary":"bg-brand-border"}`,"aria-pressed":o,children:c.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${o?"translate-x-6":"translate-x-1"}`})})]})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsx(ff,{analysisResult:a,isLoading:s}),a&&c.jsx(GN,{conclusion:a.overallConclusion})]})]})},qN=(e,n)=>new Promise((a,s)=>{const i=e.type.startsWith("image/")?"image":"video",o=(d,x,m)=>{const p=d/x,v={file:e,url:URL.createObjectURL(e),type:i,width:d,height:x,format:p>=1?"square":"vertical",hash:m};a(v)},f=async d=>{const x=await d.arrayBuffer(),m=await crypto.subtle.digest("SHA-256",x);return Array.from(new Uint8Array(m)).map(p=>p.toString(16).padStart(2,"0")).join("")};if(i==="image"){const d=new Image;d.onload=async()=>{const x=await f(e);o(d.naturalWidth,d.naturalHeight,x),URL.revokeObjectURL(n)},d.onerror=x=>{URL.revokeObjectURL(n),s(x)},d.src=n}else{const d=document.createElement("video");d.onloadedmetadata=async()=>{const x=await f(e);o(d.videoWidth,d.videoHeight,x),URL.revokeObjectURL(n)},d.onerror=x=>{URL.revokeObjectURL(n),s(x)},d.src=n}}),KN=({clients:e,getFormatAnalysis:n})=>{const[a,s]=se.useState("upload"),[i,o]=se.useState(null),[f,d]=se.useState(!1),[x,m]=se.useState(null),[p,v]=se.useState("es"),[b,y]=se.useState(null),[E,_]=se.useState(null),[w,S]=se.useState(!1),D=()=>{s("upload"),o(null),d(!1),m(null),y(null),_(null),S(!1),et.info("Creative analysis flow reset.")},A=async j=>{et.info("File uploaded for analysis",{name:j.name,type:j.type});const Q=URL.createObjectURL(j);try{const B=await qN(j,Q),K=B.type==="video"?{square:null,vertical:null,videoFile:j}:{square:B.format==="square"?B:null,vertical:B.format==="vertical"?B:null,videoFile:null};o(K),e.length>0?d(!0):alert("No hay clientes creados. Por favor, crea un cliente en la pestaa 'Clientes' antes de continuar.")}catch(B){et.error("Error processing uploaded file",B),alert("Hubo un error al procesar el archivo. Asegrate de que es un formato de imagen o video vlido."),D()}},z=j=>{const Q=e.find(B=>B.id===j);Q&&(m(Q),d(!1),s("select_format"),et.info("Client selected for analysis",{clientName:Q.name}))},V=async j=>{if(!i||!x)return;y(j),s("analyzing"),S(!0),et.info("Format selected, starting AI analysis...",{formatGroup:j,clientName:x.name});const Q=`Anlisis del creativo para el cliente "${x.name}".`,B=!!i.videoFile,ne=await n(i,j,p,Q,B);_(ne),S(!1),s("results"),et.success("AI analysis complete.")},Y=()=>{switch(a){case"upload":return c.jsx("div",{className:"max-w-4xl mx-auto",children:c.jsx(BN,{onFileUpload:A})});case"select_format":return c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsx(HN,{language:p,onLanguageChange:v}),c.jsx(PN,{onSelectFormat:V})]});case"analyzing":case"results":return i&&b?c.jsx(XN,{creativeSet:i,formatGroup:b,analysisResult:E,isLoading:w,onGoBack:D}):null;default:return null}};return c.jsxs("div",{className:"animate-fade-in",children:[c.jsxs("header",{className:"text-center mb-10",children:[c.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Anlisis de Creativos con IA"}),c.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Sube tu imagen o video para recibir un anlisis instantneo y recomendaciones de mejora."})]}),Y(),c.jsx($u,{isOpen:f,onClose:()=>D(),clients:e,onClientSelect:z,title:"Asignar Creativo a Cliente",description:"Selecciona a qu cliente pertenece este creativo. Esto ayuda a la IA a usar el contexto adecuado."})]})};class WN{constructor(){this.dbName="Ver6Database",this.version=1,this.db=null}async initialize(){return new Promise((n,a)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>a(s.error),s.onsuccess=()=>{this.db=s.result,n()},s.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains("clients")||o.createObjectStore("clients",{keyPath:"id"}),o.objectStoreNames.contains("performance_data")||o.createObjectStore("performance_data",{keyPath:"client_id"}),o.objectStoreNames.contains("looker_data")||o.createObjectStore("looker_data",{keyPath:"client_id"}),o.objectStoreNames.contains("import_history")||o.createObjectStore("import_history",{keyPath:"id"}),o.objectStoreNames.contains("processed_hashes")||o.createObjectStore("processed_hashes",{keyPath:"client_id"}),o.objectStoreNames.contains("config")||o.createObjectStore("config",{keyPath:"key"}),o.objectStoreNames.contains("generic_data")||o.createObjectStore("generic_data")}})}async saveData(n,a,s){if(!this.db)throw new Error("Database not initialized");return new Promise((i,o)=>{const d=this.db.transaction([n],"readwrite").objectStore(n),x=s?d.put({id:s,data:a}):d.put(a);x.onerror=()=>o(x.error),x.onsuccess=()=>i()})}async getData(n,a){if(!this.db)throw new Error("Database not initialized");return new Promise((s,i)=>{const f=this.db.transaction([n],"readonly").objectStore(n),d=a?f.get(a):f.getAll();d.onerror=()=>i(d.error),d.onsuccess=()=>{const x=d.result;s(a&&x?x.data:x||null)}})}async clearStore(n){if(!this.db)throw new Error("Database not initialized");return new Promise((a,s)=>{const f=this.db.transaction([n],"readwrite").objectStore(n).clear();f.onerror=()=>s(f.error),f.onsuccess=()=>a()})}async deleteData(n,a){if(!this.db)throw new Error("Database not initialized");return new Promise((s,i)=>{const d=this.db.transaction([n],"readwrite").objectStore(n).delete(a);d.onerror=()=>i(d.error),d.onsuccess=()=>s()})}async saveClients(n){await this.saveData("clients",n,"all")}async getClients(){return await this.getData("clients","all")||[]}async savePerformanceData(n){for(const[a,s]of Object.entries(n))await this.saveData("performance_data",s,a)}async getPerformanceData(){const n=await this.getData("performance_data"),a={};if(Array.isArray(n))for(const s of n)s.id&&s.data&&(a[s.id]=s.data);return a}async cleanOldData(){console.log("[IndexedDB] Cleaning old data...")}}const Cl=new WN;async function $N(){console.log("[MIGRATION] Starting migration from localStorage to IndexedDB...");try{await Cl.initialize();const e=localStorage.getItem("db_clients");if(e){const a=JSON.parse(e);await Cl.saveClients(a),console.log("[MIGRATION] Migrated clients")}const n=localStorage.getItem("db_performance_data");if(n){const a=JSON.parse(n);await Cl.savePerformanceData(a),console.log("[MIGRATION] Migrated performance data")}return console.log("[MIGRATION] Migration completed successfully"),!0}catch(e){return console.error("[MIGRATION] Error during migration:",e),!1}}const ZN=({isOpen:e,onClose:n,clients:a,performanceData:s,lookerData:i,importHistory:o})=>{const[f,d]=se.useState({}),[x,m]=se.useState({}),[p,v]=se.useState({used:"0",quota:"0",items:0}),b=se.useCallback(async()=>{if(!e)return;const w={};for(let S=0;S<localStorage.length;S++){const D=localStorage.key(S);if(D&&D.startsWith("db_"))try{const A=localStorage.getItem(D);if(A){const z=JSON.parse(A);w[D]={size:new Blob([A]).size,type:Array.isArray(z)?"array":typeof z,length:Array.isArray(z)?z.length:Object.keys(z||{}).length}}}catch{w[D]={size:0,type:"error",length:0,error:"Error parsing data"}}}d(w);try{const S=await Xe.getProcessedHashes();m(S);const D=Xe.getLocalStorageUsage();v(D)}catch(S){console.error("Error loading diagnostic data:",S)}},[e]);if(se.useEffect(()=>{b()},[b]),!e)return null;const y=w=>{if(w===0)return"0 Bytes";const S=1024,D=["Bytes","KB","MB","GB"],A=Math.floor(Math.log(w)/Math.log(S));return parseFloat((w/Math.pow(S,A)).toFixed(2))+" "+D[A]},E=Object.values(s).flat().length,_=Object.values(i).reduce((w,S)=>w+Object.keys(S).length,0);return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-brand-surface rounded-xl border border-brand-border max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-brand-border",children:[c.jsx("h2",{className:"text-xl font-bold text-brand-text",children:"Diagnstico de Datos"}),c.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Resumen General"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-brand-primary",children:a.length}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Clientes"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-green-400",children:E}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Registros Performance"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-400",children:_}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Creativos Looker"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-orange-400",children:o.length}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Importaciones"})]})]})]}),c.jsxs("div",{className:`rounded-lg p-4 border-2 ${parseFloat(p.used)>4?"bg-red-500/10 border-red-500/30":parseFloat(p.used)>2?"bg-yellow-500/10 border-yellow-500/30":"bg-green-500/10 border-green-500/30"}`,children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Uso del Almacenamiento Local"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-2xl font-bold ${parseFloat(p.used)>4?"text-red-400":parseFloat(p.used)>2?"text-yellow-400":"text-green-400"}`,children:[p.used,"MB"]}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Usado"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[p.quota,"MB"]}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Lmite Estimado"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-400",children:p.items}),c.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Items Totales"})]})]}),parseFloat(p.used)>4&&c.jsx("div",{className:"mt-3 p-2 bg-red-500/20 rounded text-sm text-red-400",children:" Almacenamiento casi lleno. Esto puede causar errores al importar datos."}),parseFloat(p.used)>2&&parseFloat(p.used)<=4&&c.jsx("div",{className:"mt-3 p-2 bg-yellow-500/20 rounded text-sm text-yellow-400",children:" Almacenamiento con uso elevado. Considere limpiar datos antiguos."})]}),c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Datos por Cliente"}),a.length===0?c.jsx("p",{className:"text-brand-text-secondary",children:"No hay clientes configurados"}):c.jsx("div",{className:"space-y-2",children:a.map(w=>{var z,V;const S=((z=s[w.id])==null?void 0:z.length)||0,D=Object.keys(i[w.id]||{}).length,A=((V=x[w.id])==null?void 0:V.length)||0;return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-brand-surface rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("img",{src:w.logo,alt:w.name,className:"w-8 h-8 rounded-full"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-brand-text",children:w.name}),c.jsxs("div",{className:"text-xs text-brand-text-secondary",children:["Meta: ",w.metaAccountName||"No configurado"]})]})]}),c.jsxs("div",{className:"flex gap-4 text-sm",children:[c.jsxs("span",{className:"text-green-400",children:[S," perf"]}),c.jsxs("span",{className:"text-purple-400",children:[D," ads"]}),c.jsxs("span",{className:"text-orange-400",children:[A," files"]})]})]},w.id)})})]}),c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Historial de Importaciones"}),o.length===0?c.jsx("p",{className:"text-brand-text-secondary",children:"No hay importaciones registradas"}):c.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:o.slice(0,10).map(w=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-brand-surface rounded",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-brand-text",children:w.fileName}),c.jsxs("div",{className:"text-xs text-brand-text-secondary",children:[w.clientName," - ",w.description]})]}),c.jsx("div",{className:"text-xs text-brand-text-secondary",children:new Date(w.timestamp).toLocaleDateString()})]},w.id))})]}),c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Almacenamiento Local"}),c.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([w,S])=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-brand-surface rounded",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-brand-text",children:w.replace("db_","")}),c.jsx("div",{className:"text-xs text-brand-text-secondary",children:S.error?S.error:`${S.type} - ${S.length} items`})]}),c.jsx("div",{className:"text-xs text-brand-text-secondary",children:y(S.size)})]},w))})]}),c.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:" Archivos Procesados (Hashes)"}),Object.keys(x).length===0?c.jsx("p",{className:"text-brand-text-secondary",children:"No hay archivos procesados registrados"}):c.jsx("div",{className:"space-y-2",children:Object.entries(x).map(([w,S])=>{const D=a.find(A=>A.id===w);return c.jsxs("div",{className:"p-2 bg-brand-surface rounded",children:[c.jsx("div",{className:"text-sm font-medium text-brand-text mb-1",children:(D==null?void 0:D.name)||"Cliente desconocido"}),c.jsxs("div",{className:"text-xs text-brand-text-secondary",children:[S.length," archivos procesados"]}),S.length>0&&c.jsxs("div",{className:"mt-1 text-xs text-brand-text-secondary break-all",children:["ltimo: ",S[S.length-1].substring(0,16),"..."]})]},w)})})]}),c.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-3",children:" Acciones de Limpieza"}),c.jsx("p",{className:"text-sm text-brand-text-secondary mb-3",children:"Si los datos no se estn mostrando correctamente o el almacenamiento est lleno, puedes usar estas acciones:"}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx("button",{onClick:async()=>{if(confirm("Migrar a IndexedDB? Esto mover los datos a un sistema de base de datos ms robusto que maneja archivos grandes mejor que localStorage."))try{await $N()?(alert("Migracin completada exitosamente. Los datos ahora estn en IndexedDB."),await b()):alert("Error durante la migracin. Ver consola para detalles.")}catch(w){console.error("Migration error:",w),alert("Error durante la migracin.")}},className:"px-3 py-1 bg-purple-500/20 text-purple-400 rounded text-sm hover:bg-purple-500/30",children:"Migrar a IndexedDB"}),c.jsx("button",{onClick:async()=>{if(confirm("Limpiar datos antiguos? Esto eliminar importaciones e historial viejo para liberar espacio."))try{await Xe.clearOldData(),await b(),alert("Datos antiguos limpiados correctamente.")}catch(w){console.error("Error cleaning old data:",w),alert("Error al limpiar datos antiguos.")}},className:"px-3 py-1 bg-orange-500/20 text-orange-400 rounded text-sm hover:bg-orange-500/30",children:"Limpiar Datos Antiguos"}),c.jsx("button",{onClick:async()=>{if(confirm("Limpiar solo el historial de archivos procesados? Esto permitir reimportar archivos."))try{await Xe.saveProcessedHashes({}),await b(),alert("Hashes de archivos limpiados correctamente.")}catch(w){console.error("Error clearing hashes:",w),alert("Error al limpiar hashes.")}},className:"px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm hover:bg-yellow-500/30",children:"Limpiar Hashes"}),c.jsx("button",{onClick:async()=>{const w=localStorage.getItem("db_performance_data");if(w)try{const S=JSON.parse(w);console.log("[DEBUG] Performance data in localStorage:",S);const D=Object.values(S).flat().length;alert(`LocalStorage contiene ${D} registros de performance para ${Object.keys(S).length} clientes.

Ver consola para detalles.`)}catch{alert("Error al parsear datos de performance en localStorage")}else alert("No hay datos de performance en localStorage")},className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm hover:bg-blue-500/30",children:"Debug Performance Data"}),c.jsx("button",{onClick:async()=>{console.log("=== INICIANDO TEST COMPLETO ===");const w=localStorage.getItem("db_performance_data");console.log("1. LocalStorage performance_data:",w?JSON.parse(w):"null");const S=Object.values(s).flat().length;console.log("2. Estado actual de la app:",{clientsWithData:Object.keys(s),totalRecords:S,performanceData:s});try{const D=await Xe.getPerformanceData(),A=Object.values(D).flat().length;console.log("3. Datos cargados desde DB:",{clientsWithData:Object.keys(D),totalRecords:A,loadedData:D});const z={localStorageHasData:!!w,appStateHasData:S>0,dbFunctionReturnsData:A>0,dataMatches:JSON.stringify(s)===JSON.stringify(D)};console.log("4. Comparacin:",z),alert(`Test completo ejecutado. Ver consola para detalles.

Resumen:
- LocalStorage: ${z.localStorageHasData?"S":"NO"} tiene datos
- App State: ${z.appStateHasData?"S":"NO"} tiene datos
- DB Function: ${z.dbFunctionReturnsData?"S":"NO"} retorna datos
- Datos coinciden: ${z.dataMatches?"S":"NO"}`)}catch(D){console.error("Error en test:",D),alert("Error durante el test. Ver consola.")}console.log("=== FIN TEST COMPLETO ===")},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30",children:"Test Completo"}),c.jsx("button",{onClick:()=>{confirm("Recargar la pgina? Esto reiniciar el estado de la aplicacin.")&&window.location.reload()},className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm hover:bg-blue-500/30",children:"Recargar Pgina"}),c.jsx("button",{onClick:async()=>{try{xi.connected?(et.info("La tabla de rendimiento ya est ONLINE."),alert("La tabla de rendimiento ya est ONLINE.")):(await Cl.initialize(),await Cl.savePerformanceData({}),localStorage.setItem("db_performance_data_storage","indexeddb"),xi.connected=!0,et.success("Tabla de rendimiento creada y marcada como ONLINE."),console.log("[DIAGNOSTICS] Tabla de rendimiento creada y ONLINE."),alert("Tabla de rendimiento creada correctamente y ONLINE."),await b())}catch(w){et.error("Error creando la tabla de rendimiento.",{error:w}),console.error("[DIAGNOSTICS] Error creando la tabla de rendimiento:",w),alert("Error creando la tabla de rendimiento. Ver consola y log.")}},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30",children:"Crear tabla de rendimiento"})]})]})]})]})})},Cp=async(e,n,a,s,i)=>{const o=a==="es";return{creativeDescription:o?"Error: API Key no configurada.":"Error: API Key not set.",effectivenessScore:0,effectivenessJustification:o?"API Key no configurada.":"API Key not set.",clarityScore:0,clarityJustification:o?"API Key no configurada.":"API Key not set.",textToImageRatio:0,textToImageRatioJustification:o?"API Key no configurada.":"API Key not set.",funnelStage:"N/A",funnelStageJustification:o?"API Key no configurada.":"API Key not set.",recommendations:[],advantagePlusAnalysis:[],placementSummaries:[],overallConclusion:{headline:o?"Error de Configuracin":"Configuration Error",checklist:[{severity:"CRITICAL",text:o?"La API Key de Gemini no est configurada. Por favor, asegrate de que la variable de entorno API_KEY est disponible.":"The Gemini API Key is not configured. Please ensure the API_KEY environment variable is available."}]}}},QN=()=>{const[e,n]=se.useState(!1),[a,s]=se.useState(null),[i,o]=se.useState("creative_analysis"),[f,d]=se.useState(!0),[x,m]=se.useState(!1),[p,v]=se.useState([]),[b,y]=se.useState([]),[E,_]=se.useState({}),[w,S]=se.useState(null),[D,A]=se.useState([]),[z,V]=se.useState([]),[Y,j]=se.useState([]),[Q,B]=se.useState({}),ne=new Date,K=new Date(ne);K.setDate(ne.getDate()-7);const[X,ee]=se.useState(K.toISOString().split("T")[0]),[he,_e]=se.useState(ne.toISOString().split("T")[0]);se.useEffect(()=>{(async()=>{et.info("Application initializing..."),d(!0);try{await Xe.connect();const[R,W,pe,ve,Se,we,Be,I,Pe]=await Promise.all([Xe.getUsers(),Xe.getClients(),Xe.getLookerData(),Xe.getLoggedInUser(),Xe.getMetaApiConfig(),Xe.getBitacoraReports(),Xe.getUploadedVideos(),Xe.getImportHistory(),Xe.getPerformanceData()]);if(R.length===0){et.warn("No users found in DB. Creating default Admin user."),console.log("=== CREATING DEFAULT USER ===");const We={id:crypto.randomUUID(),username:"Admin",password:"Admin",role:"admin"};console.log("Default admin user:",We),v([We]),await Xe.saveUsers([We]),console.log("Default user saved to database")}else console.log("=== LOADED USERS FROM DB ==="),console.log("Loaded users:",R),v(R);y(W),_(pe),S(Se),A(we),V(Be),j(I),B(Pe);const Ue=Object.values(Pe).flat().length;if(et.success(`Loaded ${R.length} users, ${W.length} clients, ${Ue} performance records, and data for ${Object.keys(pe).length} accounts.`),Ue>0){et.info(`Performance data loaded for clients: ${Object.keys(Pe).join(", ")}`);for(const[We,Ve]of Object.entries(Pe))et.info(`Client ${We}: ${Ve.length} performance records`)}else et.warn("No performance data loaded from database!");ve&&(R.length>0?R:[{id:crypto.randomUUID(),username:"Admin",password:"Admin",role:"admin"}]).some(We=>We.id===ve.id)&&(et.info(`Found logged in user: ${ve.username}`),s(ve),n(!0))}catch(R){const W=R instanceof Error?R.message:"Unknown DB error";et.error("Failed to load data from database.",{error:W}),xi.connected=!1,alert("Error crtico: No se pudieron cargar los datos de la base de datos.")}finally{d(!1)}})()},[]),se.useEffect(()=>{p.length>0&&(Xe.saveUsers(p),et.info(`[PERSISTENCE] Saved ${p.length} users to DB`))},[p]),se.useEffect(()=>{Xe.saveClients(b),et.info(`[PERSISTENCE] Saved ${b.length} clients to DB`)},[b]),se.useEffect(()=>{Xe.saveLookerData(E),et.info(`[PERSISTENCE] Saved Looker data for ${Object.keys(E).length} clients to DB`)},[E]),se.useEffect(()=>{w&&Xe.saveMetaApiConfig(w)},[w]),se.useEffect(()=>{Xe.saveBitacoraReports(D),et.info(`[PERSISTENCE] Saved ${D.length} bitcora reports to DB`)},[D]),se.useEffect(()=>{Xe.saveUploadedVideos(z),et.info(`[PERSISTENCE] Saved ${z.length} uploaded videos to DB`)},[z]),se.useEffect(()=>{Xe.saveImportHistory(Y),et.info(`[PERSISTENCE] Saved ${Y.length} import history records to DB`)},[Y]),se.useEffect(()=>{const U=Object.values(Q).flat().length;U>0||Object.keys(Q).length>0?Xe.savePerformanceData(Q).then(()=>{et.info(`[PERSISTENCE] Successfully saved ${U} performance records for ${Object.keys(Q).length} clients to DB`);const R=Object.keys(Q);R.length>0&&et.info(`[PERSISTENCE] Clients with performance data: ${R.join(", ")}`)}).catch(R=>{et.error("[PERSISTENCE] Failed to save performance data:",R)}):et.warn(`[PERSISTENCE] No performance data to save (${U} records, ${Object.keys(Q).length} clients)`)},[Q]);const Z=se.useMemo(()=>(a==null?void 0:a.role)==="admin"?b:a?b.filter(U=>U.userId===a.id):[],[b,a]),ue=se.useCallback(async(U,R)=>"Error: API Key de Gemini no configurada.",[]),Re=se.useCallback(async(U,R,W,pe)=>({trends:[]}),[]),te=se.useCallback(async U=>{throw new Error("API Key de Gemini no configurada")},[]),H=async U=>{if(!w){alert("La configuracin de la API de Meta no est definida.");return}const R=b.find(W=>W.id===U);if(!R||!R.metaAccountName){alert("El cliente seleccionado no tiene un 'Nombre de Cuenta de Meta' configurado.");return}d(!0);try{const W=await IN(w,R.metaAccountName),pe=await cf(W,b,Q,"meta",!1);if(!Array.isArray(pe))throw new Error("La respuesta del procesador de datos no es vlida.");if(pe.length===0){alert("Sincronizacin completada. No se encontraron nuevos registros."),et.info(`Synced from Meta API for client ${R.name}. No new records.`),d(!1);return}let ve=0;for(const Se of pe){const{newRecordsCount:we,client:Be,records:I,undoKeys:Pe}=Se;if(Be&&we>0){ve+=we,B(Ve=>({...Ve,[Be.id]:[...Ve[Be.id]||[],...I]}));const Ue={source:"meta",fileName:`API Sync @ ${new Date().toLocaleString()}`,clientName:Be.name,description:`${we} filas sincronizadas desde la API`,undoData:{type:"meta",keys:Pe,clientId:Be.id}},We=await Xe.getImportHistory();await Xe.saveImportHistory([{...Ue,id:crypto.randomUUID(),timestamp:new Date().toISOString(),fileHash:`api_sync_${Date.now()}`},...We]),j(await Xe.getImportHistory())}}alert(`Sincronizacin completada. Se aadieron ${ve} nuevos registros.`),ve>0&&et.success(`Synced from Meta API. Added ${ve} records.`)}catch(W){const pe=W instanceof Error?W.message:"Error desconocido";alert(`Error durante la sincronizacin: ${pe}`),et.error("Meta API sync failed",W)}finally{d(!1)}},oe=(U,R)=>{console.log("=== HANDLE LOGIN DEBUG ==="),console.log("Available users:",p),console.log("Searching for user:",{username:U,pass:R});const W=p.find(pe=>pe.username===U&&pe.password===R);return console.log("Found user:",W),W?(et.success(`User login successful: ${U}`),s(W),n(!0),Xe.saveLoggedInUser(W),!0):(et.warn(`User login failed for username: ${U}`),console.log("Login failed - no matching user found"),!1)},k=()=>{et.info(`User logout: ${a==null?void 0:a.username}`),n(!1),s(null),Xe.saveLoggedInUser(null),o("creative_analysis")},q=()=>f?c.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-brand-bg via-brand-bg to-slate-900 flex items-center justify-center z-50",children:c.jsxs("div",{className:"flex flex-col items-center gap-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-brand-primary/30 rounded-full animate-pulse"}),c.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-transparent border-t-brand-primary rounded-full animate-spin"})]}),c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx("p",{className:"text-xl font-bold text-brand-text animate-pulse",children:"Creative Assistant"}),c.jsx("p",{className:"text-sm text-brand-text-secondary",children:"Inicializando sistema de anlisis IA..."})]}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),c.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),c.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-bg via-slate-900 to-brand-bg text-brand-text relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-5",children:c.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                                         radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.3) 0%, transparent 50%)`}})}),c.jsx("div",{className:"absolute top-10 left-10 w-32 h-32 bg-brand-primary/10 rounded-full blur-3xl animate-pulse"}),c.jsx("div",{className:"absolute bottom-10 right-10 w-40 h-40 bg-brand-accent/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("div",{className:"animate-slide-down",children:c.jsx(Db,{currentView:i,onNavigate:o,currentUser:a,onLogout:k,onOpenDiagnostics:()=>m(!0)})}),c.jsxs("main",{className:"animate-fade-in pt-24 lg:pt-20 px-4 sm:px-6 lg:px-8 pb-8",children:[i==="creative_analysis"&&c.jsx(KN,{clients:Z,getFormatAnalysis:Cp}),i==="performance"&&c.jsx(ny,{clients:Z,getPerformanceAnalysis:ue,getFormatAnalysis:Cp,lookerData:E,setLookerData:_,performanceData:Q,uploadedVideos:z,setUploadedVideos:V,startDate:X,endDate:he,onDateChange:(U,R)=>{ee(U),_e(R)}}),i==="strategies"&&c.jsx(wN,{clients:Z,lookerData:E,getTrendsAnalysis:Re,performanceData:Q,startDate:X,endDate:he,onDateChange:(U,R)=>{ee(U),_e(R)}}),i==="strategic_analysis"&&c.jsx(kN,{clients:Z,lookerData:E,performanceData:Q,getStrategicAnalysis:te,startDate:X,endDate:he,onDateChange:(U,R)=>{ee(U),_e(R)}}),i==="reports"&&c.jsx(CN,{clients:Z,lookerData:E,bitacoraReports:D}),i==="settings"&&c.jsx(Rb,{metaApiConfig:w,setMetaApiConfig:S}),i==="control_panel"&&(a==null?void 0:a.role)==="admin"&&c.jsx(Mb,{}),i==="clients"&&c.jsx(Bb,{clients:b,setClients:y,currentUser:a}),i==="import"&&(a==null?void 0:a.role)==="admin"&&c.jsx(pN,{clients:b,setClients:y,lookerData:E,setLookerData:_,performanceData:Q,setPerformanceData:B,bitacoraReports:D,setBitacoraReports:A,onSyncFromMeta:H,metaApiConfig:w,currentUser:a}),i==="users"&&(a==null?void 0:a.role)==="admin"&&c.jsx(ly,{users:p,setUsers:v,currentUser:a}),i==="help"&&c.jsx(gN,{}),i==="logs"&&(a==null?void 0:a.role)==="admin"&&c.jsx(bN,{})]})]}),c.jsx(ZN,{isOpen:x,onClose:()=>m(!1),clients:b,performanceData:Q,lookerData:E,importHistory:Y})]});return e?q():c.jsx(sy,{onLogin:oe})},f2=document.getElementById("root");if(!f2)throw new Error("Could not find root element to mount to");const JN=Cb.createRoot(f2);JN.render(c.jsx(yb.StrictMode,{children:c.jsx(QN,{})}));
