(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function Np(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Cu={exports:{}},ul={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx;function mb(){if(mx)return ul;mx=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(s,i,o){var d=null;if(o!==void 0&&(d=""+o),i.key!==void 0&&(d=""+i.key),"key"in i){o={};for(var f in i)f!=="key"&&(o[f]=i[f])}else o=i;return i=o.ref,{$$typeof:e,type:s,key:d,ref:i!==void 0?i:null,props:o}}return ul.Fragment=n,ul.jsx=t,ul.jsxs=t,ul}var px;function pb(){return px||(px=1,Cu.exports=mb()),Cu.exports}var u=pb(),Ou={exports:{}},ia={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function gb(){if(gx)return ia;gx=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function b(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,E={};function T(P,ce,C){this.props=P,this.context=ce,this.refs=E,this.updater=C||_}T.prototype.isReactComponent={},T.prototype.setState=function(P,ce){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ce,"setState")},T.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function A(){}A.prototype=T.prototype;function D(P,ce,C){this.props=P,this.context=ce,this.refs=E,this.updater=C||_}var S=D.prototype=new A;S.constructor=D,y(S,T.prototype),S.isPureReactComponent=!0;var H=Array.isArray,V={H:null,A:null,T:null,S:null,V:null},Y=Object.prototype.hasOwnProperty;function j(P,ce,C,X,U,R){return C=R.ref,{$$typeof:e,type:P,key:ce,ref:C!==void 0?C:null,props:R}}function J(P,ce){return j(P.type,ce,void 0,void 0,void 0,P.props)}function z(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function ie(P){var ce={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(C){return ce[C]})}var K=/\/+/g;function q(P,ce){return typeof P=="object"&&P!==null&&P.key!=null?ie(""+P.key):ce.toString(36)}function re(){}function pe(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(re,re):(P.status="pending",P.then(function(ce){P.status==="pending"&&(P.status="fulfilled",P.value=ce)},function(ce){P.status==="pending"&&(P.status="rejected",P.reason=ce)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function Ae(P,ce,C,X,U){var R=typeof P;(R==="undefined"||R==="boolean")&&(P=null);var W=!1;if(P===null)W=!0;else switch(R){case"bigint":case"string":case"number":W=!0;break;case"object":switch(P.$$typeof){case e:case n:W=!0;break;case g:return W=P._init,Ae(W(P._payload),ce,C,X,U)}}if(W)return U=U(P),W=X===""?"."+q(P,0):X,H(U)?(C="",W!=null&&(C=W.replace(K,"$&/")+"/"),Ae(U,ce,C,"",function(Te){return Te})):U!=null&&(z(U)&&(U=J(U,C+(U.key==null||P&&P.key===U.key?"":(""+U.key).replace(K,"$&/")+"/")+W)),ce.push(U)),1;W=0;var me=X===""?".":X+":";if(H(P))for(var ve=0;ve<P.length;ve++)X=P[ve],R=me+q(X,ve),W+=Ae(X,ce,C,R,U);else if(ve=b(P),typeof ve=="function")for(P=ve.call(P),ve=0;!(X=P.next()).done;)X=X.value,R=me+q(X,ve++),W+=Ae(X,ce,C,R,U);else if(R==="object"){if(typeof P.then=="function")return Ae(pe(P),ce,C,X,U);throw ce=String(P),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return W}function Z(P,ce,C){if(P==null)return P;var X=[],U=0;return Ae(P,X,"","",function(R){return ce.call(C,R,U++)}),X}function oe(P){if(P._status===-1){var ce=P._result;ce=ce(),ce.then(function(C){(P._status===0||P._status===-1)&&(P._status=1,P._result=C)},function(C){(P._status===0||P._status===-1)&&(P._status=2,P._result=C)}),P._status===-1&&(P._status=0,P._result=ce)}if(P._status===1)return P._result.default;throw P._result}var Re=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function ee(){}return ia.Children={map:Z,forEach:function(P,ce,C){Z(P,function(){ce.apply(this,arguments)},C)},count:function(P){var ce=0;return Z(P,function(){ce++}),ce},toArray:function(P){return Z(P,function(ce){return ce})||[]},only:function(P){if(!z(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},ia.Component=T,ia.Fragment=t,ia.Profiler=i,ia.PureComponent=D,ia.StrictMode=s,ia.Suspense=x,ia.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,ia.__COMPILER_RUNTIME={__proto__:null,c:function(P){return V.H.useMemoCache(P)}},ia.cache=function(P){return function(){return P.apply(null,arguments)}},ia.cloneElement=function(P,ce,C){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var X=y({},P.props),U=P.key,R=void 0;if(ce!=null)for(W in ce.ref!==void 0&&(R=void 0),ce.key!==void 0&&(U=""+ce.key),ce)!Y.call(ce,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&ce.ref===void 0||(X[W]=ce[W]);var W=arguments.length-2;if(W===1)X.children=C;else if(1<W){for(var me=Array(W),ve=0;ve<W;ve++)me[ve]=arguments[ve+2];X.children=me}return j(P.type,U,void 0,void 0,R,X)},ia.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:o,_context:P},P},ia.createElement=function(P,ce,C){var X,U={},R=null;if(ce!=null)for(X in ce.key!==void 0&&(R=""+ce.key),ce)Y.call(ce,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(U[X]=ce[X]);var W=arguments.length-2;if(W===1)U.children=C;else if(1<W){for(var me=Array(W),ve=0;ve<W;ve++)me[ve]=arguments[ve+2];U.children=me}if(P&&P.defaultProps)for(X in W=P.defaultProps,W)U[X]===void 0&&(U[X]=W[X]);return j(P,R,void 0,void 0,null,U)},ia.createRef=function(){return{current:null}},ia.forwardRef=function(P){return{$$typeof:f,render:P}},ia.isValidElement=z,ia.lazy=function(P){return{$$typeof:g,_payload:{_status:-1,_result:P},_init:oe}},ia.memo=function(P,ce){return{$$typeof:m,type:P,compare:ce===void 0?null:ce}},ia.startTransition=function(P){var ce=V.T,C={};V.T=C;try{var X=P(),U=V.S;U!==null&&U(C,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(ee,Re)}catch(R){Re(R)}finally{V.T=ce}},ia.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},ia.use=function(P){return V.H.use(P)},ia.useActionState=function(P,ce,C){return V.H.useActionState(P,ce,C)},ia.useCallback=function(P,ce){return V.H.useCallback(P,ce)},ia.useContext=function(P){return V.H.useContext(P)},ia.useDebugValue=function(){},ia.useDeferredValue=function(P,ce){return V.H.useDeferredValue(P,ce)},ia.useEffect=function(P,ce,C){var X=V.H;if(typeof C=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(P,ce)},ia.useId=function(){return V.H.useId()},ia.useImperativeHandle=function(P,ce,C){return V.H.useImperativeHandle(P,ce,C)},ia.useInsertionEffect=function(P,ce){return V.H.useInsertionEffect(P,ce)},ia.useLayoutEffect=function(P,ce){return V.H.useLayoutEffect(P,ce)},ia.useMemo=function(P,ce){return V.H.useMemo(P,ce)},ia.useOptimistic=function(P,ce){return V.H.useOptimistic(P,ce)},ia.useReducer=function(P,ce,C){return V.H.useReducer(P,ce,C)},ia.useRef=function(P){return V.H.useRef(P)},ia.useState=function(P){return V.H.useState(P)},ia.useSyncExternalStore=function(P,ce,C){return V.H.useSyncExternalStore(P,ce,C)},ia.useTransition=function(){return V.H.useTransition()},ia.version="19.1.1",ia}var vx;function cf(){return vx||(vx=1,Ou.exports=gb()),Ou.exports}var ue=cf();const vb=Np(ue);var Du={exports:{}},fl={},Ru={exports:{}},ju={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bx;function bb(){return bx||(bx=1,function(e){function n(Z,oe){var Re=Z.length;Z.push(oe);e:for(;0<Re;){var ee=Re-1>>>1,P=Z[ee];if(0<i(P,oe))Z[ee]=oe,Z[Re]=P,Re=ee;else break e}}function t(Z){return Z.length===0?null:Z[0]}function s(Z){if(Z.length===0)return null;var oe=Z[0],Re=Z.pop();if(Re!==oe){Z[0]=Re;e:for(var ee=0,P=Z.length,ce=P>>>1;ee<ce;){var C=2*(ee+1)-1,X=Z[C],U=C+1,R=Z[U];if(0>i(X,Re))U<P&&0>i(R,X)?(Z[ee]=R,Z[U]=Re,ee=U):(Z[ee]=X,Z[C]=Re,ee=C);else if(U<P&&0>i(R,Re))Z[ee]=R,Z[U]=Re,ee=U;else break e}}return oe}function i(Z,oe){var Re=Z.sortIndex-oe.sortIndex;return Re!==0?Re:Z.id-oe.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var d=Date,f=d.now();e.unstable_now=function(){return d.now()-f}}var x=[],m=[],g=1,v=null,b=3,_=!1,y=!1,E=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function H(Z){for(var oe=t(m);oe!==null;){if(oe.callback===null)s(m);else if(oe.startTime<=Z)s(m),oe.sortIndex=oe.expirationTime,n(x,oe);else break;oe=t(m)}}function V(Z){if(E=!1,H(Z),!y)if(t(x)!==null)y=!0,Y||(Y=!0,q());else{var oe=t(m);oe!==null&&Ae(V,oe.startTime-Z)}}var Y=!1,j=-1,J=5,z=-1;function ie(){return T?!0:!(e.unstable_now()-z<J)}function K(){if(T=!1,Y){var Z=e.unstable_now();z=Z;var oe=!0;try{e:{y=!1,E&&(E=!1,D(j),j=-1),_=!0;var Re=b;try{a:{for(H(Z),v=t(x);v!==null&&!(v.expirationTime>Z&&ie());){var ee=v.callback;if(typeof ee=="function"){v.callback=null,b=v.priorityLevel;var P=ee(v.expirationTime<=Z);if(Z=e.unstable_now(),typeof P=="function"){v.callback=P,H(Z),oe=!0;break a}v===t(x)&&s(x),H(Z)}else s(x);v=t(x)}if(v!==null)oe=!0;else{var ce=t(m);ce!==null&&Ae(V,ce.startTime-Z),oe=!1}}break e}finally{v=null,b=Re,_=!1}oe=void 0}}finally{oe?q():Y=!1}}}var q;if(typeof S=="function")q=function(){S(K)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,pe=re.port2;re.port1.onmessage=K,q=function(){pe.postMessage(null)}}else q=function(){A(K,0)};function Ae(Z,oe){j=A(function(){Z(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Z){switch(b){case 1:case 2:case 3:var oe=3;break;default:oe=b}var Re=b;b=oe;try{return Z()}finally{b=Re}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(Z,oe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Re=b;b=Z;try{return oe()}finally{b=Re}},e.unstable_scheduleCallback=function(Z,oe,Re){var ee=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?ee+Re:ee):Re=ee,Z){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=Re+P,Z={id:g++,callback:oe,priorityLevel:Z,startTime:Re,expirationTime:P,sortIndex:-1},Re>ee?(Z.sortIndex=Re,n(m,Z),t(x)===null&&Z===t(m)&&(E?(D(j),j=-1):E=!0,Ae(V,Re-ee))):(Z.sortIndex=P,n(x,Z),y||_||(y=!0,Y||(Y=!0,q()))),Z},e.unstable_shouldYield=ie,e.unstable_wrapCallback=function(Z){var oe=b;return function(){var Re=b;b=oe;try{return Z.apply(this,arguments)}finally{b=Re}}}}(ju)),ju}var yx;function yb(){return yx||(yx=1,Ru.exports=bb()),Ru.exports}var Fu={exports:{}},yt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ex;function Eb(){if(Ex)return yt;Ex=1;var e=cf();function n(x){var m="https://react.dev/errors/"+x;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+x+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(x,m,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:x,containerInfo:m,implementation:g}}var d=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(x,m){if(x==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return yt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,yt.createPortal=function(x,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(n(299));return o(x,m,null,g)},yt.flushSync=function(x){var m=d.T,g=s.p;try{if(d.T=null,s.p=2,x)return x()}finally{d.T=m,s.p=g,s.d.f()}},yt.preconnect=function(x,m){typeof x=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(x,m))},yt.prefetchDNS=function(x){typeof x=="string"&&s.d.D(x)},yt.preinit=function(x,m){if(typeof x=="string"&&m&&typeof m.as=="string"){var g=m.as,v=f(g,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,_=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?s.d.S(x,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:_}):g==="script"&&s.d.X(x,{crossOrigin:v,integrity:b,fetchPriority:_,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},yt.preinitModule=function(x,m){if(typeof x=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=f(m.as,m.crossOrigin);s.d.M(x,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(x)},yt.preload=function(x,m){if(typeof x=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,v=f(g,m.crossOrigin);s.d.L(x,g,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},yt.preloadModule=function(x,m){if(typeof x=="string")if(m){var g=f(m.as,m.crossOrigin);s.d.m(x,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(x)},yt.requestFormReset=function(x){s.d.r(x)},yt.unstable_batchedUpdates=function(x,m){return x(m)},yt.useFormState=function(x,m,g){return d.H.useFormState(x,m,g)},yt.useFormStatus=function(){return d.H.useHostTransitionStatus()},yt.version="19.1.1",yt}var _x;function _b(){if(_x)return Fu.exports;_x=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Fu.exports=Eb(),Fu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tx;function Tb(){if(Tx)return fl;Tx=1;var e=yb(),n=cf(),t=_b();function s(a){var r="https://react.dev/errors/"+a;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var r=a,l=a;if(a.alternate)for(;r.return;)r=r.return;else{a=r;do r=a,(r.flags&4098)!==0&&(l=r.return),a=r.return;while(a)}return r.tag===3?l:null}function d(a){if(a.tag===13){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function f(a){if(o(a)!==a)throw Error(s(188))}function x(a){var r=a.alternate;if(!r){if(r=o(a),r===null)throw Error(s(188));return r!==a?null:a}for(var l=a,c=r;;){var h=l.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){l=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===l)return f(h),a;if(p===c)return f(h),r;p=p.sibling}throw Error(s(188))}if(l.return!==c.return)l=h,c=p;else{for(var w=!1,k=h.child;k;){if(k===l){w=!0,l=h,c=p;break}if(k===c){w=!0,c=h,l=p;break}k=k.sibling}if(!w){for(k=p.child;k;){if(k===l){w=!0,l=p,c=h;break}if(k===c){w=!0,c=p,l=h;break}k=k.sibling}if(!w)throw Error(s(189))}}if(l.alternate!==c)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?a:r}function m(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a;for(a=a.child;a!==null;){if(r=m(a),r!==null)return r;a=a.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),S=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function q(a){return a===null||typeof a!="object"?null:(a=K&&a[K]||a["@@iterator"],typeof a=="function"?a:null)}var re=Symbol.for("react.client.reference");function pe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===re?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case y:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case V:return"Suspense";case Y:return"SuspenseList";case z:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case _:return"Portal";case S:return(a.displayName||"Context")+".Provider";case D:return(a._context.displayName||"Context")+".Consumer";case H:var r=a.render;return a=a.displayName,a||(a=r.displayName||r.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case j:return r=a.displayName||null,r!==null?r:pe(a.type)||"Memo";case J:r=a._payload,a=a._init;try{return pe(a(r))}catch{}}return null}var Ae=Array.isArray,Z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},ee=[],P=-1;function ce(a){return{current:a}}function C(a){0>P||(a.current=ee[P],ee[P]=null,P--)}function X(a,r){P++,ee[P]=a.current,a.current=r}var U=ce(null),R=ce(null),W=ce(null),me=ce(null);function ve(a,r){switch(X(W,r),X(R,a),X(U,null),r.nodeType){case 9:case 11:a=(a=r.documentElement)&&(a=a.namespaceURI)?V1(a):0;break;default:if(a=r.tagName,r=r.namespaceURI)r=V1(r),a=G1(r,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}C(U),X(U,a)}function Te(){C(U),C(R),C(W)}function Ee(a){a.memoizedState!==null&&X(me,a);var r=U.current,l=G1(r,a.type);r!==l&&(X(R,a),X(U,l))}function Be(a){R.current===a&&(C(U),C(R)),me.current===a&&(C(me),sl._currentValue=Re)}var I=Object.prototype.hasOwnProperty,Pe=e.unstable_scheduleCallback,Ue=e.unstable_cancelCallback,We=e.unstable_shouldYield,Ve=e.unstable_requestPaint,ge=e.unstable_now,Ie=e.unstable_getCurrentPriorityLevel,ma=e.unstable_ImmediatePriority,we=e.unstable_UserBlockingPriority,Fe=e.unstable_NormalPriority,la=e.unstable_LowPriority,Ge=e.unstable_IdlePriority,ra=e.log,Na=e.unstable_setDisableYieldValue,ca=null,na=null;function ke(a){if(typeof ra=="function"&&Na(a),na&&typeof na.setStrictMode=="function")try{na.setStrictMode(ca,a)}catch{}}var Qe=Math.clz32?Math.clz32:_a,Oe=Math.log,ze=Math.LN2;function _a(a){return a>>>=0,a===0?32:31-(Oe(a)/ze|0)|0}var ya=256,Pa=4194304;function $t(a){var r=a&42;if(r!==0)return r;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function sn(a,r,l){var c=a.pendingLanes;if(c===0)return 0;var h=0,p=a.suspendedLanes,w=a.pingedLanes;a=a.warmLanes;var k=c&134217727;return k!==0?(c=k&~p,c!==0?h=$t(c):(w&=k,w!==0?h=$t(w):l||(l=k&~a,l!==0&&(h=$t(l))))):(k=c&~p,k!==0?h=$t(k):w!==0?h=$t(w):l||(l=c&~a,l!==0&&(h=$t(l)))),h===0?0:r!==0&&r!==h&&(r&p)===0&&(p=h&-h,l=r&-r,p>=l||p===32&&(l&4194048)!==0)?r:h}function Ir(a,r){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&r)===0}function Es(a,r){switch(a){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pn(){var a=ya;return ya<<=1,(ya&4194048)===0&&(ya=256),a}function Hn(){var a=Pa;return Pa<<=1,(Pa&62914560)===0&&(Pa=4194304),a}function zn(a){for(var r=[],l=0;31>l;l++)r.push(a);return r}function Sr(a,r){a.pendingLanes|=r,r!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ln(a,r,l,c,h,p){var w=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var k=a.entanglements,G=a.expirationTimes,se=a.hiddenUpdates;for(l=w&~l;0<l;){var ye=31-Qe(l),Se=1<<ye;k[ye]=0,G[ye]=-1;var de=se[ye];if(de!==null)for(se[ye]=null,ye=0;ye<de.length;ye++){var xe=de[ye];xe!==null&&(xe.lane&=-536870913)}l&=~Se}c!==0&&_s(a,c,0),p!==0&&h===0&&a.tag!==0&&(a.suspendedLanes|=p&~(w&~r))}function _s(a,r,l){a.pendingLanes|=r,a.suspendedLanes&=~r;var c=31-Qe(r);a.entangledLanes|=r,a.entanglements[c]=a.entanglements[c]|1073741824|l&4194090}function Ts(a,r){var l=a.entangledLanes|=r;for(a=a.entanglements;l;){var c=31-Qe(l),h=1<<c;h&r|a[c]&r&&(a[c]|=r),l&=~h}}function Vn(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ha(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function ws(){var a=oe.p;return a!==0?a:(a=window.event,a===void 0?32:ox(a.type))}function Ss(a,r){var l=oe.p;try{return oe.p=a,r()}finally{oe.p=l}}var dr=Math.random().toString(36).slice(2),Xa="__reactFiber$"+dr,$a="__reactProps$"+dr,hr="__reactContainer$"+dr,Ye="__reactEvents$"+dr,oa="__reactListeners$"+dr,N="__reactHandles$"+dr,L="__reactResources$"+dr,O="__reactMarker$"+dr;function F(a){delete a[Xa],delete a[$a],delete a[Ye],delete a[oa],delete a[N]}function M(a){var r=a[Xa];if(r)return r;for(var l=a.parentNode;l;){if(r=l[hr]||l[Xa]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(a=K1(a);a!==null;){if(l=a[Xa])return l;a=K1(a)}return r}a=l,l=a.parentNode}return null}function B(a){if(a=a[Xa]||a[hr]){var r=a.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return a}return null}function le(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a.stateNode;throw Error(s(33))}function be(a){var r=a[L];return r||(r=a[L]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function te(a){a[O]=!0}var fe=new Set,he={};function Ne(a,r){De(a,r),De(a+"Capture",r)}function De(a,r){for(he[a]=r,a=0;a<r.length;a++)fe.add(r[a])}var Le=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ce={},je={};function ea(a){return I.call(je,a)?!0:I.call(Ce,a)?!1:Le.test(a)?je[a]=!0:(Ce[a]=!0,!1)}function ka(a,r,l){if(ea(r))if(l===null)a.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){a.removeAttribute(r);return}}a.setAttribute(r,""+l)}}function Ca(a,r,l){if(l===null)a.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(r);return}a.setAttribute(r,""+l)}}function Fa(a,r,l,c){if(c===null)a.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(r,l,""+c)}}var Br,cn;function Zt(a){if(Br===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Br=r&&r[1]||"",cn=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Br+a+cn}var xr=!1;function Gn(a,r){if(!a||xr)return"";xr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(xe){var de=xe}Reflect.construct(a,[],Se)}else{try{Se.call()}catch(xe){de=xe}a.call(Se.prototype)}}else{try{throw Error()}catch(xe){de=xe}(Se=a())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(xe){if(xe&&de&&typeof xe.stack=="string")return[xe.stack,de.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),w=p[0],k=p[1];if(w&&k){var G=w.split(`
`),se=k.split(`
`);for(h=c=0;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;for(;h<se.length&&!se[h].includes("DetermineComponentFrameRoot");)h++;if(c===G.length||h===se.length)for(c=G.length-1,h=se.length-1;1<=c&&0<=h&&G[c]!==se[h];)h--;for(;1<=c&&0<=h;c--,h--)if(G[c]!==se[h]){if(c!==1||h!==1)do if(c--,h--,0>h||G[c]!==se[h]){var ye=`
`+G[c].replace(" at new "," at ");return a.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",a.displayName)),ye}while(1<=c&&0<=h);break}}}finally{xr=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?Zt(l):""}function mr(a){switch(a.tag){case 26:case 27:case 5:return Zt(a.type);case 16:return Zt("Lazy");case 13:return Zt("Suspense");case 19:return Zt("SuspenseList");case 0:case 15:return Gn(a.type,!1);case 11:return Gn(a.type.render,!1);case 1:return Gn(a.type,!0);case 31:return Zt("Activity");default:return""}}function If(a){try{var r="";do r+=mr(a),a=a.return;while(a);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Qt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Bf(a){var r=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function u2(a){var r=Bf(a)?"checked":"value",l=Object.getOwnPropertyDescriptor(a.constructor.prototype,r),c=""+a[r];if(!a.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,p=l.set;return Object.defineProperty(a,r,{configurable:!0,get:function(){return h.call(this)},set:function(w){c=""+w,p.call(this,w)}}),Object.defineProperty(a,r,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){a._valueTracker=null,delete a[r]}}}}function Vl(a){a._valueTracker||(a._valueTracker=u2(a))}function Uf(a){if(!a)return!1;var r=a._valueTracker;if(!r)return!0;var l=r.getValue(),c="";return a&&(c=Bf(a)?a.checked?"true":"false":a.value),a=c,a!==l?(r.setValue(a),!0):!1}function Gl(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var f2=/[\n"\\]/g;function Jt(a){return a.replace(f2,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function S0(a,r,l,c,h,p,w,k){a.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?a.type=w:a.removeAttribute("type"),r!=null?w==="number"?(r===0&&a.value===""||a.value!=r)&&(a.value=""+Qt(r)):a.value!==""+Qt(r)&&(a.value=""+Qt(r)):w!=="submit"&&w!=="reset"||a.removeAttribute("value"),r!=null?A0(a,w,Qt(r)):l!=null?A0(a,w,Qt(l)):c!=null&&a.removeAttribute("value"),h==null&&p!=null&&(a.defaultChecked=!!p),h!=null&&(a.checked=h&&typeof h!="function"&&typeof h!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.name=""+Qt(k):a.removeAttribute("name")}function Pf(a,r,l,c,h,p,w,k){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(a.type=p),r!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||r!=null))return;l=l!=null?""+Qt(l):"",r=r!=null?""+Qt(r):l,k||r===a.value||(a.value=r),a.defaultValue=r}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,a.checked=k?a.checked:!!c,a.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.name=w)}function A0(a,r,l){r==="number"&&Gl(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function As(a,r,l,c){if(a=a.options,r){r={};for(var h=0;h<l.length;h++)r["$"+l[h]]=!0;for(l=0;l<a.length;l++)h=r.hasOwnProperty("$"+a[l].value),a[l].selected!==h&&(a[l].selected=h),h&&c&&(a[l].defaultSelected=!0)}else{for(l=""+Qt(l),r=null,h=0;h<a.length;h++){if(a[h].value===l){a[h].selected=!0,c&&(a[h].defaultSelected=!0);return}r!==null||a[h].disabled||(r=a[h])}r!==null&&(r.selected=!0)}}function Hf(a,r,l){if(r!=null&&(r=""+Qt(r),r!==a.value&&(a.value=r),l==null)){a.defaultValue!==r&&(a.defaultValue=r);return}a.defaultValue=l!=null?""+Qt(l):""}function zf(a,r,l,c){if(r==null){if(c!=null){if(l!=null)throw Error(s(92));if(Ae(c)){if(1<c.length)throw Error(s(93));c=c[0]}l=c}l==null&&(l=""),r=l}l=Qt(r),a.defaultValue=l,c=a.textContent,c===l&&c!==""&&c!==null&&(a.value=c)}function Ns(a,r){if(r){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=r;return}}a.textContent=r}var d2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vf(a,r,l){var c=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?a.setProperty(r,""):r==="float"?a.cssFloat="":a[r]="":c?a.setProperty(r,l):typeof l!="number"||l===0||d2.has(r)?r==="float"?a.cssFloat=l:a[r]=(""+l).trim():a[r]=l+"px"}function Gf(a,r,l){if(r!=null&&typeof r!="object")throw Error(s(62));if(a=a.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="");for(var h in r)c=r[h],r.hasOwnProperty(h)&&l[h]!==c&&Vf(a,h,c)}else for(var p in r)r.hasOwnProperty(p)&&Vf(a,p,r[p])}function N0(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var h2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),x2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yl(a){return x2.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var k0=null;function C0(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ks=null,Cs=null;function Yf(a){var r=B(a);if(r&&(a=r.stateNode)){var l=a[$a]||null;e:switch(a=r.stateNode,r.type){case"input":if(S0(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Jt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var c=l[r];if(c!==a&&c.form===a.form){var h=c[$a]||null;if(!h)throw Error(s(90));S0(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<l.length;r++)c=l[r],c.form===a.form&&Uf(c)}break e;case"textarea":Hf(a,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&As(a,!!l.multiple,r,!1)}}}var O0=!1;function Xf(a,r,l){if(O0)return a(r,l);O0=!0;try{var c=a(r);return c}finally{if(O0=!1,(ks!==null||Cs!==null)&&(Oc(),ks&&(r=ks,a=Cs,Cs=ks=null,Yf(r),a)))for(r=0;r<a.length;r++)Yf(a[r])}}function vi(a,r){var l=a.stateNode;if(l===null)return null;var c=l[$a]||null;if(c===null)return null;l=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(a=a.type,c=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!c;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(s(231,r,typeof l));return l}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),D0=!1;if(Ur)try{var bi={};Object.defineProperty(bi,"passive",{get:function(){D0=!0}}),window.addEventListener("test",bi,bi),window.removeEventListener("test",bi,bi)}catch{D0=!1}var on=null,R0=null,Xl=null;function qf(){if(Xl)return Xl;var a,r=R0,l=r.length,c,h="value"in on?on.value:on.textContent,p=h.length;for(a=0;a<l&&r[a]===h[a];a++);var w=l-a;for(c=1;c<=w&&r[l-c]===h[p-c];c++);return Xl=h.slice(a,1<c?1-c:void 0)}function ql(a){var r=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&r===13&&(a=13)):a=r,a===10&&(a=13),32<=a||a===13?a:0}function Kl(){return!0}function Kf(){return!1}function Ft(a){function r(l,c,h,p,w){this._reactName=l,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=w,this.currentTarget=null;for(var k in a)a.hasOwnProperty(k)&&(l=a[k],this[k]=l?l(p):p[k]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Kl:Kf,this.isPropagationStopped=Kf,this}return g(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),r}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wl=Ft(Yn),yi=g({},Yn,{view:0,detail:0}),m2=Ft(yi),j0,F0,Ei,$l=g({},yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:M0,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ei&&(Ei&&a.type==="mousemove"?(j0=a.screenX-Ei.screenX,F0=a.screenY-Ei.screenY):F0=j0=0,Ei=a),j0)},movementY:function(a){return"movementY"in a?a.movementY:F0}}),Wf=Ft($l),p2=g({},$l,{dataTransfer:0}),g2=Ft(p2),v2=g({},yi,{relatedTarget:0}),L0=Ft(v2),b2=g({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),y2=Ft(b2),E2=g({},Yn,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),_2=Ft(E2),T2=g({},Yn,{data:0}),$f=Ft(T2),w2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N2(a){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(a):(a=A2[a])?!!r[a]:!1}function M0(){return N2}var k2=g({},yi,{key:function(a){if(a.key){var r=w2[a.key]||a.key;if(r!=="Unidentified")return r}return a.type==="keypress"?(a=ql(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?S2[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:M0,charCode:function(a){return a.type==="keypress"?ql(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ql(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),C2=Ft(k2),O2=g({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zf=Ft(O2),D2=g({},yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:M0}),R2=Ft(D2),j2=g({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),F2=Ft(j2),L2=g({},$l,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),M2=Ft(L2),I2=g({},Yn,{newState:0,oldState:0}),B2=Ft(I2),U2=[9,13,27,32],I0=Ur&&"CompositionEvent"in window,_i=null;Ur&&"documentMode"in document&&(_i=document.documentMode);var P2=Ur&&"TextEvent"in window&&!_i,Qf=Ur&&(!I0||_i&&8<_i&&11>=_i),Jf=" ",ed=!1;function ad(a,r){switch(a){case"keyup":return U2.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Os=!1;function H2(a,r){switch(a){case"compositionend":return td(r);case"keypress":return r.which!==32?null:(ed=!0,Jf);case"textInput":return a=r.data,a===Jf&&ed?null:a;default:return null}}function z2(a,r){if(Os)return a==="compositionend"||!I0&&ad(a,r)?(a=qf(),Xl=R0=on=null,Os=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Qf&&r.locale!=="ko"?null:r.data;default:return null}}var V2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rd(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r==="input"?!!V2[a.type]:r==="textarea"}function nd(a,r,l,c){ks?Cs?Cs.push(c):Cs=[c]:ks=c,r=Mc(r,"onChange"),0<r.length&&(l=new Wl("onChange","change",null,l,c),a.push({event:l,listeners:r}))}var Ti=null,wi=null;function G2(a){B1(a,0)}function Zl(a){var r=le(a);if(Uf(r))return a}function sd(a,r){if(a==="change")return r}var id=!1;if(Ur){var B0;if(Ur){var U0="oninput"in document;if(!U0){var ld=document.createElement("div");ld.setAttribute("oninput","return;"),U0=typeof ld.oninput=="function"}B0=U0}else B0=!1;id=B0&&(!document.documentMode||9<document.documentMode)}function cd(){Ti&&(Ti.detachEvent("onpropertychange",od),wi=Ti=null)}function od(a){if(a.propertyName==="value"&&Zl(wi)){var r=[];nd(r,wi,a,C0(a)),Xf(G2,r)}}function Y2(a,r,l){a==="focusin"?(cd(),Ti=r,wi=l,Ti.attachEvent("onpropertychange",od)):a==="focusout"&&cd()}function X2(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Zl(wi)}function q2(a,r){if(a==="click")return Zl(r)}function K2(a,r){if(a==="input"||a==="change")return Zl(r)}function W2(a,r){return a===r&&(a!==0||1/a===1/r)||a!==a&&r!==r}var Ut=typeof Object.is=="function"?Object.is:W2;function Si(a,r){if(Ut(a,r))return!0;if(typeof a!="object"||a===null||typeof r!="object"||r===null)return!1;var l=Object.keys(a),c=Object.keys(r);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var h=l[c];if(!I.call(r,h)||!Ut(a[h],r[h]))return!1}return!0}function ud(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function fd(a,r){var l=ud(a);a=0;for(var c;l;){if(l.nodeType===3){if(c=a+l.textContent.length,a<=r&&c>=r)return{node:l,offset:r-a};a=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ud(l)}}function dd(a,r){return a&&r?a===r?!0:a&&a.nodeType===3?!1:r&&r.nodeType===3?dd(a,r.parentNode):"contains"in a?a.contains(r):a.compareDocumentPosition?!!(a.compareDocumentPosition(r)&16):!1:!1}function hd(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var r=Gl(a.document);r instanceof a.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)a=r.contentWindow;else break;r=Gl(a.document)}return r}function P0(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r&&(r==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||r==="textarea"||a.contentEditable==="true")}var $2=Ur&&"documentMode"in document&&11>=document.documentMode,Ds=null,H0=null,Ai=null,z0=!1;function xd(a,r,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;z0||Ds==null||Ds!==Gl(c)||(c=Ds,"selectionStart"in c&&P0(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ai&&Si(Ai,c)||(Ai=c,c=Mc(H0,"onSelect"),0<c.length&&(r=new Wl("onSelect","select",null,r,l),a.push({event:r,listeners:c}),r.target=Ds)))}function Xn(a,r){var l={};return l[a.toLowerCase()]=r.toLowerCase(),l["Webkit"+a]="webkit"+r,l["Moz"+a]="moz"+r,l}var Rs={animationend:Xn("Animation","AnimationEnd"),animationiteration:Xn("Animation","AnimationIteration"),animationstart:Xn("Animation","AnimationStart"),transitionrun:Xn("Transition","TransitionRun"),transitionstart:Xn("Transition","TransitionStart"),transitioncancel:Xn("Transition","TransitionCancel"),transitionend:Xn("Transition","TransitionEnd")},V0={},md={};Ur&&(md=document.createElement("div").style,"AnimationEvent"in window||(delete Rs.animationend.animation,delete Rs.animationiteration.animation,delete Rs.animationstart.animation),"TransitionEvent"in window||delete Rs.transitionend.transition);function qn(a){if(V0[a])return V0[a];if(!Rs[a])return a;var r=Rs[a],l;for(l in r)if(r.hasOwnProperty(l)&&l in md)return V0[a]=r[l];return a}var pd=qn("animationend"),gd=qn("animationiteration"),vd=qn("animationstart"),Z2=qn("transitionrun"),Q2=qn("transitionstart"),J2=qn("transitioncancel"),bd=qn("transitionend"),yd=new Map,G0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");G0.push("scrollEnd");function pr(a,r){yd.set(a,r),Ne(r,[a])}var Ed=new WeakMap;function er(a,r){if(typeof a=="object"&&a!==null){var l=Ed.get(a);return l!==void 0?l:(r={value:a,source:r,stack:If(r)},Ed.set(a,r),r)}return{value:a,source:r,stack:If(r)}}var ar=[],js=0,Y0=0;function Ql(){for(var a=js,r=Y0=js=0;r<a;){var l=ar[r];ar[r++]=null;var c=ar[r];ar[r++]=null;var h=ar[r];ar[r++]=null;var p=ar[r];if(ar[r++]=null,c!==null&&h!==null){var w=c.pending;w===null?h.next=h:(h.next=w.next,w.next=h),c.pending=h}p!==0&&_d(l,h,p)}}function Jl(a,r,l,c){ar[js++]=a,ar[js++]=r,ar[js++]=l,ar[js++]=c,Y0|=c,a.lanes|=c,a=a.alternate,a!==null&&(a.lanes|=c)}function X0(a,r,l,c){return Jl(a,r,l,c),ec(a)}function Fs(a,r){return Jl(a,null,null,r),ec(a)}function _d(a,r,l){a.lanes|=l;var c=a.alternate;c!==null&&(c.lanes|=l);for(var h=!1,p=a.return;p!==null;)p.childLanes|=l,c=p.alternate,c!==null&&(c.childLanes|=l),p.tag===22&&(a=p.stateNode,a===null||a._visibility&1||(h=!0)),a=p,p=p.return;return a.tag===3?(p=a.stateNode,h&&r!==null&&(h=31-Qe(l),a=p.hiddenUpdates,c=a[h],c===null?a[h]=[r]:c.push(r),r.lane=l|536870912),p):null}function ec(a){if(50<Zi)throw Zi=0,Jo=null,Error(s(185));for(var r=a.return;r!==null;)a=r,r=a.return;return a.tag===3?a.stateNode:null}var Ls={};function ev(a,r,l,c){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pt(a,r,l,c){return new ev(a,r,l,c)}function q0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Pr(a,r){var l=a.alternate;return l===null?(l=Pt(a.tag,r,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=r,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,r=a.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function Td(a,r){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=r,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,r=l.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a}function ac(a,r,l,c,h,p){var w=0;if(c=a,typeof a=="function")q0(a)&&(w=1);else if(typeof a=="string")w=tb(a,l,U.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case z:return a=Pt(31,l,r,h),a.elementType=z,a.lanes=p,a;case y:return Kn(l.children,h,p,r);case E:w=8,h|=24;break;case T:return a=Pt(12,l,r,h|2),a.elementType=T,a.lanes=p,a;case V:return a=Pt(13,l,r,h),a.elementType=V,a.lanes=p,a;case Y:return a=Pt(19,l,r,h),a.elementType=Y,a.lanes=p,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case A:case S:w=10;break e;case D:w=9;break e;case H:w=11;break e;case j:w=14;break e;case J:w=16,c=null;break e}w=29,l=Error(s(130,a===null?"null":typeof a,"")),c=null}return r=Pt(w,l,r,h),r.elementType=a,r.type=c,r.lanes=p,r}function Kn(a,r,l,c){return a=Pt(7,a,c,r),a.lanes=l,a}function K0(a,r,l){return a=Pt(6,a,null,r),a.lanes=l,a}function W0(a,r,l){return r=Pt(4,a.children!==null?a.children:[],a.key,r),r.lanes=l,r.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},r}var Ms=[],Is=0,tc=null,rc=0,tr=[],rr=0,Wn=null,Hr=1,zr="";function $n(a,r){Ms[Is++]=rc,Ms[Is++]=tc,tc=a,rc=r}function wd(a,r,l){tr[rr++]=Hr,tr[rr++]=zr,tr[rr++]=Wn,Wn=a;var c=Hr;a=zr;var h=32-Qe(c)-1;c&=~(1<<h),l+=1;var p=32-Qe(r)+h;if(30<p){var w=h-h%5;p=(c&(1<<w)-1).toString(32),c>>=w,h-=w,Hr=1<<32-Qe(r)+h|l<<h|c,zr=p+a}else Hr=1<<p|l<<h|c,zr=a}function $0(a){a.return!==null&&($n(a,1),wd(a,1,0))}function Z0(a){for(;a===tc;)tc=Ms[--Is],Ms[Is]=null,rc=Ms[--Is],Ms[Is]=null;for(;a===Wn;)Wn=tr[--rr],tr[rr]=null,zr=tr[--rr],tr[rr]=null,Hr=tr[--rr],tr[rr]=null}var kt=null,za=null,Ta=!1,Zn=null,Ar=!1,Q0=Error(s(519));function Qn(a){var r=Error(s(418,""));throw Ci(er(r,a)),Q0}function Sd(a){var r=a.stateNode,l=a.type,c=a.memoizedProps;switch(r[Xa]=a,r[$a]=c,l){case"dialog":ha("cancel",r),ha("close",r);break;case"iframe":case"object":case"embed":ha("load",r);break;case"video":case"audio":for(l=0;l<Ji.length;l++)ha(Ji[l],r);break;case"source":ha("error",r);break;case"img":case"image":case"link":ha("error",r),ha("load",r);break;case"details":ha("toggle",r);break;case"input":ha("invalid",r),Pf(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Vl(r);break;case"select":ha("invalid",r);break;case"textarea":ha("invalid",r),zf(r,c.value,c.defaultValue,c.children),Vl(r)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||c.suppressHydrationWarning===!0||z1(r.textContent,l)?(c.popover!=null&&(ha("beforetoggle",r),ha("toggle",r)),c.onScroll!=null&&ha("scroll",r),c.onScrollEnd!=null&&ha("scrollend",r),c.onClick!=null&&(r.onclick=Ic),r=!0):r=!1,r||Qn(a)}function Ad(a){for(kt=a.return;kt;)switch(kt.tag){case 5:case 13:Ar=!1;return;case 27:case 3:Ar=!0;return;default:kt=kt.return}}function Ni(a){if(a!==kt)return!1;if(!Ta)return Ad(a),Ta=!0,!1;var r=a.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||mu(a.type,a.memoizedProps)),l=!l),l&&za&&Qn(a),Ad(a),r===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));e:{for(a=a.nextSibling,r=0;a;){if(a.nodeType===8)if(l=a.data,l==="/$"){if(r===0){za=vr(a.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;a=a.nextSibling}za=null}}else r===27?(r=za,Sn(a.type)?(a=bu,bu=null,za=a):za=r):za=kt?vr(a.stateNode.nextSibling):null;return!0}function ki(){za=kt=null,Ta=!1}function Nd(){var a=Zn;return a!==null&&(It===null?It=a:It.push.apply(It,a),Zn=null),a}function Ci(a){Zn===null?Zn=[a]:Zn.push(a)}var J0=ce(null),Jn=null,Vr=null;function un(a,r,l){X(J0,r._currentValue),r._currentValue=l}function Gr(a){a._currentValue=J0.current,C(J0)}function eo(a,r,l){for(;a!==null;){var c=a.alternate;if((a.childLanes&r)!==r?(a.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),a===l)break;a=a.return}}function ao(a,r,l,c){var h=a.child;for(h!==null&&(h.return=a);h!==null;){var p=h.dependencies;if(p!==null){var w=h.child;p=p.firstContext;e:for(;p!==null;){var k=p;p=h;for(var G=0;G<r.length;G++)if(k.context===r[G]){p.lanes|=l,k=p.alternate,k!==null&&(k.lanes|=l),eo(p.return,l,a),c||(w=null);break e}p=k.next}}else if(h.tag===18){if(w=h.return,w===null)throw Error(s(341));w.lanes|=l,p=w.alternate,p!==null&&(p.lanes|=l),eo(w,l,a),w=null}else w=h.child;if(w!==null)w.return=h;else for(w=h;w!==null;){if(w===a){w=null;break}if(h=w.sibling,h!==null){h.return=w.return,w=h;break}w=w.return}h=w}}function Oi(a,r,l,c){a=null;for(var h=r,p=!1;h!==null;){if(!p){if((h.flags&524288)!==0)p=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var w=h.alternate;if(w===null)throw Error(s(387));if(w=w.memoizedProps,w!==null){var k=h.type;Ut(h.pendingProps.value,w.value)||(a!==null?a.push(k):a=[k])}}else if(h===me.current){if(w=h.alternate,w===null)throw Error(s(387));w.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(a!==null?a.push(sl):a=[sl])}h=h.return}a!==null&&ao(r,a,l,c),r.flags|=262144}function nc(a){for(a=a.firstContext;a!==null;){if(!Ut(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function es(a){Jn=a,Vr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function bt(a){return kd(Jn,a)}function sc(a,r){return Jn===null&&es(a),kd(a,r)}function kd(a,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},Vr===null){if(a===null)throw Error(s(308));Vr=r,a.dependencies={lanes:0,firstContext:r},a.flags|=524288}else Vr=Vr.next=r;return l}var av=typeof AbortController<"u"?AbortController:function(){var a=[],r=this.signal={aborted:!1,addEventListener:function(l,c){a.push(c)}};this.abort=function(){r.aborted=!0,a.forEach(function(l){return l()})}},tv=e.unstable_scheduleCallback,rv=e.unstable_NormalPriority,tt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function to(){return{controller:new av,data:new Map,refCount:0}}function Di(a){a.refCount--,a.refCount===0&&tv(rv,function(){a.controller.abort()})}var Ri=null,ro=0,Bs=0,Us=null;function nv(a,r){if(Ri===null){var l=Ri=[];ro=0,Bs=iu(),Us={status:"pending",value:void 0,then:function(c){l.push(c)}}}return ro++,r.then(Cd,Cd),r}function Cd(){if(--ro===0&&Ri!==null){Us!==null&&(Us.status="fulfilled");var a=Ri;Ri=null,Bs=0,Us=null;for(var r=0;r<a.length;r++)(0,a[r])()}}function sv(a,r){var l=[],c={status:"pending",value:null,reason:null,then:function(h){l.push(h)}};return a.then(function(){c.status="fulfilled",c.value=r;for(var h=0;h<l.length;h++)(0,l[h])(r)},function(h){for(c.status="rejected",c.reason=h,h=0;h<l.length;h++)(0,l[h])(void 0)}),c}var Od=Z.S;Z.S=function(a,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&nv(a,r),Od!==null&&Od(a,r)};var as=ce(null);function no(){var a=as.current;return a!==null?a:La.pooledCache}function ic(a,r){r===null?X(as,as.current):X(as,r.pool)}function Dd(){var a=no();return a===null?null:{parent:tt._currentValue,pool:a}}var ji=Error(s(460)),Rd=Error(s(474)),lc=Error(s(542)),so={then:function(){}};function jd(a){return a=a.status,a==="fulfilled"||a==="rejected"}function cc(){}function Fd(a,r,l){switch(l=a[l],l===void 0?a.push(r):l!==r&&(r.then(cc,cc),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,Md(a),a;default:if(typeof r.status=="string")r.then(cc,cc);else{if(a=La,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=r,a.status="pending",a.then(function(c){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=c}},function(c){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,Md(a),a}throw Fi=r,ji}}var Fi=null;function Ld(){if(Fi===null)throw Error(s(459));var a=Fi;return Fi=null,a}function Md(a){if(a===ji||a===lc)throw Error(s(483))}var fn=!1;function io(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lo(a,r){a=a.updateQueue,r.updateQueue===a&&(r.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function dn(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function hn(a,r,l){var c=a.updateQueue;if(c===null)return null;if(c=c.shared,(Sa&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,r=ec(a),_d(a,null,l),r}return Jl(a,c,r,l),ec(a)}function Li(a,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var c=r.lanes;c&=a.pendingLanes,l|=c,r.lanes=l,Ts(a,l)}}function co(a,r){var l=a.updateQueue,c=a.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var h=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?h=p=w:p=p.next=w,l=l.next}while(l!==null);p===null?h=p=r:p=p.next=r}else h=p=r;l={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=r:a.next=r,l.lastBaseUpdate=r}var oo=!1;function Mi(){if(oo){var a=Us;if(a!==null)throw a}}function Ii(a,r,l,c){oo=!1;var h=a.updateQueue;fn=!1;var p=h.firstBaseUpdate,w=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var G=k,se=G.next;G.next=null,w===null?p=se:w.next=se,w=G;var ye=a.alternate;ye!==null&&(ye=ye.updateQueue,k=ye.lastBaseUpdate,k!==w&&(k===null?ye.firstBaseUpdate=se:k.next=se,ye.lastBaseUpdate=G))}if(p!==null){var Se=h.baseState;w=0,ye=se=G=null,k=p;do{var de=k.lane&-536870913,xe=de!==k.lane;if(xe?(pa&de)===de:(c&de)===de){de!==0&&de===Bs&&(oo=!0),ye!==null&&(ye=ye.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var $e=a,Xe=k;de=r;var Ra=l;switch(Xe.tag){case 1:if($e=Xe.payload,typeof $e=="function"){Se=$e.call(Ra,Se,de);break e}Se=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=Xe.payload,de=typeof $e=="function"?$e.call(Ra,Se,de):$e,de==null)break e;Se=g({},Se,de);break e;case 2:fn=!0}}de=k.callback,de!==null&&(a.flags|=64,xe&&(a.flags|=8192),xe=h.callbacks,xe===null?h.callbacks=[de]:xe.push(de))}else xe={lane:de,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ye===null?(se=ye=xe,G=Se):ye=ye.next=xe,w|=de;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;xe=k,k=xe.next,xe.next=null,h.lastBaseUpdate=xe,h.shared.pending=null}}while(!0);ye===null&&(G=Se),h.baseState=G,h.firstBaseUpdate=se,h.lastBaseUpdate=ye,p===null&&(h.shared.lanes=0),En|=w,a.lanes=w,a.memoizedState=Se}}function Id(a,r){if(typeof a!="function")throw Error(s(191,a));a.call(r)}function Bd(a,r){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Id(l[a],r)}var Ps=ce(null),oc=ce(0);function Ud(a,r){a=Zr,X(oc,a),X(Ps,r),Zr=a|r.baseLanes}function uo(){X(oc,Zr),X(Ps,Ps.current)}function fo(){Zr=oc.current,C(Ps),C(oc)}var xn=0,ua=null,Oa=null,Za=null,uc=!1,Hs=!1,ts=!1,fc=0,Bi=0,zs=null,iv=0;function qa(){throw Error(s(321))}function ho(a,r){if(r===null)return!1;for(var l=0;l<r.length&&l<a.length;l++)if(!Ut(a[l],r[l]))return!1;return!0}function xo(a,r,l,c,h,p){return xn=p,ua=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z.H=a===null||a.memoizedState===null?_h:Th,ts=!1,p=l(c,h),ts=!1,Hs&&(p=Hd(r,l,c,h)),Pd(a),p}function Pd(a){Z.H=gc;var r=Oa!==null&&Oa.next!==null;if(xn=0,Za=Oa=ua=null,uc=!1,Bi=0,zs=null,r)throw Error(s(300));a===null||ct||(a=a.dependencies,a!==null&&nc(a)&&(ct=!0))}function Hd(a,r,l,c){ua=a;var h=0;do{if(Hs&&(zs=null),Bi=0,Hs=!1,25<=h)throw Error(s(301));if(h+=1,Za=Oa=null,a.updateQueue!=null){var p=a.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}Z.H=hv,p=r(l,c)}while(Hs);return p}function lv(){var a=Z.H,r=a.useState()[0];return r=typeof r.then=="function"?Ui(r):r,a=a.useState()[0],(Oa!==null?Oa.memoizedState:null)!==a&&(ua.flags|=1024),r}function mo(){var a=fc!==0;return fc=0,a}function po(a,r,l){r.updateQueue=a.updateQueue,r.flags&=-2053,a.lanes&=~l}function go(a){if(uc){for(a=a.memoizedState;a!==null;){var r=a.queue;r!==null&&(r.pending=null),a=a.next}uc=!1}xn=0,Za=Oa=ua=null,Hs=!1,Bi=fc=0,zs=null}function Lt(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Za===null?ua.memoizedState=Za=a:Za=Za.next=a,Za}function Qa(){if(Oa===null){var a=ua.alternate;a=a!==null?a.memoizedState:null}else a=Oa.next;var r=Za===null?ua.memoizedState:Za.next;if(r!==null)Za=r,Oa=a;else{if(a===null)throw ua.alternate===null?Error(s(467)):Error(s(310));Oa=a,a={memoizedState:Oa.memoizedState,baseState:Oa.baseState,baseQueue:Oa.baseQueue,queue:Oa.queue,next:null},Za===null?ua.memoizedState=Za=a:Za=Za.next=a}return Za}function vo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ui(a){var r=Bi;return Bi+=1,zs===null&&(zs=[]),a=Fd(zs,a,r),r=ua,(Za===null?r.memoizedState:Za.next)===null&&(r=r.alternate,Z.H=r===null||r.memoizedState===null?_h:Th),a}function dc(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ui(a);if(a.$$typeof===S)return bt(a)}throw Error(s(438,String(a)))}function bo(a){var r=null,l=ua.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var c=ua.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=vo(),ua.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(a),c=0;c<a;c++)l[c]=ie;return r.index++,l}function Yr(a,r){return typeof r=="function"?r(a):r}function hc(a){var r=Qa();return yo(r,Oa,a)}function yo(a,r,l){var c=a.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=l;var h=a.baseQueue,p=c.pending;if(p!==null){if(h!==null){var w=h.next;h.next=p.next,p.next=w}r.baseQueue=h=p,c.pending=null}if(p=a.baseState,h===null)a.memoizedState=p;else{r=h.next;var k=w=null,G=null,se=r,ye=!1;do{var Se=se.lane&-536870913;if(Se!==se.lane?(pa&Se)===Se:(xn&Se)===Se){var de=se.revertLane;if(de===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),Se===Bs&&(ye=!0);else if((xn&de)===de){se=se.next,de===Bs&&(ye=!0);continue}else Se={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(k=G=Se,w=p):G=G.next=Se,ua.lanes|=de,En|=de;Se=se.action,ts&&l(p,Se),p=se.hasEagerState?se.eagerState:l(p,Se)}else de={lane:Se,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(k=G=de,w=p):G=G.next=de,ua.lanes|=Se,En|=Se;se=se.next}while(se!==null&&se!==r);if(G===null?w=p:G.next=k,!Ut(p,a.memoizedState)&&(ct=!0,ye&&(l=Us,l!==null)))throw l;a.memoizedState=p,a.baseState=w,a.baseQueue=G,c.lastRenderedState=p}return h===null&&(c.lanes=0),[a.memoizedState,c.dispatch]}function Eo(a){var r=Qa(),l=r.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=a;var c=l.dispatch,h=l.pending,p=r.memoizedState;if(h!==null){l.pending=null;var w=h=h.next;do p=a(p,w.action),w=w.next;while(w!==h);Ut(p,r.memoizedState)||(ct=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),l.lastRenderedState=p}return[p,c]}function zd(a,r,l){var c=ua,h=Qa(),p=Ta;if(p){if(l===void 0)throw Error(s(407));l=l()}else l=r();var w=!Ut((Oa||h).memoizedState,l);w&&(h.memoizedState=l,ct=!0),h=h.queue;var k=Yd.bind(null,c,h,a);if(Pi(2048,8,k,[a]),h.getSnapshot!==r||w||Za!==null&&Za.memoizedState.tag&1){if(c.flags|=2048,Vs(9,xc(),Gd.bind(null,c,h,l,r),null),La===null)throw Error(s(349));p||(xn&124)!==0||Vd(c,r,l)}return l}function Vd(a,r,l){a.flags|=16384,a={getSnapshot:r,value:l},r=ua.updateQueue,r===null?(r=vo(),ua.updateQueue=r,r.stores=[a]):(l=r.stores,l===null?r.stores=[a]:l.push(a))}function Gd(a,r,l,c){r.value=l,r.getSnapshot=c,Xd(r)&&qd(a)}function Yd(a,r,l){return l(function(){Xd(r)&&qd(a)})}function Xd(a){var r=a.getSnapshot;a=a.value;try{var l=r();return!Ut(a,l)}catch{return!0}}function qd(a){var r=Fs(a,2);r!==null&&Yt(r,a,2)}function _o(a){var r=Lt();if(typeof a=="function"){var l=a;if(a=l(),ts){ke(!0);try{l()}finally{ke(!1)}}}return r.memoizedState=r.baseState=a,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:a},r}function Kd(a,r,l,c){return a.baseState=l,yo(a,Oa,typeof c=="function"?c:Yr)}function cv(a,r,l,c,h){if(pc(a))throw Error(s(485));if(a=r.action,a!==null){var p={payload:h,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){p.listeners.push(w)}};Z.T!==null?l(!0):p.isTransition=!1,c(p),l=r.pending,l===null?(p.next=r.pending=p,Wd(r,p)):(p.next=l.next,r.pending=l.next=p)}}function Wd(a,r){var l=r.action,c=r.payload,h=a.state;if(r.isTransition){var p=Z.T,w={};Z.T=w;try{var k=l(h,c),G=Z.S;G!==null&&G(w,k),$d(a,r,k)}catch(se){To(a,r,se)}finally{Z.T=p}}else try{p=l(h,c),$d(a,r,p)}catch(se){To(a,r,se)}}function $d(a,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Zd(a,r,c)},function(c){return To(a,r,c)}):Zd(a,r,l)}function Zd(a,r,l){r.status="fulfilled",r.value=l,Qd(r),a.state=l,r=a.pending,r!==null&&(l=r.next,l===r?a.pending=null:(l=l.next,r.next=l,Wd(a,l)))}function To(a,r,l){var c=a.pending;if(a.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=l,Qd(r),r=r.next;while(r!==c)}a.action=null}function Qd(a){a=a.listeners;for(var r=0;r<a.length;r++)(0,a[r])()}function Jd(a,r){return r}function eh(a,r){if(Ta){var l=La.formState;if(l!==null){e:{var c=ua;if(Ta){if(za){a:{for(var h=za,p=Ar;h.nodeType!==8;){if(!p){h=null;break a}if(h=vr(h.nextSibling),h===null){h=null;break a}}p=h.data,h=p==="F!"||p==="F"?h:null}if(h){za=vr(h.nextSibling),c=h.data==="F!";break e}}Qn(c)}c=!1}c&&(r=l[0])}}return l=Lt(),l.memoizedState=l.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jd,lastRenderedState:r},l.queue=c,l=bh.bind(null,ua,c),c.dispatch=l,c=_o(!1),p=ko.bind(null,ua,!1,c.queue),c=Lt(),h={state:r,dispatch:null,action:a,pending:null},c.queue=h,l=cv.bind(null,ua,h,p,l),h.dispatch=l,c.memoizedState=a,[r,l,!1]}function ah(a){var r=Qa();return th(r,Oa,a)}function th(a,r,l){if(r=yo(a,r,Jd)[0],a=hc(Yr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Ui(r)}catch(w){throw w===ji?lc:w}else c=r;r=Qa();var h=r.queue,p=h.dispatch;return l!==r.memoizedState&&(ua.flags|=2048,Vs(9,xc(),ov.bind(null,h,l),null)),[c,p,a]}function ov(a,r){a.action=r}function rh(a){var r=Qa(),l=Oa;if(l!==null)return th(r,l,a);Qa(),r=r.memoizedState,l=Qa();var c=l.queue.dispatch;return l.memoizedState=a,[r,c,!1]}function Vs(a,r,l,c){return a={tag:a,create:l,deps:c,inst:r,next:null},r=ua.updateQueue,r===null&&(r=vo(),ua.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=a.next=a:(c=l.next,l.next=a,a.next=c,r.lastEffect=a),a}function xc(){return{destroy:void 0,resource:void 0}}function nh(){return Qa().memoizedState}function mc(a,r,l,c){var h=Lt();c=c===void 0?null:c,ua.flags|=a,h.memoizedState=Vs(1|r,xc(),l,c)}function Pi(a,r,l,c){var h=Qa();c=c===void 0?null:c;var p=h.memoizedState.inst;Oa!==null&&c!==null&&ho(c,Oa.memoizedState.deps)?h.memoizedState=Vs(r,p,l,c):(ua.flags|=a,h.memoizedState=Vs(1|r,p,l,c))}function sh(a,r){mc(8390656,8,a,r)}function ih(a,r){Pi(2048,8,a,r)}function lh(a,r){return Pi(4,2,a,r)}function ch(a,r){return Pi(4,4,a,r)}function oh(a,r){if(typeof r=="function"){a=a();var l=r(a);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return a=a(),r.current=a,function(){r.current=null}}function uh(a,r,l){l=l!=null?l.concat([a]):null,Pi(4,4,oh.bind(null,r,a),l)}function wo(){}function fh(a,r){var l=Qa();r=r===void 0?null:r;var c=l.memoizedState;return r!==null&&ho(r,c[1])?c[0]:(l.memoizedState=[a,r],a)}function dh(a,r){var l=Qa();r=r===void 0?null:r;var c=l.memoizedState;if(r!==null&&ho(r,c[1]))return c[0];if(c=a(),ts){ke(!0);try{a()}finally{ke(!1)}}return l.memoizedState=[c,r],c}function So(a,r,l){return l===void 0||(xn&1073741824)!==0?a.memoizedState=r:(a.memoizedState=l,a=m1(),ua.lanes|=a,En|=a,l)}function hh(a,r,l,c){return Ut(l,r)?l:Ps.current!==null?(a=So(a,l,c),Ut(a,r)||(ct=!0),a):(xn&42)===0?(ct=!0,a.memoizedState=l):(a=m1(),ua.lanes|=a,En|=a,r)}function xh(a,r,l,c,h){var p=oe.p;oe.p=p!==0&&8>p?p:8;var w=Z.T,k={};Z.T=k,ko(a,!1,r,l);try{var G=h(),se=Z.S;if(se!==null&&se(k,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ye=sv(G,c);Hi(a,r,ye,Gt(a))}else Hi(a,r,c,Gt(a))}catch(Se){Hi(a,r,{then:function(){},status:"rejected",reason:Se},Gt())}finally{oe.p=p,Z.T=w}}function uv(){}function Ao(a,r,l,c){if(a.tag!==5)throw Error(s(476));var h=mh(a).queue;xh(a,h,r,Re,l===null?uv:function(){return ph(a),l(c)})}function mh(a){var r=a.memoizedState;if(r!==null)return r;r={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:Re},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:l},next:null},a.memoizedState=r,a=a.alternate,a!==null&&(a.memoizedState=r),r}function ph(a){var r=mh(a).next.queue;Hi(a,r,{},Gt())}function No(){return bt(sl)}function gh(){return Qa().memoizedState}function vh(){return Qa().memoizedState}function fv(a){for(var r=a.return;r!==null;){switch(r.tag){case 24:case 3:var l=Gt();a=dn(l);var c=hn(r,a,l);c!==null&&(Yt(c,r,l),Li(c,r,l)),r={cache:to()},a.payload=r;return}r=r.return}}function dv(a,r,l){var c=Gt();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},pc(a)?yh(r,l):(l=X0(a,r,l,c),l!==null&&(Yt(l,a,c),Eh(l,r,c)))}function bh(a,r,l){var c=Gt();Hi(a,r,l,c)}function Hi(a,r,l,c){var h={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(pc(a))yh(r,h);else{var p=a.alternate;if(a.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var w=r.lastRenderedState,k=p(w,l);if(h.hasEagerState=!0,h.eagerState=k,Ut(k,w))return Jl(a,r,h,0),La===null&&Ql(),!1}catch{}finally{}if(l=X0(a,r,h,c),l!==null)return Yt(l,a,c),Eh(l,r,c),!0}return!1}function ko(a,r,l,c){if(c={lane:2,revertLane:iu(),action:c,hasEagerState:!1,eagerState:null,next:null},pc(a)){if(r)throw Error(s(479))}else r=X0(a,l,c,2),r!==null&&Yt(r,a,2)}function pc(a){var r=a.alternate;return a===ua||r!==null&&r===ua}function yh(a,r){Hs=uc=!0;var l=a.pending;l===null?r.next=r:(r.next=l.next,l.next=r),a.pending=r}function Eh(a,r,l){if((l&4194048)!==0){var c=r.lanes;c&=a.pendingLanes,l|=c,r.lanes=l,Ts(a,l)}}var gc={readContext:bt,use:dc,useCallback:qa,useContext:qa,useEffect:qa,useImperativeHandle:qa,useLayoutEffect:qa,useInsertionEffect:qa,useMemo:qa,useReducer:qa,useRef:qa,useState:qa,useDebugValue:qa,useDeferredValue:qa,useTransition:qa,useSyncExternalStore:qa,useId:qa,useHostTransitionStatus:qa,useFormState:qa,useActionState:qa,useOptimistic:qa,useMemoCache:qa,useCacheRefresh:qa},_h={readContext:bt,use:dc,useCallback:function(a,r){return Lt().memoizedState=[a,r===void 0?null:r],a},useContext:bt,useEffect:sh,useImperativeHandle:function(a,r,l){l=l!=null?l.concat([a]):null,mc(4194308,4,oh.bind(null,r,a),l)},useLayoutEffect:function(a,r){return mc(4194308,4,a,r)},useInsertionEffect:function(a,r){mc(4,2,a,r)},useMemo:function(a,r){var l=Lt();r=r===void 0?null:r;var c=a();if(ts){ke(!0);try{a()}finally{ke(!1)}}return l.memoizedState=[c,r],c},useReducer:function(a,r,l){var c=Lt();if(l!==void 0){var h=l(r);if(ts){ke(!0);try{l(r)}finally{ke(!1)}}}else h=r;return c.memoizedState=c.baseState=h,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:h},c.queue=a,a=a.dispatch=dv.bind(null,ua,a),[c.memoizedState,a]},useRef:function(a){var r=Lt();return a={current:a},r.memoizedState=a},useState:function(a){a=_o(a);var r=a.queue,l=bh.bind(null,ua,r);return r.dispatch=l,[a.memoizedState,l]},useDebugValue:wo,useDeferredValue:function(a,r){var l=Lt();return So(l,a,r)},useTransition:function(){var a=_o(!1);return a=xh.bind(null,ua,a.queue,!0,!1),Lt().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,r,l){var c=ua,h=Lt();if(Ta){if(l===void 0)throw Error(s(407));l=l()}else{if(l=r(),La===null)throw Error(s(349));(pa&124)!==0||Vd(c,r,l)}h.memoizedState=l;var p={value:l,getSnapshot:r};return h.queue=p,sh(Yd.bind(null,c,p,a),[a]),c.flags|=2048,Vs(9,xc(),Gd.bind(null,c,p,l,r),null),l},useId:function(){var a=Lt(),r=La.identifierPrefix;if(Ta){var l=zr,c=Hr;l=(c&~(1<<32-Qe(c)-1)).toString(32)+l,r="«"+r+"R"+l,l=fc++,0<l&&(r+="H"+l.toString(32)),r+="»"}else l=iv++,r="«"+r+"r"+l.toString(32)+"»";return a.memoizedState=r},useHostTransitionStatus:No,useFormState:eh,useActionState:eh,useOptimistic:function(a){var r=Lt();r.memoizedState=r.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=ko.bind(null,ua,!0,l),l.dispatch=r,[a,r]},useMemoCache:bo,useCacheRefresh:function(){return Lt().memoizedState=fv.bind(null,ua)}},Th={readContext:bt,use:dc,useCallback:fh,useContext:bt,useEffect:ih,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:ch,useMemo:dh,useReducer:hc,useRef:nh,useState:function(){return hc(Yr)},useDebugValue:wo,useDeferredValue:function(a,r){var l=Qa();return hh(l,Oa.memoizedState,a,r)},useTransition:function(){var a=hc(Yr)[0],r=Qa().memoizedState;return[typeof a=="boolean"?a:Ui(a),r]},useSyncExternalStore:zd,useId:gh,useHostTransitionStatus:No,useFormState:ah,useActionState:ah,useOptimistic:function(a,r){var l=Qa();return Kd(l,Oa,a,r)},useMemoCache:bo,useCacheRefresh:vh},hv={readContext:bt,use:dc,useCallback:fh,useContext:bt,useEffect:ih,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:ch,useMemo:dh,useReducer:Eo,useRef:nh,useState:function(){return Eo(Yr)},useDebugValue:wo,useDeferredValue:function(a,r){var l=Qa();return Oa===null?So(l,a,r):hh(l,Oa.memoizedState,a,r)},useTransition:function(){var a=Eo(Yr)[0],r=Qa().memoizedState;return[typeof a=="boolean"?a:Ui(a),r]},useSyncExternalStore:zd,useId:gh,useHostTransitionStatus:No,useFormState:rh,useActionState:rh,useOptimistic:function(a,r){var l=Qa();return Oa!==null?Kd(l,Oa,a,r):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:bo,useCacheRefresh:vh},Gs=null,zi=0;function vc(a){var r=zi;return zi+=1,Gs===null&&(Gs=[]),Fd(Gs,a,r)}function Vi(a,r){r=r.props.ref,a.ref=r!==void 0?r:null}function bc(a,r){throw r.$$typeof===v?Error(s(525)):(a=Object.prototype.toString.call(r),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":a)))}function wh(a){var r=a._init;return r(a._payload)}function Sh(a){function r(ae,Q){if(a){var ne=ae.deletions;ne===null?(ae.deletions=[Q],ae.flags|=16):ne.push(Q)}}function l(ae,Q){if(!a)return null;for(;Q!==null;)r(ae,Q),Q=Q.sibling;return null}function c(ae){for(var Q=new Map;ae!==null;)ae.key!==null?Q.set(ae.key,ae):Q.set(ae.index,ae),ae=ae.sibling;return Q}function h(ae,Q){return ae=Pr(ae,Q),ae.index=0,ae.sibling=null,ae}function p(ae,Q,ne){return ae.index=ne,a?(ne=ae.alternate,ne!==null?(ne=ne.index,ne<Q?(ae.flags|=67108866,Q):ne):(ae.flags|=67108866,Q)):(ae.flags|=1048576,Q)}function w(ae){return a&&ae.alternate===null&&(ae.flags|=67108866),ae}function k(ae,Q,ne,_e){return Q===null||Q.tag!==6?(Q=K0(ne,ae.mode,_e),Q.return=ae,Q):(Q=h(Q,ne),Q.return=ae,Q)}function G(ae,Q,ne,_e){var Me=ne.type;return Me===y?ye(ae,Q,ne.props.children,_e,ne.key):Q!==null&&(Q.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===J&&wh(Me)===Q.type)?(Q=h(Q,ne.props),Vi(Q,ne),Q.return=ae,Q):(Q=ac(ne.type,ne.key,ne.props,null,ae.mode,_e),Vi(Q,ne),Q.return=ae,Q)}function se(ae,Q,ne,_e){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ne.containerInfo||Q.stateNode.implementation!==ne.implementation?(Q=W0(ne,ae.mode,_e),Q.return=ae,Q):(Q=h(Q,ne.children||[]),Q.return=ae,Q)}function ye(ae,Q,ne,_e,Me){return Q===null||Q.tag!==7?(Q=Kn(ne,ae.mode,_e,Me),Q.return=ae,Q):(Q=h(Q,ne),Q.return=ae,Q)}function Se(ae,Q,ne){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=K0(""+Q,ae.mode,ne),Q.return=ae,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case b:return ne=ac(Q.type,Q.key,Q.props,null,ae.mode,ne),Vi(ne,Q),ne.return=ae,ne;case _:return Q=W0(Q,ae.mode,ne),Q.return=ae,Q;case J:var _e=Q._init;return Q=_e(Q._payload),Se(ae,Q,ne)}if(Ae(Q)||q(Q))return Q=Kn(Q,ae.mode,ne,null),Q.return=ae,Q;if(typeof Q.then=="function")return Se(ae,vc(Q),ne);if(Q.$$typeof===S)return Se(ae,sc(ae,Q),ne);bc(ae,Q)}return null}function de(ae,Q,ne,_e){var Me=Q!==null?Q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Me!==null?null:k(ae,Q,""+ne,_e);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return ne.key===Me?G(ae,Q,ne,_e):null;case _:return ne.key===Me?se(ae,Q,ne,_e):null;case J:return Me=ne._init,ne=Me(ne._payload),de(ae,Q,ne,_e)}if(Ae(ne)||q(ne))return Me!==null?null:ye(ae,Q,ne,_e,null);if(typeof ne.then=="function")return de(ae,Q,vc(ne),_e);if(ne.$$typeof===S)return de(ae,Q,sc(ae,ne),_e);bc(ae,ne)}return null}function xe(ae,Q,ne,_e,Me){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return ae=ae.get(ne)||null,k(Q,ae,""+_e,Me);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case b:return ae=ae.get(_e.key===null?ne:_e.key)||null,G(Q,ae,_e,Me);case _:return ae=ae.get(_e.key===null?ne:_e.key)||null,se(Q,ae,_e,Me);case J:var fa=_e._init;return _e=fa(_e._payload),xe(ae,Q,ne,_e,Me)}if(Ae(_e)||q(_e))return ae=ae.get(ne)||null,ye(Q,ae,_e,Me,null);if(typeof _e.then=="function")return xe(ae,Q,ne,vc(_e),Me);if(_e.$$typeof===S)return xe(ae,Q,ne,sc(Q,_e),Me);bc(Q,_e)}return null}function $e(ae,Q,ne,_e){for(var Me=null,fa=null,He=Q,qe=Q=0,ut=null;He!==null&&qe<ne.length;qe++){He.index>qe?(ut=He,He=null):ut=He.sibling;var Ea=de(ae,He,ne[qe],_e);if(Ea===null){He===null&&(He=ut);break}a&&He&&Ea.alternate===null&&r(ae,He),Q=p(Ea,Q,qe),fa===null?Me=Ea:fa.sibling=Ea,fa=Ea,He=ut}if(qe===ne.length)return l(ae,He),Ta&&$n(ae,qe),Me;if(He===null){for(;qe<ne.length;qe++)He=Se(ae,ne[qe],_e),He!==null&&(Q=p(He,Q,qe),fa===null?Me=He:fa.sibling=He,fa=He);return Ta&&$n(ae,qe),Me}for(He=c(He);qe<ne.length;qe++)ut=xe(He,ae,qe,ne[qe],_e),ut!==null&&(a&&ut.alternate!==null&&He.delete(ut.key===null?qe:ut.key),Q=p(ut,Q,qe),fa===null?Me=ut:fa.sibling=ut,fa=ut);return a&&He.forEach(function(On){return r(ae,On)}),Ta&&$n(ae,qe),Me}function Xe(ae,Q,ne,_e){if(ne==null)throw Error(s(151));for(var Me=null,fa=null,He=Q,qe=Q=0,ut=null,Ea=ne.next();He!==null&&!Ea.done;qe++,Ea=ne.next()){He.index>qe?(ut=He,He=null):ut=He.sibling;var On=de(ae,He,Ea.value,_e);if(On===null){He===null&&(He=ut);break}a&&He&&On.alternate===null&&r(ae,He),Q=p(On,Q,qe),fa===null?Me=On:fa.sibling=On,fa=On,He=ut}if(Ea.done)return l(ae,He),Ta&&$n(ae,qe),Me;if(He===null){for(;!Ea.done;qe++,Ea=ne.next())Ea=Se(ae,Ea.value,_e),Ea!==null&&(Q=p(Ea,Q,qe),fa===null?Me=Ea:fa.sibling=Ea,fa=Ea);return Ta&&$n(ae,qe),Me}for(He=c(He);!Ea.done;qe++,Ea=ne.next())Ea=xe(He,ae,qe,Ea.value,_e),Ea!==null&&(a&&Ea.alternate!==null&&He.delete(Ea.key===null?qe:Ea.key),Q=p(Ea,Q,qe),fa===null?Me=Ea:fa.sibling=Ea,fa=Ea);return a&&He.forEach(function(xb){return r(ae,xb)}),Ta&&$n(ae,qe),Me}function Ra(ae,Q,ne,_e){if(typeof ne=="object"&&ne!==null&&ne.type===y&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:e:{for(var Me=ne.key;Q!==null;){if(Q.key===Me){if(Me=ne.type,Me===y){if(Q.tag===7){l(ae,Q.sibling),_e=h(Q,ne.props.children),_e.return=ae,ae=_e;break e}}else if(Q.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===J&&wh(Me)===Q.type){l(ae,Q.sibling),_e=h(Q,ne.props),Vi(_e,ne),_e.return=ae,ae=_e;break e}l(ae,Q);break}else r(ae,Q);Q=Q.sibling}ne.type===y?(_e=Kn(ne.props.children,ae.mode,_e,ne.key),_e.return=ae,ae=_e):(_e=ac(ne.type,ne.key,ne.props,null,ae.mode,_e),Vi(_e,ne),_e.return=ae,ae=_e)}return w(ae);case _:e:{for(Me=ne.key;Q!==null;){if(Q.key===Me)if(Q.tag===4&&Q.stateNode.containerInfo===ne.containerInfo&&Q.stateNode.implementation===ne.implementation){l(ae,Q.sibling),_e=h(Q,ne.children||[]),_e.return=ae,ae=_e;break e}else{l(ae,Q);break}else r(ae,Q);Q=Q.sibling}_e=W0(ne,ae.mode,_e),_e.return=ae,ae=_e}return w(ae);case J:return Me=ne._init,ne=Me(ne._payload),Ra(ae,Q,ne,_e)}if(Ae(ne))return $e(ae,Q,ne,_e);if(q(ne)){if(Me=q(ne),typeof Me!="function")throw Error(s(150));return ne=Me.call(ne),Xe(ae,Q,ne,_e)}if(typeof ne.then=="function")return Ra(ae,Q,vc(ne),_e);if(ne.$$typeof===S)return Ra(ae,Q,sc(ae,ne),_e);bc(ae,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,Q!==null&&Q.tag===6?(l(ae,Q.sibling),_e=h(Q,ne),_e.return=ae,ae=_e):(l(ae,Q),_e=K0(ne,ae.mode,_e),_e.return=ae,ae=_e),w(ae)):l(ae,Q)}return function(ae,Q,ne,_e){try{zi=0;var Me=Ra(ae,Q,ne,_e);return Gs=null,Me}catch(He){if(He===ji||He===lc)throw He;var fa=Pt(29,He,null,ae.mode);return fa.lanes=_e,fa.return=ae,fa}finally{}}}var Ys=Sh(!0),Ah=Sh(!1),nr=ce(null),Nr=null;function mn(a){var r=a.alternate;X(rt,rt.current&1),X(nr,a),Nr===null&&(r===null||Ps.current!==null||r.memoizedState!==null)&&(Nr=a)}function Nh(a){if(a.tag===22){if(X(rt,rt.current),X(nr,a),Nr===null){var r=a.alternate;r!==null&&r.memoizedState!==null&&(Nr=a)}}else pn()}function pn(){X(rt,rt.current),X(nr,nr.current)}function Xr(a){C(nr),Nr===a&&(Nr=null),C(rt)}var rt=ce(0);function yc(a){for(var r=a;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||vu(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function Co(a,r,l,c){r=a.memoizedState,l=l(c,r),l=l==null?r:g({},r,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var Oo={enqueueSetState:function(a,r,l){a=a._reactInternals;var c=Gt(),h=dn(c);h.payload=r,l!=null&&(h.callback=l),r=hn(a,h,c),r!==null&&(Yt(r,a,c),Li(r,a,c))},enqueueReplaceState:function(a,r,l){a=a._reactInternals;var c=Gt(),h=dn(c);h.tag=1,h.payload=r,l!=null&&(h.callback=l),r=hn(a,h,c),r!==null&&(Yt(r,a,c),Li(r,a,c))},enqueueForceUpdate:function(a,r){a=a._reactInternals;var l=Gt(),c=dn(l);c.tag=2,r!=null&&(c.callback=r),r=hn(a,c,l),r!==null&&(Yt(r,a,l),Li(r,a,l))}};function kh(a,r,l,c,h,p,w){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(c,p,w):r.prototype&&r.prototype.isPureReactComponent?!Si(l,c)||!Si(h,p):!0}function Ch(a,r,l,c){a=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,c),r.state!==a&&Oo.enqueueReplaceState(r,r.state,null)}function rs(a,r){var l=r;if("ref"in r){l={};for(var c in r)c!=="ref"&&(l[c]=r[c])}if(a=a.defaultProps){l===r&&(l=g({},l));for(var h in a)l[h]===void 0&&(l[h]=a[h])}return l}var Ec=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function Oh(a){Ec(a)}function Dh(a){console.error(a)}function Rh(a){Ec(a)}function _c(a,r){try{var l=a.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function jh(a,r,l){try{var c=a.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Do(a,r,l){return l=dn(l),l.tag=3,l.payload={element:null},l.callback=function(){_c(a,r)},l}function Fh(a){return a=dn(a),a.tag=3,a}function Lh(a,r,l,c){var h=l.type.getDerivedStateFromError;if(typeof h=="function"){var p=c.value;a.payload=function(){return h(p)},a.callback=function(){jh(r,l,c)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(a.callback=function(){jh(r,l,c),typeof h!="function"&&(_n===null?_n=new Set([this]):_n.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function xv(a,r,l,c,h){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=l.alternate,r!==null&&Oi(r,l,h,!0),l=nr.current,l!==null){switch(l.tag){case 13:return Nr===null?au():l.alternate===null&&Va===0&&(Va=3),l.flags&=-257,l.flags|=65536,l.lanes=h,c===so?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([c]):r.add(c),ru(a,c,h)),!1;case 22:return l.flags|=65536,c===so?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([c]):l.add(c)),ru(a,c,h)),!1}throw Error(s(435,l.tag))}return ru(a,c,h),au(),!1}if(Ta)return r=nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,c!==Q0&&(a=Error(s(422),{cause:c}),Ci(er(a,l)))):(c!==Q0&&(r=Error(s(423),{cause:c}),Ci(er(r,l))),a=a.current.alternate,a.flags|=65536,h&=-h,a.lanes|=h,c=er(c,l),h=Do(a.stateNode,c,h),co(a,h),Va!==4&&(Va=2)),!1;var p=Error(s(520),{cause:c});if(p=er(p,l),$i===null?$i=[p]:$i.push(p),Va!==4&&(Va=2),r===null)return!0;c=er(c,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,a=h&-h,l.lanes|=a,a=Do(l.stateNode,c,a),co(l,a),!1;case 1:if(r=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(_n===null||!_n.has(p))))return l.flags|=65536,h&=-h,l.lanes|=h,h=Fh(h),Lh(h,a,l,c),co(l,h),!1}l=l.return}while(l!==null);return!1}var Mh=Error(s(461)),ct=!1;function ht(a,r,l,c){r.child=a===null?Ah(r,null,l,c):Ys(r,a.child,l,c)}function Ih(a,r,l,c,h){l=l.render;var p=r.ref;if("ref"in c){var w={};for(var k in c)k!=="ref"&&(w[k]=c[k])}else w=c;return es(r),c=xo(a,r,l,w,p,h),k=mo(),a!==null&&!ct?(po(a,r,h),qr(a,r,h)):(Ta&&k&&$0(r),r.flags|=1,ht(a,r,c,h),r.child)}function Bh(a,r,l,c,h){if(a===null){var p=l.type;return typeof p=="function"&&!q0(p)&&p.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=p,Uh(a,r,p,c,h)):(a=ac(l.type,null,c,r,r.mode,h),a.ref=r.ref,a.return=r,r.child=a)}if(p=a.child,!Uo(a,h)){var w=p.memoizedProps;if(l=l.compare,l=l!==null?l:Si,l(w,c)&&a.ref===r.ref)return qr(a,r,h)}return r.flags|=1,a=Pr(p,c),a.ref=r.ref,a.return=r,r.child=a}function Uh(a,r,l,c,h){if(a!==null){var p=a.memoizedProps;if(Si(p,c)&&a.ref===r.ref)if(ct=!1,r.pendingProps=c=p,Uo(a,h))(a.flags&131072)!==0&&(ct=!0);else return r.lanes=a.lanes,qr(a,r,h)}return Ro(a,r,l,c,h)}function Ph(a,r,l){var c=r.pendingProps,h=c.children,p=a!==null?a.memoizedState:null;if(c.mode==="hidden"){if((r.flags&128)!==0){if(c=p!==null?p.baseLanes|l:l,a!==null){for(h=r.child=a.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;r.childLanes=p&~c}else r.childLanes=0,r.child=null;return Hh(a,r,c,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},a!==null&&ic(r,p!==null?p.cachePool:null),p!==null?Ud(r,p):uo(),Nh(r);else return r.lanes=r.childLanes=536870912,Hh(a,r,p!==null?p.baseLanes|l:l,l)}else p!==null?(ic(r,p.cachePool),Ud(r,p),pn(),r.memoizedState=null):(a!==null&&ic(r,null),uo(),pn());return ht(a,r,h,l),r.child}function Hh(a,r,l,c){var h=no();return h=h===null?null:{parent:tt._currentValue,pool:h},r.memoizedState={baseLanes:l,cachePool:h},a!==null&&ic(r,null),uo(),Nh(r),a!==null&&Oi(a,r,c,!0),null}function Tc(a,r){var l=r.ref;if(l===null)a!==null&&a.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(a===null||a.ref!==l)&&(r.flags|=4194816)}}function Ro(a,r,l,c,h){return es(r),l=xo(a,r,l,c,void 0,h),c=mo(),a!==null&&!ct?(po(a,r,h),qr(a,r,h)):(Ta&&c&&$0(r),r.flags|=1,ht(a,r,l,h),r.child)}function zh(a,r,l,c,h,p){return es(r),r.updateQueue=null,l=Hd(r,c,l,h),Pd(a),c=mo(),a!==null&&!ct?(po(a,r,p),qr(a,r,p)):(Ta&&c&&$0(r),r.flags|=1,ht(a,r,l,p),r.child)}function Vh(a,r,l,c,h){if(es(r),r.stateNode===null){var p=Ls,w=l.contextType;typeof w=="object"&&w!==null&&(p=bt(w)),p=new l(c,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Oo,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=c,p.state=r.memoizedState,p.refs={},io(r),w=l.contextType,p.context=typeof w=="object"&&w!==null?bt(w):Ls,p.state=r.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Co(r,l,w,c),p.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(w=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),w!==p.state&&Oo.enqueueReplaceState(p,p.state,null),Ii(r,c,p,h),Mi(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(a===null){p=r.stateNode;var k=r.memoizedProps,G=rs(l,k);p.props=G;var se=p.context,ye=l.contextType;w=Ls,typeof ye=="object"&&ye!==null&&(w=bt(ye));var Se=l.getDerivedStateFromProps;ye=typeof Se=="function"||typeof p.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,ye||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(k||se!==w)&&Ch(r,p,c,w),fn=!1;var de=r.memoizedState;p.state=de,Ii(r,c,p,h),Mi(),se=r.memoizedState,k||de!==se||fn?(typeof Se=="function"&&(Co(r,l,Se,c),se=r.memoizedState),(G=fn||kh(r,l,G,c,de,se,w))?(ye||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=se),p.props=c,p.state=se,p.context=w,c=G):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{p=r.stateNode,lo(a,r),w=r.memoizedProps,ye=rs(l,w),p.props=ye,Se=r.pendingProps,de=p.context,se=l.contextType,G=Ls,typeof se=="object"&&se!==null&&(G=bt(se)),k=l.getDerivedStateFromProps,(se=typeof k=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(w!==Se||de!==G)&&Ch(r,p,c,G),fn=!1,de=r.memoizedState,p.state=de,Ii(r,c,p,h),Mi();var xe=r.memoizedState;w!==Se||de!==xe||fn||a!==null&&a.dependencies!==null&&nc(a.dependencies)?(typeof k=="function"&&(Co(r,l,k,c),xe=r.memoizedState),(ye=fn||kh(r,l,ye,c,de,xe,G)||a!==null&&a.dependencies!==null&&nc(a.dependencies))?(se||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,xe,G),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,xe,G)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||w===a.memoizedProps&&de===a.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&de===a.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=xe),p.props=c,p.state=xe,p.context=G,c=ye):(typeof p.componentDidUpdate!="function"||w===a.memoizedProps&&de===a.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&de===a.memoizedState||(r.flags|=1024),c=!1)}return p=c,Tc(a,r),c=(r.flags&128)!==0,p||c?(p=r.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,a!==null&&c?(r.child=Ys(r,a.child,null,h),r.child=Ys(r,null,l,h)):ht(a,r,l,h),r.memoizedState=p.state,a=r.child):a=qr(a,r,h),a}function Gh(a,r,l,c){return ki(),r.flags|=256,ht(a,r,l,c),r.child}var jo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fo(a){return{baseLanes:a,cachePool:Dd()}}function Lo(a,r,l){return a=a!==null?a.childLanes&~l:0,r&&(a|=sr),a}function Yh(a,r,l){var c=r.pendingProps,h=!1,p=(r.flags&128)!==0,w;if((w=p)||(w=a!==null&&a.memoizedState===null?!1:(rt.current&2)!==0),w&&(h=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,a===null){if(Ta){if(h?mn(r):pn(),Ta){var k=za,G;if(G=k){e:{for(G=k,k=Ar;G.nodeType!==8;){if(!k){k=null;break e}if(G=vr(G.nextSibling),G===null){k=null;break e}}k=G}k!==null?(r.memoizedState={dehydrated:k,treeContext:Wn!==null?{id:Hr,overflow:zr}:null,retryLane:536870912,hydrationErrors:null},G=Pt(18,null,null,0),G.stateNode=k,G.return=r,r.child=G,kt=r,za=null,G=!0):G=!1}G||Qn(r)}if(k=r.memoizedState,k!==null&&(k=k.dehydrated,k!==null))return vu(k)?r.lanes=32:r.lanes=536870912,null;Xr(r)}return k=c.children,c=c.fallback,h?(pn(),h=r.mode,k=wc({mode:"hidden",children:k},h),c=Kn(c,h,l,null),k.return=r,c.return=r,k.sibling=c,r.child=k,h=r.child,h.memoizedState=Fo(l),h.childLanes=Lo(a,w,l),r.memoizedState=jo,c):(mn(r),Mo(r,k))}if(G=a.memoizedState,G!==null&&(k=G.dehydrated,k!==null)){if(p)r.flags&256?(mn(r),r.flags&=-257,r=Io(a,r,l)):r.memoizedState!==null?(pn(),r.child=a.child,r.flags|=128,r=null):(pn(),h=c.fallback,k=r.mode,c=wc({mode:"visible",children:c.children},k),h=Kn(h,k,l,null),h.flags|=2,c.return=r,h.return=r,c.sibling=h,r.child=c,Ys(r,a.child,null,l),c=r.child,c.memoizedState=Fo(l),c.childLanes=Lo(a,w,l),r.memoizedState=jo,r=h);else if(mn(r),vu(k)){if(w=k.nextSibling&&k.nextSibling.dataset,w)var se=w.dgst;w=se,c=Error(s(419)),c.stack="",c.digest=w,Ci({value:c,source:null,stack:null}),r=Io(a,r,l)}else if(ct||Oi(a,r,l,!1),w=(l&a.childLanes)!==0,ct||w){if(w=La,w!==null&&(c=l&-l,c=(c&42)!==0?1:Vn(c),c=(c&(w.suspendedLanes|l))!==0?0:c,c!==0&&c!==G.retryLane))throw G.retryLane=c,Fs(a,c),Yt(w,a,c),Mh;k.data==="$?"||au(),r=Io(a,r,l)}else k.data==="$?"?(r.flags|=192,r.child=a.child,r=null):(a=G.treeContext,za=vr(k.nextSibling),kt=r,Ta=!0,Zn=null,Ar=!1,a!==null&&(tr[rr++]=Hr,tr[rr++]=zr,tr[rr++]=Wn,Hr=a.id,zr=a.overflow,Wn=r),r=Mo(r,c.children),r.flags|=4096);return r}return h?(pn(),h=c.fallback,k=r.mode,G=a.child,se=G.sibling,c=Pr(G,{mode:"hidden",children:c.children}),c.subtreeFlags=G.subtreeFlags&65011712,se!==null?h=Pr(se,h):(h=Kn(h,k,l,null),h.flags|=2),h.return=r,c.return=r,c.sibling=h,r.child=c,c=h,h=r.child,k=a.child.memoizedState,k===null?k=Fo(l):(G=k.cachePool,G!==null?(se=tt._currentValue,G=G.parent!==se?{parent:se,pool:se}:G):G=Dd(),k={baseLanes:k.baseLanes|l,cachePool:G}),h.memoizedState=k,h.childLanes=Lo(a,w,l),r.memoizedState=jo,c):(mn(r),l=a.child,a=l.sibling,l=Pr(l,{mode:"visible",children:c.children}),l.return=r,l.sibling=null,a!==null&&(w=r.deletions,w===null?(r.deletions=[a],r.flags|=16):w.push(a)),r.child=l,r.memoizedState=null,l)}function Mo(a,r){return r=wc({mode:"visible",children:r},a.mode),r.return=a,a.child=r}function wc(a,r){return a=Pt(22,a,null,r),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Io(a,r,l){return Ys(r,a.child,null,l),a=Mo(r,r.pendingProps.children),a.flags|=2,r.memoizedState=null,a}function Xh(a,r,l){a.lanes|=r;var c=a.alternate;c!==null&&(c.lanes|=r),eo(a.return,r,l)}function Bo(a,r,l,c,h){var p=a.memoizedState;p===null?a.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:h}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=l,p.tailMode=h)}function qh(a,r,l){var c=r.pendingProps,h=c.revealOrder,p=c.tail;if(ht(a,r,c.children,l),c=rt.current,(c&2)!==0)c=c&1|2,r.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=r.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Xh(a,l,r);else if(a.tag===19)Xh(a,l,r);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}c&=1}switch(X(rt,c),h){case"forwards":for(l=r.child,h=null;l!==null;)a=l.alternate,a!==null&&yc(a)===null&&(h=l),l=l.sibling;l=h,l===null?(h=r.child,r.child=null):(h=l.sibling,l.sibling=null),Bo(r,!1,h,l,p);break;case"backwards":for(l=null,h=r.child,r.child=null;h!==null;){if(a=h.alternate,a!==null&&yc(a)===null){r.child=h;break}a=h.sibling,h.sibling=l,l=h,h=a}Bo(r,!0,l,null,p);break;case"together":Bo(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function qr(a,r,l){if(a!==null&&(r.dependencies=a.dependencies),En|=r.lanes,(l&r.childLanes)===0)if(a!==null){if(Oi(a,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(a!==null&&r.child!==a.child)throw Error(s(153));if(r.child!==null){for(a=r.child,l=Pr(a,a.pendingProps),r.child=l,l.return=r;a.sibling!==null;)a=a.sibling,l=l.sibling=Pr(a,a.pendingProps),l.return=r;l.sibling=null}return r.child}function Uo(a,r){return(a.lanes&r)!==0?!0:(a=a.dependencies,!!(a!==null&&nc(a)))}function mv(a,r,l){switch(r.tag){case 3:ve(r,r.stateNode.containerInfo),un(r,tt,a.memoizedState.cache),ki();break;case 27:case 5:Ee(r);break;case 4:ve(r,r.stateNode.containerInfo);break;case 10:un(r,r.type,r.memoizedProps.value);break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(mn(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Yh(a,r,l):(mn(r),a=qr(a,r,l),a!==null?a.sibling:null);mn(r);break;case 19:var h=(a.flags&128)!==0;if(c=(l&r.childLanes)!==0,c||(Oi(a,r,l,!1),c=(l&r.childLanes)!==0),h){if(c)return qh(a,r,l);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),X(rt,rt.current),c)break;return null;case 22:case 23:return r.lanes=0,Ph(a,r,l);case 24:un(r,tt,a.memoizedState.cache)}return qr(a,r,l)}function Kh(a,r,l){if(a!==null)if(a.memoizedProps!==r.pendingProps)ct=!0;else{if(!Uo(a,l)&&(r.flags&128)===0)return ct=!1,mv(a,r,l);ct=(a.flags&131072)!==0}else ct=!1,Ta&&(r.flags&1048576)!==0&&wd(r,rc,r.index);switch(r.lanes=0,r.tag){case 16:e:{a=r.pendingProps;var c=r.elementType,h=c._init;if(c=h(c._payload),r.type=c,typeof c=="function")q0(c)?(a=rs(c,a),r.tag=1,r=Vh(null,r,c,a,l)):(r.tag=0,r=Ro(null,r,c,a,l));else{if(c!=null){if(h=c.$$typeof,h===H){r.tag=11,r=Ih(null,r,c,a,l);break e}else if(h===j){r.tag=14,r=Bh(null,r,c,a,l);break e}}throw r=pe(c)||c,Error(s(306,r,""))}}return r;case 0:return Ro(a,r,r.type,r.pendingProps,l);case 1:return c=r.type,h=rs(c,r.pendingProps),Vh(a,r,c,h,l);case 3:e:{if(ve(r,r.stateNode.containerInfo),a===null)throw Error(s(387));c=r.pendingProps;var p=r.memoizedState;h=p.element,lo(a,r),Ii(r,c,null,l);var w=r.memoizedState;if(c=w.cache,un(r,tt,c),c!==p.cache&&ao(r,[tt],l,!0),Mi(),c=w.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=Gh(a,r,c,l);break e}else if(c!==h){h=er(Error(s(424)),r),Ci(h),r=Gh(a,r,c,l);break e}else{switch(a=r.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(za=vr(a.firstChild),kt=r,Ta=!0,Zn=null,Ar=!0,l=Ah(r,null,c,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ki(),c===h){r=qr(a,r,l);break e}ht(a,r,c,l)}r=r.child}return r;case 26:return Tc(a,r),a===null?(l=Q1(r.type,null,r.pendingProps,null))?r.memoizedState=l:Ta||(l=r.type,a=r.pendingProps,c=Bc(W.current).createElement(l),c[Xa]=r,c[$a]=a,mt(c,l,a),te(c),r.stateNode=c):r.memoizedState=Q1(r.type,a.memoizedProps,r.pendingProps,a.memoizedState),null;case 27:return Ee(r),a===null&&Ta&&(c=r.stateNode=W1(r.type,r.pendingProps,W.current),kt=r,Ar=!0,h=za,Sn(r.type)?(bu=h,za=vr(c.firstChild)):za=h),ht(a,r,r.pendingProps.children,l),Tc(a,r),a===null&&(r.flags|=4194304),r.child;case 5:return a===null&&Ta&&((h=c=za)&&(c=Vv(c,r.type,r.pendingProps,Ar),c!==null?(r.stateNode=c,kt=r,za=vr(c.firstChild),Ar=!1,h=!0):h=!1),h||Qn(r)),Ee(r),h=r.type,p=r.pendingProps,w=a!==null?a.memoizedProps:null,c=p.children,mu(h,p)?c=null:w!==null&&mu(h,w)&&(r.flags|=32),r.memoizedState!==null&&(h=xo(a,r,lv,null,null,l),sl._currentValue=h),Tc(a,r),ht(a,r,c,l),r.child;case 6:return a===null&&Ta&&((a=l=za)&&(l=Gv(l,r.pendingProps,Ar),l!==null?(r.stateNode=l,kt=r,za=null,a=!0):a=!1),a||Qn(r)),null;case 13:return Yh(a,r,l);case 4:return ve(r,r.stateNode.containerInfo),c=r.pendingProps,a===null?r.child=Ys(r,null,c,l):ht(a,r,c,l),r.child;case 11:return Ih(a,r,r.type,r.pendingProps,l);case 7:return ht(a,r,r.pendingProps,l),r.child;case 8:return ht(a,r,r.pendingProps.children,l),r.child;case 12:return ht(a,r,r.pendingProps.children,l),r.child;case 10:return c=r.pendingProps,un(r,r.type,c.value),ht(a,r,c.children,l),r.child;case 9:return h=r.type._context,c=r.pendingProps.children,es(r),h=bt(h),c=c(h),r.flags|=1,ht(a,r,c,l),r.child;case 14:return Bh(a,r,r.type,r.pendingProps,l);case 15:return Uh(a,r,r.type,r.pendingProps,l);case 19:return qh(a,r,l);case 31:return c=r.pendingProps,l=r.mode,c={mode:c.mode,children:c.children},a===null?(l=wc(c,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=Pr(a.child,c),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return Ph(a,r,l);case 24:return es(r),c=bt(tt),a===null?(h=no(),h===null&&(h=La,p=to(),h.pooledCache=p,p.refCount++,p!==null&&(h.pooledCacheLanes|=l),h=p),r.memoizedState={parent:c,cache:h},io(r),un(r,tt,h)):((a.lanes&l)!==0&&(lo(a,r),Ii(r,null,null,l),Mi()),h=a.memoizedState,p=r.memoizedState,h.parent!==c?(h={parent:c,cache:c},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),un(r,tt,c)):(c=p.cache,un(r,tt,c),c!==h.cache&&ao(r,[tt],l,!0))),ht(a,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function Kr(a){a.flags|=4}function Wh(a,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!rx(r)){if(r=nr.current,r!==null&&((pa&4194048)===pa?Nr!==null:(pa&62914560)!==pa&&(pa&536870912)===0||r!==Nr))throw Fi=so,Rd;a.flags|=8192}}function Sc(a,r){r!==null&&(a.flags|=4),a.flags&16384&&(r=a.tag!==22?Hn():536870912,a.lanes|=r,Ws|=r)}function Gi(a,r){if(!Ta)switch(a.tailMode){case"hidden":r=a.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?r||a.tail===null?a.tail=null:a.tail.sibling=null:c.sibling=null}}function Ua(a){var r=a.alternate!==null&&a.alternate.child===a.child,l=0,c=0;if(r)for(var h=a.child;h!==null;)l|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=a,h=h.sibling;else for(h=a.child;h!==null;)l|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=a,h=h.sibling;return a.subtreeFlags|=c,a.childLanes=l,r}function pv(a,r,l){var c=r.pendingProps;switch(Z0(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ua(r),null;case 1:return Ua(r),null;case 3:return l=r.stateNode,c=null,a!==null&&(c=a.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Gr(tt),Te(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Ni(r)?Kr(r):a===null||a.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Nd())),Ua(r),null;case 26:return l=r.memoizedState,a===null?(Kr(r),l!==null?(Ua(r),Wh(r,l)):(Ua(r),r.flags&=-16777217)):l?l!==a.memoizedState?(Kr(r),Ua(r),Wh(r,l)):(Ua(r),r.flags&=-16777217):(a.memoizedProps!==c&&Kr(r),Ua(r),r.flags&=-16777217),null;case 27:Be(r),l=W.current;var h=r.type;if(a!==null&&r.stateNode!=null)a.memoizedProps!==c&&Kr(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return Ua(r),null}a=U.current,Ni(r)?Sd(r):(a=W1(h,c,l),r.stateNode=a,Kr(r))}return Ua(r),null;case 5:if(Be(r),l=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==c&&Kr(r);else{if(!c){if(r.stateNode===null)throw Error(s(166));return Ua(r),null}if(a=U.current,Ni(r))Sd(r);else{switch(h=Bc(W.current),a){case 1:a=h.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:a=h.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":a=h.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":a=h.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":a=h.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof c.is=="string"?h.createElement("select",{is:c.is}):h.createElement("select"),c.multiple?a.multiple=!0:c.size&&(a.size=c.size);break;default:a=typeof c.is=="string"?h.createElement(l,{is:c.is}):h.createElement(l)}}a[Xa]=r,a[$a]=c;e:for(h=r.child;h!==null;){if(h.tag===5||h.tag===6)a.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===r)break e;for(;h.sibling===null;){if(h.return===null||h.return===r)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}r.stateNode=a;e:switch(mt(a,l,c),l){case"button":case"input":case"select":case"textarea":a=!!c.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Kr(r)}}return Ua(r),r.flags&=-16777217,null;case 6:if(a&&r.stateNode!=null)a.memoizedProps!==c&&Kr(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(s(166));if(a=W.current,Ni(r)){if(a=r.stateNode,l=r.memoizedProps,c=null,h=kt,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}a[Xa]=r,a=!!(a.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||z1(a.nodeValue,l)),a||Qn(r)}else a=Bc(a).createTextNode(c),a[Xa]=r,r.stateNode=a}return Ua(r),null;case 13:if(c=r.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(h=Ni(r),c!==null&&c.dehydrated!==null){if(a===null){if(!h)throw Error(s(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[Xa]=r}else ki(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ua(r),h=!1}else h=Nd(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Xr(r),r):(Xr(r),null)}if(Xr(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=c!==null,a=a!==null&&a.memoizedState!==null,l){c=r.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool);var p=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==h&&(c.flags|=2048)}return l!==a&&l&&(r.child.flags|=8192),Sc(r,r.updateQueue),Ua(r),null;case 4:return Te(),a===null&&uu(r.stateNode.containerInfo),Ua(r),null;case 10:return Gr(r.type),Ua(r),null;case 19:if(C(rt),h=r.memoizedState,h===null)return Ua(r),null;if(c=(r.flags&128)!==0,p=h.rendering,p===null)if(c)Gi(h,!1);else{if(Va!==0||a!==null&&(a.flags&128)!==0)for(a=r.child;a!==null;){if(p=yc(a),p!==null){for(r.flags|=128,Gi(h,!1),a=p.updateQueue,r.updateQueue=a,Sc(r,a),r.subtreeFlags=0,a=l,l=r.child;l!==null;)Td(l,a),l=l.sibling;return X(rt,rt.current&1|2),r.child}a=a.sibling}h.tail!==null&&ge()>kc&&(r.flags|=128,c=!0,Gi(h,!1),r.lanes=4194304)}else{if(!c)if(a=yc(p),a!==null){if(r.flags|=128,c=!0,a=a.updateQueue,r.updateQueue=a,Sc(r,a),Gi(h,!0),h.tail===null&&h.tailMode==="hidden"&&!p.alternate&&!Ta)return Ua(r),null}else 2*ge()-h.renderingStartTime>kc&&l!==536870912&&(r.flags|=128,c=!0,Gi(h,!1),r.lanes=4194304);h.isBackwards?(p.sibling=r.child,r.child=p):(a=h.last,a!==null?a.sibling=p:r.child=p,h.last=p)}return h.tail!==null?(r=h.tail,h.rendering=r,h.tail=r.sibling,h.renderingStartTime=ge(),r.sibling=null,a=rt.current,X(rt,c?a&1|2:a&1),r):(Ua(r),null);case 22:case 23:return Xr(r),fo(),c=r.memoizedState!==null,a!==null?a.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(l&536870912)!==0&&(r.flags&128)===0&&(Ua(r),r.subtreeFlags&6&&(r.flags|=8192)):Ua(r),l=r.updateQueue,l!==null&&Sc(r,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==l&&(r.flags|=2048),a!==null&&C(as),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Gr(tt),Ua(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function gv(a,r){switch(Z0(r),r.tag){case 1:return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 3:return Gr(tt),Te(),a=r.flags,(a&65536)!==0&&(a&128)===0?(r.flags=a&-65537|128,r):null;case 26:case 27:case 5:return Be(r),null;case 13:if(Xr(r),a=r.memoizedState,a!==null&&a.dehydrated!==null){if(r.alternate===null)throw Error(s(340));ki()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 19:return C(rt),null;case 4:return Te(),null;case 10:return Gr(r.type),null;case 22:case 23:return Xr(r),fo(),a!==null&&C(as),a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 24:return Gr(tt),null;case 25:return null;default:return null}}function $h(a,r){switch(Z0(r),r.tag){case 3:Gr(tt),Te();break;case 26:case 27:case 5:Be(r);break;case 4:Te();break;case 13:Xr(r);break;case 19:C(rt);break;case 10:Gr(r.type);break;case 22:case 23:Xr(r),fo(),a!==null&&C(as);break;case 24:Gr(tt)}}function Yi(a,r){try{var l=r.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var h=c.next;l=h;do{if((l.tag&a)===a){c=void 0;var p=l.create,w=l.inst;c=p(),w.destroy=c}l=l.next}while(l!==h)}}catch(k){ja(r,r.return,k)}}function gn(a,r,l){try{var c=r.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var p=h.next;c=p;do{if((c.tag&a)===a){var w=c.inst,k=w.destroy;if(k!==void 0){w.destroy=void 0,h=r;var G=l,se=k;try{se()}catch(ye){ja(h,G,ye)}}}c=c.next}while(c!==p)}}catch(ye){ja(r,r.return,ye)}}function Zh(a){var r=a.updateQueue;if(r!==null){var l=a.stateNode;try{Bd(r,l)}catch(c){ja(a,a.return,c)}}}function Qh(a,r,l){l.props=rs(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(c){ja(a,r,c)}}function Xi(a,r){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var c=a.stateNode;break;case 30:c=a.stateNode;break;default:c=a.stateNode}typeof l=="function"?a.refCleanup=l(c):l.current=c}}catch(h){ja(a,r,h)}}function kr(a,r){var l=a.ref,c=a.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(h){ja(a,r,h)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(h){ja(a,r,h)}else l.current=null}function Jh(a){var r=a.type,l=a.memoizedProps,c=a.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(h){ja(a,a.return,h)}}function Po(a,r,l){try{var c=a.stateNode;Bv(c,a.type,l,r),c[$a]=r}catch(h){ja(a,a.return,h)}}function e1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Sn(a.type)||a.tag===4}function Ho(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||e1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Sn(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function zo(a,r,l){var c=a.tag;if(c===5||c===6)a=a.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(a),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Ic));else if(c!==4&&(c===27&&Sn(a.type)&&(l=a.stateNode,r=null),a=a.child,a!==null))for(zo(a,r,l),a=a.sibling;a!==null;)zo(a,r,l),a=a.sibling}function Ac(a,r,l){var c=a.tag;if(c===5||c===6)a=a.stateNode,r?l.insertBefore(a,r):l.appendChild(a);else if(c!==4&&(c===27&&Sn(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(Ac(a,r,l),a=a.sibling;a!==null;)Ac(a,r,l),a=a.sibling}function a1(a){var r=a.stateNode,l=a.memoizedProps;try{for(var c=a.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);mt(r,c,l),r[Xa]=a,r[$a]=l}catch(p){ja(a,a.return,p)}}var Wr=!1,Ka=!1,Vo=!1,t1=typeof WeakSet=="function"?WeakSet:Set,ot=null;function vv(a,r){if(a=a.containerInfo,hu=Gc,a=hd(a),P0(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var w=0,k=-1,G=-1,se=0,ye=0,Se=a,de=null;a:for(;;){for(var xe;Se!==l||h!==0&&Se.nodeType!==3||(k=w+h),Se!==p||c!==0&&Se.nodeType!==3||(G=w+c),Se.nodeType===3&&(w+=Se.nodeValue.length),(xe=Se.firstChild)!==null;)de=Se,Se=xe;for(;;){if(Se===a)break a;if(de===l&&++se===h&&(k=w),de===p&&++ye===c&&(G=w),(xe=Se.nextSibling)!==null)break;Se=de,de=Se.parentNode}Se=xe}l=k===-1||G===-1?null:{start:k,end:G}}else l=null}l=l||{start:0,end:0}}else l=null;for(xu={focusedElem:a,selectionRange:l},Gc=!1,ot=r;ot!==null;)if(r=ot,a=r.child,(r.subtreeFlags&1024)!==0&&a!==null)a.return=r,ot=a;else for(;ot!==null;){switch(r=ot,p=r.alternate,a=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&p!==null){a=void 0,l=r,h=p.memoizedProps,p=p.memoizedState,c=l.stateNode;try{var $e=rs(l.type,h,l.elementType===l.type);a=c.getSnapshotBeforeUpdate($e,p),c.__reactInternalSnapshotBeforeUpdate=a}catch(Xe){ja(l,l.return,Xe)}}break;case 3:if((a&1024)!==0){if(a=r.stateNode.containerInfo,l=a.nodeType,l===9)gu(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":gu(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=r.sibling,a!==null){a.return=r.return,ot=a;break}ot=r.return}}function r1(a,r,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:vn(a,l),c&4&&Yi(5,l);break;case 1:if(vn(a,l),c&4)if(a=l.stateNode,r===null)try{a.componentDidMount()}catch(w){ja(l,l.return,w)}else{var h=rs(l.type,r.memoizedProps);r=r.memoizedState;try{a.componentDidUpdate(h,r,a.__reactInternalSnapshotBeforeUpdate)}catch(w){ja(l,l.return,w)}}c&64&&Zh(l),c&512&&Xi(l,l.return);break;case 3:if(vn(a,l),c&64&&(a=l.updateQueue,a!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Bd(a,r)}catch(w){ja(l,l.return,w)}}break;case 27:r===null&&c&4&&a1(l);case 26:case 5:vn(a,l),r===null&&c&4&&Jh(l),c&512&&Xi(l,l.return);break;case 12:vn(a,l);break;case 13:vn(a,l),c&4&&i1(a,l),c&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=Nv.bind(null,l),Yv(a,l))));break;case 22:if(c=l.memoizedState!==null||Wr,!c){r=r!==null&&r.memoizedState!==null||Ka,h=Wr;var p=Ka;Wr=c,(Ka=r)&&!p?bn(a,l,(l.subtreeFlags&8772)!==0):vn(a,l),Wr=h,Ka=p}break;case 30:break;default:vn(a,l)}}function n1(a){var r=a.alternate;r!==null&&(a.alternate=null,n1(r)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(r=a.stateNode,r!==null&&F(r)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Ia=null,Mt=!1;function $r(a,r,l){for(l=l.child;l!==null;)s1(a,r,l),l=l.sibling}function s1(a,r,l){if(na&&typeof na.onCommitFiberUnmount=="function")try{na.onCommitFiberUnmount(ca,l)}catch{}switch(l.tag){case 26:Ka||kr(l,r),$r(a,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ka||kr(l,r);var c=Ia,h=Mt;Sn(l.type)&&(Ia=l.stateNode,Mt=!1),$r(a,r,l),al(l.stateNode),Ia=c,Mt=h;break;case 5:Ka||kr(l,r);case 6:if(c=Ia,h=Mt,Ia=null,$r(a,r,l),Ia=c,Mt=h,Ia!==null)if(Mt)try{(Ia.nodeType===9?Ia.body:Ia.nodeName==="HTML"?Ia.ownerDocument.body:Ia).removeChild(l.stateNode)}catch(p){ja(l,r,p)}else try{Ia.removeChild(l.stateNode)}catch(p){ja(l,r,p)}break;case 18:Ia!==null&&(Mt?(a=Ia,q1(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),ol(a)):q1(Ia,l.stateNode));break;case 4:c=Ia,h=Mt,Ia=l.stateNode.containerInfo,Mt=!0,$r(a,r,l),Ia=c,Mt=h;break;case 0:case 11:case 14:case 15:Ka||gn(2,l,r),Ka||gn(4,l,r),$r(a,r,l);break;case 1:Ka||(kr(l,r),c=l.stateNode,typeof c.componentWillUnmount=="function"&&Qh(l,r,c)),$r(a,r,l);break;case 21:$r(a,r,l);break;case 22:Ka=(c=Ka)||l.memoizedState!==null,$r(a,r,l),Ka=c;break;default:$r(a,r,l)}}function i1(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{ol(a)}catch(l){ja(r,r.return,l)}}function bv(a){switch(a.tag){case 13:case 19:var r=a.stateNode;return r===null&&(r=a.stateNode=new t1),r;case 22:return a=a.stateNode,r=a._retryCache,r===null&&(r=a._retryCache=new t1),r;default:throw Error(s(435,a.tag))}}function Go(a,r){var l=bv(a);r.forEach(function(c){var h=kv.bind(null,a,c);l.has(c)||(l.add(c),c.then(h,h))})}function Ht(a,r){var l=r.deletions;if(l!==null)for(var c=0;c<l.length;c++){var h=l[c],p=a,w=r,k=w;e:for(;k!==null;){switch(k.tag){case 27:if(Sn(k.type)){Ia=k.stateNode,Mt=!1;break e}break;case 5:Ia=k.stateNode,Mt=!1;break e;case 3:case 4:Ia=k.stateNode.containerInfo,Mt=!0;break e}k=k.return}if(Ia===null)throw Error(s(160));s1(p,w,h),Ia=null,Mt=!1,p=h.alternate,p!==null&&(p.return=null),h.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)l1(r,a),r=r.sibling}var gr=null;function l1(a,r){var l=a.alternate,c=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ht(r,a),zt(a),c&4&&(gn(3,a,a.return),Yi(3,a),gn(5,a,a.return));break;case 1:Ht(r,a),zt(a),c&512&&(Ka||l===null||kr(l,l.return)),c&64&&Wr&&(a=a.updateQueue,a!==null&&(c=a.callbacks,c!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var h=gr;if(Ht(r,a),zt(a),c&512&&(Ka||l===null||kr(l,l.return)),c&4){var p=l!==null?l.memoizedState:null;if(c=a.memoizedState,l===null)if(c===null)if(a.stateNode===null){e:{c=a.type,l=a.memoizedProps,h=h.ownerDocument||h;a:switch(c){case"title":p=h.getElementsByTagName("title")[0],(!p||p[O]||p[Xa]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=h.createElement(c),h.head.insertBefore(p,h.querySelector("head > title"))),mt(p,c,l),p[Xa]=a,te(p),c=p;break e;case"link":var w=ax("link","href",h).get(c+(l.href||""));if(w){for(var k=0;k<w.length;k++)if(p=w[k],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(k,1);break a}}p=h.createElement(c),mt(p,c,l),h.head.appendChild(p);break;case"meta":if(w=ax("meta","content",h).get(c+(l.content||""))){for(k=0;k<w.length;k++)if(p=w[k],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(k,1);break a}}p=h.createElement(c),mt(p,c,l),h.head.appendChild(p);break;default:throw Error(s(468,c))}p[Xa]=a,te(p),c=p}a.stateNode=c}else tx(h,a.type,a.stateNode);else a.stateNode=ex(h,c,a.memoizedProps);else p!==c?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,c===null?tx(h,a.type,a.stateNode):ex(h,c,a.memoizedProps)):c===null&&a.stateNode!==null&&Po(a,a.memoizedProps,l.memoizedProps)}break;case 27:Ht(r,a),zt(a),c&512&&(Ka||l===null||kr(l,l.return)),l!==null&&c&4&&Po(a,a.memoizedProps,l.memoizedProps);break;case 5:if(Ht(r,a),zt(a),c&512&&(Ka||l===null||kr(l,l.return)),a.flags&32){h=a.stateNode;try{Ns(h,"")}catch(xe){ja(a,a.return,xe)}}c&4&&a.stateNode!=null&&(h=a.memoizedProps,Po(a,h,l!==null?l.memoizedProps:h)),c&1024&&(Vo=!0);break;case 6:if(Ht(r,a),zt(a),c&4){if(a.stateNode===null)throw Error(s(162));c=a.memoizedProps,l=a.stateNode;try{l.nodeValue=c}catch(xe){ja(a,a.return,xe)}}break;case 3:if(Hc=null,h=gr,gr=Uc(r.containerInfo),Ht(r,a),gr=h,zt(a),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ol(r.containerInfo)}catch(xe){ja(a,a.return,xe)}Vo&&(Vo=!1,c1(a));break;case 4:c=gr,gr=Uc(a.stateNode.containerInfo),Ht(r,a),zt(a),gr=c;break;case 12:Ht(r,a),zt(a);break;case 13:Ht(r,a),zt(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&($o=ge()),c&4&&(c=a.updateQueue,c!==null&&(a.updateQueue=null,Go(a,c)));break;case 22:h=a.memoizedState!==null;var G=l!==null&&l.memoizedState!==null,se=Wr,ye=Ka;if(Wr=se||h,Ka=ye||G,Ht(r,a),Ka=ye,Wr=se,zt(a),c&8192)e:for(r=a.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(l===null||G||Wr||Ka||ns(a)),l=null,r=a;;){if(r.tag===5||r.tag===26){if(l===null){G=l=r;try{if(p=G.stateNode,h)w=p.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{k=G.stateNode;var Se=G.memoizedProps.style,de=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;k.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(xe){ja(G,G.return,xe)}}}else if(r.tag===6){if(l===null){G=r;try{G.stateNode.nodeValue=h?"":G.memoizedProps}catch(xe){ja(G,G.return,xe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===a)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=a.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Go(a,l))));break;case 19:Ht(r,a),zt(a),c&4&&(c=a.updateQueue,c!==null&&(a.updateQueue=null,Go(a,c)));break;case 30:break;case 21:break;default:Ht(r,a),zt(a)}}function zt(a){var r=a.flags;if(r&2){try{for(var l,c=a.return;c!==null;){if(e1(c)){l=c;break}c=c.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var h=l.stateNode,p=Ho(a);Ac(a,p,h);break;case 5:var w=l.stateNode;l.flags&32&&(Ns(w,""),l.flags&=-33);var k=Ho(a);Ac(a,k,w);break;case 3:case 4:var G=l.stateNode.containerInfo,se=Ho(a);zo(a,se,G);break;default:throw Error(s(161))}}catch(ye){ja(a,a.return,ye)}a.flags&=-3}r&4096&&(a.flags&=-4097)}function c1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var r=a;c1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),a=a.sibling}}function vn(a,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)r1(a,r.alternate,r),r=r.sibling}function ns(a){for(a=a.child;a!==null;){var r=a;switch(r.tag){case 0:case 11:case 14:case 15:gn(4,r,r.return),ns(r);break;case 1:kr(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Qh(r,r.return,l),ns(r);break;case 27:al(r.stateNode);case 26:case 5:kr(r,r.return),ns(r);break;case 22:r.memoizedState===null&&ns(r);break;case 30:ns(r);break;default:ns(r)}a=a.sibling}}function bn(a,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,h=a,p=r,w=p.flags;switch(p.tag){case 0:case 11:case 15:bn(h,p,l),Yi(4,p);break;case 1:if(bn(h,p,l),c=p,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(se){ja(c,c.return,se)}if(c=p,h=c.updateQueue,h!==null){var k=c.stateNode;try{var G=h.shared.hiddenCallbacks;if(G!==null)for(h.shared.hiddenCallbacks=null,h=0;h<G.length;h++)Id(G[h],k)}catch(se){ja(c,c.return,se)}}l&&w&64&&Zh(p),Xi(p,p.return);break;case 27:a1(p);case 26:case 5:bn(h,p,l),l&&c===null&&w&4&&Jh(p),Xi(p,p.return);break;case 12:bn(h,p,l);break;case 13:bn(h,p,l),l&&w&4&&i1(h,p);break;case 22:p.memoizedState===null&&bn(h,p,l),Xi(p,p.return);break;case 30:break;default:bn(h,p,l)}r=r.sibling}}function Yo(a,r){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&Di(l))}function Xo(a,r){a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&Di(a))}function Cr(a,r,l,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)o1(a,r,l,c),r=r.sibling}function o1(a,r,l,c){var h=r.flags;switch(r.tag){case 0:case 11:case 15:Cr(a,r,l,c),h&2048&&Yi(9,r);break;case 1:Cr(a,r,l,c);break;case 3:Cr(a,r,l,c),h&2048&&(a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&Di(a)));break;case 12:if(h&2048){Cr(a,r,l,c),a=r.stateNode;try{var p=r.memoizedProps,w=p.id,k=p.onPostCommit;typeof k=="function"&&k(w,r.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(G){ja(r,r.return,G)}}else Cr(a,r,l,c);break;case 13:Cr(a,r,l,c);break;case 23:break;case 22:p=r.stateNode,w=r.alternate,r.memoizedState!==null?p._visibility&2?Cr(a,r,l,c):qi(a,r):p._visibility&2?Cr(a,r,l,c):(p._visibility|=2,Xs(a,r,l,c,(r.subtreeFlags&10256)!==0)),h&2048&&Yo(w,r);break;case 24:Cr(a,r,l,c),h&2048&&Xo(r.alternate,r);break;default:Cr(a,r,l,c)}}function Xs(a,r,l,c,h){for(h=h&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var p=a,w=r,k=l,G=c,se=w.flags;switch(w.tag){case 0:case 11:case 15:Xs(p,w,k,G,h),Yi(8,w);break;case 23:break;case 22:var ye=w.stateNode;w.memoizedState!==null?ye._visibility&2?Xs(p,w,k,G,h):qi(p,w):(ye._visibility|=2,Xs(p,w,k,G,h)),h&&se&2048&&Yo(w.alternate,w);break;case 24:Xs(p,w,k,G,h),h&&se&2048&&Xo(w.alternate,w);break;default:Xs(p,w,k,G,h)}r=r.sibling}}function qi(a,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=a,c=r,h=c.flags;switch(c.tag){case 22:qi(l,c),h&2048&&Yo(c.alternate,c);break;case 24:qi(l,c),h&2048&&Xo(c.alternate,c);break;default:qi(l,c)}r=r.sibling}}var Ki=8192;function qs(a){if(a.subtreeFlags&Ki)for(a=a.child;a!==null;)u1(a),a=a.sibling}function u1(a){switch(a.tag){case 26:qs(a),a.flags&Ki&&a.memoizedState!==null&&nb(gr,a.memoizedState,a.memoizedProps);break;case 5:qs(a);break;case 3:case 4:var r=gr;gr=Uc(a.stateNode.containerInfo),qs(a),gr=r;break;case 22:a.memoizedState===null&&(r=a.alternate,r!==null&&r.memoizedState!==null?(r=Ki,Ki=16777216,qs(a),Ki=r):qs(a));break;default:qs(a)}}function f1(a){var r=a.alternate;if(r!==null&&(a=r.child,a!==null)){r.child=null;do r=a.sibling,a.sibling=null,a=r;while(a!==null)}}function Wi(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];ot=c,h1(c,a)}f1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)d1(a),a=a.sibling}function d1(a){switch(a.tag){case 0:case 11:case 15:Wi(a),a.flags&2048&&gn(9,a,a.return);break;case 3:Wi(a);break;case 12:Wi(a);break;case 22:var r=a.stateNode;a.memoizedState!==null&&r._visibility&2&&(a.return===null||a.return.tag!==13)?(r._visibility&=-3,Nc(a)):Wi(a);break;default:Wi(a)}}function Nc(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];ot=c,h1(c,a)}f1(a)}for(a=a.child;a!==null;){switch(r=a,r.tag){case 0:case 11:case 15:gn(8,r,r.return),Nc(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Nc(r));break;default:Nc(r)}a=a.sibling}}function h1(a,r){for(;ot!==null;){var l=ot;switch(l.tag){case 0:case 11:case 15:gn(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Di(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,ot=c;else e:for(l=a;ot!==null;){c=ot;var h=c.sibling,p=c.return;if(n1(c),c===l){ot=null;break e}if(h!==null){h.return=p,ot=h;break e}ot=p}}}var yv={getCacheForType:function(a){var r=bt(tt),l=r.data.get(a);return l===void 0&&(l=a(),r.data.set(a,l)),l}},Ev=typeof WeakMap=="function"?WeakMap:Map,Sa=0,La=null,da=null,pa=0,Aa=0,Vt=null,yn=!1,Ks=!1,qo=!1,Zr=0,Va=0,En=0,ss=0,Ko=0,sr=0,Ws=0,$i=null,It=null,Wo=!1,$o=0,kc=1/0,Cc=null,_n=null,xt=0,Tn=null,$s=null,Zs=0,Zo=0,Qo=null,x1=null,Zi=0,Jo=null;function Gt(){if((Sa&2)!==0&&pa!==0)return pa&-pa;if(Z.T!==null){var a=Bs;return a!==0?a:iu()}return ws()}function m1(){sr===0&&(sr=(pa&536870912)===0||Ta?Pn():536870912);var a=nr.current;return a!==null&&(a.flags|=32),sr}function Yt(a,r,l){(a===La&&(Aa===2||Aa===9)||a.cancelPendingCommit!==null)&&(Qs(a,0),wn(a,pa,sr,!1)),Sr(a,l),((Sa&2)===0||a!==La)&&(a===La&&((Sa&2)===0&&(ss|=l),Va===4&&wn(a,pa,sr,!1)),Or(a))}function p1(a,r,l){if((Sa&6)!==0)throw Error(s(327));var c=!l&&(r&124)===0&&(r&a.expiredLanes)===0||Ir(a,r),h=c?wv(a,r):tu(a,r,!0),p=c;do{if(h===0){Ks&&!c&&wn(a,r,0,!1);break}else{if(l=a.current.alternate,p&&!_v(l)){h=tu(a,r,!1),p=!1;continue}if(h===2){if(p=r,a.errorRecoveryDisabledLanes&p)var w=0;else w=a.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var k=a;h=$i;var G=k.current.memoizedState.isDehydrated;if(G&&(Qs(k,w).flags|=256),w=tu(k,w,!1),w!==2){if(qo&&!G){k.errorRecoveryDisabledLanes|=p,ss|=p,h=4;break e}p=It,It=h,p!==null&&(It===null?It=p:It.push.apply(It,p))}h=w}if(p=!1,h!==2)continue}}if(h===1){Qs(a,0),wn(a,r,0,!0);break}e:{switch(c=a,p=h,p){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:wn(c,r,sr,!yn);break e;case 2:It=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(h=$o+300-ge(),10<h)){if(wn(c,r,sr,!yn),sn(c,0,!0)!==0)break e;c.timeoutHandle=Y1(g1.bind(null,c,l,It,Cc,Wo,r,sr,ss,Ws,yn,p,2,-0,0),h);break e}g1(c,l,It,Cc,Wo,r,sr,ss,Ws,yn,p,0,-0,0)}}break}while(!0);Or(a)}function g1(a,r,l,c,h,p,w,k,G,se,ye,Se,de,xe){if(a.timeoutHandle=-1,Se=r.subtreeFlags,(Se&8192||(Se&16785408)===16785408)&&(nl={stylesheets:null,count:0,unsuspend:rb},u1(r),Se=sb(),Se!==null)){a.cancelPendingCommit=Se(w1.bind(null,a,r,p,l,c,h,w,k,G,ye,1,de,xe)),wn(a,p,w,!se);return}w1(a,r,p,l,c,h,w,k,G)}function _v(a){for(var r=a;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var h=l[c],p=h.getSnapshot;h=h.value;try{if(!Ut(p(),h))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function wn(a,r,l,c){r&=~Ko,r&=~ss,a.suspendedLanes|=r,a.pingedLanes&=~r,c&&(a.warmLanes|=r),c=a.expirationTimes;for(var h=r;0<h;){var p=31-Qe(h),w=1<<p;c[p]=-1,h&=~w}l!==0&&_s(a,l,r)}function Oc(){return(Sa&6)===0?(Qi(0),!1):!0}function eu(){if(da!==null){if(Aa===0)var a=da.return;else a=da,Vr=Jn=null,go(a),Gs=null,zi=0,a=da;for(;a!==null;)$h(a.alternate,a),a=a.return;da=null}}function Qs(a,r){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,Pv(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),eu(),La=a,da=l=Pr(a.current,null),pa=r,Aa=0,Vt=null,yn=!1,Ks=Ir(a,r),qo=!1,Ws=sr=Ko=ss=En=Va=0,It=$i=null,Wo=!1,(r&8)!==0&&(r|=r&32);var c=a.entangledLanes;if(c!==0)for(a=a.entanglements,c&=r;0<c;){var h=31-Qe(c),p=1<<h;r|=a[h],c&=~p}return Zr=r,Ql(),l}function v1(a,r){ua=null,Z.H=gc,r===ji||r===lc?(r=Ld(),Aa=3):r===Rd?(r=Ld(),Aa=4):Aa=r===Mh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Vt=r,da===null&&(Va=1,_c(a,er(r,a.current)))}function b1(){var a=Z.H;return Z.H=gc,a===null?gc:a}function y1(){var a=Z.A;return Z.A=yv,a}function au(){Va=4,yn||(pa&4194048)!==pa&&nr.current!==null||(Ks=!0),(En&134217727)===0&&(ss&134217727)===0||La===null||wn(La,pa,sr,!1)}function tu(a,r,l){var c=Sa;Sa|=2;var h=b1(),p=y1();(La!==a||pa!==r)&&(Cc=null,Qs(a,r)),r=!1;var w=Va;e:do try{if(Aa!==0&&da!==null){var k=da,G=Vt;switch(Aa){case 8:eu(),w=6;break e;case 3:case 2:case 9:case 6:nr.current===null&&(r=!0);var se=Aa;if(Aa=0,Vt=null,Js(a,k,G,se),l&&Ks){w=0;break e}break;default:se=Aa,Aa=0,Vt=null,Js(a,k,G,se)}}Tv(),w=Va;break}catch(ye){v1(a,ye)}while(!0);return r&&a.shellSuspendCounter++,Vr=Jn=null,Sa=c,Z.H=h,Z.A=p,da===null&&(La=null,pa=0,Ql()),w}function Tv(){for(;da!==null;)E1(da)}function wv(a,r){var l=Sa;Sa|=2;var c=b1(),h=y1();La!==a||pa!==r?(Cc=null,kc=ge()+500,Qs(a,r)):Ks=Ir(a,r);e:do try{if(Aa!==0&&da!==null){r=da;var p=Vt;a:switch(Aa){case 1:Aa=0,Vt=null,Js(a,r,p,1);break;case 2:case 9:if(jd(p)){Aa=0,Vt=null,_1(r);break}r=function(){Aa!==2&&Aa!==9||La!==a||(Aa=7),Or(a)},p.then(r,r);break e;case 3:Aa=7;break e;case 4:Aa=5;break e;case 7:jd(p)?(Aa=0,Vt=null,_1(r)):(Aa=0,Vt=null,Js(a,r,p,7));break;case 5:var w=null;switch(da.tag){case 26:w=da.memoizedState;case 5:case 27:var k=da;if(!w||rx(w)){Aa=0,Vt=null;var G=k.sibling;if(G!==null)da=G;else{var se=k.return;se!==null?(da=se,Dc(se)):da=null}break a}}Aa=0,Vt=null,Js(a,r,p,5);break;case 6:Aa=0,Vt=null,Js(a,r,p,6);break;case 8:eu(),Va=6;break e;default:throw Error(s(462))}}Sv();break}catch(ye){v1(a,ye)}while(!0);return Vr=Jn=null,Z.H=c,Z.A=h,Sa=l,da!==null?0:(La=null,pa=0,Ql(),Va)}function Sv(){for(;da!==null&&!We();)E1(da)}function E1(a){var r=Kh(a.alternate,a,Zr);a.memoizedProps=a.pendingProps,r===null?Dc(a):da=r}function _1(a){var r=a,l=r.alternate;switch(r.tag){case 15:case 0:r=zh(l,r,r.pendingProps,r.type,void 0,pa);break;case 11:r=zh(l,r,r.pendingProps,r.type.render,r.ref,pa);break;case 5:go(r);default:$h(l,r),r=da=Td(r,Zr),r=Kh(l,r,Zr)}a.memoizedProps=a.pendingProps,r===null?Dc(a):da=r}function Js(a,r,l,c){Vr=Jn=null,go(r),Gs=null,zi=0;var h=r.return;try{if(xv(a,h,r,l,pa)){Va=1,_c(a,er(l,a.current)),da=null;return}}catch(p){if(h!==null)throw da=h,p;Va=1,_c(a,er(l,a.current)),da=null;return}r.flags&32768?(Ta||c===1?a=!0:Ks||(pa&536870912)!==0?a=!1:(yn=a=!0,(c===2||c===9||c===3||c===6)&&(c=nr.current,c!==null&&c.tag===13&&(c.flags|=16384))),T1(r,a)):Dc(r)}function Dc(a){var r=a;do{if((r.flags&32768)!==0){T1(r,yn);return}a=r.return;var l=pv(r.alternate,r,Zr);if(l!==null){da=l;return}if(r=r.sibling,r!==null){da=r;return}da=r=a}while(r!==null);Va===0&&(Va=5)}function T1(a,r){do{var l=gv(a.alternate,a);if(l!==null){l.flags&=32767,da=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(a=a.sibling,a!==null)){da=a;return}da=a=l}while(a!==null);Va=6,da=null}function w1(a,r,l,c,h,p,w,k,G){a.cancelPendingCommit=null;do Rc();while(xt!==0);if((Sa&6)!==0)throw Error(s(327));if(r!==null){if(r===a.current)throw Error(s(177));if(p=r.lanes|r.childLanes,p|=Y0,ln(a,l,p,w,k,G),a===La&&(da=La=null,pa=0),$s=r,Tn=a,Zs=l,Zo=p,Qo=h,x1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,Cv(Fe,function(){return C1(),null})):(a.callbackNode=null,a.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,h=oe.p,oe.p=2,w=Sa,Sa|=4;try{vv(a,r,l)}finally{Sa=w,oe.p=h,Z.T=c}}xt=1,S1(),A1(),N1()}}function S1(){if(xt===1){xt=0;var a=Tn,r=$s,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Z.T,Z.T=null;var c=oe.p;oe.p=2;var h=Sa;Sa|=4;try{l1(r,a);var p=xu,w=hd(a.containerInfo),k=p.focusedElem,G=p.selectionRange;if(w!==k&&k&&k.ownerDocument&&dd(k.ownerDocument.documentElement,k)){if(G!==null&&P0(k)){var se=G.start,ye=G.end;if(ye===void 0&&(ye=se),"selectionStart"in k)k.selectionStart=se,k.selectionEnd=Math.min(ye,k.value.length);else{var Se=k.ownerDocument||document,de=Se&&Se.defaultView||window;if(de.getSelection){var xe=de.getSelection(),$e=k.textContent.length,Xe=Math.min(G.start,$e),Ra=G.end===void 0?Xe:Math.min(G.end,$e);!xe.extend&&Xe>Ra&&(w=Ra,Ra=Xe,Xe=w);var ae=fd(k,Xe),Q=fd(k,Ra);if(ae&&Q&&(xe.rangeCount!==1||xe.anchorNode!==ae.node||xe.anchorOffset!==ae.offset||xe.focusNode!==Q.node||xe.focusOffset!==Q.offset)){var ne=Se.createRange();ne.setStart(ae.node,ae.offset),xe.removeAllRanges(),Xe>Ra?(xe.addRange(ne),xe.extend(Q.node,Q.offset)):(ne.setEnd(Q.node,Q.offset),xe.addRange(ne))}}}}for(Se=[],xe=k;xe=xe.parentNode;)xe.nodeType===1&&Se.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<Se.length;k++){var _e=Se[k];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}Gc=!!hu,xu=hu=null}finally{Sa=h,oe.p=c,Z.T=l}}a.current=r,xt=2}}function A1(){if(xt===2){xt=0;var a=Tn,r=$s,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Z.T,Z.T=null;var c=oe.p;oe.p=2;var h=Sa;Sa|=4;try{r1(a,r.alternate,r)}finally{Sa=h,oe.p=c,Z.T=l}}xt=3}}function N1(){if(xt===4||xt===3){xt=0,Ve();var a=Tn,r=$s,l=Zs,c=x1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?xt=5:(xt=0,$s=Tn=null,k1(a,a.pendingLanes));var h=a.pendingLanes;if(h===0&&(_n=null),Ha(l),r=r.stateNode,na&&typeof na.onCommitFiberRoot=="function")try{na.onCommitFiberRoot(ca,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Z.T,h=oe.p,oe.p=2,Z.T=null;try{for(var p=a.onRecoverableError,w=0;w<c.length;w++){var k=c[w];p(k.value,{componentStack:k.stack})}}finally{Z.T=r,oe.p=h}}(Zs&3)!==0&&Rc(),Or(a),h=a.pendingLanes,(l&4194090)!==0&&(h&42)!==0?a===Jo?Zi++:(Zi=0,Jo=a):Zi=0,Qi(0)}}function k1(a,r){(a.pooledCacheLanes&=r)===0&&(r=a.pooledCache,r!=null&&(a.pooledCache=null,Di(r)))}function Rc(a){return S1(),A1(),N1(),C1()}function C1(){if(xt!==5)return!1;var a=Tn,r=Zo;Zo=0;var l=Ha(Zs),c=Z.T,h=oe.p;try{oe.p=32>l?32:l,Z.T=null,l=Qo,Qo=null;var p=Tn,w=Zs;if(xt=0,$s=Tn=null,Zs=0,(Sa&6)!==0)throw Error(s(331));var k=Sa;if(Sa|=4,d1(p.current),o1(p,p.current,w,l),Sa=k,Qi(0,!1),na&&typeof na.onPostCommitFiberRoot=="function")try{na.onPostCommitFiberRoot(ca,p)}catch{}return!0}finally{oe.p=h,Z.T=c,k1(a,r)}}function O1(a,r,l){r=er(l,r),r=Do(a.stateNode,r,2),a=hn(a,r,2),a!==null&&(Sr(a,2),Or(a))}function ja(a,r,l){if(a.tag===3)O1(a,a,l);else for(;r!==null;){if(r.tag===3){O1(r,a,l);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(_n===null||!_n.has(c))){a=er(l,a),l=Fh(2),c=hn(r,l,2),c!==null&&(Lh(l,c,r,a),Sr(c,2),Or(c));break}}r=r.return}}function ru(a,r,l){var c=a.pingCache;if(c===null){c=a.pingCache=new Ev;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(l)||(qo=!0,h.add(l),a=Av.bind(null,a,r,l),r.then(a,a))}function Av(a,r,l){var c=a.pingCache;c!==null&&c.delete(r),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,La===a&&(pa&l)===l&&(Va===4||Va===3&&(pa&62914560)===pa&&300>ge()-$o?(Sa&2)===0&&Qs(a,0):Ko|=l,Ws===pa&&(Ws=0)),Or(a)}function D1(a,r){r===0&&(r=Hn()),a=Fs(a,r),a!==null&&(Sr(a,r),Or(a))}function Nv(a){var r=a.memoizedState,l=0;r!==null&&(l=r.retryLane),D1(a,l)}function kv(a,r){var l=0;switch(a.tag){case 13:var c=a.stateNode,h=a.memoizedState;h!==null&&(l=h.retryLane);break;case 19:c=a.stateNode;break;case 22:c=a.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(r),D1(a,l)}function Cv(a,r){return Pe(a,r)}var jc=null,ei=null,nu=!1,Fc=!1,su=!1,is=0;function Or(a){a!==ei&&a.next===null&&(ei===null?jc=ei=a:ei=ei.next=a),Fc=!0,nu||(nu=!0,Dv())}function Qi(a,r){if(!su&&Fc){su=!0;do for(var l=!1,c=jc;c!==null;){if(a!==0){var h=c.pendingLanes;if(h===0)var p=0;else{var w=c.suspendedLanes,k=c.pingedLanes;p=(1<<31-Qe(42|a)+1)-1,p&=h&~(w&~k),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,L1(c,p))}else p=pa,p=sn(c,c===La?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Ir(c,p)||(l=!0,L1(c,p));c=c.next}while(l);su=!1}}function Ov(){R1()}function R1(){Fc=nu=!1;var a=0;is!==0&&(Uv()&&(a=is),is=0);for(var r=ge(),l=null,c=jc;c!==null;){var h=c.next,p=j1(c,r);p===0?(c.next=null,l===null?jc=h:l.next=h,h===null&&(ei=l)):(l=c,(a!==0||(p&3)!==0)&&(Fc=!0)),c=h}Qi(a)}function j1(a,r){for(var l=a.suspendedLanes,c=a.pingedLanes,h=a.expirationTimes,p=a.pendingLanes&-62914561;0<p;){var w=31-Qe(p),k=1<<w,G=h[w];G===-1?((k&l)===0||(k&c)!==0)&&(h[w]=Es(k,r)):G<=r&&(a.expiredLanes|=k),p&=~k}if(r=La,l=pa,l=sn(a,a===r?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),c=a.callbackNode,l===0||a===r&&(Aa===2||Aa===9)||a.cancelPendingCommit!==null)return c!==null&&c!==null&&Ue(c),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||Ir(a,l)){if(r=l&-l,r===a.callbackPriority)return r;switch(c!==null&&Ue(c),Ha(l)){case 2:case 8:l=we;break;case 32:l=Fe;break;case 268435456:l=Ge;break;default:l=Fe}return c=F1.bind(null,a),l=Pe(l,c),a.callbackPriority=r,a.callbackNode=l,r}return c!==null&&c!==null&&Ue(c),a.callbackPriority=2,a.callbackNode=null,2}function F1(a,r){if(xt!==0&&xt!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Rc()&&a.callbackNode!==l)return null;var c=pa;return c=sn(a,a===La?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),c===0?null:(p1(a,c,r),j1(a,ge()),a.callbackNode!=null&&a.callbackNode===l?F1.bind(null,a):null)}function L1(a,r){if(Rc())return null;p1(a,r,!0)}function Dv(){Hv(function(){(Sa&6)!==0?Pe(ma,Ov):R1()})}function iu(){return is===0&&(is=Pn()),is}function M1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Yl(""+a)}function I1(a,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,a.id&&l.setAttribute("form",a.id),r.parentNode.insertBefore(l,r),a=new FormData(a),l.parentNode.removeChild(l),a}function Rv(a,r,l,c,h){if(r==="submit"&&l&&l.stateNode===h){var p=M1((h[$a]||null).action),w=c.submitter;w&&(r=(r=w[$a]||null)?M1(r.formAction):w.getAttribute("formAction"),r!==null&&(p=r,w=null));var k=new Wl("action","action",null,c,h);a.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(is!==0){var G=w?I1(h,w):new FormData(h);Ao(l,{pending:!0,data:G,method:h.method,action:p},null,G)}}else typeof p=="function"&&(k.preventDefault(),G=w?I1(h,w):new FormData(h),Ao(l,{pending:!0,data:G,method:h.method,action:p},p,G))},currentTarget:h}]})}}for(var lu=0;lu<G0.length;lu++){var cu=G0[lu],jv=cu.toLowerCase(),Fv=cu[0].toUpperCase()+cu.slice(1);pr(jv,"on"+Fv)}pr(pd,"onAnimationEnd"),pr(gd,"onAnimationIteration"),pr(vd,"onAnimationStart"),pr("dblclick","onDoubleClick"),pr("focusin","onFocus"),pr("focusout","onBlur"),pr(Z2,"onTransitionRun"),pr(Q2,"onTransitionStart"),pr(J2,"onTransitionCancel"),pr(bd,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),Ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ji));function B1(a,r){r=(r&4)!==0;for(var l=0;l<a.length;l++){var c=a[l],h=c.event;c=c.listeners;e:{var p=void 0;if(r)for(var w=c.length-1;0<=w;w--){var k=c[w],G=k.instance,se=k.currentTarget;if(k=k.listener,G!==p&&h.isPropagationStopped())break e;p=k,h.currentTarget=se;try{p(h)}catch(ye){Ec(ye)}h.currentTarget=null,p=G}else for(w=0;w<c.length;w++){if(k=c[w],G=k.instance,se=k.currentTarget,k=k.listener,G!==p&&h.isPropagationStopped())break e;p=k,h.currentTarget=se;try{p(h)}catch(ye){Ec(ye)}h.currentTarget=null,p=G}}}}function ha(a,r){var l=r[Ye];l===void 0&&(l=r[Ye]=new Set);var c=a+"__bubble";l.has(c)||(U1(r,a,2,!1),l.add(c))}function ou(a,r,l){var c=0;r&&(c|=4),U1(l,a,c,r)}var Lc="_reactListening"+Math.random().toString(36).slice(2);function uu(a){if(!a[Lc]){a[Lc]=!0,fe.forEach(function(l){l!=="selectionchange"&&(Lv.has(l)||ou(l,!1,a),ou(l,!0,a))});var r=a.nodeType===9?a:a.ownerDocument;r===null||r[Lc]||(r[Lc]=!0,ou("selectionchange",!1,r))}}function U1(a,r,l,c){switch(ox(r)){case 2:var h=cb;break;case 8:h=ob;break;default:h=wu}l=h.bind(null,r,l,a),h=void 0,!D0||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?a.addEventListener(r,l,{capture:!0,passive:h}):a.addEventListener(r,l,!0):h!==void 0?a.addEventListener(r,l,{passive:h}):a.addEventListener(r,l,!1)}function fu(a,r,l,c,h){var p=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var k=c.stateNode.containerInfo;if(k===h)break;if(w===4)for(w=c.return;w!==null;){var G=w.tag;if((G===3||G===4)&&w.stateNode.containerInfo===h)return;w=w.return}for(;k!==null;){if(w=M(k),w===null)return;if(G=w.tag,G===5||G===6||G===26||G===27){c=p=w;continue e}k=k.parentNode}}c=c.return}Xf(function(){var se=p,ye=C0(l),Se=[];e:{var de=yd.get(a);if(de!==void 0){var xe=Wl,$e=a;switch(a){case"keypress":if(ql(l)===0)break e;case"keydown":case"keyup":xe=C2;break;case"focusin":$e="focus",xe=L0;break;case"focusout":$e="blur",xe=L0;break;case"beforeblur":case"afterblur":xe=L0;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Wf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=g2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=R2;break;case pd:case gd:case vd:xe=y2;break;case bd:xe=F2;break;case"scroll":case"scrollend":xe=m2;break;case"wheel":xe=M2;break;case"copy":case"cut":case"paste":xe=_2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Zf;break;case"toggle":case"beforetoggle":xe=B2}var Xe=(r&4)!==0,Ra=!Xe&&(a==="scroll"||a==="scrollend"),ae=Xe?de!==null?de+"Capture":null:de;Xe=[];for(var Q=se,ne;Q!==null;){var _e=Q;if(ne=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||ne===null||ae===null||(_e=vi(Q,ae),_e!=null&&Xe.push(el(Q,_e,ne))),Ra)break;Q=Q.return}0<Xe.length&&(de=new xe(de,$e,null,l,ye),Se.push({event:de,listeners:Xe}))}}if((r&7)===0){e:{if(de=a==="mouseover"||a==="pointerover",xe=a==="mouseout"||a==="pointerout",de&&l!==k0&&($e=l.relatedTarget||l.fromElement)&&(M($e)||$e[hr]))break e;if((xe||de)&&(de=ye.window===ye?ye:(de=ye.ownerDocument)?de.defaultView||de.parentWindow:window,xe?($e=l.relatedTarget||l.toElement,xe=se,$e=$e?M($e):null,$e!==null&&(Ra=o($e),Xe=$e.tag,$e!==Ra||Xe!==5&&Xe!==27&&Xe!==6)&&($e=null)):(xe=null,$e=se),xe!==$e)){if(Xe=Wf,_e="onMouseLeave",ae="onMouseEnter",Q="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=Zf,_e="onPointerLeave",ae="onPointerEnter",Q="pointer"),Ra=xe==null?de:le(xe),ne=$e==null?de:le($e),de=new Xe(_e,Q+"leave",xe,l,ye),de.target=Ra,de.relatedTarget=ne,_e=null,M(ye)===se&&(Xe=new Xe(ae,Q+"enter",$e,l,ye),Xe.target=ne,Xe.relatedTarget=Ra,_e=Xe),Ra=_e,xe&&$e)a:{for(Xe=xe,ae=$e,Q=0,ne=Xe;ne;ne=ai(ne))Q++;for(ne=0,_e=ae;_e;_e=ai(_e))ne++;for(;0<Q-ne;)Xe=ai(Xe),Q--;for(;0<ne-Q;)ae=ai(ae),ne--;for(;Q--;){if(Xe===ae||ae!==null&&Xe===ae.alternate)break a;Xe=ai(Xe),ae=ai(ae)}Xe=null}else Xe=null;xe!==null&&P1(Se,de,xe,Xe,!1),$e!==null&&Ra!==null&&P1(Se,Ra,$e,Xe,!0)}}e:{if(de=se?le(se):window,xe=de.nodeName&&de.nodeName.toLowerCase(),xe==="select"||xe==="input"&&de.type==="file")var Me=sd;else if(rd(de))if(id)Me=K2;else{Me=X2;var fa=Y2}else xe=de.nodeName,!xe||xe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?se&&N0(se.elementType)&&(Me=sd):Me=q2;if(Me&&(Me=Me(a,se))){nd(Se,Me,l,ye);break e}fa&&fa(a,de,se),a==="focusout"&&se&&de.type==="number"&&se.memoizedProps.value!=null&&A0(de,"number",de.value)}switch(fa=se?le(se):window,a){case"focusin":(rd(fa)||fa.contentEditable==="true")&&(Ds=fa,H0=se,Ai=null);break;case"focusout":Ai=H0=Ds=null;break;case"mousedown":z0=!0;break;case"contextmenu":case"mouseup":case"dragend":z0=!1,xd(Se,l,ye);break;case"selectionchange":if($2)break;case"keydown":case"keyup":xd(Se,l,ye)}var He;if(I0)e:{switch(a){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Os?ad(a,l)&&(qe="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(qe="onCompositionStart");qe&&(Qf&&l.locale!=="ko"&&(Os||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Os&&(He=qf()):(on=ye,R0="value"in on?on.value:on.textContent,Os=!0)),fa=Mc(se,qe),0<fa.length&&(qe=new $f(qe,a,null,l,ye),Se.push({event:qe,listeners:fa}),He?qe.data=He:(He=td(l),He!==null&&(qe.data=He)))),(He=P2?H2(a,l):z2(a,l))&&(qe=Mc(se,"onBeforeInput"),0<qe.length&&(fa=new $f("onBeforeInput","beforeinput",null,l,ye),Se.push({event:fa,listeners:qe}),fa.data=He)),Rv(Se,a,se,l,ye)}B1(Se,r)})}function el(a,r,l){return{instance:a,listener:r,currentTarget:l}}function Mc(a,r){for(var l=r+"Capture",c=[];a!==null;){var h=a,p=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||p===null||(h=vi(a,l),h!=null&&c.unshift(el(a,h,p)),h=vi(a,r),h!=null&&c.push(el(a,h,p))),a.tag===3)return c;a=a.return}return[]}function ai(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function P1(a,r,l,c,h){for(var p=r._reactName,w=[];l!==null&&l!==c;){var k=l,G=k.alternate,se=k.stateNode;if(k=k.tag,G!==null&&G===c)break;k!==5&&k!==26&&k!==27||se===null||(G=se,h?(se=vi(l,p),se!=null&&w.unshift(el(l,se,G))):h||(se=vi(l,p),se!=null&&w.push(el(l,se,G)))),l=l.return}w.length!==0&&a.push({event:r,listeners:w})}var Mv=/\r\n?/g,Iv=/\u0000|\uFFFD/g;function H1(a){return(typeof a=="string"?a:""+a).replace(Mv,`
`).replace(Iv,"")}function z1(a,r){return r=H1(r),H1(a)===r}function Ic(){}function Da(a,r,l,c,h,p){switch(l){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ns(a,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ns(a,""+c);break;case"className":Ca(a,"class",c);break;case"tabIndex":Ca(a,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ca(a,l,c);break;case"style":Gf(a,c,p);break;case"data":if(r!=="object"){Ca(a,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||l!=="href")){a.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){a.removeAttribute(l);break}c=Yl(""+c),a.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(r!=="input"&&Da(a,r,"name",h.name,h,null),Da(a,r,"formEncType",h.formEncType,h,null),Da(a,r,"formMethod",h.formMethod,h,null),Da(a,r,"formTarget",h.formTarget,h,null)):(Da(a,r,"encType",h.encType,h,null),Da(a,r,"method",h.method,h,null),Da(a,r,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){a.removeAttribute(l);break}c=Yl(""+c),a.setAttribute(l,c);break;case"onClick":c!=null&&(a.onclick=Ic);break;case"onScroll":c!=null&&ha("scroll",a);break;case"onScrollEnd":c!=null&&ha("scrollend",a);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(h.children!=null)throw Error(s(60));a.innerHTML=l}}break;case"multiple":a.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":a.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){a.removeAttribute("xlink:href");break}l=Yl(""+c),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,""+c):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":c===!0?a.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?a.setAttribute(l,c):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?a.setAttribute(l,c):a.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?a.removeAttribute(l):a.setAttribute(l,c);break;case"popover":ha("beforetoggle",a),ha("toggle",a),ka(a,"popover",c);break;case"xlinkActuate":Fa(a,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Fa(a,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Fa(a,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Fa(a,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Fa(a,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Fa(a,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Fa(a,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Fa(a,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Fa(a,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ka(a,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=h2.get(l)||l,ka(a,l,c))}}function du(a,r,l,c,h,p){switch(l){case"style":Gf(a,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(h.children!=null)throw Error(s(60));a.innerHTML=l}}break;case"children":typeof c=="string"?Ns(a,c):(typeof c=="number"||typeof c=="bigint")&&Ns(a,""+c);break;case"onScroll":c!=null&&ha("scroll",a);break;case"onScrollEnd":c!=null&&ha("scrollend",a);break;case"onClick":c!=null&&(a.onclick=Ic);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!he.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(h=l.endsWith("Capture"),r=l.slice(2,h?l.length-7:void 0),p=a[$a]||null,p=p!=null?p[l]:null,typeof p=="function"&&a.removeEventListener(r,p,h),typeof c=="function")){typeof p!="function"&&p!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(r,c,h);break e}l in a?a[l]=c:c===!0?a.setAttribute(l,""):ka(a,l,c)}}}function mt(a,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ha("error",a),ha("load",a);var c=!1,h=!1,p;for(p in l)if(l.hasOwnProperty(p)){var w=l[p];if(w!=null)switch(p){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Da(a,r,p,w,l,null)}}h&&Da(a,r,"srcSet",l.srcSet,l,null),c&&Da(a,r,"src",l.src,l,null);return;case"input":ha("invalid",a);var k=p=w=h=null,G=null,se=null;for(c in l)if(l.hasOwnProperty(c)){var ye=l[c];if(ye!=null)switch(c){case"name":h=ye;break;case"type":w=ye;break;case"checked":G=ye;break;case"defaultChecked":se=ye;break;case"value":p=ye;break;case"defaultValue":k=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(s(137,r));break;default:Da(a,r,c,ye,l,null)}}Pf(a,p,k,G,se,w,h,!1),Vl(a);return;case"select":ha("invalid",a),c=w=p=null;for(h in l)if(l.hasOwnProperty(h)&&(k=l[h],k!=null))switch(h){case"value":p=k;break;case"defaultValue":w=k;break;case"multiple":c=k;default:Da(a,r,h,k,l,null)}r=p,l=w,a.multiple=!!c,r!=null?As(a,!!c,r,!1):l!=null&&As(a,!!c,l,!0);return;case"textarea":ha("invalid",a),p=h=c=null;for(w in l)if(l.hasOwnProperty(w)&&(k=l[w],k!=null))switch(w){case"value":c=k;break;case"defaultValue":h=k;break;case"children":p=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(s(91));break;default:Da(a,r,w,k,l,null)}zf(a,c,h,p),Vl(a);return;case"option":for(G in l)if(l.hasOwnProperty(G)&&(c=l[G],c!=null))switch(G){case"selected":a.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Da(a,r,G,c,l,null)}return;case"dialog":ha("beforetoggle",a),ha("toggle",a),ha("cancel",a),ha("close",a);break;case"iframe":case"object":ha("load",a);break;case"video":case"audio":for(c=0;c<Ji.length;c++)ha(Ji[c],a);break;case"image":ha("error",a),ha("load",a);break;case"details":ha("toggle",a);break;case"embed":case"source":case"link":ha("error",a),ha("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in l)if(l.hasOwnProperty(se)&&(c=l[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Da(a,r,se,c,l,null)}return;default:if(N0(r)){for(ye in l)l.hasOwnProperty(ye)&&(c=l[ye],c!==void 0&&du(a,r,ye,c,l,void 0));return}}for(k in l)l.hasOwnProperty(k)&&(c=l[k],c!=null&&Da(a,r,k,c,l,null))}function Bv(a,r,l,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,p=null,w=null,k=null,G=null,se=null,ye=null;for(xe in l){var Se=l[xe];if(l.hasOwnProperty(xe)&&Se!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":G=Se;default:c.hasOwnProperty(xe)||Da(a,r,xe,null,c,Se)}}for(var de in c){var xe=c[de];if(Se=l[de],c.hasOwnProperty(de)&&(xe!=null||Se!=null))switch(de){case"type":p=xe;break;case"name":h=xe;break;case"checked":se=xe;break;case"defaultChecked":ye=xe;break;case"value":w=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(s(137,r));break;default:xe!==Se&&Da(a,r,de,xe,c,Se)}}S0(a,w,k,G,se,ye,p,h);return;case"select":xe=w=k=de=null;for(p in l)if(G=l[p],l.hasOwnProperty(p)&&G!=null)switch(p){case"value":break;case"multiple":xe=G;default:c.hasOwnProperty(p)||Da(a,r,p,null,c,G)}for(h in c)if(p=c[h],G=l[h],c.hasOwnProperty(h)&&(p!=null||G!=null))switch(h){case"value":de=p;break;case"defaultValue":k=p;break;case"multiple":w=p;default:p!==G&&Da(a,r,h,p,c,G)}r=k,l=w,c=xe,de!=null?As(a,!!l,de,!1):!!c!=!!l&&(r!=null?As(a,!!l,r,!0):As(a,!!l,l?[]:"",!1));return;case"textarea":xe=de=null;for(k in l)if(h=l[k],l.hasOwnProperty(k)&&h!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Da(a,r,k,null,c,h)}for(w in c)if(h=c[w],p=l[w],c.hasOwnProperty(w)&&(h!=null||p!=null))switch(w){case"value":de=h;break;case"defaultValue":xe=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==p&&Da(a,r,w,h,c,p)}Hf(a,de,xe);return;case"option":for(var $e in l)if(de=l[$e],l.hasOwnProperty($e)&&de!=null&&!c.hasOwnProperty($e))switch($e){case"selected":a.selected=!1;break;default:Da(a,r,$e,null,c,de)}for(G in c)if(de=c[G],xe=l[G],c.hasOwnProperty(G)&&de!==xe&&(de!=null||xe!=null))switch(G){case"selected":a.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:Da(a,r,G,de,c,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)de=l[Xe],l.hasOwnProperty(Xe)&&de!=null&&!c.hasOwnProperty(Xe)&&Da(a,r,Xe,null,c,de);for(se in c)if(de=c[se],xe=l[se],c.hasOwnProperty(se)&&de!==xe&&(de!=null||xe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(s(137,r));break;default:Da(a,r,se,de,c,xe)}return;default:if(N0(r)){for(var Ra in l)de=l[Ra],l.hasOwnProperty(Ra)&&de!==void 0&&!c.hasOwnProperty(Ra)&&du(a,r,Ra,void 0,c,de);for(ye in c)de=c[ye],xe=l[ye],!c.hasOwnProperty(ye)||de===xe||de===void 0&&xe===void 0||du(a,r,ye,de,c,xe);return}}for(var ae in l)de=l[ae],l.hasOwnProperty(ae)&&de!=null&&!c.hasOwnProperty(ae)&&Da(a,r,ae,null,c,de);for(Se in c)de=c[Se],xe=l[Se],!c.hasOwnProperty(Se)||de===xe||de==null&&xe==null||Da(a,r,Se,de,c,xe)}var hu=null,xu=null;function Bc(a){return a.nodeType===9?a:a.ownerDocument}function V1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function G1(a,r){if(a===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&r==="foreignObject"?0:a}function mu(a,r){return a==="textarea"||a==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var pu=null;function Uv(){var a=window.event;return a&&a.type==="popstate"?a===pu?!1:(pu=a,!0):(pu=null,!1)}var Y1=typeof setTimeout=="function"?setTimeout:void 0,Pv=typeof clearTimeout=="function"?clearTimeout:void 0,X1=typeof Promise=="function"?Promise:void 0,Hv=typeof queueMicrotask=="function"?queueMicrotask:typeof X1<"u"?function(a){return X1.resolve(null).then(a).catch(zv)}:Y1;function zv(a){setTimeout(function(){throw a})}function Sn(a){return a==="head"}function q1(a,r){var l=r,c=0,h=0;do{var p=l.nextSibling;if(a.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(0<c&&8>c){l=c;var w=a.ownerDocument;if(l&1&&al(w.documentElement),l&2&&al(w.body),l&4)for(l=w.head,al(l),w=l.firstChild;w;){var k=w.nextSibling,G=w.nodeName;w[O]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=k}}if(h===0){a.removeChild(p),ol(r);return}h--}else l==="$"||l==="$?"||l==="$!"?h++:c=l.charCodeAt(0)-48;else c=0;l=p}while(l);ol(r)}function gu(a){var r=a.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":gu(l),F(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function Vv(a,r,l,c){for(;a.nodeType===1;){var h=l;if(a.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(c){if(!a[O])switch(r){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(p=a.getAttribute("rel"),p==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(p!==h.rel||a.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||a.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||a.getAttribute("title")!==(h.title==null?null:h.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(p=a.getAttribute("src"),(p!==(h.src==null?null:h.src)||a.getAttribute("type")!==(h.type==null?null:h.type)||a.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&p&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(r==="input"&&a.type==="hidden"){var p=h.name==null?null:""+h.name;if(h.type==="hidden"&&a.getAttribute("name")===p)return a}else return a;if(a=vr(a.nextSibling),a===null)break}return null}function Gv(a,r,l){if(r==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=vr(a.nextSibling),a===null))return null;return a}function vu(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function Yv(a,r){var l=a.ownerDocument;if(a.data!=="$?"||l.readyState==="complete")r();else{var c=function(){r(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),a._reactRetry=c}}function vr(a){for(;a!=null;a=a.nextSibling){var r=a.nodeType;if(r===1||r===3)break;if(r===8){if(r=a.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return a}var bu=null;function K1(a){a=a.previousSibling;for(var r=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return a;r--}else l==="/$"&&r++}a=a.previousSibling}return null}function W1(a,r,l){switch(r=Bc(l),a){case"html":if(a=r.documentElement,!a)throw Error(s(452));return a;case"head":if(a=r.head,!a)throw Error(s(453));return a;case"body":if(a=r.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function al(a){for(var r=a.attributes;r.length;)a.removeAttributeNode(r[0]);F(a)}var ir=new Map,$1=new Set;function Uc(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Qr=oe.d;oe.d={f:Xv,r:qv,D:Kv,C:Wv,L:$v,m:Zv,X:Jv,S:Qv,M:eb};function Xv(){var a=Qr.f(),r=Oc();return a||r}function qv(a){var r=B(a);r!==null&&r.tag===5&&r.type==="form"?ph(r):Qr.r(a)}var ti=typeof document>"u"?null:document;function Z1(a,r,l){var c=ti;if(c&&typeof r=="string"&&r){var h=Jt(r);h='link[rel="'+a+'"][href="'+h+'"]',typeof l=="string"&&(h+='[crossorigin="'+l+'"]'),$1.has(h)||($1.add(h),a={rel:a,crossOrigin:l,href:r},c.querySelector(h)===null&&(r=c.createElement("link"),mt(r,"link",a),te(r),c.head.appendChild(r)))}}function Kv(a){Qr.D(a),Z1("dns-prefetch",a,null)}function Wv(a,r){Qr.C(a,r),Z1("preconnect",a,r)}function $v(a,r,l){Qr.L(a,r,l);var c=ti;if(c&&a&&r){var h='link[rel="preload"][as="'+Jt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(h+='[imagesrcset="'+Jt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(h+='[imagesizes="'+Jt(l.imageSizes)+'"]')):h+='[href="'+Jt(a)+'"]';var p=h;switch(r){case"style":p=ri(a);break;case"script":p=ni(a)}ir.has(p)||(a=g({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:a,as:r},l),ir.set(p,a),c.querySelector(h)!==null||r==="style"&&c.querySelector(tl(p))||r==="script"&&c.querySelector(rl(p))||(r=c.createElement("link"),mt(r,"link",a),te(r),c.head.appendChild(r)))}}function Zv(a,r){Qr.m(a,r);var l=ti;if(l&&a){var c=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+Jt(c)+'"][href="'+Jt(a)+'"]',p=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ni(a)}if(!ir.has(p)&&(a=g({rel:"modulepreload",href:a},r),ir.set(p,a),l.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(rl(p)))return}c=l.createElement("link"),mt(c,"link",a),te(c),l.head.appendChild(c)}}}function Qv(a,r,l){Qr.S(a,r,l);var c=ti;if(c&&a){var h=be(c).hoistableStyles,p=ri(a);r=r||"default";var w=h.get(p);if(!w){var k={loading:0,preload:null};if(w=c.querySelector(tl(p)))k.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":r},l),(l=ir.get(p))&&yu(a,l);var G=w=c.createElement("link");te(G),mt(G,"link",a),G._p=new Promise(function(se,ye){G.onload=se,G.onerror=ye}),G.addEventListener("load",function(){k.loading|=1}),G.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Pc(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:k},h.set(p,w)}}}function Jv(a,r){Qr.X(a,r);var l=ti;if(l&&a){var c=be(l).hoistableScripts,h=ni(a),p=c.get(h);p||(p=l.querySelector(rl(h)),p||(a=g({src:a,async:!0},r),(r=ir.get(h))&&Eu(a,r),p=l.createElement("script"),te(p),mt(p,"link",a),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(h,p))}}function eb(a,r){Qr.M(a,r);var l=ti;if(l&&a){var c=be(l).hoistableScripts,h=ni(a),p=c.get(h);p||(p=l.querySelector(rl(h)),p||(a=g({src:a,async:!0,type:"module"},r),(r=ir.get(h))&&Eu(a,r),p=l.createElement("script"),te(p),mt(p,"link",a),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(h,p))}}function Q1(a,r,l,c){var h=(h=W.current)?Uc(h):null;if(!h)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=ri(l.href),l=be(h).hoistableStyles,c=l.get(r),c||(c={type:"style",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=ri(l.href);var p=be(h).hoistableStyles,w=p.get(a);if(w||(h=h.ownerDocument||h,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(a,w),(p=h.querySelector(tl(a)))&&!p._p&&(w.instance=p,w.state.loading=5),ir.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ir.set(a,l),p||ab(h,a,l,w.state))),r&&c===null)throw Error(s(528,""));return w}if(r&&c!==null)throw Error(s(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ni(l),l=be(h).hoistableScripts,c=l.get(r),c||(c={type:"script",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function ri(a){return'href="'+Jt(a)+'"'}function tl(a){return'link[rel="stylesheet"]['+a+"]"}function J1(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function ab(a,r,l,c){a.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=a.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),mt(r,"link",l),te(r),a.head.appendChild(r))}function ni(a){return'[src="'+Jt(a)+'"]'}function rl(a){return"script[async]"+a}function ex(a,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var c=a.querySelector('style[data-href~="'+Jt(l.href)+'"]');if(c)return r.instance=c,te(c),c;var h=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(a.ownerDocument||a).createElement("style"),te(c),mt(c,"style",h),Pc(c,l.precedence,a),r.instance=c;case"stylesheet":h=ri(l.href);var p=a.querySelector(tl(h));if(p)return r.state.loading|=4,r.instance=p,te(p),p;c=J1(l),(h=ir.get(h))&&yu(c,h),p=(a.ownerDocument||a).createElement("link"),te(p);var w=p;return w._p=new Promise(function(k,G){w.onload=k,w.onerror=G}),mt(p,"link",c),r.state.loading|=4,Pc(p,l.precedence,a),r.instance=p;case"script":return p=ni(l.src),(h=a.querySelector(rl(p)))?(r.instance=h,te(h),h):(c=l,(h=ir.get(p))&&(c=g({},l),Eu(c,h)),a=a.ownerDocument||a,h=a.createElement("script"),te(h),mt(h,"link",c),a.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Pc(c,l.precedence,a));return r.instance}function Pc(a,r,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,p=h,w=0;w<c.length;w++){var k=c[w];if(k.dataset.precedence===r)p=k;else if(p!==h)break}p?p.parentNode.insertBefore(a,p.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(a,r.firstChild))}function yu(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.title==null&&(a.title=r.title)}function Eu(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.integrity==null&&(a.integrity=r.integrity)}var Hc=null;function ax(a,r,l){if(Hc===null){var c=new Map,h=Hc=new Map;h.set(l,c)}else h=Hc,c=h.get(l),c||(c=new Map,h.set(l,c));if(c.has(a))return c;for(c.set(a,null),l=l.getElementsByTagName(a),h=0;h<l.length;h++){var p=l[h];if(!(p[O]||p[Xa]||a==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var w=p.getAttribute(r)||"";w=a+w;var k=c.get(w);k?k.push(p):c.set(w,[p])}}return c}function tx(a,r,l){a=a.ownerDocument||a,a.head.insertBefore(l,r==="title"?a.querySelector("head > title"):null)}function tb(a,r,l){if(l===1||r.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return a=r.disabled,typeof r.precedence=="string"&&a==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function rx(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var nl=null;function rb(){}function nb(a,r,l){if(nl===null)throw Error(s(475));var c=nl;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var h=ri(l.href),p=a.querySelector(tl(h));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(c.count++,c=zc.bind(c),a.then(c,c)),r.state.loading|=4,r.instance=p,te(p);return}p=a.ownerDocument||a,l=J1(l),(h=ir.get(h))&&yu(l,h),p=p.createElement("link"),te(p);var w=p;w._p=new Promise(function(k,G){w.onload=k,w.onerror=G}),mt(p,"link",l),r.instance=p}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(r,a),(a=r.state.preload)&&(r.state.loading&3)===0&&(c.count++,r=zc.bind(c),a.addEventListener("load",r),a.addEventListener("error",r))}}function sb(){if(nl===null)throw Error(s(475));var a=nl;return a.stylesheets&&a.count===0&&_u(a,a.stylesheets),0<a.count?function(r){var l=setTimeout(function(){if(a.stylesheets&&_u(a,a.stylesheets),a.unsuspend){var c=a.unsuspend;a.unsuspend=null,c()}},6e4);return a.unsuspend=r,function(){a.unsuspend=null,clearTimeout(l)}}:null}function zc(){if(this.count--,this.count===0){if(this.stylesheets)_u(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Vc=null;function _u(a,r){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Vc=new Map,r.forEach(ib,a),Vc=null,zc.call(a))}function ib(a,r){if(!(r.state.loading&4)){var l=Vc.get(a);if(l)var c=l.get(null);else{l=new Map,Vc.set(a,l);for(var h=a.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<h.length;p++){var w=h[p];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),c=w)}c&&l.set(null,c)}h=r.instance,w=h.getAttribute("data-precedence"),p=l.get(w)||c,p===c&&l.set(null,h),l.set(w,h),this.count++,c=zc.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),p?p.parentNode.insertBefore(h,p.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(h,a.firstChild)),r.state.loading|=4}}var sl={$$typeof:S,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function lb(a,r,l,c,h,p,w,k){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zn(0),this.hiddenUpdates=zn(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=p,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function nx(a,r,l,c,h,p,w,k,G,se,ye,Se){return a=new lb(a,r,l,w,k,G,se,Se),r=1,p===!0&&(r|=24),p=Pt(3,null,null,r),a.current=p,p.stateNode=a,r=to(),r.refCount++,a.pooledCache=r,r.refCount++,p.memoizedState={element:c,isDehydrated:l,cache:r},io(p),a}function sx(a){return a?(a=Ls,a):Ls}function ix(a,r,l,c,h,p){h=sx(h),c.context===null?c.context=h:c.pendingContext=h,c=dn(r),c.payload={element:l},p=p===void 0?null:p,p!==null&&(c.callback=p),l=hn(a,c,r),l!==null&&(Yt(l,a,r),Li(l,a,r))}function lx(a,r){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<r?l:r}}function Tu(a,r){lx(a,r),(a=a.alternate)&&lx(a,r)}function cx(a){if(a.tag===13){var r=Fs(a,67108864);r!==null&&Yt(r,a,67108864),Tu(a,67108864)}}var Gc=!0;function cb(a,r,l,c){var h=Z.T;Z.T=null;var p=oe.p;try{oe.p=2,wu(a,r,l,c)}finally{oe.p=p,Z.T=h}}function ob(a,r,l,c){var h=Z.T;Z.T=null;var p=oe.p;try{oe.p=8,wu(a,r,l,c)}finally{oe.p=p,Z.T=h}}function wu(a,r,l,c){if(Gc){var h=Su(c);if(h===null)fu(a,r,c,Yc,l),ux(a,c);else if(fb(h,a,r,l,c))c.stopPropagation();else if(ux(a,c),r&4&&-1<ub.indexOf(a)){for(;h!==null;){var p=B(h);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var w=$t(p.pendingLanes);if(w!==0){var k=p;for(k.pendingLanes|=2,k.entangledLanes|=2;w;){var G=1<<31-Qe(w);k.entanglements[1]|=G,w&=~G}Or(p),(Sa&6)===0&&(kc=ge()+500,Qi(0))}}break;case 13:k=Fs(p,2),k!==null&&Yt(k,p,2),Oc(),Tu(p,2)}if(p=Su(c),p===null&&fu(a,r,c,Yc,l),p===h)break;h=p}h!==null&&c.stopPropagation()}else fu(a,r,c,null,l)}}function Su(a){return a=C0(a),Au(a)}var Yc=null;function Au(a){if(Yc=null,a=M(a),a!==null){var r=o(a);if(r===null)a=null;else{var l=r.tag;if(l===13){if(a=d(r),a!==null)return a;a=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;a=null}else r!==a&&(a=null)}}return Yc=a,null}function ox(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case ma:return 2;case we:return 8;case Fe:case la:return 32;case Ge:return 268435456;default:return 32}default:return 32}}var Nu=!1,An=null,Nn=null,kn=null,il=new Map,ll=new Map,Cn=[],ub="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ux(a,r){switch(a){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":il.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ll.delete(r.pointerId)}}function cl(a,r,l,c,h,p){return a===null||a.nativeEvent!==p?(a={blockedOn:r,domEventName:l,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},r!==null&&(r=B(r),r!==null&&cx(r)),a):(a.eventSystemFlags|=c,r=a.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),a)}function fb(a,r,l,c,h){switch(r){case"focusin":return An=cl(An,a,r,l,c,h),!0;case"dragenter":return Nn=cl(Nn,a,r,l,c,h),!0;case"mouseover":return kn=cl(kn,a,r,l,c,h),!0;case"pointerover":var p=h.pointerId;return il.set(p,cl(il.get(p)||null,a,r,l,c,h)),!0;case"gotpointercapture":return p=h.pointerId,ll.set(p,cl(ll.get(p)||null,a,r,l,c,h)),!0}return!1}function fx(a){var r=M(a.target);if(r!==null){var l=o(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){a.blockedOn=r,Ss(a.priority,function(){if(l.tag===13){var c=Gt();c=Vn(c);var h=Fs(l,c);h!==null&&Yt(h,l,c),Tu(l,c)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xc(a){if(a.blockedOn!==null)return!1;for(var r=a.targetContainers;0<r.length;){var l=Su(a.nativeEvent);if(l===null){l=a.nativeEvent;var c=new l.constructor(l.type,l);k0=c,l.target.dispatchEvent(c),k0=null}else return r=B(l),r!==null&&cx(r),a.blockedOn=l,!1;r.shift()}return!0}function dx(a,r,l){Xc(a)&&l.delete(r)}function db(){Nu=!1,An!==null&&Xc(An)&&(An=null),Nn!==null&&Xc(Nn)&&(Nn=null),kn!==null&&Xc(kn)&&(kn=null),il.forEach(dx),ll.forEach(dx)}function qc(a,r){a.blockedOn===r&&(a.blockedOn=null,Nu||(Nu=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,db)))}var Kc=null;function hx(a){Kc!==a&&(Kc=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Kc===a&&(Kc=null);for(var r=0;r<a.length;r+=3){var l=a[r],c=a[r+1],h=a[r+2];if(typeof c!="function"){if(Au(c||l)===null)continue;break}var p=B(l);p!==null&&(a.splice(r,3),r-=3,Ao(p,{pending:!0,data:h,method:l.method,action:c},c,h))}}))}function ol(a){function r(G){return qc(G,a)}An!==null&&qc(An,a),Nn!==null&&qc(Nn,a),kn!==null&&qc(kn,a),il.forEach(r),ll.forEach(r);for(var l=0;l<Cn.length;l++){var c=Cn[l];c.blockedOn===a&&(c.blockedOn=null)}for(;0<Cn.length&&(l=Cn[0],l.blockedOn===null);)fx(l),l.blockedOn===null&&Cn.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var h=l[c],p=l[c+1],w=h[$a]||null;if(typeof p=="function")w||hx(l);else if(w){var k=null;if(p&&p.hasAttribute("formAction")){if(h=p,w=p[$a]||null)k=w.formAction;else if(Au(h)!==null)continue}else k=w.action;typeof k=="function"?l[c+1]=k:(l.splice(c,3),c-=3),hx(l)}}}function ku(a){this._internalRoot=a}Wc.prototype.render=ku.prototype.render=function(a){var r=this._internalRoot;if(r===null)throw Error(s(409));var l=r.current,c=Gt();ix(l,c,a,r,null,null)},Wc.prototype.unmount=ku.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var r=a.containerInfo;ix(a.current,2,null,a,null,null),Oc(),r[hr]=null}};function Wc(a){this._internalRoot=a}Wc.prototype.unstable_scheduleHydration=function(a){if(a){var r=ws();a={blockedOn:null,target:a,priority:r};for(var l=0;l<Cn.length&&r!==0&&r<Cn[l].priority;l++);Cn.splice(l,0,a),l===0&&fx(a)}};var xx=n.version;if(xx!=="19.1.1")throw Error(s(527,xx,"19.1.1"));oe.findDOMNode=function(a){var r=a._reactInternals;if(r===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=x(r),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var hb={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{ca=$c.inject(hb),na=$c}catch{}}return fl.createRoot=function(a,r){if(!i(a))throw Error(s(299));var l=!1,c="",h=Oh,p=Dh,w=Rh,k=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(k=r.unstable_transitionCallbacks)),r=nx(a,1,!1,null,null,l,c,h,p,w,k,null),a[hr]=r.current,uu(a),new ku(r)},fl.hydrateRoot=function(a,r,l){if(!i(a))throw Error(s(299));var c=!1,h="",p=Oh,w=Dh,k=Rh,G=null,se=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(G=l.unstable_transitionCallbacks),l.formState!==void 0&&(se=l.formState)),r=nx(a,1,!0,r,l??null,c,h,p,w,k,G,se),r.context=sx(null),l=r.current,c=Gt(),c=Vn(c),h=dn(c),h.callback=null,hn(l,h,c),l=c,r.current.lanes=l,Sr(r,l),Or(r),a[hr]=r.current,uu(a),new Wc(r)},fl.version="19.1.1",fl}var wx;function wb(){if(wx)return Du.exports;wx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Du.exports=Tb(),Du.exports}var Sb=wb();const Ab=Np(Sb);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 *//**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sx;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Sx||(Sx={}));var Ax;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Ax||(Ax={}));var Nx;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Nx||(Nx={}));var kx;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(kx||(kx={}));var Cx;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Cx||(Cx={}));var Ox;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Ox||(Ox={}));var Dx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Dx||(Dx={}));var Rx;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(Rx||(Rx={}));var jx;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(jx||(jx={}));var Fx;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Fx||(Fx={}));var Lx;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Lx||(Lx={}));var Mx;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Mx||(Mx={}));var Ix;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Ix||(Ix={}));var Bx;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Bx||(Bx={}));var Ux;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(Ux||(Ux={}));var Px;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Px||(Px={}));var Hx;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Hx||(Hx={}));var zx;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(zx||(zx={}));var Vx;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Vx||(Vx={}));var Gx;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Gx||(Gx={}));var Yx;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(Yx||(Yx={}));var Xx;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(Xx||(Xx={}));var qx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(qx||(qx={}));var Kx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(Kx||(Kx={}));var Wx;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Wx||(Wx={}));var $x;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})($x||($x={}));var Zx;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Zx||(Zx={}));var Qx;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Qx||(Qx={}));var Jx;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Jx||(Jx={}));var em;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(em||(em={}));var am;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(am||(am={}));var tm;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(tm||(tm={}));var rm;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(rm||(rm={}));var nm;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(nm||(nm={}));var sm;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(sm||(sm={}));var im;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(im||(im={}));var lm;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(lm||(lm={}));var cm;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(cm||(cm={}));var om;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(om||(om={}));var um;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(um||(um={}));var fm;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(fm||(fm={}));var dm;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(dm||(dm={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var hm;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(hm||(hm={}));var Xt=(e=>(e[e.FB_FEED=0]="FB_FEED",e[e.FB_VIDEO_FEED=1]="FB_VIDEO_FEED",e[e.FB_STORIES=2]="FB_STORIES",e[e.FB_MARKETPLACE=3]="FB_MARKETPLACE",e[e.FB_REELS=4]="FB_REELS",e[e.IG_FEED=5]="IG_FEED",e[e.IG_STORIES=6]="IG_STORIES",e[e.IG_REELS=7]="IG_REELS",e[e.IG_EXPLORE=8]="IG_EXPLORE",e[e.MESSENGER_INBOX=9]="MESSENGER_INBOX",e[e.MESSENGER_STORIES=10]="MESSENGER_STORIES",e[e.AUDIENCE_NETWORK=11]="AUDIENCE_NETWORK",e[e.MASTER_VIEW=12]="MASTER_VIEW",e))(Xt||{});const Nb=[{id:Xt.FB_FEED,platform:"Facebook",name:"Feed (Noticias)",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1","4:5"],recommendedResolution:"1080x1080 / 1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.FB_VIDEO_FEED,platform:"Facebook",name:"Video Feed",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["4:5","1:1"],recommendedResolution:"1080x1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.FB_STORIES,platform:"Facebook",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xt.FB_REELS,platform:"Facebook",name:"Reels",uiType:"REELS",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xt.FB_MARKETPLACE,platform:"Facebook",name:"Marketplace",uiType:"MARKETPLACE",group:"SQUARE_LIKE",aspectRatios:["1:1"],recommendedResolution:"1080x1080 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.IG_FEED,platform:"Instagram",name:"Feed",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1","4:5"],recommendedResolution:"1080x1080 / 1350 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.IG_STORIES,platform:"Instagram",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xt.IG_REELS,platform:"Instagram",name:"Reels",uiType:"REELS",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xt.IG_EXPLORE,platform:"Instagram",name:"Explore",uiType:"FEED",group:"SQUARE_LIKE",aspectRatios:["1:1"],recommendedResolution:"1080x1080 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.MESSENGER_INBOX,platform:"Messenger",name:"Inbox",uiType:"MESSENGER_INBOX",group:"SQUARE_LIKE",aspectRatios:["1.91:1"],recommendedResolution:"1200x628 px",safeZone:{top:"9.3%",bottom:"9.3%",left:"9.3%",right:"9.3%"}},{id:Xt.MESSENGER_STORIES,platform:"Messenger",name:"Stories",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16"],recommendedResolution:"1080x1920 px",safeZone:{top:"14%",bottom:"20%"}},{id:Xt.AUDIENCE_NETWORK,platform:"Audience Network",name:"Nativo/Intersticial",uiType:"STORIES",group:"VERTICAL",aspectRatios:["9:16","1:1","1.91:1"],recommendedResolution:"1080x1920 px",safeZone:{top:"15%",bottom:"20%"}}],kb=({currentView:e,onNavigate:n,currentUser:t,onLogout:s,onOpenDiagnostics:i})=>{const[o,d]=ue.useState(!1),f=[{view:"creative_analysis",label:"Análisis IA",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),adminOnly:!1,description:"Análisis de creativos con IA",color:"text-purple-400"},{view:"performance",label:"Performance",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),adminOnly:!1,description:"Métricas y rendimiento",color:"text-green-400"},{view:"strategies",label:"Estrategias",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a1 1 0 01-1-1V9a1 1 0 011-1h1a2 2 0 100-4H4a1 1 0 01-1-1V4a1 1 0 011-1h3a1 1 0 011 1v1z"})}),adminOnly:!1,description:"Optimización de campañas",color:"text-blue-400"},{view:"strategic_analysis",label:"Plan Estratégico",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),adminOnly:!1,description:"Análisis estratégico integral",color:"text-indigo-400"},{view:"reports",label:"Reportes",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),adminOnly:!1,description:"Informes detallados",color:"text-orange-400"}],x=[{view:"clients",label:"Clientes",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),adminOnly:!1,description:"Gestión de clientes"},{view:"import",label:"Importar",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),adminOnly:!0,description:"Importar datos"}],m=[{view:"users",label:"Usuarios",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),adminOnly:!0,description:"Gestión de usuarios"},{view:"control_panel",label:"Panel Admin",icon:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),adminOnly:!0,description:"Panel de control"},{view:"logs",label:"Logs",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),adminOnly:!0,description:"Logs del sistema"}],g=({item:v,isActive:b})=>u.jsxs("button",{onClick:()=>n(v.view),className:`group relative flex items-center gap-3 px-3 py-2 rounded-xl font-medium transition-all duration-200 ${b?"bg-white/10 text-white shadow-lg ring-1 ring-white/20":"text-gray-300 hover:text-white hover:bg-white/5"}`,title:v.description,children:[u.jsx("span",{className:`transition-colors ${b?"text-white":v.color||"text-gray-400"}`,children:v.icon}),u.jsx("span",{className:"text-sm",children:v.label}),b&&u.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/20 to-purple-500/20 -z-10"})]});return u.jsxs(u.Fragment,{children:[u.jsx("nav",{className:"hidden lg:flex fixed top-6 left-6 right-6 z-50 bg-gray-900/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl",children:u.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),u.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg blur opacity-30 group-hover:opacity-100 transition duration-1000"})]}),u.jsx("div",{children:u.jsx("h1",{className:"text-white font-bold text-lg",children:"Creative AI"})})]}),u.jsx("div",{className:"flex items-center gap-1",children:f.map(v=>u.jsx(g,{item:v,isActive:e===v.view},v.view))}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:x.map(v=>v.adminOnly&&t.role!=="admin"?null:u.jsx(g,{item:v,isActive:e===v.view},v.view))}),t.role==="admin"&&u.jsx("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:m.map(v=>u.jsx("button",{onClick:()=>n(v.view),className:`p-2 rounded-lg transition-all duration-200 ${e===v.view?"bg-red-500/20 text-red-400 ring-1 ring-red-500/30":"text-gray-400 hover:text-red-400 hover:bg-red-500/10"}`,title:v.description,children:v.icon},v.view))}),u.jsxs("div",{className:"flex items-center gap-1 pl-4 border-l border-gray-700",children:[u.jsx("button",{onClick:()=>n("settings"),className:`p-2 rounded-lg transition-all duration-200 ${e==="settings"?"bg-white/10 text-white ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"}`,title:"Configuración",children:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),u.jsx("button",{onClick:()=>n("help"),className:`p-2 rounded-lg transition-all duration-200 ${e==="help"?"bg-white/10 text-white ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"}`,title:"Ayuda",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),u.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-gray-700",children:[t.role==="admin"&&i&&u.jsx("button",{onClick:i,className:"p-2 rounded-lg text-gray-400 hover:text-orange-400 hover:bg-orange-500/10 transition-all duration-200",title:"Diagnóstico de Datos",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white text-sm font-medium",children:t.username.charAt(0).toUpperCase()})}),u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"text-white font-medium",children:t.username}),u.jsx("div",{className:"text-gray-400 text-xs capitalize",children:t.role})]})]}),u.jsx("button",{onClick:s,className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all duration-200",title:"Cerrar Sesión",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})]})}),u.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-xl border-b border-gray-700/50",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),u.jsx("span",{className:"text-white font-bold",children:"Creative AI"})]}),u.jsx("button",{onClick:()=>d(!o),className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:o?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]}),o&&u.jsx("div",{className:"border-t border-gray-700/50 bg-gray-900/95 backdrop-blur-xl",children:u.jsxs("div",{className:"px-4 py-3 space-y-1",children:[u.jsx("div",{className:"space-y-1",children:f.map(v=>u.jsxs("button",{onClick:()=>{n(v.view),d(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[u.jsx("span",{className:v.color||"text-gray-400",children:v.icon}),u.jsx("span",{children:v.label})]},v.view))}),u.jsx("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:x.map(v=>v.adminOnly&&t.role!=="admin"?null:u.jsxs("button",{onClick:()=>{n(v.view),d(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[u.jsx("span",{className:"text-gray-400",children:v.icon}),u.jsx("span",{children:v.label})]},v.view))}),t.role==="admin"&&u.jsx("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:m.map(v=>u.jsxs("button",{onClick:()=>{n(v.view),d(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e===v.view?"bg-red-500/20 text-red-400":"text-gray-300 hover:text-red-400 hover:bg-red-500/10"}`,children:[u.jsx("span",{className:"text-red-400",children:v.icon}),u.jsx("span",{children:v.label})]},v.view))}),u.jsxs("div",{className:"pt-3 border-t border-gray-700/50 space-y-1",children:[u.jsxs("button",{onClick:()=>{n("settings"),d(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e==="settings"?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[u.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),u.jsx("span",{children:"Configuración"})]}),u.jsxs("button",{onClick:()=>{n("help"),d(!1)},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${e==="help"?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-white/5"}`,children:[u.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{children:"Ayuda"})]}),t.role==="admin"&&i&&u.jsxs("button",{onClick:()=>{i(),d(!1)},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:text-orange-400 hover:bg-orange-500/10 transition-all",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),u.jsx("span",{children:"Diagnóstico"})]})]}),u.jsxs("div",{className:"pt-3 border-t border-gray-700/50",children:[u.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-gray-300",children:[u.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white text-sm font-medium",children:t.username.charAt(0).toUpperCase()})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-white font-medium",children:t.username}),u.jsx("div",{className:"text-gray-400 text-xs capitalize",children:t.role})]})]}),u.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-gray-300 hover:text-red-400 hover:bg-red-500/10 transition-all",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),u.jsx("span",{children:"Cerrar Sesión"})]})]})]})})]})]})};class ci{constructor(){this.logs=[],this.subscribers=[]}static getInstance(){return ci.instance||(ci.instance=new ci),ci.instance}addLog(n,t,s){const i={timestamp:new Date,level:n,message:t,context:s};this.logs.push(i),this.logs.length>200&&this.logs.shift(),this.subscribers.forEach(d=>d(i));const o=[`[${n}] ${t}`];switch(s&&o.push(s),n){case"ERROR":console.error(...o);break;case"WARNING":console.warn(...o);break;default:console.log(...o)}}info(n,t){this.addLog("INFO",n,t)}success(n,t){this.addLog("SUCCESS",n,t)}warn(n,t){this.addLog("WARNING",n,t)}error(n,t){this.addLog("ERROR",n,t)}debug(n,t){this.addLog("DEBUG",n,t)}getLogs(){return this.logs}subscribe(n){return this.subscribers.push(n),()=>{this.subscribers=this.subscribers.filter(t=>t!==n)}}clear(){this.logs=[],this.info("Logs cleared by user.")}}const Je=ci.getInstance(),Cb=({metaApiConfig:e,setMetaApiConfig:n})=>{const[t,s]=ue.useState({appId:"",appSecret:"",accessToken:""}),[i,o]=ue.useState(!1),[d,f]=ue.useState(null);ue.useEffect(()=>{e&&(s(e),f(!0))},[e]);const x=v=>{s({...t,[v.target.name]:v.target.value})},m=async()=>{o(!0),Je.info("Simulating Meta API connection test..."),await new Promise(b=>setTimeout(b,1e3));const v=!!(t.appId&&t.appSecret&&t.accessToken);f(v),v?(n(t),Je.success("Meta API configuration saved."),alert("Configuración guardada con éxito (simulado).")):Je.error("Meta API connection test failed."),o(!1)},g=!!(e!=null&&e.appId&&(e!=null&&e.appSecret)&&(e!=null&&e.accessToken));return u.jsxs("div",{className:"max-w-2xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:"Conexión API de Meta"}),u.jsxs("p",{className:"text-brand-text-secondary mb-6",children:["Introduce las credenciales de tu aplicación de Meta para automatizar la importación de datos. La conexión se realiza a través de un backend seguro (actualmente simulado).",u.jsx("br",{}),u.jsx("strong",{children:"Estado:"}),u.jsx("span",{className:`ml-2 font-bold ${g?"text-green-400":"text-red-400"}`,children:g?"Configurado":"No Configurado"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(Lu,{label:"App ID",name:"appId",value:t.appId,onChange:x}),u.jsx(Lu,{label:"App Secret",name:"appSecret",value:t.appSecret,onChange:x,type:"password"}),u.jsx(Lu,{label:"Access Token",name:"accessToken",value:t.accessToken,onChange:x,type:"password"})]}),u.jsxs("div",{className:"mt-8 flex items-center justify-between",children:[u.jsx("button",{onClick:m,disabled:i,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Probando...":"Guardar Conexión"}),d!==null&&!i&&u.jsx("div",{className:`text-sm font-semibold px-4 py-2 rounded-md ${d?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"}`,children:d?"Conexión Exitosa":"Falló la Conexión"})]})]})},Lu=({label:e,name:n,value:t,onChange:s,type:i="text"})=>u.jsxs("div",{children:[u.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-brand-text-secondary mb-1",children:e}),u.jsx("input",{type:i,name:n,id:n,value:t,onChange:s,className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary transition-colors",autoComplete:i==="password"?"current-password":"off"})]});class Ob{constructor(){this.maxLocalStorageSize=5*1024*1024}async saveData(n,t){const s=JSON.stringify(t),i=new Blob([s]).size,o=(i/1024/1024).toFixed(2);if(console.log(`[UniversalStorage] Saving ${n}: ${o}MB`),i<this.maxLocalStorageSize)try{localStorage.setItem(`us_${n}`,s),localStorage.setItem(`us_${n}_meta`,JSON.stringify({type:"localStorage",size:i,timestamp:Date.now()})),console.log(`[UniversalStorage] Saved ${n} to localStorage (${o}MB)`);return}catch{console.warn(`[UniversalStorage] localStorage failed for ${n}, downloading file instead`)}try{await this.downloadDataAsFile(n,s),localStorage.setItem(`us_${n}_meta`,JSON.stringify({type:"downloadedFile",size:i,timestamp:Date.now(),fileName:`ver6_${n}_data.json`,sizeMB:o})),console.log(`[UniversalStorage] Downloaded ${n} as file (${o}MB)`),this.showDownloadInstructions(n,o)}catch(d){throw new Error(`Cannot save ${n}: Failed to download file. ${d}`)}}async loadData(n){try{const t=localStorage.getItem(`us_${n}_meta`);if(!t)return console.log(`[UniversalStorage] No metadata found for ${n}`),null;const s=JSON.parse(t);if(s.type==="localStorage"){const i=localStorage.getItem(`us_${n}`);if(i)return console.log(`[UniversalStorage] Loaded ${n} from localStorage`),JSON.parse(i)}else if(s.type==="downloadedFile")return await this.promptUserForFile(n,s);return console.log(`[UniversalStorage] No data found for ${n}`),null}catch(t){return console.error(`[UniversalStorage] Error loading ${n}:`,t),null}}deleteData(n){try{const t=localStorage.getItem(`us_${n}_meta`);if(t){const s=JSON.parse(t);s.type==="localStorage"?localStorage.removeItem(`us_${n}`):s.type==="downloadedFile"&&console.log(`[UniversalStorage] File ${s.fileName} should be manually deleted from Downloads folder`),localStorage.removeItem(`us_${n}_meta`),console.log(`[UniversalStorage] Deleted ${n}`)}}catch(t){console.error(`[UniversalStorage] Error deleting ${n}:`,t)}}async downloadDataAsFile(n,t){const s=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=`ver6_${n}_data.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}showDownloadInstructions(n,t){const s=`
✅ Archivo guardado exitosamente!

📁 Se ha descargado: ver6_${n}_data.json (${t}MB)

📋 IMPORTANTE - Para cargar los datos la próxima vez:
1. El archivo se encuentra en tu carpeta de Descargas
2. Cuando refresques la página, se te pedirá que selecciones este archivo
3. NO muevas ni renombres el archivo

¿Continuar?`;alert(s)}async promptUserForFile(n,t){return new Promise(s=>{const i=`
📁 Necesito cargar tus datos de ${n}

Archivo requerido: ${t.fileName} (${t.sizeMB}MB)
Descargado el: ${new Date(t.timestamp).toLocaleString()}

Busca este archivo en tu carpeta de Descargas y selecciónalo.

¿Seleccionar archivo ahora?`;if(!confirm(i)){s(null);return}const o=document.createElement("input");o.type="file",o.accept=".json",o.onchange=async d=>{var x;const f=(x=d.target.files)==null?void 0:x[0];if(!f){s(null);return}try{const m=await f.text(),g=JSON.parse(m);console.log(`[UniversalStorage] Loaded ${n} from uploaded file`),s(g)}catch(m){alert(`Error al leer el archivo: ${m}`),s(null)}},o.oncancel=()=>s(null),o.click()})}getStorageInfo(){const n=[],t=[];let s=0;for(let i=0;i<localStorage.length;i++){const o=localStorage.key(i);if(o!=null&&o.startsWith("us_")&&o.endsWith("_meta")){const d=o.replace("us_","").replace("_meta","");n.push(d);try{const f=JSON.parse(localStorage.getItem(o)||"{}");f.type==="localStorage"?s+=f.size||0:f.type==="downloadedFile"&&t.push(`${f.fileName} (${f.sizeMB}MB)`)}catch{console.warn(`[UniversalStorage] Invalid metadata for ${o}`)}}}return{keys:n,totalLocalStorageSize:s,downloadedFiles:t}}clearAll(){const n=[],t=[];for(let s=0;s<localStorage.length;s++){const i=localStorage.key(s);if(i!=null&&i.startsWith("us_")&&(n.push(i),i.endsWith("_meta")))try{const o=JSON.parse(localStorage.getItem(i)||"{}");o.type==="downloadedFile"&&t.push(o.fileName)}catch{}}if(n.forEach(s=>localStorage.removeItem(s)),console.log(`[UniversalStorage] Cleared ${n.length} universal storage items`),t.length>0){const s=`
🗑️ Datos borrados del navegador.

📁 Archivos en Descargas que puedes eliminar manualmente:
${t.map(i=>`• ${i}`).join(`
`)}

Estos archivos ya no son necesarios.`;alert(s)}}getDownloadedFilesStatus(){const n=this.getStorageInfo();return{hasDownloadedFiles:n.downloadedFiles.length>0,files:n.downloadedFiles}}}const si=new Ob,Nl={connected:!1},Zc=()=>{if(!Nl.connected){const e="Database not connected. Please check configuration in Settings.";throw console.error(`[DB] ${e}`),new Error(e)}},wa={async select(e,n){e!=="config"&&e!=="import_history"&&e!=="processed_files_hashes"&&Zc(),console.log(`[DB] Executing: SELECT * FROM ${e}`);try{const t=await si.loadData(e);if(t!==null)return console.log(`[DB] Retrieved ${e} from universal storage`),t;const s=localStorage.getItem(`db_${e}`);if(s){const i=JSON.parse(s);return console.log(`[DB] Retrieved ${e} from localStorage (legacy)`),i}return console.log(`[DB] No data found for ${e}, returning default`),n}catch(t){return console.error(`[DB] Error loading ${e}:`,t),n}},async update(e,n){e!=="config"&&Zc(),console.log(`[DB] Executing: UPDATE ${e} with new data...`);try{await si.saveData(e,n),console.log(`[DB] Successfully saved ${e} using universal storage`),localStorage.removeItem(`db_${e}`),localStorage.removeItem(`db_${e}_storage`)}catch(t){console.error(`[DB] Failed to save ${e}:`,t);try{const s=JSON.stringify(n);localStorage.setItem(`db_${e}`,s),console.log(`[DB] Saved ${e} to localStorage as fallback`)}catch{const i=`Error: No se pudieron guardar los datos. El archivo es demasiado grande. Intenta con un archivo más pequeño. ${t}`;throw alert(i),new Error(i)}}},async clearTable(e){Zc(),console.log(`[DB] Executing: DELETE FROM ${e} (clearing table)`);try{si.deleteData(e),localStorage.removeItem(`db_${e}`),localStorage.removeItem(`db_${e}_storage`),console.log(`[DB] Cleared table ${e} from all storage systems`)}catch(n){throw console.error(`[DB] Error clearing table ${e}:`,n),n}},async clearAllData(){Zc(),console.log("[DB] Executing: CLEAR ALL USER DATA"),si.clearAll(),["db_clients","db_users","db_performance_data","db_looker_data","db_bitacora_reports","db_uploaded_videos","db_import_history","db_processed_files_hashes","current_client_id","logged_in_user"].forEach(n=>localStorage.removeItem(n)),Object.keys(localStorage).forEach(n=>{n.startsWith("metaAdCreativeAnalysis_")&&localStorage.removeItem(n)}),Object.keys(localStorage).forEach(n=>{n.endsWith("_storage")&&localStorage.removeItem(n)}),console.log("[DB] All user data cleared from compression storage and localStorage")},async factoryReset(){console.log("[DB] Executing: FACTORY RESET"),si.clearAll(),localStorage.clear(),console.log("[DB] Factory reset completed - all data cleared")},getLocalStorageUsage(){const e=si.getStorageInfo();let n=0,t=0;for(let o in localStorage)if(localStorage.hasOwnProperty(o)&&!o.startsWith("us_")){const d=localStorage.getItem(o);d&&(n+=o.length+d.length,t++)}const s=((e.totalLocalStorageSize+n)/(1024*1024)).toFixed(2),i=e.keys.length+t;return console.log(`[DB] Storage usage: ${s}MB (${e.keys.length} items: ${e.downloadedFiles.length} downloaded files, ${e.keys.length-e.downloadedFiles.length} in localStorage, ${t} legacy)`),{used:s,quota:"∞",items:i}},async clearOldData(){console.log("[DB] Clearing old data to free space...");const e=localStorage.getItem("db_import_history");if(e)try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>10){const s=t.slice(-10);localStorage.setItem("db_import_history",JSON.stringify(s)),console.log(`[DB] Reduced import history from ${t.length} to ${s.length} items`)}}catch(t){console.warn("[DB] Error cleaning import history:",t)}const n=localStorage.getItem("db_processed_files_hashes");if(n)try{const t=JSON.parse(n),s={};for(const[i,o]of Object.entries(t))Array.isArray(o)&&o.length>20?s[i]=o.slice(-20):Array.isArray(o)?s[i]=o:s[i]=[];localStorage.setItem("db_processed_files_hashes",JSON.stringify(s)),console.log("[DB] Cleaned old file hashes")}catch(t){console.warn("[DB] Error cleaning file hashes:",t)}console.log("[DB] Old data cleanup completed")}},ta={getUsers:()=>wa.select("users",[]),saveUsers:e=>wa.update("users",e),getClients:()=>wa.select("clients",[]),saveClients:e=>wa.update("clients",e),getPerformanceData:()=>wa.select("performance_data",{}),savePerformanceData:e=>wa.update("performance_data",e),getLookerData:()=>wa.select("looker_data",{}),saveLookerData:e=>wa.update("looker_data",e),getBitacoraReports:()=>wa.select("bitacora_reports",[]),saveBitacoraReports:e=>wa.update("bitacora_reports",e),getUploadedVideos:()=>wa.select("uploaded_videos",[]),saveUploadedVideos:e=>wa.update("uploaded_videos",e),getImportHistory:()=>wa.select("import_history",[]),saveImportHistory:e=>wa.update("import_history",e),getLoggedInUser:()=>wa.select("logged_in_user",null),saveLoggedInUser:e=>wa.update("logged_in_user",e),getMetaApiConfig:()=>wa.select("config",null),saveMetaApiConfig:e=>wa.update("config",e),getProcessedHashes:()=>wa.select("processed_files_hashes",{}),saveProcessedHashes:e=>wa.update("processed_files_hashes",e),getLocalStorageUsage:()=>wa.getLocalStorageUsage(),clearOldData:()=>wa.clearOldData()},Db=()=>{const[e,n]=ue.useState({}),[t,s]=ue.useState({}),[i,o]=ue.useState(!1),[d,f]=ue.useState(["> Log de producción inicializado. Esperando comandos..."]),x=b=>{const _=new Date().toLocaleTimeString();f(y=>[...y.slice(-100),`[${_}] ${b}`])},m=[{key:"clients",name:"Tabla de Clientes",description:"Almacena perfiles de clientes."},{key:"users",name:"Tabla de Usuarios",description:"Almacena credenciales y roles de usuarios."},{key:"performance_data",name:"Tabla de Rendimiento (Meta)",description:"Almacena datos de reportes XLSX."},{key:"looker_data",name:"Tabla de Creativos (Looker)",description:"Almacena URLs de creativos por anuncio."},{key:"bitacora_reports",name:"Tabla de Reportes (TXT)",description:"Almacena los reportes de bitácora parseados."},{key:"uploaded_videos",name:"Tabla de Videos Subidos",description:"Almacena los archivos de video para análisis."},{key:"import_history",name:"Tabla de Historial de Importación",description:"Registra todas las operaciones de subida."},{key:"processed_files_hashes",name:"Tabla de Hashes de Archivos",description:"Previene la subida de archivos duplicados."}],g=ue.useCallback(async()=>{o(!0),x("> Ejecutando: CHECK DATABASE STATUS..."),await new Promise(y=>setTimeout(y,500));const b=y=>localStorage.getItem(y)!==null,_=m.reduce((y,E)=>(y[E.key]=b(`db_${E.key}`),y),{});n(_),x("✅ Status de tablas verificado desde el almacenamiento."),o(!1)},[]);ue.useEffect(()=>{g()},[g]);const v=async()=>{if(window.confirm("¿ESTÁS SEGURO? Esta acción eliminará TODA la información de la aplicación (clientes, historial, reportes, usuarios) de forma permanente. Esta acción no se puede deshacer.")&&window.confirm("CONFIRMACIÓN FINAL: ¿Realmente quieres borrar toda la base de datos (excepto la configuración)?"))try{x("☢️ Iniciando protocolo de limpieza de datos de la base de datos..."),await wa.clearAllData(),x("✅ Base de datos limpiada con éxito. La aplicación se reiniciará."),alert("Base de datos limpiada. La aplicación se recargará."),window.location.reload()}catch(b){console.error("Error al limpiar la base de datos:",b);const _=b instanceof Error?b.message:String(b);x(`❌ Error durante la limpieza: ${_}`),alert("Ocurrió un error al intentar limpiar la base de datos.")}};return u.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in space-y-8",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-2",children:"Panel de Control de la Base de Datos"}),u.jsx("p",{className:"text-brand-text-secondary",children:'Gestiona las "tablas" de la base de datos simulada de la aplicación.'})]}),u.jsxs("button",{onClick:g,disabled:i,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center sm:justify-start gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${i?"animate-spin":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{d:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"})}),u.jsx("span",{children:i?"Verificando...":"Refrescar Estado"})]})]}),u.jsx("div",{className:"space-y-4",children:m.map(b=>u.jsxs("div",{className:"bg-brand-border/50 p-4 rounded-md flex justify-between items-center transition-colors",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-brand-text",children:b.name}),u.jsx("p",{className:"text-sm text-brand-text-secondary",children:b.description})]}),e[b.key]?u.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-bold bg-green-500/20 px-3 py-1 rounded-full text-sm",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"ONLINE"]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-yellow-400 font-bold bg-yellow-500/20 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"OFFLINE"]}),u.jsx("button",{className:"ml-2 px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30 font-bold",disabled:!!t[b.key],onClick:async()=>{s(_=>({..._,[b.key]:!0})),x(`> Intentando crear la tabla '${b.name}'...`);try{b.key==="performance_data"?await wa.update("performance_data",{}):b.key==="clients"?await wa.update("clients",[]):b.key==="users"?await wa.update("users",[]):b.key==="looker_data"?await wa.update("looker_data",{}):b.key==="bitacora_reports"?await wa.update("bitacora_reports",[]):b.key==="uploaded_videos"?await wa.update("uploaded_videos",[]):b.key==="import_history"?await wa.update("import_history",[]):b.key==="processed_files_hashes"&&await wa.update("processed_files_hashes",{}),x(`✅ Tabla '${b.name}' creada correctamente.`),await g()}catch(_){x(`❌ Error creando la tabla '${b.name}': ${_ instanceof Error?_.message:String(_)}`),alert("Error creando la tabla. Ver log.")}s(_=>({..._,[b.key]:!1}))},children:"Crear tabla"})]})]},b.key))}),u.jsxs("div",{className:"mt-6",children:[u.jsx("h3",{className:"text-sm font-semibold text-brand-text-secondary mb-2",children:"LOG DE OPERACIONES DE PRODUCCIÓN"}),u.jsx("pre",{className:"bg-brand-bg p-4 rounded-md font-mono text-xs text-brand-text-secondary h-40 overflow-y-auto w-full",children:d.map((b,_)=>u.jsx("p",{className:`whitespace-pre-wrap ${b.includes("✅")?"text-green-400":b.includes("⚠️")?"text-yellow-400":b.includes("❌")||b.includes("☢️")?"text-red-400":""}`,children:b},_))})]})]}),u.jsxs("div",{className:"border-t-2 border-red-500/30 pt-6 space-y-4",children:[u.jsx("h3",{className:"text-xl font-bold text-red-400",children:"Zona de Peligro"}),u.jsxs("div",{className:"bg-red-600/10 p-4 rounded-md flex flex-col sm:flex-row justify-between items-center gap-4",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-red-400",children:"Limpiar Todos los Datos"}),u.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:"Elimina permanentemente todos los clientes, análisis, reportes, usuarios, etc. La aplicación volverá a su estado inicial."})]}),u.jsx("button",{onClick:v,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex-shrink-0",children:"Limpiar Datos"})]})]})]})},rn=({isOpen:e,onClose:n,children:t})=>(ue.useEffect(()=>{const s=i=>{i.key==="Escape"&&n()};return e&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}},[e,n]),e?u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 animate-fade-in",onClick:n,children:u.jsx("div",{className:"relative",onClick:s=>s.stopPropagation(),children:t})}):null),Rb=e=>new Promise((n,t)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>n(s.result),s.onerror=i=>t(i)}),jb=({isOpen:e,onClose:n,onSave:t,initialData:s,currentUser:i})=>{const[o,d]=ue.useState(""),[f,x]=ue.useState("USD"),[m,g]=ue.useState(null),[v,b]=ue.useState(null),[_,y]=ue.useState(""),E=ue.useRef(null);ue.useEffect(()=>{e&&(s?(d(s.name),x(s.currency),b(s.logo),y(s.metaAccountName||""),g(null)):(d(""),x("EUR"),b(null),y(""),g(null)))},[e,s]);const T=D=>{if(D.target.files&&D.target.files[0]){const S=D.target.files[0];g(S),b(URL.createObjectURL(S))}},A=async D=>{if(D.preventDefault(),!o.trim()||!f.trim())return;let S=(s==null?void 0:s.logo)||`https://avatar.vercel.sh/${encodeURIComponent(o.trim())}.png?text=${encodeURIComponent(o.trim().charAt(0))}`;m&&(S=await Rb(m));const H={id:(s==null?void 0:s.id)||crypto.randomUUID(),name:o.trim(),logo:S,currency:f.trim().toUpperCase(),userId:(s==null?void 0:s.userId)||i.id,metaAccountName:_.trim()?_.trim():void 0};t(H),n()};return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:s?"Editar Cliente":"Añadir Nuevo Cliente"}),u.jsxs("form",{onSubmit:A,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"clientName",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre del Cliente"}),u.jsx("input",{id:"clientName",type:"text",value:o,onChange:D=>d(D.target.value),placeholder:"Ej: Muto Longevity",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"clientCurrency",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Moneda (3 letras)"}),u.jsx("input",{id:"clientCurrency",type:"text",value:f,onChange:D=>x(D.target.value),placeholder:"Ej: EUR",maxLength:3,className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"metaAccountName",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre de Cuenta de Meta (Opcional)"}),u.jsxs("p",{className:"text-xs text-brand-text-secondary/70 mb-1",children:['Este es el "Nombre de la cuenta" exacto que aparece en tus reportes. Es ',u.jsx("span",{className:"font-bold text-brand-text-secondary",children:"crucial"})," para vincular los datos automáticamente."]}),u.jsx("input",{id:"metaAccountName",type:"text",value:_,onChange:D=>y(D.target.value),placeholder:"Ej: MiCliente - Ventas (ES)",className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Logo del Cliente (Opcional)"}),u.jsxs("div",{className:"mt-1 flex items-center gap-4 bg-brand-bg border border-brand-border rounded-md p-2",children:[u.jsx("span",{className:"h-12 w-12 rounded-full overflow-hidden bg-brand-border flex-shrink-0",children:v?u.jsx("img",{src:v,alt:"Logo Preview",className:"h-full w-full object-cover"}):u.jsx("svg",{className:"h-full w-full text-brand-text-secondary p-2",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 20.993V24H0v-2.997A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})}),u.jsx("input",{id:"clientLogo",type:"file",ref:E,onChange:T,className:"block w-full text-sm text-brand-text-secondary file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary/10 file:text-brand-primary hover:file:bg-brand-primary/20 cursor-pointer",accept:"image/png, image/jpeg, image/gif"})]})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[u.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),u.jsx("button",{type:"submit",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:"Guardar"})]})]}),u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},Fb=({client:e,onEdit:n,onDelete:t})=>u.jsxs("li",{className:"bg-brand-border/50 p-4 rounded-md flex items-center gap-4 transition-all hover:shadow-lg hover:bg-brand-border/70 relative",children:[u.jsx("img",{src:e.logo,alt:e.name,className:"h-12 w-12 rounded-full bg-brand-border object-cover flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-semibold text-brand-text",children:e.name}),u.jsxs("p",{className:"text-sm text-brand-text-secondary",children:["Moneda: ",e.currency]}),e.metaAccountName&&u.jsxs("p",{className:"text-xs text-brand-primary/80 font-mono",children:["Cuenta Meta: ",e.metaAccountName]})]}),u.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-shrink-0",children:[u.jsx("button",{onClick:n,className:"p-2 rounded-full text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-colors","aria-label":`Editar cliente ${e.name}`,children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),u.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]})}),u.jsx("button",{onClick:t,className:"p-2 rounded-full text-brand-text-secondary hover:bg-red-500 hover:text-white transition-colors","aria-label":`Eliminar cliente ${e.name}`,children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]}),Lb=({clients:e,setClients:n,currentUser:t})=>{const[s,i]=ue.useState(!1),[o,d]=ue.useState(null),f=t.role==="admin",x=ue.useMemo(()=>f?e:e.filter(_=>_.userId===t.id),[e,f,t]),m=()=>{d(null),i(!0)},g=_=>{d(_),i(!0)},v=_=>{const E=e.some(T=>T.id===_.id)?e.map(T=>T.id===_.id?_:T):[...e,_];n(E),i(!1)},b=_=>{window.confirm("¿Seguro que quieres eliminar este cliente? Esta acción también eliminará todos sus datos asociados (rendimiento, reportes, etc.) y no se puede deshacer.")&&n(e.filter(y=>y.id!==_))};return u.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text",children:[f?"Todos los Clientes":"Mis Clientes"," (",x.length,")"]}),u.jsxs("button",{onClick:m,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Añadir Cliente"]})]}),x.length>0?u.jsx("ul",{className:"space-y-4",children:x.map(_=>u.jsx(Fb,{client:_,onEdit:()=>g(_),onDelete:()=>b(_.id)},_.id))}):u.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-brand-border rounded-lg",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),u.jsx("p",{className:"mt-4 text-brand-text-secondary",children:"No se han encontrado clientes."}),u.jsx("p",{className:"text-sm text-brand-text-secondary/70",children:"Añade uno nuevo para empezar."})]})]}),u.jsx(jb,{isOpen:s,onClose:()=>i(!1),onSave:v,initialData:o,currentUser:t})]})},Mb=({ad:e,onShowMetricsDetail:n,onShowAnalysisDetail:t,onUpdateAnalysis:s,onUploadVideo:i,generatingAnalysis:o})=>{const d=[{label:"ROAS",value:e.roas.toFixed(2),highlight:!0},{label:"Gasto",value:e.spend.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"Ventas",value:e.purchases.toLocaleString("es-ES")},{label:"CPA",value:e.cpa.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"CTR (Link)",value:`${e.ctrLink.toFixed(2)}%`},{label:"CPM",value:e.cpm.toLocaleString("es-ES",{style:"currency",currency:e.currency})},{label:"Frecuencia",value:e.frequency.toFixed(2)}],f=()=>{e.creativeType==="video"&&e.isMatched&&i()},x=()=>e.isMatched&&e.imageUrl?u.jsxs("button",{onClick:f,className:"relative w-full h-full group","aria-label":e.creativeType==="video"?"Subir video para este anuncio":"Vista previa del creativo",disabled:e.creativeType!=="video",children:[u.jsx("img",{src:e.imageUrl,alt:e.adName,className:"w-full h-full object-cover"}),e.creativeType==="video"&&u.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none group-hover:bg-black/50 transition-colors",children:u.jsx("svg",{className:"h-10 w-10 text-white/80",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):u.jsxs("div",{className:"text-brand-text-secondary text-center p-4 flex flex-col items-center justify-center h-full",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),u.jsx("p",{className:"text-xs mt-2",children:e.isMatched?"Error al cargar":"Creativo no vinculado"})]}),m=e.creativeType==="video"&&!e.isVideoUploaded;return u.jsxs("div",{className:"bg-brand-border/50 rounded-lg overflow-hidden shadow-lg transform transition-all duration-300 hover:shadow-brand-primary/20 hover:-translate-y-1 flex flex-col",children:[u.jsx("div",{className:"w-full aspect-square bg-brand-bg flex items-center justify-center overflow-hidden",children:x()}),u.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[u.jsx("p",{className:"text-sm font-semibold text-brand-text truncate",title:e.adName,children:e.adName}),e.inMultipleAdSets&&u.jsx("p",{className:"text-xs text-brand-text-secondary mt-1",children:"En múltiples Ad-Sets"}),u.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 mt-4 flex-grow",children:d.map(g=>u.jsxs("div",{className:g.highlight?"col-span-2 bg-brand-primary/20 p-2 rounded-md text-center":"",children:[u.jsx("p",{className:`text-xs uppercase tracking-wider ${g.highlight?"text-brand-primary":"text-brand-text-secondary"}`,children:g.label}),u.jsx("p",{className:`font-bold ${g.highlight?"text-brand-primary text-2xl":"text-brand-text text-base"}`,children:g.value})]},g.label))}),u.jsxs("div",{className:"mt-4 pt-3 border-t border-brand-border/50 flex items-center gap-2",children:[e.adPreviewLink&&u.jsx("a",{href:e.adPreviewLink,target:"_blank",rel:"noopener noreferrer",title:"Ver vista previa en Meta",className:"p-2 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),u.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),u.jsx("button",{onClick:n,title:"Ver todas las métricas",className:"p-2 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 110 2H3a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2H8a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"}),u.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm0 2h12v12H4V4z",clipRule:"evenodd"})]})}),e.isMatched&&e.imageUrl&&(e.creativeDescription?u.jsx("button",{onClick:t,className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text text-sm font-bold py-2 px-3 rounded-md transition-colors",children:"Mostrar Análisis"}):u.jsx("button",{onClick:s,disabled:o||m,title:m?"Sube el archivo de video para poder analizarlo.":"",className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white text-sm font-bold py-2 px-3 rounded-md transition-colors disabled:opacity-50 disabled:cursor-wait",children:o?"Analizando...":"Generar Análisis IA"}))]})]})]})},Ib=({data:e,onShowMetricsDetail:n,onShowAnalysisDetail:t,onUpdateAnalysis:s,onUploadVideo:i,generatingAnalysis:o})=>{if(e.length===0)return u.jsx("p",{className:"text-brand-text-secondary text-center py-8",children:"No hay datos de rendimiento para el rango de fechas y filtro seleccionado."});const d=["Creativo","Anuncio","Gasto","ROAS","Ventas","CPA","CPM","Frecuencia","CTR (Link)","Impresiones","Acción"];return u.jsx("div",{className:"overflow-x-auto bg-brand-bg rounded-lg",children:u.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[u.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-surface",children:u.jsx("tr",{children:d.map(f=>u.jsx("th",{scope:"col",className:"px-4 py-3 whitespace-nowrap",children:f},f))})}),u.jsx("tbody",{children:e.map(f=>u.jsxs("tr",{className:"bg-brand-surface border-b border-brand-border hover:bg-brand-border/50",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsx("button",{onClick:()=>f.creativeType==="video"?i(f):void 0,className:"w-16 h-16 bg-brand-bg rounded-md flex items-center justify-center overflow-hidden relative group",children:f.imageUrl?u.jsxs(u.Fragment,{children:[u.jsx("img",{src:f.imageUrl,alt:f.adName,className:"w-full h-full object-cover"}),f.creativeType==="video"&&u.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none group-hover:bg-black/50 transition-colors",children:u.jsx("svg",{className:"h-6 w-6 text-white/80",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-brand-border",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),u.jsx("td",{className:"px-4 py-3 truncate max-w-xs font-medium text-brand-text",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{title:f.adName,children:f.adName}),f.inMultipleAdSets&&u.jsx("span",{title:"Este anuncio se encuentra en múltiples conjuntos de anuncios.",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-brand-text-secondary",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{d:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"})})})]})}),u.jsx("td",{className:"px-4 py-3",children:f.spend.toLocaleString("es-ES",{style:"currency",currency:f.currency})}),u.jsx("td",{className:"px-4 py-3 font-semibold text-brand-text",children:f.roas.toFixed(2)}),u.jsx("td",{className:"px-4 py-3",children:f.purchases.toLocaleString("es-ES")}),u.jsx("td",{className:"px-4 py-3",children:f.cpa.toLocaleString("es-ES",{style:"currency",currency:f.currency})}),u.jsx("td",{className:"px-4 py-3",children:f.cpm.toLocaleString("es-ES",{style:"currency",currency:f.currency})}),u.jsx("td",{className:"px-4 py-3",children:f.frequency.toFixed(2)}),u.jsx("td",{className:"px-4 py-3",children:`${f.ctrLink.toFixed(2)}%`}),u.jsx("td",{className:"px-4 py-3",children:f.impressions.toLocaleString("es-ES")}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center gap-2",children:[f.adPreviewLink&&u.jsx("a",{href:f.adPreviewLink,target:"_blank",rel:"noopener noreferrer",title:"Ver vista previa en Meta",className:"p-1.5 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),u.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),u.jsx("button",{onClick:()=>n(f),title:"Ver todas las métricas",className:"p-1.5 rounded-md text-brand-text-secondary bg-brand-border hover:bg-brand-border/70 transition-colors",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 110 2H3a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2H8a1 1 0 01-1-1zm5 0a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"}),u.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm0 2h12v12H4V4z",clipRule:"evenodd"})]})}),f.isMatched&&f.imageUrl&&u.jsx(u.Fragment,{children:f.creativeDescription?u.jsx("button",{onClick:()=>t(f),className:"bg-brand-border hover:bg-brand-border/70 text-brand-text text-xs font-bold py-1 px-2 rounded-md transition-colors",children:"Análisis"}):u.jsx("button",{onClick:()=>s(f),disabled:o[f.adName]||f.creativeType==="video"&&!f.isVideoUploaded,title:f.creativeType==="video"&&!f.isVideoUploaded?"Sube el video para analizar.":"",className:"bg-brand-primary/20 text-brand-primary hover:bg-brand-primary/40 text-xs font-bold py-1 px-2 rounded-md transition-colors disabled:opacity-50 disabled:cursor-wait",children:o[f.adName]?"Analizando...":"Generar IA"})})]})})]},f.adName))})]})})},c0=({onDateChange:e,startDate:n,endDate:t})=>{const[s,i]=ue.useState(n),[o,d]=ue.useState(t),[f,x]=ue.useState("");ue.useEffect(()=>{i(n),d(t)},[n,t]);const m=()=>{e(s,o)},g=(b,_)=>{const y=new Date,E=new Date;E.setDate(y.getDate()-b);const T=E.toISOString().split("T")[0],A=y.toISOString().split("T")[0];i(T),d(A),x(_),e(T,A)},v=()=>{x("")};return u.jsxs("div",{className:"flex flex-col items-stretch gap-2 bg-brand-border/30 p-2 rounded-lg",children:[u.jsxs("div",{className:"flex items-center justify-around gap-1",children:[u.jsx("button",{onClick:()=>g(7,"7d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${f==="7d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"7 días"}),u.jsx("button",{onClick:()=>g(15,"15d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${f==="15d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"15 días"}),u.jsx("button",{onClick:()=>g(30,"30d"),className:`flex-1 text-xs px-2 py-1 rounded-md transition-colors ${f==="30d"?"bg-brand-primary text-white":"bg-brand-bg text-brand-text-secondary hover:bg-brand-surface"}`,children:"30 días"})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx("input",{type:"date",id:"startDate",value:s,onChange:b=>{i(b.target.value),v()},className:"bg-brand-bg border border-brand-border text-brand-text rounded-md p-1.5 text-sm w-full focus:ring-brand-primary focus:border-brand-primary"}),u.jsx("span",{className:"text-brand-text-secondary",children:"-"}),u.jsx("input",{type:"date",id:"endDate",value:o,onChange:b=>{d(b.target.value),v()},className:"bg-brand-bg border border-brand-border text-brand-text rounded-md p-1.5 text-sm w-full focus:ring-brand-primary focus:border-brand-primary"})]}),u.jsx("button",{onClick:m,className:"w-full sm:w-auto bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors text-sm",children:"Aplicar"})]})]})},Bb=()=>u.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[u.jsxs("svg",{className:"animate-spin h-10 w-10 text-brand-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u.jsx("p",{className:"text-lg font-semibold text-brand-text",children:"Generando conclusión estratégica..."})]}),Ub=({text:e})=>{const n=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`([^`]+)`/g,'<code class="bg-brand-bg px-1 py-0.5 rounded-sm font-mono text-sm text-yellow-300">$1</code>').replace(/^- (.*$)/gm,'<li class="ml-4 list-disc">$1</li>').replace(/^(#+) (.*$)/gm,(t,s,i)=>{const o=s.length;return`<h${o} class="${o===1?"text-xl":o===2?"text-lg":"text-md"} font-bold mt-4 mb-2 text-brand-text">${i}</h${o}>`}).replace(/\n/g,"<br />");return u.jsx("div",{className:"prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:n.replace(/<br \/><(h[1-6]|li|strong|em)/g,"<$1")}})},Pb=({isOpen:e,onClose:n,isLoading:t,analysisText:s})=>u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-2xl max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Conclusión Estratégica de la IA"}),u.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow",children:t?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Bb,{})}):u.jsx("div",{className:"text-brand-text-secondary space-y-4 whitespace-pre-wrap",children:u.jsx(Ub,{text:s})})})]})}),Hb={ACTIVATE:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),CAUTION:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})},xm=({score:e,label:n,colorClass:t,justification:s})=>{const o=2*Math.PI*35,d=o-e/100*o;return u.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[u.jsxs("div",{className:"relative h-24 w-24",children:[u.jsxs("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[u.jsx("circle",{className:"text-brand-surface",strokeWidth:"10",stroke:"currentColor",fill:"transparent",r:35,cx:"50",cy:"50"}),u.jsx("circle",{className:t,strokeWidth:"10",strokeDasharray:o,strokeDashoffset:d,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:35,cx:"50",cy:"50",style:{transition:"stroke-dashoffset 0.5s ease-in-out"}})]}),u.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-4xl font-bold text-brand-text",children:[Math.round(e),u.jsx("span",{className:"text-xl",children:"%"})]})]}),u.jsx("span",{className:"block mt-4 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:n}),u.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:s})]})},zb=({score:e,justification:n})=>{let t="text-green-400",s=u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});return e>35?(t="text-red-400",s=u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})):e>20&&(t="text-yellow-400",s=u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})),u.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[s,u.jsxs("p",{className:`text-4xl font-bold mt-3 ${t}`,children:[e,"%"]}),u.jsx("span",{className:"block mt-3 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:"Texto en Imagen"}),u.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:n})]})},Vb=({stage:e,justification:n})=>u.jsxs("div",{className:"flex flex-col items-center justify-start p-4 bg-brand-border/30 rounded-lg text-center h-full",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})}),u.jsx("p",{className:"text-4xl font-bold mt-3",children:e}),u.jsx("span",{className:"block mt-3 text-sm font-semibold text-brand-text-secondary uppercase tracking-wider",children:"Etapa del Embudo"}),u.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:n})]}),Gb=({item:e})=>{const[n,t]=ue.useState(!1),s=e.applicable==="CAUTION";return u.jsxs("div",{className:`rounded-md ${s?"bg-yellow-500/10":"bg-green-500/10"}`,children:[u.jsxs("button",{className:"flex items-center w-full text-left gap-3 p-3",onClick:()=>t(!n),children:[u.jsx("div",{className:"flex-shrink-0",children:Hb[e.applicable]}),u.jsx("p",{className:`flex-1 font-semibold ${s?"text-yellow-300":"text-green-300"}`,children:e.enhancement}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-brand-text-secondary transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&u.jsx("div",{className:"px-3 pb-3 pl-11",children:u.jsx("p",{className:"text-brand-text-secondary text-sm",children:e.justification})})]})},Yb=({description:e})=>{const[n,t]=ue.useState(!1);return u.jsxs("div",{className:"pt-6 border-t border-brand-border",children:[u.jsxs("button",{className:"flex justify-between items-center w-full text-left",onClick:()=>t(!n),children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text",children:"Descripción del Creativo (Contexto IA)"}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-brand-text-secondary transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&u.jsx("div",{className:"mt-3 p-4 rounded-md bg-brand-border/30",children:u.jsx("p",{className:"text-brand-text-secondary text-sm whitespace-pre-wrap",children:e})})]})},Xb=()=>u.jsxs("div",{className:"space-y-6 animate-pulse",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),u.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),u.jsx("div",{className:"h-48 bg-brand-border rounded-lg"}),u.jsx("div",{className:"h-48 bg-brand-border rounded-lg"})]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[u.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),u.jsxs("div",{className:"space-y-2 p-3 bg-brand-border/50 rounded-md",children:[u.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),u.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),u.jsx("div",{className:"h-3 bg-brand-border rounded w-5/6"})]})]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[u.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),[...Array(2)].map((e,n)=>u.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-brand-border/50 rounded-md",children:[u.jsx("div",{className:"h-4 bg-brand-border rounded w-1/2"}),u.jsx("div",{className:"h-3 bg-brand-border rounded w-full"}),u.jsx("div",{className:"h-3 bg-brand-border rounded w-5/6"})]},n))]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-brand-border",children:[u.jsx("div",{className:"h-5 bg-brand-border rounded w-1/3 mb-4"}),[...Array(3)].map((e,n)=>u.jsxs("div",{className:"flex items-start gap-3 p-3 bg-brand-border/50 rounded-md",children:[u.jsx("div",{className:"w-5 h-5 bg-brand-border rounded-full mt-1"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-brand-border rounded w-1/4"}),u.jsx("div",{className:"h-3 bg-brand-border rounded w-full"})]})]},n))]})]}),of=({analysisResult:e,isLoading:n})=>u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg min-h-[200px]",children:[u.jsxs("h2",{className:"text-xl font-semibold text-brand-text mb-6 flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-brand-primary",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Análisis Estratégico de IA"]}),n&&u.jsx(Xb,{}),e&&!n&&u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx(xm,{score:e.effectivenessScore,label:"EFECTIVIDAD",colorClass:"text-green-400",justification:e.effectivenessJustification}),u.jsx(xm,{score:e.clarityScore,label:"CLARIDAD",colorClass:"text-blue-400",justification:e.clarityJustification}),u.jsx(zb,{score:e.textToImageRatio,justification:e.textToImageRatioJustification}),u.jsx(Vb,{stage:e.funnelStage,justification:e.funnelStageJustification})]}),e.creativeDescription&&u.jsx(Yb,{description:e.creativeDescription}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3 pt-6 border-t border-brand-border",children:"Recomendaciones Clave"}),u.jsx("div",{className:"space-y-4",children:e.recommendations.map((t,s)=>u.jsxs("div",{className:"p-4 rounded-md bg-brand-border/30",children:[u.jsx("h4",{className:"font-bold text-brand-text mb-2",children:t.headline}),u.jsx("ul",{className:"list-disc list-inside space-y-1 text-brand-text-secondary text-sm",children:t.points.map((i,o)=>u.jsx("li",{children:i},o))})]},s))})]}),u.jsxs("div",{className:"pt-6 border-t border-brand-border",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"Análisis de Mejoras Advantage+"}),u.jsx("div",{className:"space-y-3",children:e.advantagePlusAnalysis.map((t,s)=>u.jsx(Gb,{item:t},s))})]})]})]}),qb=({isOpen:e,onClose:n,adData:t})=>{if(!t)return null;const s=t.analysisResult;return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-4xl max-h-[90vh] flex flex-col relative",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0 border-b border-brand-border pb-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Análisis Detallado del Creativo"}),u.jsx("p",{className:"text-brand-text-secondary truncate max-w-lg",children:t.adName})]}),u.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow",children:s?u.jsx(of,{analysisResult:s,isLoading:!1}):u.jsx("div",{className:"text-center py-16 text-brand-text-secondary",children:u.jsx("p",{children:"No se encontró un resultado de análisis para este creativo."})})})]})})},Kb=({isOpen:e,onClose:n,adData:t,onSave:s})=>{const[i,o]=ue.useState(null),[d,f]=ue.useState(!1),x=ue.useRef(null),m=v=>{v.target.files&&v.target.files[0]&&o(v.target.files[0])},g=()=>{i&&s(t.adName,i)};return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:"Subir Video para Análisis"}),u.jsx("p",{className:"text-brand-text-secondary mb-2",children:"Sube el archivo de video para el anuncio:"}),u.jsx("p",{className:"font-mono text-sm bg-brand-bg p-2 rounded-md text-brand-primary mb-6 truncate",children:t.adName}),u.jsxs("div",{className:"space-y-4",children:[!d&&u.jsxs("div",{className:"bg-brand-border/30 p-4 rounded-md text-center",children:[u.jsx("p",{className:"text-brand-text-secondary text-sm",children:"El sistema espera un archivo con el nombre:"}),u.jsx("p",{className:"font-semibold text-brand-text mt-1",children:t.videoFileName||"Nombre no especificado"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"video-upload",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:d?"Selecciona el archivo de video":"Selecciona el archivo correspondiente"}),u.jsx("input",{id:"video-upload",type:"file",ref:x,onChange:m,className:"block w-full text-sm text-brand-text-secondary file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-primary/10 file:text-brand-primary hover:file:bg-brand-primary/20 cursor-pointer bg-brand-bg border border-brand-border rounded-lg p-2",accept:"video/*"}),i&&u.jsxs("p",{className:"text-xs text-green-400 mt-2",children:["Archivo seleccionado: ",i.name]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{id:"different-name-checkbox",type:"checkbox",checked:d,onChange:v=>f(v.target.checked),className:"h-4 w-4 rounded border-brand-border text-brand-primary focus:ring-brand-primary"}),u.jsx("label",{htmlFor:"different-name-checkbox",className:"ml-2 block text-sm text-brand-text-secondary",children:"El archivo que quiero subir tiene un nombre diferente."})]})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-6 mt-4 border-t border-brand-border",children:[u.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),u.jsx("button",{type:"button",onClick:g,disabled:!i,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Guardar Video"})]})]})})},ls=({title:e,children:n,className:t=""})=>u.jsxs("div",{className:`bg-brand-bg/50 rounded-lg p-4 shadow-inner h-full ${t}`,children:[u.jsx("h3",{className:"text-sm font-semibold text-brand-text-secondary uppercase tracking-wider mb-4",children:e}),u.jsx("div",{className:"space-y-4",children:n})]}),nt=({label:e,value:n,average:t,isHighlighted:s=!1})=>u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-brand-text-secondary",children:e}),u.jsx("p",{className:`font-bold break-words ${s?"text-brand-primary text-xl":"text-brand-text text-lg"}`,children:n}),t&&u.jsxs("p",{className:"text-xs text-brand-text-secondary/70 mt-0.5",children:["Prom. Cuenta: ",t]})]}),mm=({title:e,items:n,type:t})=>{const[s,i]=ue.useState(!1);if(n.length===0)return null;const o=t==="included"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300";return u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>i(!s),className:`w-full text-left flex justify-between items-center p-2 rounded-md hover:bg-brand-border/80 transition-colors ${o}`,"aria-expanded":s,children:[u.jsxs("span",{className:"text-xs font-semibold",children:[e," (",n.length,")"]}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transform transition-transform ${s?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&u.jsx("div",{className:"text-xs font-mono bg-brand-bg rounded p-2 mt-1 max-h-24 overflow-y-auto",children:n.map(d=>u.jsx("div",{className:"truncate",title:d,children:d},d))})]})},Wb=({demographics:e,currency:n})=>{const t=ue.useMemo(()=>{if(!e||e.length===0)return[];const i=Math.max(...e.map(f=>f.spend>0?f.purchaseValue/f.spend:0)),o=Math.max(...e.map(f=>f.purchaseValue));return e.map(f=>{const x=f.spend>0?f.purchaseValue/f.spend:0,m=i>0?x/i:0,g=o>0?f.purchaseValue/o:0,v=m*.5+g*.5;return{...f,score:v,roas:x}}).sort((f,x)=>x.score-f.score).slice(0,3)},[e]);if(!e||e.length===0)return u.jsx(ls,{title:"Rendimiento Demográfico",children:u.jsx("p",{className:"text-xs text-brand-text-secondary",children:"No hay datos demográficos."})});const s=i=>`${i.gender.toLowerCase()==="female"?"Mujer":i.gender.toLowerCase()==="male"?"Hombre":"Otro"} ${i.ageRange}`;return u.jsx(ls,{title:"Rendimiento Demográfico",children:u.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.length>0?t.map((i,o)=>u.jsxs("div",{className:"border-b border-brand-border/50 pb-3 last:border-b-0 last:pb-0",children:[u.jsxs("p",{className:"font-bold text-brand-text text-lg flex items-center gap-2",children:[u.jsx("span",{className:"text-sm font-mono bg-brand-primary/20 text-brand-primary rounded-full h-6 w-6 flex items-center justify-center",children:o+1}),s(i)]}),u.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-brand-text-secondary",children:"Ventas"}),u.jsx("p",{className:"text-sm font-semibold",children:i.purchaseValue.toLocaleString("es-ES",{style:"currency",currency:n})})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-brand-text-secondary",children:"ROAS"}),u.jsx("p",{className:"text-sm font-semibold",children:i.roas.toFixed(2)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-brand-text-secondary",children:"CTR"}),u.jsx("p",{className:"text-sm font-semibold",children:`${(i.impressions>0?i.linkClicks/i.impressions*100:0).toFixed(2)}%`})]})]})]},o)):u.jsx("p",{className:"text-xs text-brand-text-secondary",children:"No hay suficientes datos para mostrar un top."})})})},$b=({label:e,value:n,prevValue:t,isLast:s})=>{const i=t!==null&&t>0?100-n/t*100:0,d=(f=>f>50?{color:"bg-red-500/20 text-red-300",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})}:f>=30?{color:"bg-yellow-500/20 text-yellow-300",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})}:{color:"bg-green-500/20 text-green-300",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})(i);return u.jsxs("div",{className:"relative group",children:[u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsx("p",{className:"text-sm font-semibold text-brand-text flex-1 truncate",children:e}),u.jsx("p",{className:"text-sm font-bold text-brand-text",children:n.toLocaleString("es-ES")}),t!==null&&u.jsxs("div",{className:`flex items-center gap-1 text-xs font-mono px-1.5 py-0.5 rounded ${d.color}`,children:[d.icon,u.jsxs("span",{children:["-",i.toFixed(1),"%"]})]})]}),!s&&u.jsx("div",{className:"flex justify-center my-1",children:u.jsx("div",{className:"h-3 w-px bg-brand-border group-hover:bg-brand-primary transition-colors"})})]})},Zb=({isOpen:e,onClose:n,currentMetrics:t,previousMetrics:s,currency:i})=>{const o=m=>m.toLocaleString("es-ES",{style:"currency",currency:i}),d=m=>m.toLocaleString("es-ES",{maximumFractionDigits:0}),f=m=>m.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),x=({label:m,current:g,previous:v,format:b,isGoodUp:_})=>{let y="N/A",E="text-brand-text-secondary";if(v!==void 0&&v!==0){const T=(g-v)/v*100,A=T>=0,D=_?A:!A;E=Math.abs(T)<.1?"text-brand-text-secondary":D?"text-green-400":"text-red-400",y=`${A?"+":""}${T.toFixed(1)}%`}else v===0&&g>0&&(y="+∞%",E=_?"text-green-400":"text-red-400");return u.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center py-2 border-b border-brand-border/50 last:border-b-0",children:[u.jsx("div",{className:"font-semibold text-brand-text",children:m}),u.jsx("div",{className:"text-right font-mono",children:v!==void 0?b(v):"N/A"}),u.jsxs("div",{className:"text-right font-mono flex items-center justify-end gap-2",children:[u.jsx("span",{children:b(g)}),u.jsx("span",{className:`text-xs font-bold w-16 text-center py-0.5 rounded ${E}`,children:y})]})]})};return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-2xl relative",children:[u.jsx("h2",{className:"text-xl font-bold text-brand-text mb-2",children:"Evolución vs. Semana Anterior"}),u.jsx("p",{className:"text-brand-text-secondary mb-6 text-sm",children:"Comparativa de métricas clave del período actual contra el período anterior de igual duración."}),u.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs font-bold text-brand-text-secondary uppercase tracking-wider mb-2",children:[u.jsx("div",{className:"",children:"Métrica"}),u.jsx("div",{className:"text-right",children:"Semana Anterior"}),u.jsx("div",{className:"text-right",children:"Semana Actual"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx(x,{label:"ROAS",current:t.roas,previous:s==null?void 0:s.roas,format:f,isGoodUp:!0}),u.jsx(x,{label:"Compras",current:t.purchases,previous:s==null?void 0:s.purchases,format:d,isGoodUp:!0}),u.jsx(x,{label:"CPA",current:t.cpa,previous:s==null?void 0:s.cpa,format:o,isGoodUp:!1}),u.jsx(x,{label:"CPM",current:t.cpm,previous:s==null?void 0:s.cpm,format:o,isGoodUp:!1}),u.jsx(x,{label:"Frecuencia",current:t.frequency,previous:s==null?void 0:s.frequency,format:f,isGoodUp:!1}),u.jsx(x,{label:"Tasa de Compra",current:t.tasaCompra,previous:s==null?void 0:s.tasaCompra,format:m=>`${f(m)}%`,isGoodUp:!0}),u.jsx(x,{label:"CTR (Link)",current:t.ctrLink,previous:s==null?void 0:s.ctrLink,format:m=>`${f(m)}%`,isGoodUp:!0})]})]})})},Qb=({isOpen:e,onClose:n,adData:t,accountAverages:s})=>{const[i,o]=ue.useState(!1);if(!e||!t)return null;const d=y=>y.toLocaleString("es-ES",{style:"currency",currency:t.currency}),f=y=>y.toLocaleString("es-ES",{maximumFractionDigits:0}),x=y=>y.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),m=y=>`${x(y)}%`,g=[{label:"Impresiones",value:t.impressions},{label:"Alcance",value:t.alcance},{label:"Visitas a Página",value:t.visitasLP},{label:"Atención",value:t.atencion},{label:"Interés",value:t.interes},{label:"Deseo",value:t.deseo},{label:"Añadido al Carrito",value:t.addsToCart},{label:"Pago Iniciado",value:t.checkoutsInitiated},{label:"Compra",value:t.purchases}].filter(y=>y.value>0),v=y=>{var E;return((E=y.split(":").pop())==null?void 0:E.trim())||y},b=[...new Set(t.includedCustomAudiences.map(v))],_=[...new Set(t.excludedCustomAudiences.map(v))];return u.jsxs(u.Fragment,{children:[u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-6xl max-h-[90vh] flex flex-col relative",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4 flex-shrink-0 border-b border-brand-border pb-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[t.imageUrl&&u.jsx("img",{src:t.imageUrl,alt:"Creative Thumbnail",className:"w-16 h-16 rounded-md object-cover bg-brand-bg flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Métricas Detalladas"}),u.jsx("p",{className:"text-brand-text-secondary truncate max-w-md",title:t.adName,children:t.adName})]})]}),u.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"overflow-y-auto pr-4 -mr-4 flex-grow grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsx(ls,{title:"Embudo de Conversión",children:u.jsx("div",{className:"space-y-1",children:g.map((y,E)=>u.jsx($b,{label:y.label,value:y.value,prevValue:E>0?g[E-1].value:null,isLast:E===g.length-1},y.label))})})}),u.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-6",children:[u.jsx(ls,{title:"Resultados Principales",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[u.jsx(nt,{label:"ROAS",value:x(t.roas),average:s?x(s.roas):void 0,isHighlighted:!0}),u.jsx(nt,{label:"Ventas",value:d(t.purchaseValue),isHighlighted:!0}),u.jsx(nt,{label:"Tasa de Compra",value:m(t.tasaCompra),average:s?m(s.tasaCompra):void 0,isHighlighted:!0}),u.jsx(nt,{label:"Compras",value:f(t.purchases)}),u.jsx(nt,{label:"Ticket Promedio",value:d(t.ticketPromedio)}),u.jsx(nt,{label:"Gasto",value:d(t.spend)})]})}),u.jsx(ls,{title:"Costes y Eficiencia",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[u.jsx(nt,{label:"CPA",value:d(t.cpa),average:s?d(s.cpa):void 0}),u.jsx(nt,{label:"CPM",value:d(t.cpm),average:s?d(s.cpm):void 0}),u.jsx(nt,{label:"CPC (Todo)",value:d(t.cpc)}),u.jsx(nt,{label:"Frecuencia",value:x(t.frequency),average:s?x(s.frequency):void 0})]})}),t.previousWeekMetrics&&u.jsx("div",{className:"mt-auto",children:u.jsx("button",{onClick:()=>o(!0),className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg transition-colors",children:"Ver Evolución Semanal"})})]}),u.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-6",children:[u.jsx(ls,{title:"Interacción",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-5",children:[u.jsx(nt,{label:"Clics (Enlace)",value:f(t.linkClicks)}),u.jsx(nt,{label:"CTR (Enlace)",value:m(t.ctrLink),average:s?m(s.ctrLink):void 0}),u.jsx(nt,{label:"Reacciones",value:f(t.postReactions)}),u.jsx(nt,{label:"Comentarios",value:f(t.postComments)}),u.jsx(nt,{label:"Compartidos",value:f(t.postShares)}),u.jsx(nt,{label:"Me Gusta Página",value:f(t.pageLikes)}),t.creativeType==="video"&&u.jsxs(u.Fragment,{children:[u.jsx(nt,{label:"Tiempo Reprod.",value:`${x(t.videoAveragePlayTime)}s`}),u.jsx(nt,{label:"ThruPlays",value:f(t.thruPlays)})]})]})}),u.jsx(Wb,{demographics:t.demographics,currency:t.currency}),u.jsxs(ls,{title:"Contexto y Audiencias",children:[u.jsx(nt,{label:"Días Activos (Total)",value:f(t.activeDays)}),u.jsx(mm,{title:"Públicos Incluidos",items:b,type:"included"}),u.jsx(mm,{title:"Públicos Excluidos",items:_,type:"excluded"})]})]})]})]})}),t.previousWeekMetrics&&u.jsx(Zb,{isOpen:i,onClose:()=>o(!1),currentMetrics:t,previousMetrics:t.previousWeekMetrics,currency:t.currency})]})},Jb=e=>new Promise((n,t)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>n(s.result),s.onerror=i=>t(i)}),ey=(e,n)=>new Promise((t,s)=>{const i=e.type.startsWith("image/")?"image":"video",o=(f,x,m)=>{const g=f/x,v={file:e,url:n,type:i,width:f,height:x,format:g>=1?"square":"vertical",hash:m};t(v)},d=async f=>{const x=await f.arrayBuffer(),m=await crypto.subtle.digest("SHA-256",x);return Array.from(new Uint8Array(m)).map(g=>g.toString(16).padStart(2,"0")).join("")};if(i==="image"){const f=new Image;f.onload=async()=>{const x=await d(e);o(f.naturalWidth,f.naturalHeight,x)},f.onerror=x=>{URL.revokeObjectURL(n),s(x)},f.src=n}else{const f=document.createElement("video");f.onloadedmetadata=async()=>{const x=await d(e);o(f.videoWidth,f.videoHeight,x)},f.onerror=x=>{URL.revokeObjectURL(n),s(x)},f.src=n}}),pm=e=>{if(!e)return null;const n=e.split("/");if(n.length===3){const[s,i,o]=n.map(Number);if(!isNaN(s)&&!isNaN(i)&&!isNaN(o))return new Date(o,i-1,s)}const t=new Date(e);return isNaN(t.getTime())?null:t},ay=({clients:e,getPerformanceAnalysis:n,getFormatAnalysis:t,lookerData:s,setLookerData:i,performanceData:o,uploadedVideos:d,setUploadedVideos:f,startDate:x,endDate:m,onDateChange:g})=>{const[v,b]=ue.useState("list"),[_,y]=ue.useState("all"),[E,T]=ue.useState("cards"),[A,D]=ue.useState(null),[S,H]=ue.useState({active:!1,current:0,total:0}),[V,Y]=ue.useState(null),[j,J]=ue.useState({}),[z,ie]=ue.useState(!1),[K,q]=ue.useState(""),[re,pe]=ue.useState(!1),[Ae,Z]=ue.useState(!1),[oe,Re]=ue.useState(null),[ee,P]=ue.useState(!1),[ce,C]=ue.useState(null),[X,U]=ue.useState(!1),[R,W]=ue.useState(null);ue.useEffect(()=>{if(!A||!o[A.id]){Y(null);return}const we=o[A.id];if(we.length===0){Y(null);return}const Fe=we.reduce((Ge,ra)=>(Ge.spend+=ra.spend,Ge.purchases+=ra.purchases,Ge.purchaseValue+=ra.purchaseValue,Ge.impressions+=ra.impressions,Ge.linkClicks+=ra.linkClicks,Ge.frequencyTotal+=ra.frequency*ra.impressions,Ge.landingPageViews+=ra.landingPageViews,Ge),{spend:0,purchases:0,purchaseValue:0,impressions:0,linkClicks:0,frequencyTotal:0,landingPageViews:0}),la={roas:Fe.spend>0?Fe.purchaseValue/Fe.spend:0,cpa:Fe.purchases>0?Fe.spend/Fe.purchases:0,ctrLink:Fe.impressions>0?Fe.linkClicks/Fe.impressions*100:0,cpm:Fe.impressions>0?Fe.spend/Fe.impressions*1e3:0,frequency:Fe.impressions>0?Fe.frequencyTotal/Fe.impressions:0,tasaCompra:Fe.landingPageViews>0?Fe.purchases/Fe.landingPageViews*100:0};Y(la)},[A,o]);const me=ue.useMemo(()=>{const we=new Date(x);we.setHours(0,0,0,0);const Fe=new Date(m);Fe.setHours(23,59,59,999);const la={};for(const Ge in o)la[Ge]=o[Ge].filter(ra=>{const Na=pm(ra.day);return Na?Na>=we&&Na<=Fe:!1});return la},[o,x,m]),ve=ue.useMemo(()=>e.map(we=>{const Fe=me[we.id]||[],la=s[we.id]||{};if(Fe.length===0)return{...we,gastoTotal:0,roas:0,totalAds:0,matchedCount:0};const Ge=Fe.reduce((ke,Qe)=>ke+(Qe.spend||0),0),ra=Fe.reduce((ke,Qe)=>ke+(Qe.purchaseValue||0),0),Na=Ge>0?ra/Ge:0,ca=new Set(Fe.map(ke=>ke.adName)),na=Array.from(ca).filter(ke=>{var Qe;return!!((Qe=la[ke])!=null&&Qe.imageUrl)}).length;return{...we,gastoTotal:Ge,roas:Na,totalAds:ca.size,matchedCount:na}}),[e,me,s]),Te=ue.useMemo(()=>{if(!A)return[];const we=o[A.id]||[],la=(me[A.id]||[]).filter(ca=>{var na;return((na=ca.adDelivery)==null?void 0:na.toLowerCase())==="active"&&ca.impressions>0}),Ge=s[A.id]||{};if(la.length===0)return[];const ra=la.reduce((ca,na)=>(na.adName&&(ca[na.adName]||(ca[na.adName]=[]),ca[na.adName].push(na)),ca),{}),Na=Object.entries(ra).map(([ca,na])=>{var hr;const ke=na.reduce((Ye,oa)=>(Ye.spend+=oa.spend,Ye.purchases+=oa.purchases,Ye.purchaseValue+=oa.purchaseValue,Ye.impressions+=oa.impressions,Ye.reach+=oa.reach,Ye.clicks+=oa.clicksAll,Ye.linkClicks+=oa.linkClicks,Ye.thruPlays+=oa.thruPlays,Ye.frequencyTotal+=oa.frequency*oa.impressions,Ye.landingPageViews+=oa.landingPageViews,Ye.addsToCart+=oa.addsToCart,Ye.checkoutsInitiated+=oa.checkoutsInitiated,Ye.postInteractions+=oa.postInteractions,Ye.postReactions+=oa.postReactions,Ye.postComments+=oa.postComments,Ye.postShares+=oa.postShares,Ye.pageLikes+=oa.pageLikes,Ye.atencion+=oa.attention,Ye.interes+=oa.interest,Ye.deseo+=oa.desire,oa.videoAveragePlayTime>0&&oa.impressions>0&&(Ye.videoAveragePlayTimeWeightedTotal+=oa.videoAveragePlayTime*oa.impressions,Ye.videoImpressions+=oa.impressions),Ye),{spend:0,purchases:0,purchaseValue:0,impressions:0,reach:0,clicks:0,linkClicks:0,thruPlays:0,videoAveragePlayTimeWeightedTotal:0,videoImpressions:0,frequencyTotal:0,landingPageViews:0,addsToCart:0,checkoutsInitiated:0,postInteractions:0,postReactions:0,postComments:0,postShares:0,pageLikes:0,atencion:0,interes:0,deseo:0}),Qe=we.filter(Ye=>Ye.adName===ca),Oe=new Set;Qe.forEach(Ye=>{var oa,N,L;((oa=Ye.adDelivery)==null?void 0:oa.toLowerCase())==="active"&&((N=Ye.adSetDelivery)==null?void 0:N.toLowerCase())==="active"&&((L=Ye.campaignDelivery)==null?void 0:L.toLowerCase())==="active"&&Oe.add(Ye.day)});const ze=Oe.size,_a=[...new Set(Qe.map(Ye=>Ye.adSetName))],ya=[...new Set(Qe.map(Ye=>Ye.campaignName))],Pa=[...new Set(Qe.flatMap(Ye=>{var oa;return((oa=Ye.includedCustomAudiences)==null?void 0:oa.split(",").map(N=>N.trim()))||[]}).filter(Boolean))],$t=[...new Set(Qe.flatMap(Ye=>{var oa;return((oa=Ye.excludedCustomAudiences)==null?void 0:oa.split(",").map(N=>N.trim()))||[]}).filter(Boolean))],sn=ke.spend>0?ke.purchaseValue/ke.spend:0,Ir=ke.purchases>0?ke.spend/ke.purchases:0,Es=ke.impressions>0?ke.spend/ke.impressions*1e3:0,Pn=ke.impressions>0?ke.clicks/ke.impressions*100:0,Hn=ke.impressions>0?ke.linkClicks/ke.impressions*100:0,zn=ke.impressions>0?ke.frequencyTotal/ke.impressions:1,Sr=ke.videoImpressions>0?ke.videoAveragePlayTimeWeightedTotal/ke.videoImpressions:0,ln=ke.purchases>0?ke.purchaseValue/ke.purchases:0,_s=ke.clicks>0?ke.spend/ke.clicks:0,Ts=ke.linkClicks>0?ke.landingPageViews/ke.linkClicks*100:0,Vn=ke.landingPageViews>0?ke.purchases/ke.landingPageViews*100:0,Ha=Ge[ca],ws=new Set(na.map(Ye=>Ye.adSetName)).size>1,Ss=(hr=na.find(Ye=>Ye.videoFileName))==null?void 0:hr.videoFileName,Xa=!!Ss||na.some(Ye=>Ye.thruPlays>0)&&Sr>1?"video":Ha!=null&&Ha.imageUrl?"image":void 0,$a=Xa==="video"?d.some(Ye=>Ye.clientId===A.id&&Ye.adName===ca):!1;return{adName:ca,adSetNames:_a,campaignNames:ya,includedCustomAudiences:Pa,excludedCustomAudiences:$t,spend:ke.spend,purchases:ke.purchases,purchaseValue:ke.purchaseValue,impressions:ke.impressions,clicks:ke.clicks,linkClicks:ke.linkClicks,roas:sn,cpa:Ir,cpm:Es,ctr:Pn,ctrLink:Hn,frequency:zn,videoAveragePlayTime:Sr,thruPlays:ke.thruPlays,isMatched:!!Ha,creativeDescription:Ha==null?void 0:Ha.creativeDescription,currency:A.currency,inMultipleAdSets:ws,imageUrl:Ha==null?void 0:Ha.imageUrl,adPreviewLink:Ha==null?void 0:Ha.adPreviewLink,creativeType:Xa,analysisResult:Ha==null?void 0:Ha.analysisResult,videoFileName:Ss,isVideoUploaded:$a,ticketPromedio:ln,alcance:ke.reach,cpc:_s,visitasLP:ke.landingPageViews,tasaVisitaLP:Ts,tasaCompra:Vn,addsToCart:ke.addsToCart,checkoutsInitiated:ke.checkoutsInitiated,postInteractions:ke.postInteractions,postReactions:ke.postReactions,postComments:ke.postComments,postShares:ke.postShares,pageLikes:ke.pageLikes,activeDays:ze,atencion:ke.atencion,interes:ke.interes,deseo:ke.deseo,demographics:[]}}).sort((ca,na)=>na.roas-ca.roas);return _==="all"?Na:Na.filter(ca=>ca.creativeType===_)},[A,me,o,s,_,d]),Ee=ue.useMemo(()=>Te.some(we=>we.isMatched&&we.creativeDescription),[Te]),Be=ue.useMemo(()=>Te.filter(we=>we.isMatched&&we.imageUrl&&!we.creativeDescription&&(we.creativeType==="image"||we.creativeType==="video"&&we.isVideoUploaded)).length,[Te]),I=we=>{D(we),T("cards"),y("all"),b("detail")},Pe=async()=>{if(!A)return;const we=Te.filter(la=>la.isMatched&&la.creativeDescription);if(we.length===0){alert("No hay anuncios con análisis de IA en el período y filtro seleccionado. Genere o actualice análisis para algunos anuncios primero.");return}pe(!0),ie(!0),q("");const Fe=await n(we,A);q(Fe),pe(!1)},Ue=async we=>{var Fe,la;if(!(!A||!we.imageUrl)){J(Ge=>({...Ge,[we.adName]:!0}));try{const Ge=we.creativeType==="video";let ra;if(Ge){const Oe=d.find(ya=>ya.clientId===A.id&&ya.adName===we.adName);if(!Oe)throw new Error("No se encontró el archivo de video subido.");const _a=await(await fetch(Oe.dataUrl)).blob();ra=new File([_a],Oe.videoFileName,{type:_a.type})}else{const ze=await(await fetch(we.imageUrl)).blob();ra=new File([ze],we.adName,{type:ze.type})}const Na=URL.createObjectURL(ra),ca=Ge?{square:null,vertical:null,videoFile:ra}:await ey(ra,Na).then(Oe=>(URL.revokeObjectURL(Na),{square:Oe.format==="square"?Oe:null,vertical:Oe.format==="vertical"?Oe:null})),na=Ge?"VERTICAL":ca.square?"SQUARE_LIKE":"VERTICAL",ke=`Análisis del creativo para el anuncio llamado "${we.adName}" del cliente "${A.name}".`,Qe=await t(ca,na,"es",ke,Ge);if(Qe&&!Qe.overallConclusion.headline.toLowerCase().includes("error"))i(Oe=>{const ze=JSON.parse(JSON.stringify(Oe));return ze[A.id]||(ze[A.id]={}),ze[A.id][we.adName]={...ze[A.id][we.adName],imageUrl:we.imageUrl,creativeDescription:Qe.creativeDescription,analysisResult:Qe},ze});else throw new Error(((la=(Fe=Qe==null?void 0:Qe.overallConclusion)==null?void 0:Fe.checklist[0])==null?void 0:la.text)||"Unknown analysis error")}catch(Ge){const ra=Ge instanceof Error?Ge.message:"Error desconocido";alert(`Error al analizar creativo para "${we.adName}": ${ra}`)}finally{J(Ge=>({...Ge,[we.adName]:!1}))}}},We=async()=>{const we=Te.filter(Fe=>Fe.isMatched&&Fe.imageUrl&&!Fe.creativeDescription&&(Fe.creativeType==="image"||Fe.creativeType==="video"&&Fe.isVideoUploaded));if(we.length!==0){H({active:!0,current:0,total:we.length});for(let Fe=0;Fe<we.length;Fe++){const la=we[Fe];H(Ge=>({...Ge,current:Fe+1}));try{await Ue(la)}catch(Ge){Je.error(`Bulk analysis failed for ${la.adName}, continuing...`,Ge)}}H({active:!1,current:0,total:0}),alert("Análisis en masa completado.")}},Ve=we=>{Re(we),Z(!0)},ge=we=>{if(!A)return;const la=(o[A.id]||[]).filter(Oe=>Oe.adName===we.adName),Ge=la.reduce((Oe,ze)=>{const _a=ze.age||"Unknown",ya=ze.gender||"Unknown",Pa=`${ya}-${_a}`;return Oe[Pa]||(Oe[Pa]={ageRange:_a,gender:ya,spend:0,purchases:0,purchaseValue:0,linkClicks:0,impressions:0}),Oe[Pa].spend+=ze.spend,Oe[Pa].purchases+=ze.purchases,Oe[Pa].purchaseValue+=ze.purchaseValue,Oe[Pa].linkClicks+=ze.linkClicks,Oe[Pa].impressions+=ze.impressions,Oe},{}),ra=new Date(x),Na=new Date(ra.getTime()-1440*60*1e3),ca=new Date(Na.getTime()-8640*60*1e3),na=la.filter(Oe=>{const ze=pm(Oe.day);return ze&&ze>=ca&&ze<=Na});let ke;if(na.length>0){const Oe=na.reduce((ze,_a)=>(ze.spend+=_a.spend,ze.purchases+=_a.purchases,ze.purchaseValue+=_a.purchaseValue,ze.impressions+=_a.impressions,ze.linkClicks+=_a.linkClicks,ze.landingPageViews+=_a.landingPageViews,ze.frequencyTotal+=_a.frequency*_a.impressions,ze),{spend:0,purchases:0,purchaseValue:0,impressions:0,linkClicks:0,landingPageViews:0,frequencyTotal:0});ke={spend:Oe.spend,roas:Oe.spend>0?Oe.purchaseValue/Oe.spend:0,cpa:Oe.purchases>0?Oe.spend/Oe.purchases:0,ctrLink:Oe.impressions>0?Oe.linkClicks/Oe.impressions*100:0,tasaCompra:Oe.landingPageViews>0?Oe.purchases/Oe.landingPageViews*100:0,purchases:Oe.purchases,cpm:Oe.impressions>0?Oe.spend/Oe.impressions*1e3:0,frequency:Oe.impressions>0?Oe.frequencyTotal/Oe.impressions:0}}const Qe={...we,demographics:Object.values(Ge),previousWeekMetrics:ke};C(Qe),P(!0)},Ie=we=>{W(we),U(!0)},ma=async(we,Fe)=>{if(A)try{const la=await Jb(Fe),Ge={id:`${A.id}_${we}`,clientId:A.id,adName:we,videoFileName:Fe.name,dataUrl:la},ra=[...d.filter(Na=>Na.id!==Ge.id),Ge];f(ra)}catch{alert("Ocurrió un error al guardar el video.")}finally{U(!1),W(null)}};return v==="list"?u.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Rendimiento por Cliente"}),u.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Selecciona un cliente para ver el detalle de sus anuncios."})]}),u.jsx(c0,{onDateChange:g,startDate:x,endDate:m})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ve.map(we=>u.jsxs("button",{onClick:()=>I(we),className:"bg-brand-surface p-4 rounded-lg shadow-md hover:shadow-xl hover:shadow-brand-primary/20 transition-all text-left flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center gap-3 w-full mb-4",children:[u.jsx("img",{src:we.logo,alt:we.name,className:"h-10 w-10 rounded-full bg-brand-border"}),u.jsx("h3",{className:"font-bold text-brand-text flex-1 truncate",children:we.name})]}),u.jsxs("div",{className:"w-full grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[u.jsx("div",{className:"text-brand-text-secondary",children:"Gasto Total:"}),u.jsx("div",{className:"font-semibold text-brand-text text-right",children:we.gastoTotal.toLocaleString("es-ES",{style:"currency",currency:we.currency})}),u.jsx("div",{className:"text-brand-text-secondary",children:"ROAS:"}),u.jsx("div",{className:"font-semibold text-brand-text text-right",children:we.roas.toFixed(2)}),u.jsx("div",{className:"text-brand-text-secondary",children:"Anuncios:"}),u.jsx("div",{className:"font-semibold text-brand-text text-right",children:we.totalAds}),u.jsx("div",{className:"text-brand-text-secondary",children:"Creativos Vinculados:"}),u.jsxs("div",{className:"font-semibold text-brand-text text-right",children:[we.matchedCount," / ",we.totalAds]})]})]},we.id))})]}):v==="detail"&&A?u.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in",children:[u.jsxs("header",{children:[u.jsxs("button",{onClick:()=>b("list"),className:"mb-4 flex items-center gap-2 text-sm text-brand-text-secondary hover:text-brand-text",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Volver a la lista de clientes"]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("img",{src:A.logo,alt:A.name,className:"h-12 w-12 rounded-full bg-brand-border"}),u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl font-bold text-brand-text",children:["Rendimiento de ",A.name]}),u.jsxs("p",{className:"text-brand-text-secondary",children:["Datos del ",new Date(x).toLocaleDateString("es-ES")," al ",new Date(m).toLocaleDateString("es-ES")]})]})]}),u.jsx(c0,{onDateChange:g,startDate:x,endDate:m})]})]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 p-4 bg-brand-surface rounded-lg shadow-md",children:[u.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm font-semibold text-brand-text-secondary",children:"Filtro:"}),u.jsxs("div",{className:"flex rounded-lg bg-brand-border p-1",children:[u.jsx("button",{onClick:()=>y("all"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${_==="all"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Todos"}),u.jsx("button",{onClick:()=>y("image"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${_==="image"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Imágenes"}),u.jsx("button",{onClick:()=>y("video"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${_==="video"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Videos"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm font-semibold text-brand-text-secondary",children:"Vista:"}),u.jsxs("div",{className:"flex rounded-lg bg-brand-border p-1",children:[u.jsx("button",{onClick:()=>T("table"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${E==="table"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Tabla"}),u.jsx("button",{onClick:()=>T("cards"),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${E==="cards"?"bg-brand-primary text-white":"text-brand-text-secondary hover:bg-brand-surface"}`,children:"Tarjetas"})]})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 self-end md:self-center",children:[u.jsx("button",{onClick:We,disabled:Be===0||S.active,title:Be===0?"No hay creativos sin analizar":"Generar análisis para todos los creativos faltantes",className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",children:S.active?`Analizando ${S.current}/${S.total}...`:`Generar ${Be} Faltantes`}),u.jsxs("button",{onClick:Pe,disabled:!Ee||re,title:Ee?"Generar conclusión estratégica de IA":"Se requiere al menos un anuncio con análisis de IA para generar la conclusión.",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),u.jsx("span",{children:re?"Analizando...":"Conclusión de IA"})]})]})]}),u.jsx("div",{children:E==="table"?u.jsx(Ib,{data:Te,onShowMetricsDetail:ge,onShowAnalysisDetail:Ve,onUpdateAnalysis:Ue,generatingAnalysis:j,onUploadVideo:Ie}):u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Te.length>0?Te.map(we=>u.jsx(Mb,{ad:we,onShowMetricsDetail:()=>ge(we),onShowAnalysisDetail:()=>Ve(we),onUpdateAnalysis:()=>Ue(we),generatingAnalysis:j[we.adName],onUploadVideo:()=>Ie(we)},we.adName)):u.jsx("p",{className:"text-brand-text-secondary text-center py-8 col-span-full",children:"No hay datos de rendimiento para la selección actual."})})}),u.jsx(Pb,{isOpen:z,onClose:()=>ie(!1),isLoading:re,analysisText:K}),u.jsx(qb,{isOpen:Ae,onClose:()=>Z(!1),adData:oe}),u.jsx(Qb,{isOpen:ee,onClose:()=>P(!1),adData:ce,accountAverages:V}),R&&u.jsx(Kb,{isOpen:X,onClose:()=>U(!1),adData:R,onSave:ma})]}):null},ty=({onLogin:e})=>{const[n,t]=ue.useState(""),[s,i]=ue.useState(""),[o,d]=ue.useState(""),[f,x]=ue.useState(!1),m=async g=>{g.preventDefault(),d(""),x(!0),await new Promise(v=>setTimeout(v,800)),e(n,s)||d("Usuario o contraseña incorrectos."),x(!1)};return u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-bg via-slate-900 to-brand-bg flex items-center justify-center relative overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 opacity-10",children:u.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.4) 0%, transparent 50%),
                                     radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.4) 0%, transparent 50%)`}})}),u.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-brand-primary/20 rounded-full blur-3xl animate-pulse"}),u.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 bg-brand-accent/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),u.jsx("div",{className:"absolute top-1/2 left-10 w-24 h-24 bg-brand-primary/10 rounded-full blur-2xl animate-pulse",style:{animationDelay:"2s"}}),u.jsx("div",{className:"relative z-10 w-full max-w-md mx-auto p-6",children:u.jsxs("div",{className:"bg-gradient-to-br from-brand-surface/80 to-brand-surface/60 backdrop-blur-xl border border-brand-border/50 rounded-2xl p-8 shadow-2xl animate-scale-in",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-brand-primary to-brand-accent rounded-2xl flex items-center justify-center mx-auto mb-4 animate-glow",children:u.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),u.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-brand-primary to-brand-accent bg-clip-text text-transparent",children:"Creative Assistant"}),u.jsx("p",{className:"text-brand-text-secondary mt-2",children:"AI-Powered Marketing Intelligence"}),u.jsx("div",{className:"mt-4 h-px bg-gradient-to-r from-transparent via-brand-border to-transparent"})]}),u.jsxs("form",{onSubmit:m,className:"space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"group",children:[u.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-brand-text-secondary mb-2 group-focus-within:text-brand-primary transition-colors",children:"Usuario"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx("svg",{className:"h-5 w-5 text-brand-text-secondary group-focus-within:text-brand-primary transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),u.jsx("input",{id:"username",type:"text",value:n,onChange:g=>t(g.target.value),className:"w-full bg-brand-bg/50 border border-brand-border text-brand-text rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-primary/50 focus:border-brand-primary transition-all duration-200 placeholder-brand-text-secondary/50",placeholder:"Ingresa tu usuario",required:!0,disabled:f})]})]}),u.jsxs("div",{className:"group",children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-text-secondary mb-2 group-focus-within:text-brand-primary transition-colors",children:"Contraseña"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx("svg",{className:"h-5 w-5 text-brand-text-secondary group-focus-within:text-brand-primary transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),u.jsx("input",{id:"password",type:"password",value:s,onChange:g=>i(g.target.value),className:"w-full bg-brand-bg/50 border border-brand-border text-brand-text rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-primary/50 focus:border-brand-primary transition-all duration-200 placeholder-brand-text-secondary/50",placeholder:"Ingresa tu contraseña",required:!0,disabled:f})]})]})]}),o&&u.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 animate-slide-up",children:u.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[u.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"text-sm font-medium",children:o})]})}),u.jsx("button",{type:"submit",disabled:f,className:"w-full bg-gradient-to-r from-brand-primary to-brand-accent hover:from-brand-primary-hover hover:to-brand-accent text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:shadow-glow transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98] group",children:f?u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),u.jsx("span",{children:"Iniciando sesión..."})]}):u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("span",{children:"Iniciar Sesión"}),u.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]}),u.jsxs("div",{className:"mt-6 p-4 bg-brand-bg/30 rounded-xl border border-brand-border/30",children:[u.jsx("p",{className:"text-xs text-brand-text-secondary text-center mb-2",children:"Credenciales de demo:"}),u.jsxs("div",{className:"text-xs text-brand-text-secondary space-y-1",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{children:"Admin:"}),u.jsx("span",{className:"text-brand-primary",children:"admin / admin123"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{children:"Usuario:"}),u.jsx("span",{className:"text-brand-primary",children:"user / user123"})]})]})]})]})})]})},ry=({isOpen:e,onClose:n,onSave:t,initialData:s})=>{const[i,o]=ue.useState(""),[d,f]=ue.useState(""),[x,m]=ue.useState("user");ue.useEffect(()=>{e&&(s?(o(s.username),f(""),m(s.role)):(o(""),f(""),m("user")))},[e,s]);const g=v=>{if(v.preventDefault(),!i.trim()||!s&&!d.trim()){alert("El nombre de usuario y la contraseña son obligatorios para nuevos usuarios.");return}const b={id:(s==null?void 0:s.id)||crypto.randomUUID(),username:i.trim(),password:d.trim()||s.password,role:x};t(b),n()};return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:s?"Editar Usuario":"Añadir Nuevo Usuario"}),u.jsxs("form",{onSubmit:g,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Nombre de Usuario"}),u.jsx("input",{id:"username",type:"text",value:i,onChange:v=>o(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:["Contraseña ",s&&"(dejar en blanco para no cambiar)"]}),u.jsx("input",{id:"password",type:"password",value:d,onChange:v=>f(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",required:!s})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Rol"}),u.jsxs("select",{id:"role",value:x,onChange:v=>m(v.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-2 focus:ring-brand-primary focus:border-brand-primary",children:[u.jsx("option",{value:"user",children:"Usuario"}),u.jsx("option",{value:"admin",children:"Administrador"})]})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[u.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),u.jsx("button",{type:"submit",className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:"Guardar"})]})]}),u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},ny=({users:e,setUsers:n,currentUser:t})=>{const[s,i]=ue.useState(!1),[o,d]=ue.useState(null),f=()=>{d(null),i(!0)},x=v=>{d(v),i(!0)},m=v=>{const _=e.some(y=>y.id===v.id)?e.map(y=>y.id===v.id?v:y):[...e,v];n(_),i(!1)},g=v=>{if(v===t.id){alert("No puedes eliminar tu propia cuenta de administrador.");return}if(window.confirm("¿Seguro que quieres eliminar este usuario? Esta acción es irreversible.")){const b=e.filter(_=>_.id!==v);n(b)}};return u.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text",children:["Gestión de Usuarios (",e.length,")"]}),u.jsxs("button",{onClick:f,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Añadir Usuario"]})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[u.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-border/50",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"px-6 py-3",children:"Usuario"}),u.jsx("th",{scope:"col",className:"px-6 py-3",children:"Rol"}),u.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID de Usuario"}),u.jsx("th",{scope:"col",className:"px-6 py-3",children:u.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),u.jsx("tbody",{children:e.map(v=>u.jsxs("tr",{className:"bg-brand-surface border-b border-brand-border hover:bg-brand-border/30",children:[u.jsx("td",{className:"px-6 py-4 font-medium text-brand-text whitespace-nowrap",children:v.username}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v.role==="admin"?"bg-blue-500/20 text-blue-300":"bg-gray-500/20 text-gray-300"}`,children:v.role})}),u.jsx("td",{className:"px-6 py-4 font-mono text-xs",children:v.id}),u.jsxs("td",{className:"px-6 py-4 text-right flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>x(v),className:"p-2 rounded-full text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-colors",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),u.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]})}),u.jsx("button",{onClick:()=>g(v.id),disabled:v.id===t.id,className:"p-2 rounded-full text-brand-text-secondary hover:bg-red-500 hover:text-white transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},v.id))})]})})]}),u.jsx(ry,{isOpen:s,onClose:()=>i(!1),onSave:m,initialData:o})]})},sy=({isOpen:e,onClose:n,newAccountNames:t,onConfirm:s})=>e?u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-xl p-6 sm:p-8 w-full max-w-lg relative",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:"Nuevas Cuentas Detectadas"}),u.jsx("p",{className:"text-brand-text-secondary mb-6",children:"Se encontraron las siguientes cuentas en el reporte que no están vinculadas a ningún cliente existente. ¿Deseas crearlos ahora?"}),u.jsx("div",{className:"bg-brand-bg rounded-md p-4 max-h-60 overflow-y-auto mb-6",children:u.jsx("ul",{className:"space-y-2",children:t.map(i=>u.jsxs("li",{className:"text-brand-text flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-brand-primary",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),i]},i))})}),u.jsxs("div",{className:"flex justify-end gap-4",children:[u.jsx("button",{type:"button",onClick:n,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg",children:"Cancelar"}),u.jsxs("button",{type:"button",onClick:()=>s(t),className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors",children:["Crear ",t.length," Clientes y Continuar"]})]})]})}):null,iy=e=>{if(!e||e.trim()==="-")return e;const n=e.trim(),t=n.match(/^(€|£|\$)?\s*([0-9.,]+)\s*(x|%|s)?\s*(\(([-+]?[0-9.,]+)%\s*(🔺|🔻|▲|▼|✅|🏆)\))?$/i);if(t){const[,i,o,d,,f,x]=t,m=parseFloat(o.replace(/\./g,"").replace(",","."));if(isNaN(m))return n;const g={value:m};return i&&(g.symbol=i),d?g.symbol=(g.symbol||"")+d:o.includes(","),f&&(g.change=parseFloat(f.replace(",","."))/100,x==="🔺"||x==="▲"||x==="✅"||x==="🏆"?g.direction="up":x==="🔻"||x==="▼"?g.direction="down":g.direction="neutral"),g}const s=n.match(/^([0-9.,]+)%\s*(✅|🏆)$/);if(s){const[,i,o]=s,d=parseFloat(i.replace(",","."));return isNaN(d)?n:{value:d,symbol:"% "+o,direction:"up"}}return n},gm=(e,n)=>{if(e.length<2)return{title:n,headers:[],rows:[]};const t=e[0].split("|").map(i=>i.trim()).filter(Boolean),s=[];for(let i=2;i<e.length;i++){const o=e[i].split("|").map(f=>f.trim()).filter(Boolean);if(o.length===0||t.length===0)continue;const d={};t.forEach((f,x)=>{d[f]=iy(o[x]||"")}),s.push(d)}return{title:n,headers:t,rows:s}},ly=e=>{const n=e.split(`
`),t={},s=[];let i="",o=[],d=!1;n.forEach(m=>{var _,y,E,T;m.startsWith("Reporte Bitácora")&&(t.reportType=((_=m.split("(")[1])==null?void 0:_.split(")")[0])||"Unknown"),m.startsWith("Moneda Detectada:")&&(t.currency=(y=m.split(":")[1])==null?void 0:y.trim()),m.startsWith("Campaña Filtrada:")&&(t.campaignFilter=(E=m.split(":")[1])==null?void 0:E.trim()),m.startsWith("AdSets Filtrados:")&&(t.adSetFilter=(T=m.split(":")[1])==null?void 0:T.trim());const g=m.match(/^\s*\*{2}\s*(.*?)\s*\*{2}\s*$/)||m.match(/^-{3,}\s*(.*?)\s*-{3,}$/)||m.match(/^={3,}\s*(.*?)\s*={3,}$/)||m.match(/^\s*TABLA:\s*(.*?)\s*$/);g&&g[1]&&(i=g[1].trim());const v=m.trim().match(/^\|-.*-\|$/);m.trim().startsWith("|")&&!v&&!d?(d=!0,o.push(m.trim())):d&&(m.trim().startsWith("|")?o.push(m.trim()):(o.length>1&&s.push(gm(o,i||`Tabla Sin Título ${s.length+1}`)),o=[],i="",d=!1))}),d&&o.length>1&&s.push(gm(o,i||`Tabla Sin Título ${s.length+1}`));const f=m=>s.find(g=>g.title.toLowerCase().includes(m.toLowerCase())),x=m=>s.filter(g=>g.title.toLowerCase().includes(m.toLowerCase()));return{metadata:t,mainSummaryTable:f("cuenta completa"),funnelAnalysisTable:f("análisis de embudo"),topAdsTables:x("top 20 ads"),topAdSetsTables:x("top 20 adsets"),topCampaignsTables:x("top 10 campañas"),audiencePerformanceTable:f("performance_publico"),ratioTrendsTable:f("tendencia_ratios")}},Ku=({isOpen:e,onClose:n,clients:t,onClientSelect:s,title:i="Asignar a Cliente",description:o="Selecciona el cliente para esta operación."})=>{const[d,f]=ue.useState("");if(ue.useEffect(()=>{e&&t.length>0&&f(t[0].id)},[e,t]),!e)return null;const x=()=>{d&&s(d)};return u.jsx(rn,{isOpen:e,onClose:n,children:u.jsxs("div",{className:"relative bg-brand-surface rounded-lg shadow-xl p-8 w-full max-w-md",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-4",children:i}),u.jsx("p",{className:"text-brand-text-secondary mb-6",children:o}),t.length>0?u.jsxs("div",{className:"space-y-4",children:[u.jsx("select",{value:d,onChange:m=>f(m.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",children:t.map(m=>u.jsx("option",{value:m.id,children:m.name},m.id))}),u.jsx("button",{onClick:x,disabled:!d,className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirmar"})]}):u.jsx("p",{className:"text-yellow-400 bg-yellow-500/10 p-4 rounded-md text-center",children:"No tienes clientes asignados. Por favor, crea uno en la pestaña de 'Clientes'."}),u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-brand-text-secondary hover:text-brand-text transition-colors","aria-label":"Cerrar modal",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},cy=({history:e,setHistory:n,setLookerData:t})=>{const s=async i=>{if(!window.confirm("¿Seguro que quieres deshacer esta importación? Los datos añadidos serán eliminados."))return;const o=e.find(d=>d.id===i);if(o){Je.warn(`Undoing import batch: ${i}`,o);try{const{type:d,keys:f,clientId:x}=o.undoData;if(d==="meta"){const g=await ta.getPerformanceData();if(g[x]){const v=new Set(f);g[x]=g[x].filter(b=>!v.has(b.uniqueId)),await ta.savePerformanceData(g)}}else if(d==="looker"){const g=await ta.getLookerData();g[x]&&(f.forEach(v=>{delete g[x][v]}),await ta.saveLookerData(g),t(g))}else if(d==="txt"){let g=await ta.getBitacoraReports();const v=new Set(f);g=g.filter(b=>!v.has(b.id)),await ta.saveBitacoraReports(g)}const m=e.filter(g=>g.id!==i);n(m),await ta.saveImportHistory(m),Je.success(`Successfully undone import batch: ${i}`),alert("Importación deshecha con éxito.")}catch(d){Je.error(`Failed to undo import batch: ${i}`,d),alert("Ocurrió un error al deshacer la importación.")}}};return e.length===0?null:u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg mt-8",children:[u.jsx("h3",{className:"text-xl font-bold text-brand-text mb-4",children:"Historial de Importaciones Recientes"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-brand-text-secondary",children:[u.jsx("thead",{className:"text-xs text-brand-text uppercase bg-brand-border/50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2",children:"Fecha"}),u.jsx("th",{className:"px-4 py-2",children:"Tipo"}),u.jsx("th",{className:"px-4 py-2",children:"Archivo"}),u.jsx("th",{className:"px-4 py-2",children:"Cliente"}),u.jsx("th",{className:"px-4 py-2",children:"Descripción"}),u.jsx("th",{className:"px-4 py-2",children:"Acción"})]})}),u.jsx("tbody",{children:e.map(i=>u.jsxs("tr",{className:"bg-brand-bg border-b border-brand-border/50 hover:bg-brand-border/20",children:[u.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(i.timestamp).toLocaleString("es-ES")}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("span",{className:"font-semibold uppercase",children:i.source})}),u.jsx("td",{className:"px-4 py-2 truncate max-w-xs",title:i.fileName,children:i.fileName}),u.jsx("td",{className:"px-4 py-2",children:i.clientName}),u.jsx("td",{className:"px-4 py-2",children:i.description}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("button",{onClick:()=>s(i.id),className:"bg-red-600/20 text-red-400 hover:bg-red-600/40 text-xs font-bold py-1 px-2 rounded-md transition-colors",children:"Deshacer"})})]},i.id))})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kp=1252,oy=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],uf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ff=function(e){oy.indexOf(e)!=-1&&(kp=uf[0]=e)};function uy(){ff(1252)}var _r=function(e){ff(e)};function Cp(){_r(1200),uy()}function vm(e){for(var n=[],t=0,s=e.length;t<s;++t)n[t]=e.charCodeAt(t);return n}function fy(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Op(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var hl=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?fy(e.slice(2)):n==254&&t==255?Op(e.slice(2)):n==65279?e.slice(1):e},Qc=function(n){return String.fromCharCode(n)},bm=function(n){return String.fromCharCode(n)},kl,Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ym(e){for(var n="",t=0,s=0,i=0,o=0,d=0,f=0,x=0,m=0;m<e.length;)t=e.charCodeAt(m++),o=t>>2,s=e.charCodeAt(m++),d=(t&3)<<4|s>>4,i=e.charCodeAt(m++),f=(s&15)<<2|i>>6,x=i&63,isNaN(s)?f=x=64:isNaN(i)&&(x=64),n+=Fn.charAt(o)+Fn.charAt(d)+Fn.charAt(f)+Fn.charAt(x);return n}function Wt(e){var n="",t=0,s=0,i=0,o=0,d=0,f=0,x=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)o=Fn.indexOf(e.charAt(m++)),d=Fn.indexOf(e.charAt(m++)),t=o<<2|d>>4,n+=String.fromCharCode(t),f=Fn.indexOf(e.charAt(m++)),s=(d&15)<<4|f>>2,f!==64&&(n+=String.fromCharCode(s)),x=Fn.indexOf(e.charAt(m++)),i=(f&3)<<6|x,x!==64&&(n+=String.fromCharCode(i));return n}var xa=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ms=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function In(e){return xa?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Em(e){return xa?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Er=function(n){return xa?ms(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function ps(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function df(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return df(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var jn=xa?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ms(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var s=new Uint8Array(t),i=0;for(n=0,t=0;n<e.length;t+=i,++n)if(i=e[n].length,e[n]instanceof Uint8Array)s.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";s.set(new Uint8Array(e[n]),t)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function dy(e){for(var n=[],t=0,s=e.length+250,i=In(e.length+255),o=0;o<e.length;++o){var d=e.charCodeAt(o);if(d<128)i[t++]=d;else if(d<2048)i[t++]=192|d>>6&31,i[t++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var f=e.charCodeAt(++o)&1023;i[t++]=240|d>>8&7,i[t++]=128|d>>2&63,i[t++]=128|f>>6&15|(d&3)<<4,i[t++]=128|f&63}else i[t++]=224|d>>12&15,i[t++]=128|d>>6&63,i[t++]=128|d&63;t>s&&(n.push(i.slice(0,t)),t=0,i=In(65535),s=65530)}return n.push(i.slice(0,t)),jn(n)}var Rt=/\u0000/g,xl=/[\u0001-\u0006]/g;function ui(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function Tr(e,n){var t=""+e;return t.length>=n?t:Ga("0",n-t.length)+t}function hf(e,n){var t=""+e;return t.length>=n?t:Ga(" ",n-t.length)+t}function o0(e,n){var t=""+e;return t.length>=n?t:t+Ga(" ",n-t.length)}function hy(e,n){var t=""+Math.round(e);return t.length>=n?t:Ga("0",n-t.length)+t}function xy(e,n){var t=""+e;return t.length>=n?t:Ga("0",n-t.length)+t}var _m=Math.pow(2,32);function ii(e,n){if(e>_m||e<-_m)return hy(e,n);var t=Math.round(e);return xy(t,n)}function u0(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Tm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function my(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var sa={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},wm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},py={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function f0(e,n,t){for(var s=e<0?-1:1,i=e*s,o=0,d=1,f=0,x=1,m=0,g=0,v=Math.floor(i);m<n&&(v=Math.floor(i),f=v*d+o,g=v*m+x,!(i-v<5e-8));)i=1/(i-v),o=d,d=f,x=m,m=g;if(g>n&&(m>n?(g=x,f=o):(g=m,f=d)),!t)return[0,s*f,g];var b=Math.floor(s*f/g);return[b,s*f-b*g,g]}function os(e,n,t){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),o=0,d=[],f={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),n&&n.date1904&&(s+=1462),f.u>.9999&&(f.u=0,++i==86400&&(f.T=i=0,++s,++f.D)),s===60)d=t?[1317,10,29]:[1900,2,29],o=3;else if(s===0)d=t?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var x=new Date(1900,0,1);x.setDate(x.getDate()+s-1),d=[x.getFullYear(),x.getMonth()+1,x.getDate()],o=x.getDay(),s<60&&(o=(o+6)%7),t&&(o=_y(x,d))}return f.y=d[0],f.m=d[1],f.d=d[2],f.S=i%60,i=Math.floor(i/60),f.M=i%60,i=Math.floor(i/60),f.H=i,f.q=o,f}var Dp=new Date(1899,11,31,0,0,0),gy=Dp.getTime(),vy=new Date(1900,2,1,0,0,0);function Rp(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=vy&&(t+=1440*60*1e3),(t-(gy+(e.getTimezoneOffset()-Dp.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function by(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yy(e){var n=e<0?12:11,t=xf(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function Ey(e){var n=xf(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Cl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=yy(e):n===10?t=e.toFixed(10).substr(0,12):t=Ey(e),xf(by(t.toUpperCase()))}function ds(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Cl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ur(14,Rp(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function _y(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Ty(e,n,t,s){var i="",o=0,d=0,f=t.y,x,m=0;switch(e){case 98:f=t.y+543;case 121:switch(n.length){case 1:case 2:x=f%100,m=2;break;default:x=f%1e4,m=4;break}break;case 109:switch(n.length){case 1:case 2:x=t.m,m=n.length;break;case 3:return Mu[t.m-1][1];case 5:return Mu[t.m-1][0];default:return Mu[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:x=t.d,m=n.length;break;case 3:return Tm[t.q][0];default:return Tm[t.q][1]}break;case 104:switch(n.length){case 1:case 2:x=1+(t.H+11)%12,m=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:x=t.H,m=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:x=t.M,m=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?Tr(t.S,n.length):(s>=2?d=s===3?1e3:100:d=s===1?10:1,o=Math.round(d*(t.S+t.u)),o>=60*d&&(o=0),n==="s"?o===0?"0":""+o/d:(i=Tr(o,2+s),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":x=t.D*24+t.H;break;case"[m]":case"[mm]":x=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":x=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}m=n.length===3?1:2;break;case 101:x=f,m=1;break}var g=m>0?Tr(x,m):"";return g}function Ln(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,s=e.substr(0,t);t!=e.length;t+=n)s+=(s.length>0?",":"")+e.substr(t,n);return s}var jp=/%/g;function wy(e,n,t){var s=n.replace(jp,""),i=n.length-s.length;return en(e,s,t*Math.pow(10,2*i))+Ga("%",i)}function Sy(e,n,t){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return en(e,n.substr(0,s),t/Math.pow(10,3*(n.length-s)))}function Fp(e,n){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Fp(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(n/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),t.indexOf("e")===-1){var d=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(d-t.length+o):t+="E+"+(d-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,x,m,g){return x+m+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else t=n.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Lp=/# (\?+)( ?)\/( ?)(\d+)/;function Ay(e,n,t){var s=parseInt(e[4],10),i=Math.round(n*s),o=Math.floor(i/s),d=i-o*s,f=s;return t+(o===0?"":""+o)+" "+(d===0?Ga(" ",e[1].length+1+e[4].length):hf(d,e[1].length)+e[2]+"/"+e[3]+Tr(f,e[4].length))}function Ny(e,n,t){return t+(n===0?"":""+n)+Ga(" ",e[1].length+2+e[4].length)}var Mp=/^#*0*\.([0#]+)/,Ip=/\).*[0#]/,Bp=/\(###\) ###\\?-####/;function Ct(e){for(var n="",t,s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Sm(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Am(e,n){var t=e-Math.floor(e),s=Math.pow(10,n);return n<(""+Math.round(t*s)).length?0:Math.round(t*s)}function ky(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function Cy(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cr(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Ip)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?cr("n",s,t):"("+cr("n",s,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Sy(e,n,t);if(n.indexOf("%")!==-1)return wy(e,n,t);if(n.indexOf("E")!==-1)return Fp(n,t);if(n.charCodeAt(0)===36)return"$"+cr(e,n.substr(n.charAt(1)==" "?2:1),t);var i,o,d,f,x=Math.abs(t),m=t<0?"-":"";if(n.match(/^00+$/))return m+ii(x,n.length);if(n.match(/^[#?]+$/))return i=ii(t,0),i==="0"&&(i=""),i.length>n.length?i:Ct(n.substr(0,n.length-i.length))+i;if(o=n.match(Lp))return Ay(o,x,m);if(n.match(/^#+0+$/))return m+ii(x,n.length-n.indexOf("0"));if(o=n.match(Mp))return i=Sm(t,o[1].length).replace(/^([^\.]+)$/,"$1."+Ct(o[1])).replace(/\.$/,"."+Ct(o[1])).replace(/\.(\d*)$/,function(y,E){return"."+E+Ga("0",Ct(o[1]).length-E.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return m+Sm(x,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return m+Ln(ii(x,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+cr(e,n,-t):Ln(""+(Math.floor(t)+ky(t,o[1].length)))+"."+Tr(Am(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return cr(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ui(cr(e,n.replace(/[\\-]/g,""),t)),d=0,ui(ui(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return d<i.length?i.charAt(d++):y==="0"?"0":""}));if(n.match(Bp))return i=cr(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(o[4].length,7),f=f0(x,Math.pow(10,d)-1,!1),i=""+m,g=en("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=o0(f[2],d),g.length<o[4].length&&(g=Ct(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(o[1].length,o[4].length),7),f=f0(x,Math.pow(10,d)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?hf(f[1],d)+o[2]+"/"+o[3]+o0(f[2],d):Ga(" ",2*d+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=ii(t,0),n.length<=i.length?i:Ct(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),d=i.indexOf(".");var v=n.indexOf(".")-d,b=n.length-i.length-v;return Ct(n.substr(0,v)+i+n.substr(n.length-b))}if(o=n.match(/^00,000\.([#0]*0)$/))return d=Am(t,o[1].length),t<0?"-"+cr(e,n,-t):Ln(Cy(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Tr(0,3-y.length):"")+y})+"."+Tr(d,o[1].length);switch(n){case"###,##0.00":return cr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var _=Ln(ii(x,0));return _!=="0"?m+_:"";case"###,###.00":return cr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return cr(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function Oy(e,n,t){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return en(e,n.substr(0,s),t/Math.pow(10,3*(n.length-s)))}function Dy(e,n,t){var s=n.replace(jp,""),i=n.length-s.length;return en(e,s,t*Math.pow(10,2*i))+Ga("%",i)}function Up(e,n){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Up(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(n/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),!t.match(/[Ee]/)){var d=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(d-t.length+o):t+="E+"+(d-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,x,m,g){return x+m+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else t=n.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Rr(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Ip)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Rr("n",s,t):"("+Rr("n",s,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Oy(e,n,t);if(n.indexOf("%")!==-1)return Dy(e,n,t);if(n.indexOf("E")!==-1)return Up(n,t);if(n.charCodeAt(0)===36)return"$"+Rr(e,n.substr(n.charAt(1)==" "?2:1),t);var i,o,d,f,x=Math.abs(t),m=t<0?"-":"";if(n.match(/^00+$/))return m+Tr(x,n.length);if(n.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>n.length?i:Ct(n.substr(0,n.length-i.length))+i;if(o=n.match(Lp))return Ny(o,x,m);if(n.match(/^#+0+$/))return m+Tr(x,n.length-n.indexOf("0"));if(o=n.match(Mp))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Ct(o[1])).replace(/\.$/,"."+Ct(o[1])),i=i.replace(/\.(\d*)$/,function(y,E){return"."+E+Ga("0",Ct(o[1]).length-E.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return m+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return m+Ln(""+x);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Rr(e,n,-t):Ln(""+t)+"."+Ga("0",o[1].length);if(o=n.match(/^#,#*,#0/))return Rr(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ui(Rr(e,n.replace(/[\\-]/g,""),t)),d=0,ui(ui(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return d<i.length?i.charAt(d++):y==="0"?"0":""}));if(n.match(Bp))return i=Rr(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(o[4].length,7),f=f0(x,Math.pow(10,d)-1,!1),i=""+m,g=en("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=o0(f[2],d),g.length<o[4].length&&(g=Ct(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(o[1].length,o[4].length),7),f=f0(x,Math.pow(10,d)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?hf(f[1],d)+o[2]+"/"+o[3]+o0(f[2],d):Ga(" ",2*d+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=""+t,n.length<=i.length?i:Ct(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),d=i.indexOf(".");var v=n.indexOf(".")-d,b=n.length-i.length-v;return Ct(n.substr(0,v)+i+n.substr(n.length-b))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Rr(e,n,-t):Ln(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Tr(0,3-y.length):"")+y})+"."+Tr(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var _=Ln(""+x);return _!=="0"?m+_:"";default:if(n.match(/\.[0#?]*$/))return Rr(e,n.slice(0,n.lastIndexOf(".")),t)+Ct(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function en(e,n,t){return(t|0)===t?Rr(e,n,t):cr(e,n,t)}function Ry(e){for(var n=[],t=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=e.substr(i,s-i),i=s+1}if(n[n.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Pp=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mi(e){for(var n=0,t="",s="";n<e.length;)switch(t=e.charAt(n)){case"G":u0(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(s=t;e.charAt(n++)!=="]"&&n<e.length;)s+=e.charAt(n);if(s.match(Pp))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function jy(e,n,t,s){for(var i=[],o="",d=0,f="",x="t",m,g,v,b="H";d<e.length;)switch(f=e.charAt(d)){case"G":if(!u0(e,d))throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"G",v:"General"},d+=7;break;case'"':for(o="";(v=e.charCodeAt(++d))!==34&&d<e.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++d;break;case"\\":var _=e.charAt(++d),y=_==="("||_===")"?_:"t";i[i.length]={t:y,v:_},++d;break;case"_":i[i.length]={t:"t",v:" "},d+=2;break;case"@":i[i.length]={t:"T",v:n},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(m==null&&(m=os(n,t,e.charAt(d+1)==="2"),m==null))return"";i[i.length]={t:"X",v:e.substr(d,2)},x=f,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||m==null&&(m=os(n,t),m==null))return"";for(o=f;++d<e.length&&e.charAt(d).toLowerCase()===f;)o+=f;f==="m"&&x.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=b),i[i.length]={t:f,v:o},x=f;break;case"A":case"a":case"上":var E={t:f,v:f};if(m==null&&(m=os(n,t)),e.substr(d,3).toUpperCase()==="A/P"?(m!=null&&(E.v=m.H>=12?"P":"A"),E.t="T",b="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(m!=null&&(E.v=m.H>=12?"PM":"AM"),E.t="T",d+=5,b="h"):e.substr(d,5).toUpperCase()==="上午/下午"?(m!=null&&(E.v=m.H>=12?"下午":"上午"),E.t="T",d+=5,b="h"):(E.t="t",++d),m==null&&E.t==="T")return"";i[i.length]=E,x=f;break;case"[":for(o=f;e.charAt(d++)!=="]"&&d<e.length;)o+=e.charAt(d);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Pp)){if(m==null&&(m=os(n,t),m==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},x=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",mi(e)||(i[i.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=f;++d<e.length&&(f=e.charAt(d))==="0";)o+=f;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=f;++d<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(d))>-1;)o+=f;i[i.length]={t:"n",v:o};break;case"?":for(o=f;e.charAt(++d)===f;)o+=f;i[i.length]={t:f,v:o},x=f;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":i[i.length]={t:s===1?"t":f,v:f},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=f;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)o+=e.charAt(d);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:f,v:f},++d;break;case"$":i[i.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"t",v:f},++d;break}var T=0,A=0,D;for(d=i.length-1,x="t";d>=0;--d)switch(i[d].t){case"h":case"H":i[d].t=b,x="h",T<1&&(T=1);break;case"s":(D=i[d].v.match(/\.0+$/))&&(A=Math.max(A,D[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":x=i[d].t;break;case"m":x==="s"&&(i[d].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&i[d].v.match(/[Hh]/)&&(T=1),T<2&&i[d].v.match(/[Mm]/)&&(T=2),T<3&&i[d].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var S="",H;for(d=0;d<i.length;++d)switch(i[d].t){case"t":case"T":case" ":case"D":break;case"X":i[d].v="",i[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[d].v=Ty(i[d].t.charCodeAt(0),i[d].v,m,A),i[d].t="t";break;case"n":case"?":for(H=d+1;i[H]!=null&&((f=i[H].t)==="?"||f==="D"||(f===" "||f==="t")&&i[H+1]!=null&&(i[H+1].t==="?"||i[H+1].t==="t"&&i[H+1].v==="/")||i[d].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(i[H].v==="/"||i[H].v===" "&&i[H+1]!=null&&i[H+1].t=="?"));)i[d].v+=i[H].v,i[H]={v:"",t:";"},++H;S+=i[d].v,d=H-1;break;case"G":i[d].t="t",i[d].v=ds(n,t);break}var V="",Y,j;if(S.length>0){S.charCodeAt(0)==40?(Y=n<0&&S.charCodeAt(0)===45?-n:n,j=en("n",S,Y)):(Y=n<0&&s>1?-n:n,j=en("n",S,Y),Y<0&&i[0]&&i[0].t=="t"&&(j=j.substr(1),i[0].v="-"+i[0].v)),H=j.length-1;var J=i.length;for(d=0;d<i.length;++d)if(i[d]!=null&&i[d].t!="t"&&i[d].v.indexOf(".")>-1){J=d;break}var z=i.length;if(J===i.length&&j.indexOf("E")===-1){for(d=i.length-1;d>=0;--d)i[d]==null||"n?".indexOf(i[d].t)===-1||(H>=i[d].v.length-1?(H-=i[d].v.length,i[d].v=j.substr(H+1,i[d].v.length)):H<0?i[d].v="":(i[d].v=j.substr(0,H+1),H=-1),i[d].t="t",z=d);H>=0&&z<i.length&&(i[z].v=j.substr(0,H+1)+i[z].v)}else if(J!==i.length&&j.indexOf("E")===-1){for(H=j.indexOf(".")-1,d=J;d>=0;--d)if(!(i[d]==null||"n?".indexOf(i[d].t)===-1)){for(g=i[d].v.indexOf(".")>-1&&d===J?i[d].v.indexOf(".")-1:i[d].v.length-1,V=i[d].v.substr(g+1);g>=0;--g)H>=0&&(i[d].v.charAt(g)==="0"||i[d].v.charAt(g)==="#")&&(V=j.charAt(H--)+V);i[d].v=V,i[d].t="t",z=d}for(H>=0&&z<i.length&&(i[z].v=j.substr(0,H+1)+i[z].v),H=j.indexOf(".")+1,d=J;d<i.length;++d)if(!(i[d]==null||"n?(".indexOf(i[d].t)===-1&&d!==J)){for(g=i[d].v.indexOf(".")>-1&&d===J?i[d].v.indexOf(".")+1:0,V=i[d].v.substr(0,g);g<i[d].v.length;++g)H<j.length&&(V+=j.charAt(H++));i[d].v=V,i[d].t="t",z=d}}}for(d=0;d<i.length;++d)i[d]!=null&&"n?".indexOf(i[d].t)>-1&&(Y=s>1&&n<0&&d>0&&i[d-1].v==="-"?-n:n,i[d].v=en(i[d].t,i[d].v,Y),i[d].t="t");var ie="";for(d=0;d!==i.length;++d)i[d]!=null&&(ie+=i[d].v);return ie}var Nm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function km(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Fy(e,n){var t=Ry(e),s=t.length,i=t[s-1].indexOf("@");if(s<4&&i>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[s,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var d=t[0].match(Nm),f=t[1].match(Nm);return km(n,d)?[s,t[0]]:km(n,f)?[s,t[1]]:[s,t[d!=null&&f!=null?2:1]]}return[s,o]}function ur(e,n,t){t==null&&(t={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?s=t.dateNF:s=e;break;case"number":e==14&&t.dateNF?s=t.dateNF:s=(t.table!=null?t.table:sa)[e],s==null&&(s=t.table&&t.table[wm[e]]||sa[wm[e]]),s==null&&(s=py[e]||"General");break}if(u0(s,0))return ds(n,t);n instanceof Date&&(n=Rp(n,t.date1904));var i=Fy(s,n);if(u0(i[1]))return ds(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return jy(i[1],n,t,i[0])}function us(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(sa[t]==null){n<0&&(n=t);continue}if(sa[t]==e){n=t;break}}n<0&&(n=391)}return sa[n]=e,n}function Hp(){sa=my()}var Ly={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function My(e){var n=typeof e=="number"?sa[e]:e;return n=n.replace(zp,"(\\d+)"),new RegExp("^"+n+"$")}function Iy(e,n,t){var s=-1,i=-1,o=-1,d=-1,f=-1,x=-1;(n.match(zp)||[]).forEach(function(v,b){var _=parseInt(t[b+1],10);switch(v.toLowerCase().charAt(0)){case"y":s=_;break;case"d":o=_;break;case"h":d=_;break;case"s":x=_;break;case"m":d>=0?f=_:i=_;break}}),x>=0&&f==-1&&i>=0&&(f=i,i=-1);var m=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var g=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2);return d==-1&&f==-1&&x==-1?m:s==-1&&i==-1&&o==-1?g:m+"T"+g}var By=function(){var e={};e.version="1.2.0";function n(){for(var j=0,J=new Array(256),z=0;z!=256;++z)j=z,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,J[z]=j;return typeof Int32Array<"u"?new Int32Array(J):J}var t=n();function s(j){var J=0,z=0,ie=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)K[ie]=j[ie];for(ie=0;ie!=256;++ie)for(z=j[ie],J=256+ie;J<4096;J+=256)z=K[J]=z>>>8^j[z&255];var q=[];for(ie=1;ie!=16;++ie)q[ie-1]=typeof Int32Array<"u"?K.subarray(ie*256,ie*256+256):K.slice(ie*256,ie*256+256);return q}var i=s(t),o=i[0],d=i[1],f=i[2],x=i[3],m=i[4],g=i[5],v=i[6],b=i[7],_=i[8],y=i[9],E=i[10],T=i[11],A=i[12],D=i[13],S=i[14];function H(j,J){for(var z=J^-1,ie=0,K=j.length;ie<K;)z=z>>>8^t[(z^j.charCodeAt(ie++))&255];return~z}function V(j,J){for(var z=J^-1,ie=j.length-15,K=0;K<ie;)z=S[j[K++]^z&255]^D[j[K++]^z>>8&255]^A[j[K++]^z>>16&255]^T[j[K++]^z>>>24]^E[j[K++]]^y[j[K++]]^_[j[K++]]^b[j[K++]]^v[j[K++]]^g[j[K++]]^m[j[K++]]^x[j[K++]]^f[j[K++]]^d[j[K++]]^o[j[K++]]^t[j[K++]];for(ie+=15;K<ie;)z=z>>>8^t[(z^j[K++])&255];return~z}function Y(j,J){for(var z=J^-1,ie=0,K=j.length,q=0,re=0;ie<K;)q=j.charCodeAt(ie++),q<128?z=z>>>8^t[(z^q)&255]:q<2048?(z=z>>>8^t[(z^(192|q>>6&31))&255],z=z>>>8^t[(z^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,re=j.charCodeAt(ie++)&1023,z=z>>>8^t[(z^(240|q>>8&7))&255],z=z>>>8^t[(z^(128|q>>2&63))&255],z=z>>>8^t[(z^(128|re>>6&15|(q&3)<<4))&255],z=z>>>8^t[(z^(128|re&63))&255]):(z=z>>>8^t[(z^(224|q>>12&15))&255],z=z>>>8^t[(z^(128|q>>6&63))&255],z=z>>>8^t[(z^(128|q&63))&255]);return~z}return e.table=t,e.bstr=H,e.buf=V,e.str=Y,e}(),ga=function(){var n={};n.version="1.2.1";function t(N,L){for(var O=N.split("/"),F=L.split("/"),M=0,B=0,le=Math.min(O.length,F.length);M<le;++M){if(B=O[M].length-F[M].length)return B;if(O[M]!=F[M])return O[M]<F[M]?-1:1}return O.length-F.length}function s(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:s(N.slice(0,-1));var L=N.lastIndexOf("/");return L===-1?N:N.slice(0,L+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var L=N.lastIndexOf("/");return L===-1?N:N.slice(L+1)}function o(N,L){typeof L=="string"&&(L=new Date(L));var O=L.getHours();O=O<<6|L.getMinutes(),O=O<<5|L.getSeconds()>>>1,N.write_shift(2,O);var F=L.getFullYear()-1980;F=F<<4|L.getMonth()+1,F=F<<5|L.getDate(),N.write_shift(2,F)}function d(N){var L=N.read_shift(2)&65535,O=N.read_shift(2)&65535,F=new Date,M=O&31;O>>>=5;var B=O&15;O>>>=4,F.setMilliseconds(0),F.setFullYear(O+1980),F.setMonth(B-1),F.setDate(M);var le=L&31;L>>>=5;var be=L&63;return L>>>=6,F.setHours(L),F.setMinutes(be),F.setSeconds(le<<1),F}function f(N){pt(N,0);for(var L={},O=0;N.l<=N.length-4;){var F=N.read_shift(2),M=N.read_shift(2),B=N.l+M,le={};switch(F){case 21589:O=N.read_shift(1),O&1&&(le.mtime=N.read_shift(4)),M>5&&(O&2&&(le.atime=N.read_shift(4)),O&4&&(le.ctime=N.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}N.l=B,L[F]=le}return L}var x;function m(){return x||(x={})}function g(N,L){if(N[0]==80&&N[1]==75)return Hn(N,L);if((N[0]|32)==109&&(N[1]|32)==105)return Ss(N,L);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var O=3,F=512,M=0,B=0,le=0,be=0,te=0,fe=[],he=N.slice(0,512);pt(he,0);var Ne=v(he);switch(O=Ne[0],O){case 3:F=512;break;case 4:F=4096;break;case 0:if(Ne[1]==0)return Hn(N,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}F!==512&&(he=N.slice(0,F),pt(he,28));var De=N.slice(0,F);b(he,O);var Le=he.read_shift(4,"i");if(O===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);he.l+=4,le=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),be=he.read_shift(4,"i"),M=he.read_shift(4,"i"),te=he.read_shift(4,"i"),B=he.read_shift(4,"i");for(var Ce=-1,je=0;je<109&&(Ce=he.read_shift(4,"i"),!(Ce<0));++je)fe[je]=Ce;var ea=_(N,F);T(te,B,ea,F,fe);var ka=D(ea,le,fe,F);ka[le].name="!Directory",M>0&&be!==re&&(ka[be].name="!MiniFAT"),ka[fe[0]].name="!FAT",ka.fat_addrs=fe,ka.ssz=F;var Ca={},Fa=[],Br=[],cn=[];S(le,ka,ea,Fa,M,Ca,Br,be),y(Br,cn,Fa),Fa.shift();var Zt={FileIndex:Br,FullPaths:cn};return L&&L.raw&&(Zt.raw={header:De,sectors:ea}),Zt}function v(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(pe,"Header Signature: "),N.l+=16;var L=N.read_shift(2,"u");return[N.read_shift(2,"u"),L]}function b(N,L){var O=9;switch(N.l+=2,O=N.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function _(N,L){for(var O=Math.ceil(N.length/L)-1,F=[],M=1;M<O;++M)F[M-1]=N.slice(M*L,(M+1)*L);return F[O-1]=N.slice(O*L),F}function y(N,L,O){for(var F=0,M=0,B=0,le=0,be=0,te=O.length,fe=[],he=[];F<te;++F)fe[F]=he[F]=F,L[F]=O[F];for(;be<he.length;++be)F=he[be],M=N[F].L,B=N[F].R,le=N[F].C,fe[F]===F&&(M!==-1&&fe[M]!==M&&(fe[F]=fe[M]),B!==-1&&fe[B]!==B&&(fe[F]=fe[B])),le!==-1&&(fe[le]=F),M!==-1&&F!=fe[F]&&(fe[M]=fe[F],he.lastIndexOf(M)<be&&he.push(M)),B!==-1&&F!=fe[F]&&(fe[B]=fe[F],he.lastIndexOf(B)<be&&he.push(B));for(F=1;F<te;++F)fe[F]===F&&(B!==-1&&fe[B]!==B?fe[F]=fe[B]:M!==-1&&fe[M]!==M&&(fe[F]=fe[M]));for(F=1;F<te;++F)if(N[F].type!==0){if(be=F,be!=fe[be])do be=fe[be],L[F]=L[be]+"/"+L[F];while(be!==0&&fe[be]!==-1&&be!=fe[be]);fe[F]=-1}for(L[0]+="/",F=1;F<te;++F)N[F].type!==2&&(L[F]+="/")}function E(N,L,O){for(var F=N.start,M=N.size,B=[],le=F;O&&M>0&&le>=0;)B.push(L.slice(le*q,le*q+q)),M-=q,le=cs(O,le*4);return B.length===0?st(0):jn(B).slice(0,N.size)}function T(N,L,O,F,M){var B=re;if(N===re){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var le=O[N],be=(F>>>2)-1;if(!le)return;for(var te=0;te<be&&(B=cs(le,te*4))!==re;++te)M.push(B);T(cs(le,F-4),L-1,O,F,M)}}function A(N,L,O,F,M){var B=[],le=[];M||(M=[]);var be=F-1,te=0,fe=0;for(te=L;te>=0;){M[te]=!0,B[B.length]=te,le.push(N[te]);var he=O[Math.floor(te*4/F)];if(fe=te*4&be,F<4+fe)throw new Error("FAT boundary crossed: "+te+" 4 "+F);if(!N[he])break;te=cs(N[he],fe)}return{nodes:B,data:Bm([le])}}function D(N,L,O,F){var M=N.length,B=[],le=[],be=[],te=[],fe=F-1,he=0,Ne=0,De=0,Le=0;for(he=0;he<M;++he)if(be=[],De=he+L,De>=M&&(De-=M),!le[De]){te=[];var Ce=[];for(Ne=De;Ne>=0;){Ce[Ne]=!0,le[Ne]=!0,be[be.length]=Ne,te.push(N[Ne]);var je=O[Math.floor(Ne*4/F)];if(Le=Ne*4&fe,F<4+Le)throw new Error("FAT boundary crossed: "+Ne+" 4 "+F);if(!N[je]||(Ne=cs(N[je],Le),Ce[Ne]))break}B[De]={nodes:be,data:Bm([te])}}return B}function S(N,L,O,F,M,B,le,be){for(var te=0,fe=F.length?2:0,he=L[N].data,Ne=0,De=0,Le;Ne<he.length;Ne+=128){var Ce=he.slice(Ne,Ne+128);pt(Ce,64),De=Ce.read_shift(2),Le=bf(Ce,0,De-fe),F.push(Le);var je={name:Le,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},ea=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);ea!==0&&(je.ct=H(Ce,Ce.l-8));var ka=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);ka!==0&&(je.mt=H(Ce,Ce.l-8)),je.start=Ce.read_shift(4,"i"),je.size=Ce.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=re,je.name=""),je.type===5?(te=je.start,M>0&&te!==re&&(L[te].name="!StreamData")):je.size>=4096?(je.storage="fat",L[je.start]===void 0&&(L[je.start]=A(O,je.start,L.fat_addrs,L.ssz)),L[je.start].name=je.name,je.content=L[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:te!==re&&je.start!==re&&L[te]&&(je.content=E(je,L[te].data,(L[be]||{}).data))),je.content&&pt(je.content,0),B[Le]=je,le.push(je)}}function H(N,L){return new Date((qt(N,L+4)/1e7*Math.pow(2,32)+qt(N,L)/1e7-11644473600)*1e3)}function V(N,L){return m(),g(x.readFileSync(N),L)}function Y(N,L){var O=L&&L.type;switch(O||xa&&Buffer.isBuffer(N)&&(O="buffer"),O||"base64"){case"file":return V(N,L);case"base64":return g(Er(Wt(N)),L);case"binary":return g(Er(N),L)}return g(N,L)}function j(N,L){var O=L||{},F=O.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=F+"/",N.FileIndex[0]={name:F,type:5}),O.CLSID&&(N.FileIndex[0].clsid=O.CLSID),J(N)}function J(N){var L="Sh33tJ5";if(!ga.find(N,"/"+L)){var O=st(4);O[0]=55,O[1]=O[3]=50,O[2]=54,N.FileIndex.push({name:L,type:2,content:O,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+L),z(N)}}function z(N,L){j(N);for(var O=!1,F=!1,M=N.FullPaths.length-1;M>=0;--M){var B=N.FileIndex[M];switch(B.type){case 0:F?O=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(B.R*B.L*B.C)&&(O=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!L)){var le=new Date(1987,1,19),be=0,te=Object.create?Object.create(null):{},fe=[];for(M=0;M<N.FullPaths.length;++M)te[N.FullPaths[M]]=!0,N.FileIndex[M].type!==0&&fe.push([N.FullPaths[M],N.FileIndex[M]]);for(M=0;M<fe.length;++M){var he=s(fe[M][0]);F=te[he],F||(fe.push([he,{name:i(he).replace("/",""),type:1,clsid:Z,ct:le,mt:le,content:null}]),te[he]=!0)}for(fe.sort(function(Le,Ce){return t(Le[0],Ce[0])}),N.FullPaths=[],N.FileIndex=[],M=0;M<fe.length;++M)N.FullPaths[M]=fe[M][0],N.FileIndex[M]=fe[M][1];for(M=0;M<fe.length;++M){var Ne=N.FileIndex[M],De=N.FullPaths[M];if(Ne.name=i(De).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Z,M===0)Ne.C=fe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(De.slice(-1)=="/"){for(be=M+1;be<fe.length&&s(N.FullPaths[be])!=De;++be);for(Ne.C=be>=fe.length?-1:be,be=M+1;be<fe.length&&s(N.FullPaths[be])!=s(De);++be);Ne.R=be>=fe.length?-1:be,Ne.type=1}else s(N.FullPaths[M+1]||"")==s(De)&&(Ne.R=M+1),Ne.type=2}}}function ie(N,L){var O=L||{};if(O.fileType=="mad")return dr(N,O);switch(z(N),O.fileType){case"zip":return Sr(N,O)}var F=function(Le){for(var Ce=0,je=0,ea=0;ea<Le.FileIndex.length;++ea){var ka=Le.FileIndex[ea];if(ka.content){var Ca=ka.content.length;Ca>0&&(Ca<4096?Ce+=Ca+63>>6:je+=Ca+511>>9)}}for(var Fa=Le.FullPaths.length+3>>2,Br=Ce+7>>3,cn=Ce+127>>7,Zt=Br+je+Fa+cn,xr=Zt+127>>7,Gn=xr<=109?0:Math.ceil((xr-109)/127);Zt+xr+Gn+127>>7>xr;)Gn=++xr<=109?0:Math.ceil((xr-109)/127);var mr=[1,Gn,xr,cn,Fa,je,Ce,0];return Le.FileIndex[0].size=Ce<<6,mr[7]=(Le.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr}(N),M=st(F[7]<<9),B=0,le=0;{for(B=0;B<8;++B)M.write_shift(1,Ae[B]);for(B=0;B<8;++B)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),B=0;B<3;++B)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,F[2]),M.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:re),M.write_shift(4,F[3]),M.write_shift(-4,F[1]?F[0]-1:re),M.write_shift(4,F[1]),B=0;B<109;++B)M.write_shift(-4,B<F[2]?F[1]+B:-1)}if(F[1])for(le=0;le<F[1];++le){for(;B<236+le*127;++B)M.write_shift(-4,B<F[2]?F[1]+B:-1);M.write_shift(-4,le===F[1]-1?re:le+1)}var be=function(Le){for(le+=Le;B<le-1;++B)M.write_shift(-4,B+1);Le&&(++B,M.write_shift(-4,re))};for(le=B=0,le+=F[1];B<le;++B)M.write_shift(-4,oe.DIFSECT);for(le+=F[2];B<le;++B)M.write_shift(-4,oe.FATSECT);be(F[3]),be(F[4]);for(var te=0,fe=0,he=N.FileIndex[0];te<N.FileIndex.length;++te)he=N.FileIndex[te],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=le,be(fe+511>>9)));for(be(F[6]+7>>3);M.l&511;)M.write_shift(-4,oe.ENDOFCHAIN);for(le=B=0,te=0;te<N.FileIndex.length;++te)he=N.FileIndex[te],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=le,be(fe+63>>6)));for(;M.l&511;)M.write_shift(-4,oe.ENDOFCHAIN);for(B=0;B<F[4]<<2;++B){var Ne=N.FullPaths[B];if(!Ne||Ne.length===0){for(te=0;te<17;++te)M.write_shift(4,0);for(te=0;te<3;++te)M.write_shift(4,-1);for(te=0;te<12;++te)M.write_shift(4,0);continue}he=N.FileIndex[B],B===0&&(he.start=he.size?he.start-1:re);var De=B===0&&O.root||he.name;if(fe=2*(De.length+1),M.write_shift(64,De,"utf16le"),M.write_shift(2,fe),M.write_shift(1,he.type),M.write_shift(1,he.color),M.write_shift(-4,he.L),M.write_shift(-4,he.R),M.write_shift(-4,he.C),he.clsid)M.write_shift(16,he.clsid,"hex");else for(te=0;te<4;++te)M.write_shift(4,0);M.write_shift(4,he.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,he.start),M.write_shift(4,he.size),M.write_shift(4,0)}for(B=1;B<N.FileIndex.length;++B)if(he=N.FileIndex[B],he.size>=4096)if(M.l=he.start+1<<9,xa&&Buffer.isBuffer(he.content))he.content.copy(M,M.l,0,he.size),M.l+=he.size+511&-512;else{for(te=0;te<he.size;++te)M.write_shift(1,he.content[te]);for(;te&511;++te)M.write_shift(1,0)}for(B=1;B<N.FileIndex.length;++B)if(he=N.FileIndex[B],he.size>0&&he.size<4096)if(xa&&Buffer.isBuffer(he.content))he.content.copy(M,M.l,0,he.size),M.l+=he.size+63&-64;else{for(te=0;te<he.size;++te)M.write_shift(1,he.content[te]);for(;te&63;++te)M.write_shift(1,0)}if(xa)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function K(N,L){var O=N.FullPaths.map(function(te){return te.toUpperCase()}),F=O.map(function(te){var fe=te.split("/");return fe[fe.length-(te.slice(-1)=="/"?2:1)]}),M=!1;L.charCodeAt(0)===47?(M=!0,L=O[0].slice(0,-1)+L):M=L.indexOf("/")!==-1;var B=L.toUpperCase(),le=M===!0?O.indexOf(B):F.indexOf(B);if(le!==-1)return N.FileIndex[le];var be=!B.match(xl);for(B=B.replace(Rt,""),be&&(B=B.replace(xl,"!")),le=0;le<O.length;++le)if((be?O[le].replace(xl,"!"):O[le]).replace(Rt,"")==B||(be?F[le].replace(xl,"!"):F[le]).replace(Rt,"")==B)return N.FileIndex[le];return null}var q=64,re=-2,pe="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(N,L,O){m();var F=ie(N,O);x.writeFileSync(L,F)}function ee(N){for(var L=new Array(N.length),O=0;O<N.length;++O)L[O]=String.fromCharCode(N[O]);return L.join("")}function P(N,L){var O=ie(N,L);switch(L&&L.type||"buffer"){case"file":return m(),x.writeFileSync(L.filename,O),O;case"binary":return typeof O=="string"?O:ee(O);case"base64":return ym(typeof O=="string"?O:ee(O));case"buffer":if(xa)return Buffer.isBuffer(O)?O:ms(O);case"array":return typeof O=="string"?Er(O):O}return O}var ce;function C(N){try{var L=N.InflateRaw,O=new L;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ce=N;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function X(N,L){if(!ce)return Es(N,L);var O=ce.InflateRaw,F=new O,M=F._processChunk(N.slice(N.l),F._finishFlushFlag);return N.l+=F.bytesRead,M}function U(N){return ce?ce.deflateRawSync(N):Oe(N)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(N){var L=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(L>>16|L>>8|L)&255}for(var Te=typeof Uint8Array<"u",Ee=Te?new Uint8Array(256):[],Be=0;Be<256;++Be)Ee[Be]=ve(Be);function I(N,L){var O=Ee[N&255];return L<=8?O>>>8-L:(O=O<<8|Ee[N>>8&255],L<=16?O>>>16-L:(O=O<<8|Ee[N>>16&255],O>>>24-L))}function Pe(N,L){var O=L&7,F=L>>>3;return(N[F]|(O<=6?0:N[F+1]<<8))>>>O&3}function Ue(N,L){var O=L&7,F=L>>>3;return(N[F]|(O<=5?0:N[F+1]<<8))>>>O&7}function We(N,L){var O=L&7,F=L>>>3;return(N[F]|(O<=4?0:N[F+1]<<8))>>>O&15}function Ve(N,L){var O=L&7,F=L>>>3;return(N[F]|(O<=3?0:N[F+1]<<8))>>>O&31}function ge(N,L){var O=L&7,F=L>>>3;return(N[F]|(O<=1?0:N[F+1]<<8))>>>O&127}function Ie(N,L,O){var F=L&7,M=L>>>3,B=(1<<O)-1,le=N[M]>>>F;return O<8-F||(le|=N[M+1]<<8-F,O<16-F)||(le|=N[M+2]<<16-F,O<24-F)||(le|=N[M+3]<<24-F),le&B}function ma(N,L,O){var F=L&7,M=L>>>3;return F<=5?N[M]|=(O&7)<<F:(N[M]|=O<<F&255,N[M+1]=(O&7)>>8-F),L+3}function we(N,L,O){var F=L&7,M=L>>>3;return O=(O&1)<<F,N[M]|=O,L+1}function Fe(N,L,O){var F=L&7,M=L>>>3;return O<<=F,N[M]|=O&255,O>>>=8,N[M+1]=O,L+8}function la(N,L,O){var F=L&7,M=L>>>3;return O<<=F,N[M]|=O&255,O>>>=8,N[M+1]=O&255,N[M+2]=O>>>8,L+16}function Ge(N,L){var O=N.length,F=2*O>L?2*O:L+5,M=0;if(O>=L)return N;if(xa){var B=Em(F);if(N.copy)N.copy(B);else for(;M<N.length;++M)B[M]=N[M];return B}else if(Te){var le=new Uint8Array(F);if(le.set)le.set(N);else for(;M<O;++M)le[M]=N[M];return le}return N.length=F,N}function ra(N){for(var L=new Array(N),O=0;O<N;++O)L[O]=0;return L}function Na(N,L,O){var F=1,M=0,B=0,le=0,be=0,te=N.length,fe=Te?new Uint16Array(32):ra(32);for(B=0;B<32;++B)fe[B]=0;for(B=te;B<O;++B)N[B]=0;te=N.length;var he=Te?new Uint16Array(te):ra(te);for(B=0;B<te;++B)fe[M=N[B]]++,F<M&&(F=M),he[B]=0;for(fe[0]=0,B=1;B<=F;++B)fe[B+16]=be=be+fe[B-1]<<1;for(B=0;B<te;++B)be=N[B],be!=0&&(he[B]=fe[be+16]++);var Ne=0;for(B=0;B<te;++B)if(Ne=N[B],Ne!=0)for(be=I(he[B],F)>>F-Ne,le=(1<<F+4-Ne)-1;le>=0;--le)L[be|le<<Ne]=Ne&15|B<<4;return F}var ca=Te?new Uint16Array(512):ra(512),na=Te?new Uint16Array(32):ra(32);if(!Te){for(var ke=0;ke<512;++ke)ca[ke]=0;for(ke=0;ke<32;++ke)na[ke]=0}(function(){for(var N=[],L=0;L<32;L++)N.push(5);Na(N,na,32);var O=[];for(L=0;L<=143;L++)O.push(8);for(;L<=255;L++)O.push(9);for(;L<=279;L++)O.push(7);for(;L<=287;L++)O.push(8);Na(O,ca,288)})();var Qe=function(){for(var L=Te?new Uint8Array(32768):[],O=0,F=0;O<me.length-1;++O)for(;F<me[O+1];++F)L[F]=O;for(;F<32768;++F)L[F]=29;var M=Te?new Uint8Array(259):[];for(O=0,F=0;O<W.length-1;++O)for(;F<W[O+1];++F)M[F]=O;function B(be,te){for(var fe=0;fe<be.length;){var he=Math.min(65535,be.length-fe),Ne=fe+he==be.length;for(te.write_shift(1,+Ne),te.write_shift(2,he),te.write_shift(2,~he&65535);he-- >0;)te[te.l++]=be[fe++]}return te.l}function le(be,te){for(var fe=0,he=0,Ne=Te?new Uint16Array(32768):[];he<be.length;){var De=Math.min(65535,be.length-he);if(De<10){for(fe=ma(te,fe,+(he+De==be.length)),fe&7&&(fe+=8-(fe&7)),te.l=fe/8|0,te.write_shift(2,De),te.write_shift(2,~De&65535);De-- >0;)te[te.l++]=be[he++];fe=te.l*8;continue}fe=ma(te,fe,+(he+De==be.length)+2);for(var Le=0;De-- >0;){var Ce=be[he];Le=(Le<<5^Ce)&32767;var je=-1,ea=0;if((je=Ne[Le])&&(je|=he&-32768,je>he&&(je-=32768),je<he))for(;be[je+ea]==be[he+ea]&&ea<250;)++ea;if(ea>2){Ce=M[ea],Ce<=22?fe=Fe(te,fe,Ee[Ce+1]>>1)-1:(Fe(te,fe,3),fe+=5,Fe(te,fe,Ee[Ce-23]>>5),fe+=3);var ka=Ce<8?0:Ce-4>>2;ka>0&&(la(te,fe,ea-W[Ce]),fe+=ka),Ce=L[he-je],fe=Fe(te,fe,Ee[Ce]>>3),fe-=3;var Ca=Ce<4?0:Ce-2>>1;Ca>0&&(la(te,fe,he-je-me[Ce]),fe+=Ca);for(var Fa=0;Fa<ea;++Fa)Ne[Le]=he&32767,Le=(Le<<5^be[he])&32767,++he;De-=ea-1}else Ce<=143?Ce=Ce+48:fe=we(te,fe,1),fe=Fe(te,fe,Ee[Ce]),Ne[Le]=he&32767,++he}fe=Fe(te,fe,0)-1}return te.l=(fe+7)/8|0,te.l}return function(te,fe){return te.length<8?B(te,fe):le(te,fe)}}();function Oe(N){var L=st(50+Math.floor(N.length*1.1)),O=Qe(N,L);return L.slice(0,O)}var ze=Te?new Uint16Array(32768):ra(32768),_a=Te?new Uint16Array(32768):ra(32768),ya=Te?new Uint16Array(128):ra(128),Pa=1,$t=1;function sn(N,L){var O=Ve(N,L)+257;L+=5;var F=Ve(N,L)+1;L+=5;var M=We(N,L)+4;L+=4;for(var B=0,le=Te?new Uint8Array(19):ra(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,fe=Te?new Uint8Array(8):ra(8),he=Te?new Uint8Array(8):ra(8),Ne=le.length,De=0;De<M;++De)le[R[De]]=B=Ue(N,L),te<B&&(te=B),fe[B]++,L+=3;var Le=0;for(fe[0]=0,De=1;De<=te;++De)he[De]=Le=Le+fe[De-1]<<1;for(De=0;De<Ne;++De)(Le=le[De])!=0&&(be[De]=he[Le]++);var Ce=0;for(De=0;De<Ne;++De)if(Ce=le[De],Ce!=0){Le=Ee[be[De]]>>8-Ce;for(var je=(1<<7-Ce)-1;je>=0;--je)ya[Le|je<<Ce]=Ce&7|De<<3}var ea=[];for(te=1;ea.length<O+F;)switch(Le=ya[ge(N,L)],L+=Le&7,Le>>>=3){case 16:for(B=3+Pe(N,L),L+=2,Le=ea[ea.length-1];B-- >0;)ea.push(Le);break;case 17:for(B=3+Ue(N,L),L+=3;B-- >0;)ea.push(0);break;case 18:for(B=11+ge(N,L),L+=7;B-- >0;)ea.push(0);break;default:ea.push(Le),te<Le&&(te=Le);break}var ka=ea.slice(0,O),Ca=ea.slice(O);for(De=O;De<286;++De)ka[De]=0;for(De=F;De<30;++De)Ca[De]=0;return Pa=Na(ka,ze,286),$t=Na(Ca,_a,30),L}function Ir(N,L){if(N[0]==3&&!(N[1]&3))return[In(L),2];for(var O=0,F=0,M=Em(L||1<<18),B=0,le=M.length>>>0,be=0,te=0;(F&1)==0;){if(F=Ue(N,O),O+=3,F>>>1)F>>1==1?(be=9,te=5):(O=sn(N,O),be=Pa,te=$t);else{O&7&&(O+=8-(O&7));var fe=N[O>>>3]|N[(O>>>3)+1]<<8;if(O+=32,fe>0)for(!L&&le<B+fe&&(M=Ge(M,B+fe),le=M.length);fe-- >0;)M[B++]=N[O>>>3],O+=8;continue}for(;;){!L&&le<B+32767&&(M=Ge(M,B+32767),le=M.length);var he=Ie(N,O,be),Ne=F>>>1==1?ca[he]:ze[he];if(O+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)M[B++]=Ne;else{if(Ne==256)break;Ne-=257;var De=Ne<8?0:Ne-4>>2;De>5&&(De=0);var Le=B+W[Ne];De>0&&(Le+=Ie(N,O,De),O+=De),he=Ie(N,O,te),Ne=F>>>1==1?na[he]:_a[he],O+=Ne&15,Ne>>>=4;var Ce=Ne<4?0:Ne-2>>1,je=me[Ne];for(Ce>0&&(je+=Ie(N,O,Ce),O+=Ce),!L&&le<Le&&(M=Ge(M,Le+100),le=M.length);B<Le;)M[B]=M[B-je],++B}}}return L?[M,O+7>>>3]:[M.slice(0,B),O+7>>>3]}function Es(N,L){var O=N.slice(N.l||0),F=Ir(O,L);return N.l+=F[1],F[0]}function Pn(N,L){if(N)typeof console<"u"&&console.error(L);else throw new Error(L)}function Hn(N,L){var O=N;pt(O,0);var F=[],M=[],B={FileIndex:F,FullPaths:M};j(B,{root:L.root});for(var le=O.length-4;(O[le]!=80||O[le+1]!=75||O[le+2]!=5||O[le+3]!=6)&&le>=0;)--le;O.l=le+4,O.l+=4;var be=O.read_shift(2);O.l+=6;var te=O.read_shift(4);for(O.l=te,le=0;le<be;++le){O.l+=20;var fe=O.read_shift(4),he=O.read_shift(4),Ne=O.read_shift(2),De=O.read_shift(2),Le=O.read_shift(2);O.l+=8;var Ce=O.read_shift(4),je=f(O.slice(O.l+Ne,O.l+Ne+De));O.l+=Ne+De+Le;var ea=O.l;O.l=Ce+4,zn(O,fe,he,B,je),O.l=ea}return B}function zn(N,L,O,F,M){N.l+=2;var B=N.read_shift(2),le=N.read_shift(2),be=d(N);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var te=N.read_shift(4),fe=N.read_shift(4),he=N.read_shift(4),Ne=N.read_shift(2),De=N.read_shift(2),Le="",Ce=0;Ce<Ne;++Ce)Le+=String.fromCharCode(N[N.l++]);if(De){var je=f(N.slice(N.l,N.l+De));(je[21589]||{}).mt&&(be=je[21589].mt),((M||{})[21589]||{}).mt&&(be=M[21589].mt)}N.l+=De;var ea=N.slice(N.l,N.l+fe);switch(le){case 8:ea=X(N,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var ka=!1;B&8&&(te=N.read_shift(4),te==134695760&&(te=N.read_shift(4),ka=!0),fe=N.read_shift(4),he=N.read_shift(4)),fe!=L&&Pn(ka,"Bad compressed size: "+L+" != "+fe),he!=O&&Pn(ka,"Bad uncompressed size: "+O+" != "+he),$a(F,Le,ea,{unsafe:!0,mt:be})}function Sr(N,L){var O=L||{},F=[],M=[],B=st(1),le=O.compression?8:0,be=0,te=0,fe=0,he=0,Ne=0,De=N.FullPaths[0],Le=De,Ce=N.FileIndex[0],je=[],ea=0;for(te=1;te<N.FullPaths.length;++te)if(Le=N.FullPaths[te].slice(De.length),Ce=N.FileIndex[te],!(!Ce.size||!Ce.content||Le=="Sh33tJ5")){var ka=he,Ca=st(Le.length);for(fe=0;fe<Le.length;++fe)Ca.write_shift(1,Le.charCodeAt(fe)&127);Ca=Ca.slice(0,Ca.l),je[Ne]=By.buf(Ce.content,0);var Fa=Ce.content;le==8&&(Fa=U(Fa)),B=st(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,be),B.write_shift(2,le),Ce.mt?o(B,Ce.mt):B.write_shift(4,0),B.write_shift(-4,je[Ne]),B.write_shift(4,Fa.length),B.write_shift(4,Ce.content.length),B.write_shift(2,Ca.length),B.write_shift(2,0),he+=B.length,F.push(B),he+=Ca.length,F.push(Ca),he+=Fa.length,F.push(Fa),B=st(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,be),B.write_shift(2,le),B.write_shift(4,0),B.write_shift(-4,je[Ne]),B.write_shift(4,Fa.length),B.write_shift(4,Ce.content.length),B.write_shift(2,Ca.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,ka),ea+=B.l,M.push(B),ea+=Ca.length,M.push(Ca),++Ne}return B=st(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Ne),B.write_shift(2,Ne),B.write_shift(4,ea),B.write_shift(4,he),B.write_shift(2,0),jn([jn(F),jn(M),B])}var ln={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _s(N,L){if(N.ctype)return N.ctype;var O=N.name||"",F=O.match(/\.([^\.]+)$/);return F&&ln[F[1]]||L&&(F=(O=L).match(/[\.\\]([^\.\\])+$/),F&&ln[F[1]])?ln[F[1]]:"application/octet-stream"}function Ts(N){for(var L=ym(N),O=[],F=0;F<L.length;F+=76)O.push(L.slice(F,F+76));return O.join(`\r
`)+`\r
`}function Vn(N){var L=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],F=L.split(`\r
`),M=0;M<F.length;++M){var B=F[M];if(B.length==0){O.push("");continue}for(var le=0;le<B.length;){var be=76,te=B.slice(le,le+be);te.charAt(be-1)=="="?be--:te.charAt(be-2)=="="?be-=2:te.charAt(be-3)=="="&&(be-=3),te=B.slice(le,le+be),le+=be,le<B.length&&(te+="="),O.push(te)}}return O.join(`\r
`)}function Ha(N){for(var L=[],O=0;O<N.length;++O){for(var F=N[O];O<=N.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+N[++O];L.push(F)}for(var M=0;M<L.length;++M)L[M]=L[M].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Er(L.join(`\r
`))}function ws(N,L,O){for(var F="",M="",B="",le,be=0;be<10;++be){var te=L[be];if(!te||te.match(/^\s*$/))break;var fe=te.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":F=fe[2].trim();break;case"content-type":B=fe[2].trim();break;case"content-transfer-encoding":M=fe[2].trim();break}}switch(++be,M.toLowerCase()){case"base64":le=Er(Wt(L.slice(be).join("")));break;case"quoted-printable":le=Ha(L.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var he=$a(N,F.slice(O.length),le,{unsafe:!0});B&&(he.ctype=B)}function Ss(N,L){if(ee(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=L&&L.root||"",F=(xa&&Buffer.isBuffer(N)?N.toString("binary"):ee(N)).split(`\r
`),M=0,B="";for(M=0;M<F.length;++M)if(B=F[M],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),O||(O=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),B.slice(0,O.length)!=O););var le=(F[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var be="--"+(le[1]||""),te=[],fe=[],he={FileIndex:te,FullPaths:fe};j(he);var Ne,De=0;for(M=0;M<F.length;++M){var Le=F[M];Le!==be&&Le!==be+"--"||(De++&&ws(he,F.slice(Ne,M),O),Ne=M)}return he}function dr(N,L){var O=L||{},F=O.boundary||"SheetJS";F="------="+F;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],B=N.FullPaths[0],le=B,be=N.FileIndex[0],te=1;te<N.FullPaths.length;++te)if(le=N.FullPaths[te].slice(B.length),be=N.FileIndex[te],!(!be.size||!be.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ea){return"_x"+ea.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ea){return"_u"+ea.charCodeAt(0).toString(16)+"_"});for(var fe=be.content,he=xa&&Buffer.isBuffer(fe)?fe.toString("binary"):ee(fe),Ne=0,De=Math.min(1024,he.length),Le=0,Ce=0;Ce<=De;++Ce)(Le=he.charCodeAt(Ce))>=32&&Le<128&&++Ne;var je=Ne>=De*4/5;M.push(F),M.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+le),M.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),M.push("Content-Type: "+_s(be,le)),M.push(""),M.push(je?Vn(he):Ts(he))}return M.push(F+`--\r
`),M.join(`\r
`)}function Xa(N){var L={};return j(L,N),L}function $a(N,L,O,F){var M=F&&F.unsafe;M||j(N);var B=!M&&ga.find(N,L);if(!B){var le=N.FullPaths[0];L.slice(0,le.length)==le?le=L:(le.slice(-1)!="/"&&(le+="/"),le=(le+L).replace("//","/")),B={name:i(L),type:2},N.FileIndex.push(B),N.FullPaths.push(le),M||ga.utils.cfb_gc(N)}return B.content=O,B.size=O?O.length:0,F&&(F.CLSID&&(B.clsid=F.CLSID),F.mt&&(B.mt=F.mt),F.ct&&(B.ct=F.ct)),B}function hr(N,L){j(N);var O=ga.find(N,L);if(O){for(var F=0;F<N.FileIndex.length;++F)if(N.FileIndex[F]==O)return N.FileIndex.splice(F,1),N.FullPaths.splice(F,1),!0}return!1}function Ye(N,L,O){j(N);var F=ga.find(N,L);if(F){for(var M=0;M<N.FileIndex.length;++M)if(N.FileIndex[M]==F)return N.FileIndex[M].name=i(O),N.FullPaths[M]=O,!0}return!1}function oa(N){z(N,!0)}return n.find=K,n.read=Y,n.parse=g,n.write=P,n.writeFile=Re,n.utils={cfb_new:Xa,cfb_add:$a,cfb_del:hr,cfb_mov:Ye,cfb_gc:oa,ReadShift:gl,CheckField:ug,prep_blob:pt,bconcat:jn,use_zlib:C,_deflateRaw:Oe,_inflateRaw:Es,consts:oe},n}();function Uy(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Fr(e){for(var n=Object.keys(e),t=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e,n[s])&&t.push(n[s]);return t}function mf(e){for(var n=[],t=Fr(e),s=0;s!==t.length;++s)n[e[t[s]]]=t[s];return n}var d0=new Date(1899,11,30,0,0,0);function jt(e,n){var t=e.getTime(),s=d0.getTime()+(e.getTimezoneOffset()-d0.getTimezoneOffset())*6e4;return(t-s)/(1440*60*1e3)}var Vp=new Date,Py=d0.getTime()+(Vp.getTimezoneOffset()-d0.getTimezoneOffset())*6e4,Cm=Vp.getTimezoneOffset();function E0(e){var n=new Date;return n.setTime(e*24*60*60*1e3+Py),n.getTimezoneOffset()!==Cm&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Cm)*6e4),n}function Hy(e){var n=0,t=0,s=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(t=1,o>3&&(s=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(s)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(i[o],10)}return n}var Om=new Date("2017-02-19T19:06:09.000Z"),Gp=isNaN(Om.getFullYear())?new Date("2/19/17"):Om,zy=Gp.getFullYear()==2017;function dt(e,n){var t=new Date(e);if(zy)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Gp.getFullYear()==1917&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function hs(e,n){if(xa&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return pl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return pl(Op(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return pl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return pl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function gt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=gt(e[t]));return n}function Ga(e,n){for(var t="";t.length<n;)t+=e;return t}function wr(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,o){return t=-t,o}),!isNaN(n=Number(s)))?n/t:n}var Vy=["january","february","march","april","may","june","july","august","september","october","november","december"];function hi(e){var n=new Date(e),t=new Date(NaN),s=n.getYear(),i=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&Vy.indexOf(d)==-1)return t}else if(d.match(/[a-z]/))return t;return s<0||s>8099?t:(i>0||o>1)&&s!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var Gy=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,s,i){if(e||typeof s=="string")return t.split(s);for(var o=t.split(s),d=[o[0]],f=1;f<o.length;++f)d.push(i),d.push(o[f]);return d}}();function Yp(e){return e?e.content&&e.type?hs(e.content,!0):e.data?hl(e.data):e.asNodeBuffer&&xa?hl(e.asNodeBuffer().toString("binary")):e.asBinary?hl(e.asBinary()):e._data&&e._data.getContent?hl(hs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xp(e){if(!e)return null;if(e.data)return vm(e.data);if(e.asNodeBuffer&&xa)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?vm(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function Yy(e){return e&&e.name.slice(-4)===".bin"?Xp(e):Yp(e)}function or(e,n){for(var t=e.FullPaths||Fr(e.files),s=n.toLowerCase().replace(/[\/]/g,"\\"),i=s.replace(/\\/g,"/"),o=0;o<t.length;++o){var d=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==d||i==d)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function pf(e,n){var t=or(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function et(e,n,t){if(!t)return Yy(pf(e,n));if(!n)return null;try{return et(e,n)}catch{return null}}function Kt(e,n,t){if(!t)return Yp(pf(e,n));if(!n)return null;try{return Kt(e,n)}catch{return null}}function Xy(e,n,t){return Xp(pf(e,n))}function Dm(e){for(var n=e.FullPaths||Fr(e.files),t=[],s=0;s<n.length;++s)n[s].slice(-1)!="/"&&t.push(n[s].replace(/^Root Entry[\/]/,""));return t.sort()}function qy(e,n,t){if(e.FullPaths){if(typeof t=="string"){var s;return xa?s=ms(t):s=dy(t),ga.utils.cfb_add(e,n,s)}ga.utils.cfb_add(e,n,t)}else e.file(n,t)}function qp(e,n){switch(n.type){case"base64":return ga.read(e,{type:"base64"});case"binary":return ga.read(e,{type:"binary"});case"buffer":case"array":return ga.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ml(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var s=e.split("/");s.length!==0;){var i=s.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Kp=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ky=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Rm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Wy=/<[^>]*>/g,Nt=Kp.match(Rm)?Rm:Wy,$y=/<\w*:/,Zy=/<(\/?)\w+:/;function Ze(e,n,t){for(var s={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(n||(s[0]=e.slice(0,i)),i===e.length)return s;var d=e.match(Ky),f=0,x="",m=0,g="",v="",b=1;if(d)for(m=0;m!=d.length;++m){for(v=d[m],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(g=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(b=(i=v.charCodeAt(o+1))==34||i==39?1:0,x=v.slice(o+1+b,v.length-b),f=0;f!=g.length&&g.charCodeAt(f)!==58;++f);if(f===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),s[g]=x,s[g.toLowerCase()]=x;else{var _=(f===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(f+1);if(s[_]&&g.slice(f-3,f)=="ext")continue;s[_]=x,s[_.toLowerCase()]=x}}return s}function Lr(e){return e.replace(Zy,"<$1")}var Wp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Qy=mf(Wp),ba=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(s){var i=s+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(e,function(f,x){return Wp[f]||String.fromCharCode(parseInt(x,f.indexOf("x")>-1?16:10))||f}).replace(n,function(f,x){return String.fromCharCode(parseInt(x,16))});var d=i.indexOf("]]>");return t(i.slice(0,o))+i.slice(o+9,d)+t(i.slice(d+3))}}(),Jy=/[&<>'"]/g,eE=/[\u0000-\u001f]/g;function gf(e){var n=e+"";return n.replace(Jy,function(t){return Qy[t]}).replace(/\n/g,"<br/>").replace(eE,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var jm=function(){var e=/&#(\d+);/g;function n(t,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,n)}}();function Ba(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Iu(e){for(var n="",t=0,s=0,i=0,o=0,d=0,f=0;t<e.length;){if(s=e.charCodeAt(t++),s<128){n+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),s>191&&s<224){d=(s&31)<<6,d|=i&63,n+=String.fromCharCode(d);continue}if(o=e.charCodeAt(t++),s<240){n+=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63);continue}d=e.charCodeAt(t++),f=((s&7)<<18|(i&63)<<12|(o&63)<<6|d&63)-65536,n+=String.fromCharCode(55296+(f>>>10&1023)),n+=String.fromCharCode(56320+(f&1023))}return n}function Fm(e){var n=In(2*e.length),t,s,i=1,o=0,d=0,f;for(s=0;s<e.length;s+=i)i=1,(f=e.charCodeAt(s))<128?t=f:f<224?(t=(f&31)*64+(e.charCodeAt(s+1)&63),i=2):f<240?(t=(f&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,t=(f&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),t-=65536,d=55296+(t>>>10&1023),t=56320+(t&1023)),d!==0&&(n[o++]=d&255,n[o++]=d>>>8,d=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function Lm(e){return ms(e,"binary").toString("utf8")}var Jc="foo bar bazâð£",Ma=xa&&(Lm(Jc)==Iu(Jc)&&Lm||Fm(Jc)==Iu(Jc)&&Fm)||Iu,pl=xa?function(e){return ms(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,s=0,i=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(t++)-56320+(s<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},Ol=function(){var e={};return function(t,s){var i=t+"|"+(s||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",s||"")}}(),$p=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}}(),aE=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),tE=/<\/?(?:vt:)?variant>/g,rE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mm(e,n){var t=Ze(e),s=e.match(aE(t.baseType))||[],i=[];if(s.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+s.length+" != "+t.size);return i}return s.forEach(function(o){var d=o.replace(tE,"").match(rE);d&&i.push({v:Ma(d[2]),t:d[1]})}),i}var nE=/(^\s|\s$|\n)/;function sE(e){return Fr(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function iE(e,n,t){return"<"+e+(t!=null?sE(t):"")+(n!=null?(n.match(nE)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function vf(e){if(xa&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ma(ps(df(e)));throw new Error("Bad input format: expected Buffer or string")}var Dl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,lE={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},cE=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function oE(e,n){for(var t=1-2*(e[n+7]>>>7),s=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),i=e[n+6]&15,o=5;o>=0;--o)i=i*256+e[n+o];return s==2047?i==0?t*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),t*Math.pow(2,s-52)*i)}function uE(e,n,t){var s=(n<0||1/n==-1/0?1:0)<<7,i=0,o=0,d=s?-n:n;isFinite(d)?d==0?i=o=0:(i=Math.floor(Math.log(d)/Math.LN2),o=d*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(n)?26985:0);for(var f=0;f<=5;++f,o/=256)e[t+f]=o&255;e[t+6]=(i&15)<<4|o&15,e[t+7]=i>>4|s}var Im=function(e){for(var n=[],t=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,o=e[0][s].length;i<o;i+=t)n.push.apply(n,e[0][s].slice(i,i+t));return n},Bm=xa?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ms(n)})):Im(e)}:Im,Um=function(e,n,t){for(var s=[],i=n;i<t;i+=2)s.push(String.fromCharCode(Jr(e,i)));return s.join("").replace(Rt,"")},bf=xa?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(Rt,""):Um(e,n,t)}:Um,Pm=function(e,n,t){for(var s=[],i=n;i<n+t;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},Zp=xa?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):Pm(e,n,t)}:Pm,Hm=function(e,n,t){for(var s=[],i=n;i<t;i++)s.push(String.fromCharCode(li(e,i)));return s.join("")},Il=xa?function(n,t,s){return Buffer.isBuffer(n)?n.toString("utf8",t,s):Hm(n,t,s)}:Hm,Qp=function(e,n){var t=qt(e,n);return t>0?Il(e,n+4,n+4+t-1):""},Jp=Qp,eg=function(e,n){var t=qt(e,n);return t>0?Il(e,n+4,n+4+t-1):""},ag=eg,tg=function(e,n){var t=2*qt(e,n);return t>0?Il(e,n+4,n+4+t-1):""},rg=tg,ng=function(n,t){var s=qt(n,t);return s>0?bf(n,t+4,t+4+s):""},sg=ng,ig=function(e,n){var t=qt(e,n);return t>0?Il(e,n+4,n+4+t):""},lg=ig,cg=function(e,n){return oE(e,n)},h0=cg,og=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};xa&&(Jp=function(n,t){if(!Buffer.isBuffer(n))return Qp(n,t);var s=n.readUInt32LE(t);return s>0?n.toString("utf8",t+4,t+4+s-1):""},ag=function(n,t){if(!Buffer.isBuffer(n))return eg(n,t);var s=n.readUInt32LE(t);return s>0?n.toString("utf8",t+4,t+4+s-1):""},rg=function(n,t){if(!Buffer.isBuffer(n))return tg(n,t);var s=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+s-1)},sg=function(n,t){if(!Buffer.isBuffer(n))return ng(n,t);var s=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+s)},lg=function(n,t){if(!Buffer.isBuffer(n))return ig(n,t);var s=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+s)},h0=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):cg(n,t)},og=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var li=function(e,n){return e[n]},Jr=function(e,n){return e[n+1]*256+e[n]},fE=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},qt=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},cs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},dE=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function gl(e,n){var t="",s,i,o=[],d,f,x,m;switch(n){case"dbcs":if(m=this.l,xa&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(x=0;x<e;++x)t+=String.fromCharCode(Jr(this,m)),m+=2;e*=2;break;case"utf8":t=Il(this,this.l,this.l+e);break;case"utf16le":e*=2,t=bf(this,this.l,this.l+e);break;case"wstr":return gl.call(this,e,"dbcs");case"lpstr-ansi":t=Jp(this,this.l),e=4+qt(this,this.l);break;case"lpstr-cp":t=ag(this,this.l),e=4+qt(this,this.l);break;case"lpwstr":t=rg(this,this.l),e=4+2*qt(this,this.l);break;case"lpp4":e=4+qt(this,this.l),t=sg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qt(this,this.l),t=lg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(d=li(this,this.l+e++))!==0;)o.push(Qc(d));t=o.join("");break;case"_wstr":for(e=0,t="";(d=Jr(this,this.l+e))!==0;)o.push(Qc(d)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",m=this.l,x=0;x<e;++x){if(this.lens&&this.lens.indexOf(m)!==-1)return d=li(this,m),this.l=m+1,f=gl.call(this,e-x,d?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(Qc(Jr(this,m))),m+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,x=0;x!=e;++x){if(this.lens&&this.lens.indexOf(m)!==-1)return d=li(this,m),this.l=m+1,f=gl.call(this,e-x,d?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(Qc(li(this,m))),m+=1}t=o.join("");break;default:switch(e){case 1:return s=li(this,this.l),this.l++,s;case 2:return s=(n==="i"?fE:Jr)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(e>0?cs:dE)(this,this.l),this.l+=4,s):(i=qt(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return e==8?i=h0(this,this.l):i=h0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=Zp(this,this.l,e);break}}return this.l+=e,t}var hE=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},xE=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},mE=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function pE(e,n,t){var s=0,i=0;if(t==="dbcs"){for(i=0;i!=n.length;++i)mE(this,n.charCodeAt(i),this.l+2*i);s=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;s=n.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(n.length,e);++i){var d=n.charCodeAt(i);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,hE(this,n,this.l);break;case 8:if(s=8,t==="f"){uE(this,n,this.l);break}case 16:break;case-4:s=4,xE(this,n,this.l);break}return this.l+=s,this}function ug(e,n){var t=Zp(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function pt(e,n){e.l=n,e.read_shift=gl,e.chk=ug,e.write_shift=pE}function At(e,n){e.l+=n}function st(e){var n=In(e);return pt(n,0),n}function nn(e,n,t){if(e){var s,i,o;pt(e,e.l||0);for(var d=e.length,f=0,x=0;e.l<d;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var m=b0[f]||b0[65535];for(s=e.read_shift(1),o=s&127,i=1;i<4&&s&128;++i)o+=((s=e.read_shift(1))&127)<<7*i;x=e.l+o;var g=m.f&&m.f(e,o,t);if(e.l=x,n(g,m,f))return}}}function Wu(){var e=[],n=xa?256:2048,t=function(m){var g=st(m);return pt(g,0),g},s=t(n),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(m){return s&&m<s.length-s.l?s:(i(),s=t(Math.max(m+1,n)))},d=function(){return i(),jn(e)},f=function(m){i(),s=m,s.l==null&&(s.l=s.length),o(n)};return{next:o,push:f,end:d,_bufs:e}}function vl(e,n,t){var s=gt(e);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function zm(e,n,t){var s=gt(e);return s.s=vl(s.s,n.s,t),s.e=vl(s.e,n.s,t),s}function bl(e,n){if(e.cRel&&e.c<0)for(e=gt(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=gt(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=aa(e);return!e.cRel&&e.cRel!=null&&(t=bE(t)),!e.rRel&&e.rRel!=null&&(t=gE(t)),t}function Bu(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+it(e.s.c)+":"+(e.e.cRel?"":"$")+it(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+vt(e.s.r)+":"+(e.e.rRel?"":"$")+vt(e.e.r):bl(e.s,n.biff)+":"+bl(e.e,n.biff)}function yf(e){return parseInt(vE(e),10)-1}function vt(e){return""+(e+1)}function gE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vE(e){return e.replace(/\$(\d+)$/,"$1")}function Ef(e){for(var n=yE(e),t=0,s=0;s!==n.length;++s)t=26*t+n.charCodeAt(s)-64;return t-1}function it(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function bE(e){return e.replace(/^([A-Z])/,"$$$1")}function yE(e){return e.replace(/^\$([A-Z])/,"$1")}function EE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dt(e){for(var n=0,t=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:n-1}}function aa(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function pi(e){var n=e.indexOf(":");return n==-1?{s:Dt(e),e:Dt(e)}:{s:Dt(e.slice(0,n)),e:Dt(e.slice(n+1))}}function va(e,n){return typeof n>"u"||typeof n=="number"?va(e.s,e.e):(typeof e!="string"&&(e=aa(e)),typeof n!="string"&&(n=aa(n)),e==n?e:e+":"+n)}function Ya(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,i=0,o=e.length;for(t=0;s<o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(n.s.c=--t,t=0;s<o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;if(n.s.r=--t,s===o||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,t=0;s!=o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(n.e.c=--t,t=0;s!=o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;return n.e.r=--t,n}function Vm(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=ur(e.z,t?jt(n):n)}catch{}try{return e.w=ur((e.XF||{}).numFmtId||(t?14:0),t?jt(n):n)}catch{return""+n}}function tn(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?bs[e.v]||e.v:n==null?Vm(e,e.v):Vm(e,n))}function Un(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function fg(e,n,t){var s=t||{},i=e?Array.isArray(e):s.dense,o=e||(i?[]:{}),d=0,f=0;if(o&&s.origin!=null){if(typeof s.origin=="number")d=s.origin;else{var x=typeof s.origin=="string"?Dt(s.origin):s.origin;d=x.r,f=x.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Ya(o["!ref"]);m.s.c=g.s.c,m.s.r=g.s.r,m.e.c=Math.max(m.e.c,g.e.c),m.e.r=Math.max(m.e.r,g.e.r),d==-1&&(m.e.r=d=g.e.r+1)}for(var v=0;v!=n.length;++v)if(n[v]){if(!Array.isArray(n[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=n[v].length;++b)if(!(typeof n[v][b]>"u")){var _={v:n[v][b]},y=d+v,E=f+b;if(m.s.r>y&&(m.s.r=y),m.s.c>E&&(m.s.c=E),m.e.r<y&&(m.e.r=y),m.e.c<E&&(m.e.c=E),n[v][b]&&typeof n[v][b]=="object"&&!Array.isArray(n[v][b])&&!(n[v][b]instanceof Date))_=n[v][b];else if(Array.isArray(_.v)&&(_.f=n[v][b][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(s.nullError)_.t="e",_.v=0;else if(s.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=s.dateNF||sa[14],s.cellDates?(_.t="d",_.w=ur(_.z,jt(_.v))):(_.t="n",_.v=jt(_.v),_.w=ur(_.z,_.v))):_.t="s";if(i)o[y]||(o[y]=[]),o[y][E]&&o[y][E].z&&(_.z=o[y][E].z),o[y][E]=_;else{var T=aa({c:E,r:y});o[T]&&o[T].z&&(_.z=o[T].z),o[T]=_}}}return m.s.c<1e7&&(o["!ref"]=va(m)),o}function gi(e,n){return fg(null,e,n)}function _E(e){return e.read_shift(4,"i")}function St(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function TE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function _f(e,n){var t=e.l,s=e.read_shift(1),i=St(e),o=[],d={t:i,h:i};if((s&1)!==0){for(var f=e.read_shift(4),x=0;x!=f;++x)o.push(TE(e));d.r=o}else d.r=[{ich:0,ifnt:0}];return e.l=t+n,d}var wE=_f;function fr(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function gs(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var SE=St;function Tf(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var AE=St,$u=Tf;function wf(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,s=n[0]&2;e.l+=4;var i=s===0?h0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):cs(n,0)>>2;return t?i/100:i}function dg(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var vs=dg;function Tt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function NE(e){var n={},t=e.read_shift(1),s=t>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),d=e.read_shift(1),f=e.read_shift(1),x=e.read_shift(1);switch(e.l++,s){case 0:n.auto=1;break;case 1:n.index=i;var m=fs[i];m&&(n.rgb=jl(m));break;case 2:n.rgb=jl([d,f,x]);break;case 3:n.theme=i;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function kE(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function hg(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function CE(e){return hg(e,1)}function OE(e){return hg(e,2)}var Sf=2,Bt=3,e0=11,Gm=12,x0=19,a0=64,DE=65,RE=71,jE=4108,FE=4126,ft=80,xg=81,LE=[ft,xg],ME={1:{n:"CodePage",t:Sf},2:{n:"Category",t:ft},3:{n:"PresentationFormat",t:ft},4:{n:"ByteCount",t:Bt},5:{n:"LineCount",t:Bt},6:{n:"ParagraphCount",t:Bt},7:{n:"SlideCount",t:Bt},8:{n:"NoteCount",t:Bt},9:{n:"HiddenCount",t:Bt},10:{n:"MultimediaClipCount",t:Bt},11:{n:"ScaleCrop",t:e0},12:{n:"HeadingPairs",t:jE},13:{n:"TitlesOfParts",t:FE},14:{n:"Manager",t:ft},15:{n:"Company",t:ft},16:{n:"LinksUpToDate",t:e0},17:{n:"CharacterCount",t:Bt},19:{n:"SharedDoc",t:e0},22:{n:"HyperlinksChanged",t:e0},23:{n:"AppVersion",t:Bt,p:"version"},24:{n:"DigSig",t:DE},26:{n:"ContentType",t:ft},27:{n:"ContentStatus",t:ft},28:{n:"Language",t:ft},29:{n:"Version",t:ft},255:{},2147483648:{n:"Locale",t:x0},2147483651:{n:"Behavior",t:x0},1919054434:{}},IE={1:{n:"CodePage",t:Sf},2:{n:"Title",t:ft},3:{n:"Subject",t:ft},4:{n:"Author",t:ft},5:{n:"Keywords",t:ft},6:{n:"Comments",t:ft},7:{n:"Template",t:ft},8:{n:"LastAuthor",t:ft},9:{n:"RevNumber",t:ft},10:{n:"EditTime",t:a0},11:{n:"LastPrinted",t:a0},12:{n:"CreatedDate",t:a0},13:{n:"ModifiedDate",t:a0},14:{n:"PageCount",t:Bt},15:{n:"WordCount",t:Bt},16:{n:"CharCount",t:Bt},17:{n:"Thumbnail",t:RE},18:{n:"Application",t:ft},19:{n:"DocSecurity",t:Bt},255:{},2147483648:{n:"Locale",t:x0},2147483651:{n:"Behavior",t:x0},1919054434:{}},Ym={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},BE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UE(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var PE=UE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fs=gt(PE),bs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function HE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zE(e){var n=HE();if(!e||!e.match)return n;var t={};if((e.match(Nt)||[]).forEach(function(s){var i=Ze(s);switch(i[0].replace($y,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":n[Xm[i.ContentType]]!==void 0&&n[Xm[i.ContentType]].push(i.PartName);break}}),n.xmlns!==lE.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var oi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zu(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function yl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var s={};return(e.match(Nt)||[]).forEach(function(i){var o=Ze(i);if(o[0]==="<Relationship"){var d={};d.Type=o.Type,d.Target=o.Target,d.Id=o.Id,o.TargetMode&&(d.TargetMode=o.TargetMode);var f=o.TargetMode==="External"?o.Target:ml(o.Target,n);t[f]=d,s[o.Id]=d}}),t["!id"]=s,t}var VE="application/vnd.oasis.opendocument.spreadsheet";function GE(e,n){for(var t=vf(e),s,i;s=Dl.exec(t);)switch(s[3]){case"manifest":break;case"file-entry":if(i=Ze(s[0],!1),i.path=="/"&&i.type!==VE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw s}}var El=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],YE=function(){for(var e=new Array(El.length),n=0;n<El.length;++n){var t=El[n],s="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function pg(e){var n={};e=Ma(e);for(var t=0;t<El.length;++t){var s=El[t],i=e.match(YE[t]);i!=null&&i.length>0&&(n[s[1]]=ba(i[1])),s[2]==="date"&&n[s[1]]&&(n[s[1]]=dt(n[s[1]]))}return n}var XE=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function gg(e,n,t,s){var i=[];if(typeof e=="string")i=Mm(e,s);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(g){return{v:g}}));var d=typeof n=="string"?Mm(n,s).map(function(g){return g.v}):n,f=0,x=0;if(d.length>0)for(var m=0;m!==i.length;m+=2){switch(x=+i[m+1].v,i[m].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=x,t.SheetNames=d.slice(f,f+x);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=x,t.DefinedNames=d.slice(f,f+x);break;case"Charts":case"Diagramme":t.Chartsheets=x,t.ChartNames=d.slice(f,f+x);break}f+=x}}function qE(e,n,t){var s={};return n||(n={}),e=Ma(e),XE.forEach(function(i){var o=(e.match(Ol(i[0]))||[])[1];switch(i[2]){case"string":o&&(n[i[1]]=ba(o));break;case"bool":n[i[1]]=o==="true";break;case"raw":var d=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));d&&d.length>0&&(s[i[1]]=d[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&gg(s.HeadingPairs,s.TitlesOfParts,n,t),n}var KE=/<[^>]+>[^<]*/g;function WE(e,n){var t={},s="",i=e.match(KE);if(i)for(var o=0;o!=i.length;++o){var d=i[o],f=Ze(d);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":s=ba(f.name);break;case"</property>":s=null;break;default:if(d.indexOf("<vt:")===0){var x=d.split(">"),m=x[0].slice(4),g=x[1];switch(m){case"lpstr":case"bstr":case"lpwstr":t[s]=ba(g);break;case"bool":t[s]=Ba(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[s]=parseInt(g,10);break;case"r4":case"r8":case"decimal":t[s]=parseFloat(g);break;case"filetime":case"date":t[s]=dt(g);break;case"cy":case"error":t[s]=ba(g);break;default:if(m.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",d,m,x)}}else if(d.slice(0,2)!=="</"){if(n.WTF)throw new Error(d)}}}return t}var $E={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Uu;function ZE(e,n,t){Uu||(Uu=mf($E)),n=Uu[n]||n,e[n]=t}function Af(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vg(e,n,t){var s=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-s&3;)++e.l;return i}function bg(e,n,t){var s=e.read_shift(0,"lpwstr");return s}function yg(e,n,t){return n===31?bg(e):vg(e,n,t)}function Qu(e,n,t){return yg(e,n,t===!1?0:4)}function QE(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return yg(e,n,0)}function JE(e){for(var n=e.read_shift(4),t=[],s=0;s!=n;++s){var i=e.l;t[s]=e.read_shift(0,"lpwstr").replace(Rt,""),e.l-i&2&&(e.l+=2)}return t}function e4(e){for(var n=e.read_shift(4),t=[],s=0;s!=n;++s)t[s]=e.read_shift(0,"lpstr-cp").replace(Rt,"");return t}function a4(e){var n=e.l,t=m0(e,xg);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var s=m0(e,Bt);return[t,s]}function t4(e){for(var n=e.read_shift(4),t=[],s=0;s<n/2;++s)t.push(a4(e));return t}function qm(e,n){for(var t=e.read_shift(4),s={},i=0;i!=t;++i){var o=e.read_shift(4),d=e.read_shift(4);s[o]=e.read_shift(d,n===1200?"utf16le":"utf8").replace(Rt,"").replace(xl,"!"),n===1200&&d%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function Eg(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function r4(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function m0(e,n,t){var s=e.read_shift(2),i,o=t||{};if(e.l+=2,n!==Gm&&s!==n&&LE.indexOf(n)===-1&&!((n&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+n+" saw "+s);switch(n===Gm?s:n){case 2:return i=e.read_shift(2,"i"),o.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return vg(e,s,4).replace(Rt,"");case 31:return bg(e);case 64:return Af(e);case 65:return Eg(e);case 71:return r4(e);case 80:return Qu(e,s,!o.raw).replace(Rt,"");case 81:return QE(e,s).replace(Rt,"");case 4108:return t4(e);case 4126:case 4127:return s==4127?JE(e):e4(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+s)}}function Km(e,n){var t=e.l,s=e.read_shift(4),i=e.read_shift(4),o=[],d=0,f=0,x=-1,m={};for(d=0;d!=i;++d){var g=e.read_shift(4),v=e.read_shift(4);o[d]=[g,v+t]}o.sort(function(D,S){return D[1]-S[1]});var b={};for(d=0;d!=i;++d){if(e.l!==o[d][1]){var _=!0;if(d>0&&n)switch(n[o[d-1][0]].t){case 2:e.l+2===o[d][1]&&(e.l+=2,_=!1);break;case 80:e.l<=o[d][1]&&(e.l=o[d][1],_=!1);break;case 4108:e.l<=o[d][1]&&(e.l=o[d][1],_=!1);break}if((!n||d==0)&&e.l<=o[d][1]&&(_=!1,e.l=o[d][1]),_)throw new Error("Read Error: Expected address "+o[d][1]+" at "+e.l+" :"+d)}if(n){var y=n[o[d][0]];if(b[y.n]=m0(e,y.t,{raw:!0}),y.p==="version"&&(b[y.n]=String(b[y.n]>>16)+"."+("0000"+String(b[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(b[y.n]){case 0:b[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:_r(f=b[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+b[y.n])}}else if(o[d][0]===1){if(f=b.CodePage=m0(e,Sf),_r(f),x!==-1){var E=e.l;e.l=o[x][1],m=qm(e,f),e.l=E}}else if(o[d][0]===0){if(f===0){x=d,e.l=o[d+1][1];continue}m=qm(e,f)}else{var T=m[o[d][0]],A;switch(e[e.l]){case 65:e.l+=4,A=Eg(e);break;case 30:e.l+=4,A=Qu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=Qu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=Wa(e,4);break;case 64:e.l+=4,A=dt(Af(e));break;default:throw new Error("unparsed value: "+e[e.l])}b[T]=A}}return e.l=t+s,b}function Wm(e,n,t){var s=e.content;if(!s)return{};pt(s,0);var i,o,d,f,x=0;s.chk("feff","Byte Order: "),s.read_shift(2);var m=s.read_shift(4),g=s.read_shift(16);if(g!==ga.utils.consts.HEADER_CLSID&&g!==t)throw new Error("Bad PropertySet CLSID "+g);if(i=s.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=s.read_shift(16),f=s.read_shift(4),i===1&&f!==s.l)throw new Error("Length mismatch: "+f+" !== "+s.l);i===2&&(d=s.read_shift(16),x=s.read_shift(4));var v=Km(s,n),b={SystemIdentifier:m};for(var _ in v)b[_]=v[_];if(b.FMTID=o,i===1)return b;if(x-s.l==2&&(s.l+=2),s.l!==x)throw new Error("Length mismatch 2: "+s.l+" !== "+x);var y;try{y=Km(s,null)}catch{}for(_ in y)b[_]=y[_];return b.FMTID=[o,d],b}function Dn(e,n){return e.read_shift(n),null}function n4(e,n,t){for(var s=[],i=e.l+n;e.l<i;)s.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return s}function Wa(e,n){return e.read_shift(n)===1}function at(e){return e.read_shift(2,"u")}function _g(e,n){return n4(e,n,at)}function s4(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Bl(e,n,t){var s=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var d=s?e.read_shift(s,i):"";return d}function i4(e){var n=e.read_shift(2),t=e.read_shift(1),s=t&4,i=t&8,o=1+(t&1),d=0,f,x={};i&&(d=e.read_shift(2)),s&&(f=e.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",g=n===0?"":e.read_shift(n,m);return i&&(e.l+=4*d),s&&(e.l+=f),x.t=g,i||(x.raw="<t>"+x.t+"</t>",x.r=x.t),x}function xs(e,n,t){var s;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(n,"sbcs-cont"):s=e.read_shift(n,"dbcs-cont"),s}function Ul(e,n,t){var s=e.read_shift(t&&t.biff==2?1:2);return s===0?(e.l++,""):xs(e,s,t)}function ys(e,n,t){if(t.biff>5)return Ul(e,n,t);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function l4(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function c4(e){var n=e.read_shift(4),t=e.l,s=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=t);var i=e.read_shift((s?n-24:n)>>1,"utf16le").replace(Rt,"");return s&&(e.l+=24),i}function o4(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+s.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var d=e.read_shift(o>>1,"utf16le").replace(Rt,"");return t+d}function u4(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return c4(e);case"0303000000000000c000000000000046":return o4(e);default:throw new Error("Unsupported Moniker "+t)}}function t0(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(Rt,""):"";return t}function f4(e,n){var t=e.l+n,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var i=e.read_shift(2);e.l+=2;var o,d,f,x,m="",g,v;i&16&&(o=t0(e,t-e.l)),i&128&&(d=t0(e,t-e.l)),(i&257)===257&&(f=t0(e,t-e.l)),(i&257)===1&&(x=u4(e,t-e.l)),i&8&&(m=t0(e,t-e.l)),i&32&&(g=e.read_shift(16)),i&64&&(v=Af(e)),e.l=t;var b=d||f||x||"";b&&m&&(b+="#"+m),b||(b="#"+m),i&2&&b.charAt(0)=="/"&&b.charAt(1)!="/"&&(b="file://"+b);var _={Target:b};return g&&(_.guid=g),v&&(_.time=v),o&&(_.Tooltip=o),_}function Tg(e){var n=e.read_shift(1),t=e.read_shift(1),s=e.read_shift(1),i=e.read_shift(1);return[n,t,s,i]}function wg(e,n){var t=Tg(e);return t[3]=0,t}function Mr(e){var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2);return{r:n,c:t,ixfe:s}}function d4(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function h4(e,n,t){return n===0?"":ys(e,n,t)}function x4(e,n,t){var s=t.biff>8?4:2,i=e.read_shift(s),o=e.read_shift(s,"i"),d=e.read_shift(s,"i");return[i,o,d]}function Sg(e){var n=e.read_shift(2),t=wf(e);return[n,t]}function m4(e,n,t){e.l+=4,n-=4;var s=e.l+n,i=Bl(e,n,t),o=e.read_shift(2);if(s-=e.l,o!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+o);return e.l+=o,i}function _0(e){var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r:n},e:{c:i,r:t}}}function Ag(e){var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1);return{s:{c:s,r:n},e:{c:i,r:t}}}var p4=Ag;function Ng(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[t,n,s]}function g4(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function v4(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Et(e){e.l+=2,e.l+=e.read_shift(2)}var b4={0:Et,4:Et,5:Et,6:Et,7:v4,8:Et,9:Et,10:Et,11:Et,12:Et,13:g4,14:Et,15:Et,16:Et,17:Et,18:Et,19:Et,20:Et,21:Ng};function y4(e,n){for(var t=e.l+n,s=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{s.push(b4[i](e,t-e.l))}catch{return e.l=t,s}}return e.l!=t&&(e.l=t),s}function r0(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function E4(e,n){return n===0||e.read_shift(2),1200}function _4(e,n,t){if(t.enc)return e.l+=n,"";var s=e.l,i=ys(e,0,t);return e.read_shift(n+s-e.l),i}function T4(e,n,t){var s=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function w4(e,n,t){var s=e.read_shift(4),i=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var d=Bl(e,0,t);return d.length===0&&(d="Sheet1"),{pos:s,hs:i,dt:o,name:d}}function S4(e,n){for(var t=e.l+n,s=e.read_shift(4),i=e.read_shift(4),o=[],d=0;d!=i&&e.l<t;++d)o.push(i4(e));return o.Count=s,o.Unique=i,o}function A4(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function N4(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(n.level=s&7),s&32&&(n.hidden=!0),s&64&&(n.hpt=t/20),n}function k4(e){var n=d4(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function C4(e){return e.read_shift(2),e.read_shift(4)}function $m(e,n,t){var s=0;t&&t.biff==2||(s=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(s=1-(i>>15),i&=32767);var o={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[o,i]}function O4(e){var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),f=e.read_shift(2),x=e.read_shift(2),m=e.read_shift(2);return{Pos:[n,t],Dim:[s,i],Flags:o,CurTab:d,FirstTab:f,Selected:x,TabRatio:m}}function D4(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function R4(){}function j4(e,n,t){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Bl(e,0,t),s}function F4(e){var n=Mr(e);return n.isst=e.read_shift(4),n}function L4(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var s=e.l+n,i=Mr(e);t.biff==2&&e.l++;var o=Ul(e,s-e.l,t);return i.val=o,i}function M4(e,n,t){var s=e.read_shift(2),i=ys(e,0,t);return[s,i]}var I4=ys;function Zm(e,n,t){var s=e.l+n,i=t.biff==8||!t.biff?4:2,o=e.read_shift(i),d=e.read_shift(i),f=e.read_shift(2),x=e.read_shift(2);return e.l=s,{s:{r:o,c:f},e:{r:d,c:x}}}function B4(e){var n=e.read_shift(2),t=e.read_shift(2),s=Sg(e);return{r:n,c:t,ixfe:s[0],rknum:s[1]}}function U4(e,n){for(var t=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(Sg(e));if(e.l!==t)throw new Error("MulRK read error");var d=e.read_shift(2);if(o.length!=d-i+1)throw new Error("MulRK length mismatch");return{r:s,c:i,C:d,rkrec:o}}function P4(e,n){for(var t=e.l+n-2,s=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var d=e.read_shift(2);if(o.length!=d-i+1)throw new Error("MulBlank length mismatch");return{r:s,c:i,C:d,ixfe:o}}function H4(e,n,t,s){var i={},o=e.read_shift(4),d=e.read_shift(4),f=e.read_shift(4),x=e.read_shift(2);return i.patternType=BE[f>>26],s.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=d&15,i.dgRight=d>>4&15,i.dgTop=d>>8&15,i.dgBottom=d>>12&15,i.icvLeft=d>>16&127,i.icvRight=d>>23&127,i.grbitDiag=d>>30&3,i.icvTop=f&127,i.icvBottom=f>>7&127,i.icvDiag=f>>14&127,i.dgDiag=f>>21&15,i.icvFore=x&127,i.icvBack=x>>7&127,i.fsxButton=x>>14&1),i}function z4(e,n,t){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,n-=6,s.data=H4(e,n,s.fStyle,t),s}function V4(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function Qm(e,n,t){var s=Mr(e);(t.biff==2||n==9)&&++e.l;var i=s4(e);return s.val=i,s.t=i===!0||i===!1?"b":"e",s}function G4(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var s=Mr(e),i=Tt(e);return s.val=i,s}var Jm=h4;function Y4(e,n,t){var s=e.l+n,i=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var d=xs(e,o),f=[];s>e.l;)f.push(Ul(e));return[o,i,d,f]}function ep(e,n,t){var s=e.read_shift(2),i,o={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return t.sbcch===14849&&(i=m4(e,n-2,t)),o.body=i||e.read_shift(n-2),typeof i=="string"&&(o.Name=i),o}var X4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ap(e,n,t){var s=e.l+n,i=e.read_shift(2),o=e.read_shift(1),d=e.read_shift(1),f=e.read_shift(t&&t.biff==2?1:2),x=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),x=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var m=xs(e,d,t);i&32&&(m=X4[m.charCodeAt(0)]);var g=s-e.l;t&&t.biff==2&&--g;var v=s==e.l||f===0||!(g>0)?[]:Nw(e,g,t,f);return{chKey:o,Name:m,itab:x,rgce:v}}function kg(e,n,t){if(t.biff<8)return q4(e,n,t);for(var s=[],i=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)s.push(x4(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function q4(e,n,t){e[e.l+1]==3&&e[e.l]++;var s=Bl(e,n,t);return s.charCodeAt(0)==3?s.slice(1):s}function K4(e,n,t){if(t.biff<8){e.l+=n;return}var s=e.read_shift(2),i=e.read_shift(2),o=xs(e,s,t),d=xs(e,i,t);return[o,d]}function W4(e,n,t){var s=Ag(e);e.l++;var i=e.read_shift(1);return n-=8,[kw(e,n,t),i,s]}function tp(e,n,t){var s=p4(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[s,Sw(e,n,t)]}function $4(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,s=e.read_shift(4);return[n,t,s]}function Z4(e,n,t){if(!(t.biff<8)){var s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),f=ys(e,0,t);return t.biff<8&&e.read_shift(1),[{r:s,c:i},f,d,o]}}function Q4(e,n,t){return Z4(e,n,t)}function J4(e,n){for(var t=[],s=e.read_shift(2);s--;)t.push(_0(e));return t}function e_(e,n,t){if(t&&t.biff<8)return t_(e,n,t);var s=Ng(e),i=y4(e,n-22,s[1]);return{cmo:s,ft:i}}var a_={8:function(e,n){var t=e.l+n;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:s}}};function t_(e,n,t){e.l+=4;var s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var d=[];return d.push((a_[s]||At)(e,n,t)),{cmo:[i,s,o],ft:d}}function r_(e,n,t){var s=e.l,i="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],d;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:d=l4(e,6,t);var f=e.read_shift(2);e.read_shift(2),at(e,2);var x=e.read_shift(2);e.l+=x;for(var m=1;m<e.lens.length-1;++m){if(e.l-s!=e.lens[m])throw new Error("TxO: bad continue record");var g=e[e.l],v=xs(e,e.lens[m+1]-e.lens[m]-1);if(i+=v,i.length>=(g?f:2*f))break}if(i.length!==f&&i.length!==f*2)throw new Error("cchText: "+f+" != "+i.length);return e.l=s+n,{t:i}}catch{return e.l=s+n,{t:i}}}function n_(e,n){var t=_0(e);e.l+=16;var s=f4(e,n-24);return[t,s]}function s_(e,n){e.read_shift(2);var t=_0(e),s=e.read_shift((n-10)/2,"dbcs-cont");return s=s.replace(Rt,""),[t,s]}function i_(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=Ym[t]||t,t=e.read_shift(2),n[1]=Ym[t]||t,n}function l_(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(wg(e));return t}function c_(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(wg(e));return t}function o_(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Cg(e,n,t){if(!t.cellStyles)return At(e,n);var s=t&&t.biff>=12?4:2,i=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(s),f=e.read_shift(s),x=e.read_shift(2);s==2&&(e.l+=2);var m={s:i,e:o,w:d,ixfe:f,flags:x};return(t.biff>=5||!t.biff)&&(m.level=x>>8&7),m}function u_(e,n){var t={};return n<32||(e.l+=16,t.header=Tt(e),t.footer=Tt(e),e.l+=2),t}function f_(e,n,t){var s={area:!1};if(t.biff!=5)return e.l+=n,s;var i=e.read_shift(1);return e.l+=3,i&16&&(s.area=!0),s}var d_=Mr,h_=_g,x_=Ul;function m_(e){var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),i={fmt:n,env:t,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,i}function p_(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var s=Mr(e);++e.l;var i=ys(e,n-7,t);return s.t="str",s.val=i,s}function g_(e){var n=Mr(e);++e.l;var t=Tt(e);return n.t="n",n.val=t,n}function v_(e){var n=Mr(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function b_(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function y_(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function E_(e,n,t){var s=e.l+n,i=Mr(e),o=e.read_shift(2),d=xs(e,o,t);return e.l=s,i.t="str",i.val=d,i}var __=[2,3,48,49,131,139,140,245],rp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=mf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(f,x){var m=[],g=In(1);switch(x.type){case"base64":g=Er(Wt(f));break;case"binary":g=Er(f);break;case"buffer":case"array":g=f;break}pt(g,0);var v=g.read_shift(1),b=!!(v&136),_=!1,y=!1;switch(v){case 2:break;case 3:break;case 48:_=!0,b=!0;break;case 49:_=!0,b=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var E=0,T=521;v==2&&(E=g.read_shift(2)),g.l+=3,v!=2&&(E=g.read_shift(4)),E>1048576&&(E=1e6),v!=2&&(T=g.read_shift(2));var A=g.read_shift(2),D=x.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(D=e[g[g.l]]),g.l+=1,g.l+=2),y&&(g.l+=36);for(var S=[],H={},V=Math.min(g.length,v==2?521:T-10-(_?264:0)),Y=y?32:11;g.l<V&&g[g.l]!=13;)switch(H={},H.name=kl.utils.decode(D,g.slice(g.l,g.l+Y)).replace(/[\u0000\r\n].*$/g,""),g.l+=Y,H.type=String.fromCharCode(g.read_shift(1)),v!=2&&!y&&(H.offset=g.read_shift(4)),H.len=g.read_shift(1),v==2&&(H.offset=g.read_shift(2)),H.dec=g.read_shift(1),H.name.length&&S.push(H),v!=2&&(g.l+=y?13:14),H.type){case"B":(!_||H.len!=8)&&x.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"G":case"P":x.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+H.type)}if(g[g.l]!==13&&(g.l=T-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=T;var j=0,J=0;for(m[0]=[],J=0;J!=S.length;++J)m[0][J]=S[J].name;for(;E-- >0;){if(g[g.l]===42){g.l+=A;continue}for(++g.l,m[++j]=[],J=0,J=0;J!=S.length;++J){var z=g.slice(g.l,g.l+S[J].len);g.l+=S[J].len,pt(z,0);var ie=kl.utils.decode(D,z);switch(S[J].type){case"C":ie.trim().length&&(m[j][J]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?m[j][J]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):m[j][J]=ie;break;case"F":m[j][J]=parseFloat(ie.trim());break;case"+":case"I":m[j][J]=y?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":m[j][J]=!0;break;case"N":case"F":m[j][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[j][J]="##MEMO##"+(y?parseInt(ie.trim(),10):z.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(m[j][J]=+ie||0);break;case"@":m[j][J]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":m[j][J]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":m[j][J]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[j][J]=-z.read_shift(-8,"f");break;case"B":if(_&&S[J].len==8){m[j][J]=z.read_shift(8,"f");break}case"G":case"P":z.l+=S[J].len;break;case"0":if(S[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[J].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return x&&x.sheetRows&&(m=m.slice(0,x.sheetRows)),x.DBF=S,m}function s(f,x){var m=x||{};m.dateNF||(m.dateNF="yyyymmdd");var g=gi(t(f,m),m);return g["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,g}function i(f,x){try{return Un(s(f,x),x)}catch(m){if(x&&x.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function d(f,x){var m=x||{};if(+m.codepage>=0&&_r(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var g=Wu(),v=nf(f,{header:1,raw:!0,cellDates:!0}),b=v[0],_=v.slice(1),y=f["!cols"]||[],E=0,T=0,A=0,D=1;for(E=0;E<b.length;++E){if(((y[E]||{}).DBF||{}).name){b[E]=y[E].DBF.name,++A;continue}if(b[E]!=null){if(++A,typeof b[E]=="number"&&(b[E]=b[E].toString(10)),typeof b[E]!="string")throw new Error("DBF Invalid column name "+b[E]+" |"+typeof b[E]+"|");if(b.indexOf(b[E])!==E){for(T=0;T<1024;++T)if(b.indexOf(b[E]+"_"+T)==-1){b[E]+="_"+T;break}}}}var S=Ya(f["!ref"]),H=[],V=[],Y=[];for(E=0;E<=S.e.c-S.s.c;++E){var j="",J="",z=0,ie=[];for(T=0;T<_.length;++T)_[T][E]!=null&&ie.push(_[T][E]);if(ie.length==0||b[E]==null){H[E]="?";continue}for(T=0;T<ie.length;++T){switch(typeof ie[T]){case"number":J="B";break;case"string":J="C";break;case"boolean":J="L";break;case"object":J=ie[T]instanceof Date?"D":"C";break;default:J="C"}z=Math.max(z,String(ie[T]).length),j=j&&j!=J?"C":J}z>250&&(z=250),J=((y[E]||{}).DBF||{}).type,J=="C"&&y[E].DBF.len>z&&(z=y[E].DBF.len),j=="B"&&J=="N"&&(j="N",Y[E]=y[E].DBF.dec,z=y[E].DBF.len),V[E]=j=="C"||J=="N"?z:o[j]||0,D+=V[E],H[E]=j}var K=g.next(32);for(K.write_shift(4,318902576),K.write_shift(4,_.length),K.write_shift(2,296+32*A),K.write_shift(2,D),E=0;E<4;++E)K.write_shift(4,0);for(K.write_shift(4,0|(+n[kp]||3)<<8),E=0,T=0;E<b.length;++E)if(b[E]!=null){var q=g.next(32),re=(b[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,re,"sbcs"),q.write_shift(1,H[E]=="?"?"C":H[E],"sbcs"),q.write_shift(4,T),q.write_shift(1,V[E]||o[H[E]]||0),q.write_shift(1,Y[E]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),T+=V[E]||o[H[E]]||0}var pe=g.next(264);for(pe.write_shift(4,13),E=0;E<65;++E)pe.write_shift(4,0);for(E=0;E<_.length;++E){var Ae=g.next(D);for(Ae.write_shift(1,0),T=0;T<b.length;++T)if(b[T]!=null)switch(H[T]){case"L":Ae.write_shift(1,_[E][T]==null?63:_[E][T]?84:70);break;case"B":Ae.write_shift(8,_[E][T]||0,"f");break;case"N":var Z="0";for(typeof _[E][T]=="number"&&(Z=_[E][T].toFixed(Y[T]||0)),A=0;A<V[T]-Z.length;++A)Ae.write_shift(1,32);Ae.write_shift(1,Z,"sbcs");break;case"D":_[E][T]?(Ae.write_shift(4,("0000"+_[E][T].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(_[E][T].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+_[E][T].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(_[E][T]!=null?_[E][T]:"").slice(0,V[T]);for(Ae.write_shift(1,oe,"sbcs"),A=0;A<V[T]-oe.length;++A)Ae.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:s,from_sheet:d}}(),T_=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Fr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(b,_){var y=e[_];return typeof y=="number"?bm(y):y},s=function(b,_,y){var E=_.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return E==59?b:bm(E)};e["|"]=254;function i(b,_){switch(_.type){case"base64":return o(Wt(b),_);case"binary":return o(b,_);case"buffer":return o(xa&&Buffer.isBuffer(b)?b.toString("binary"):ps(b),_);case"array":return o(hs(b),_)}throw new Error("Unrecognized type "+_.type)}function o(b,_){var y=b.split(/[\n\r]+/),E=-1,T=-1,A=0,D=0,S=[],H=[],V=null,Y={},j=[],J=[],z=[],ie=0,K;for(+_.codepage>=0&&_r(+_.codepage);A!==y.length;++A){ie=0;var q=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,t),re=q.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),pe=re[0],Ae;if(q.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&H.push(q.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,oe=!1,Re=!1,ee=!1,P=-1,ce=-1;for(D=1;D<re.length;++D)switch(re[D].charAt(0)){case"A":break;case"X":T=parseInt(re[D].slice(1))-1,oe=!0;break;case"Y":for(E=parseInt(re[D].slice(1))-1,oe||(T=0),K=S.length;K<=E;++K)S[K]=[];break;case"K":Ae=re[D].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(wr(Ae))?isNaN(hi(Ae).getDate())||(Ae=dt(Ae)):(Ae=wr(Ae),V!==null&&mi(V)&&(Ae=E0(Ae))),Z=!0;break;case"E":ee=!0;var C=fi(re[D].slice(1),{r:E,c:T});S[E][T]=[S[E][T],C];break;case"S":Re=!0,S[E][T]=[S[E][T],"S5S"];break;case"G":break;case"R":P=parseInt(re[D].slice(1))-1;break;case"C":ce=parseInt(re[D].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+q)}if(Z&&(S[E][T]&&S[E][T].length==2?S[E][T][0]=Ae:S[E][T]=Ae,V=null),Re){if(ee)throw new Error("SYLK shared formula cannot have own formula");var X=P>-1&&S[P][ce];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");S[E][T][1]=Ug(X[1],{r:E-P,c:T-ce})}break;case"F":var U=0;for(D=1;D<re.length;++D)switch(re[D].charAt(0)){case"X":T=parseInt(re[D].slice(1))-1,++U;break;case"Y":for(E=parseInt(re[D].slice(1))-1,K=S.length;K<=E;++K)S[K]=[];break;case"M":ie=parseInt(re[D].slice(1))/20;break;case"F":break;case"G":break;case"P":V=H[parseInt(re[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=re[D].slice(1).split(" "),K=parseInt(z[0],10);K<=parseInt(z[1],10);++K)ie=parseInt(z[2],10),J[K-1]=ie===0?{hidden:!0}:{wch:ie},xi(J[K-1]);break;case"C":T=parseInt(re[D].slice(1))-1,J[T]||(J[T]={});break;case"R":E=parseInt(re[D].slice(1))-1,j[E]||(j[E]={}),ie>0?(j[E].hpt=ie,j[E].hpx=Fl(ie)):ie===0&&(j[E].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+q)}U<1&&(V=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+q)}}return j.length>0&&(Y["!rows"]=j),J.length>0&&(Y["!cols"]=J),_&&_.sheetRows&&(S=S.slice(0,_.sheetRows)),[S,Y]}function d(b,_){var y=i(b,_),E=y[0],T=y[1],A=gi(E,_);return Fr(T).forEach(function(D){A[D]=T[D]}),A}function f(b,_){return Un(d(b,_),_)}function x(b,_,y,E){var T="C;Y"+(y+1)+";X"+(E+1)+";K";switch(b.t){case"n":T+=b.v||0,b.f&&!b.F&&(T+=";E"+o3(b.f,{r:y,c:E}));break;case"b":T+=b.v?"TRUE":"FALSE";break;case"e":T+=b.w||b.v;break;case"d":T+='"'+(b.w||b.v)+'"';break;case"s":T+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(b,_){_.forEach(function(y,E){var T="F;W"+(E+1)+" "+(E+1)+" ";y.hidden?T+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=g0(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=v0(y.wpx)),typeof y.wch=="number"&&(T+=Math.round(y.wch))),T.charAt(T.length-1)!=" "&&b.push(T)})}function g(b,_){_.forEach(function(y,E){var T="F;";y.hidden?T+="M0;":y.hpt?T+="M"+20*y.hpt+";":y.hpx&&(T+="M"+20*Mg(y.hpx)+";"),T.length>2&&b.push(T+"R"+(E+1))})}function v(b,_){var y=["ID;PWXL;N;E"],E=[],T=Ya(b["!ref"]),A,D=Array.isArray(b),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),b["!cols"]&&m(y,b["!cols"]),b["!rows"]&&g(y,b["!rows"]),y.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var H=T.s.r;H<=T.e.r;++H)for(var V=T.s.c;V<=T.e.c;++V){var Y=aa({r:H,c:V});A=D?(b[H]||[])[V]:b[Y],!(!A||A.v==null&&(!A.f||A.F))&&E.push(x(A,b,H,V))}return y.join(S)+S+E.join(S)+S+"E"+S}return{to_workbook:f,to_sheet:d,from_sheet:v}}(),w_=function(){function e(o,d){switch(d.type){case"base64":return n(Wt(o),d);case"binary":return n(o,d);case"buffer":return n(xa&&Buffer.isBuffer(o)?o.toString("binary"):ps(o),d);case"array":return n(hs(o),d)}throw new Error("Unrecognized type "+d.type)}function n(o,d){for(var f=o.split(`
`),x=-1,m=-1,g=0,v=[];g!==f.length;++g){if(f[g].trim()==="BOT"){v[++x]=[],m=0;continue}if(!(x<0)){var b=f[g].trim().split(","),_=b[0],y=b[1];++g;for(var E=f[g]||"";(E.match(/["]/g)||[]).length&1&&g<f.length-1;)E+=`
`+f[++g];switch(E=E.trim(),+_){case-1:if(E==="BOT"){v[++x]=[],m=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?v[x][m]=!0:E==="FALSE"?v[x][m]=!1:isNaN(wr(y))?isNaN(hi(y).getDate())?v[x][m]=y:v[x][m]=dt(y):v[x][m]=wr(y),++m;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),v[x][m++]=E!==""?E:null;break}if(E==="EOD")break}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function t(o,d){return gi(e(o,d),d)}function s(o,d){return Un(t(o,d),d)}var i=function(){var o=function(x,m,g,v,b){x.push(m),x.push(g+","+v),x.push('"'+b.replace(/"/g,'""')+'"')},d=function(x,m,g,v){x.push(m+","+g),x.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(x){var m=[],g=Ya(x["!ref"]),v,b=Array.isArray(x);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,g.e.r-g.s.r+1,""),o(m,"TUPLES",0,g.e.c-g.s.c+1,""),o(m,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){d(m,-1,0,"BOT");for(var y=g.s.c;y<=g.e.c;++y){var E=aa({r:_,c:y});if(v=b?(x[_]||[])[y]:x[E],!v){d(m,1,0,"");continue}switch(v.t){case"n":var T=v.w;!T&&v.v!=null&&(T=v.v),T==null?v.f&&!v.F?d(m,1,0,"="+v.f):d(m,1,0,""):d(m,0,T,"V");break;case"b":d(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":d(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=ur(v.z||sa[14],jt(dt(v.v)))),d(m,0,v.w,"V");break;default:d(m,1,0,"")}}}d(m,-1,0,"EOD");var A=`\r
`,D=m.join(A);return D}}();return{to_workbook:s,to_sheet:t,from_sheet:i}}(),S_=function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,b){for(var _=v.split(`
`),y=-1,E=-1,T=0,A=[];T!==_.length;++T){var D=_[T].trim().split(":");if(D[0]==="cell"){var S=Dt(D[1]);if(A.length<=S.r)for(y=A.length;y<=S.r;++y)A[y]||(A[y]=[]);switch(y=S.r,E=S.c,D[2]){case"t":A[y][E]=e(D[3]);break;case"v":A[y][E]=+D[3];break;case"vtf":var H=D[D.length-1];case"vtc":switch(D[3]){case"nl":A[y][E]=!!+D[4];break;default:A[y][E]=+D[4];break}D[2]=="vtf"&&(A[y][E]=[A[y][E],H])}}}return b&&b.sheetRows&&(A=A.slice(0,b.sheetRows)),A}function s(v,b){return gi(t(v,b),b)}function i(v,b){return Un(s(v,b),b)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),x="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var b=[],_=[],y,E="",T=pi(v["!ref"]),A=Array.isArray(v),D=T.s.r;D<=T.e.r;++D)for(var S=T.s.c;S<=T.e.c;++S)if(E=aa({r:D,c:S}),y=A?(v[D]||[])[S]:v[E],!(!y||y.v==null||y.t==="z")){switch(_=["cell",E,"t"],y.t){case"s":case"str":_.push(n(y.v));break;case"n":y.f?(_[2]="vtf",_[3]="n",_[4]=y.v,_[5]=n(y.f)):(_[2]="v",_[3]=y.v);break;case"b":_[2]="vt"+(y.f?"f":"c"),_[3]="nl",_[4]=y.v?"1":"0",_[5]=n(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var H=jt(dt(y.v));_[2]="vtc",_[3]="nd",_[4]=""+H,_[5]=y.w||ur(y.z||sa[14],H);break;case"e":continue}b.push(_.join(":"))}return b.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function g(v){return[o,d,f,d,m(v),x].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:g}}(),Rl=function(){function e(g,v,b,_,y){y.raw?v[b][_]=g:g===""||(g==="TRUE"?v[b][_]=!0:g==="FALSE"?v[b][_]=!1:isNaN(wr(g))?isNaN(hi(g).getDate())?v[b][_]=g:v[b][_]=dt(g):v[b][_]=wr(g))}function n(g,v){var b=v||{},_=[];if(!g||g.length===0)return _;for(var y=g.split(/[\r\n]/),E=y.length-1;E>=0&&y[E].length===0;)--E;for(var T=10,A=0,D=0;D<=E;++D)A=y[D].indexOf(" "),A==-1?A=y[D].length:A++,T=Math.max(T,A);for(D=0;D<=E;++D){_[D]=[];var S=0;for(e(y[D].slice(0,T).trim(),_,D,S,b),S=1;S<=(y[D].length-T)/10+1;++S)e(y[D].slice(T+(S-1)*10,T+S*10).trim(),_,D,S,b)}return b.sheetRows&&(_=_.slice(0,b.sheetRows)),_}var t={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(g){for(var v={},b=!1,_=0,y=0;_<g.length;++_)(y=g.charCodeAt(_))==34?b=!b:!b&&y in t&&(v[y]=(v[y]||0)+1);y=[];for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&y.push([v[_],_]);if(!y.length){v=s;for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&y.push([v[_],_])}return y.sort(function(E,T){return E[0]-T[0]||s[E[1]]-s[T[1]]}),t[y.pop()[1]]||44}function o(g,v){var b=v||{},_="",y=b.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=i(g.slice(0,1024)):b&&b.FS?_=b.FS:_=i(g.slice(0,1024));var T=0,A=0,D=0,S=0,H=0,V=_.charCodeAt(0),Y=!1,j=0,J=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var z=b.dateNF!=null?My(b.dateNF):null;function ie(){var K=g.slice(S,H),q={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)q.t="z";else if(b.raw)q.t="s",q.v=K;else if(K.trim().length===0)q.t="s",q.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(q.t="s",q.v=K.slice(2,-1).replace(/""/g,'"')):f3(K)?(q.t="n",q.f=K.slice(1)):(q.t="s",q.v=K);else if(K=="TRUE")q.t="b",q.v=!0;else if(K=="FALSE")q.t="b",q.v=!1;else if(!isNaN(D=wr(K)))q.t="n",b.cellText!==!1&&(q.w=K),q.v=D;else if(!isNaN(hi(K).getDate())||z&&K.match(z)){q.z=b.dateNF||sa[14];var re=0;z&&K.match(z)&&(K=Iy(K,b.dateNF,K.match(z)||[]),re=1),b.cellDates?(q.t="d",q.v=dt(K,re)):(q.t="n",q.v=jt(dt(K,re))),b.cellText!==!1&&(q.w=ur(q.z,q.v instanceof Date?jt(q.v):q.v)),b.cellNF||delete q.z}else q.t="s",q.v=K;if(q.t=="z"||(b.dense?(y[T]||(y[T]=[]),y[T][A]=q):y[aa({c:A,r:T})]=q),S=H+1,J=g.charCodeAt(S),E.e.c<A&&(E.e.c=A),E.e.r<T&&(E.e.r=T),j==V)++A;else if(A=0,++T,b.sheetRows&&b.sheetRows<=T)return!0}e:for(;H<g.length;++H)switch(j=g.charCodeAt(H)){case 34:J===34&&(Y=!Y);break;case V:case 10:case 13:if(!Y&&ie())break e;break}return H-S>0&&ie(),y["!ref"]=va(E),y}function d(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,v):gi(n(g,v),v)}function f(g,v){var b="",_=v.type=="string"?[0,0,0,0]:Ff(g,v);switch(v.type){case"base64":b=Wt(g);break;case"binary":b=g;break;case"buffer":v.codepage==65001?b=g.toString("utf8"):v.codepage&&typeof kl<"u"||(b=xa&&Buffer.isBuffer(g)?g.toString("binary"):ps(g));break;case"array":b=hs(g);break;case"string":b=g;break;default:throw new Error("Unrecognized type "+v.type)}return _[0]==239&&_[1]==187&&_[2]==191?b=Ma(b.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?b=Ma(b):v.type=="binary"&&typeof kl<"u",b.slice(0,19)=="socialcalc:version:"?S_.to_sheet(v.type=="string"?b:Ma(b),v):d(b,v)}function x(g,v){return Un(f(g,v),v)}function m(g){for(var v=[],b=Ya(g["!ref"]),_,y=Array.isArray(g),E=b.s.r;E<=b.e.r;++E){for(var T=[],A=b.s.c;A<=b.e.c;++A){var D=aa({r:E,c:A});if(_=y?(g[E]||[])[A]:g[D],!_||_.v==null){T.push("          ");continue}for(var S=(_.w||(tn(_),_.w)||"").slice(0,10);S.length<10;)S+=" ";T.push(S+(A===0?" ":""))}v.push(T.join(""))}return v.join(`
`)}return{to_workbook:x,to_sheet:f,from_sheet:m}}();function A_(e,n){var t=n||{},s=!!t.WTF;t.WTF=!0;try{var i=T_.to_workbook(e,t);return t.WTF=s,i}catch(o){if(t.WTF=s,!o.message.match(/SYLK bad record ID/)&&s)throw o;return Rl.to_workbook(e,n)}}var _l=function(){function e(C,X,U){if(C){pt(C,C.l||0);for(var R=U.Enum||P;C.l<C.length;){var W=C.read_shift(2),me=R[W]||R[65535],ve=C.read_shift(2),Te=C.l+ve,Ee=me.f&&me.f(C,ve,U);if(C.l=Te,X(Ee,me,W))return}}}function n(C,X){switch(X.type){case"base64":return t(Er(Wt(C)),X);case"binary":return t(Er(C),X);case"buffer":case"array":return t(C,X)}throw"Unsupported type "+X.type}function t(C,X){if(!C)return C;var U=X||{},R=U.dense?[]:{},W="Sheet1",me="",ve=0,Te={},Ee=[],Be=[],I={s:{r:0,c:0},e:{r:0,c:0}},Pe=U.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)U.Enum=P,e(C,function(ge,Ie,ma){switch(ma){case 0:U.vers=ge,ge>=4096&&(U.qpro=!0);break;case 6:I=ge;break;case 204:ge&&(me=ge);break;case 222:me=ge;break;case 15:case 51:U.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:ma==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=U.dateNF||sa[14],U.cellDates&&(ge[1].t="d",ge[1].v=E0(ge[1].v))),U.qpro&&ge[3]>ve&&(R["!ref"]=va(I),Te[W]=R,Ee.push(W),R=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=ge[3],W=me||"Sheet"+(ve+1),me="");var we=U.dense?(R[ge[0].r]||[])[ge[0].c]:R[aa(ge[0])];if(we){we.t=ge[1].t,we.v=ge[1].v,ge[1].z!=null&&(we.z=ge[1].z),ge[1].f!=null&&(we.f=ge[1].f);break}U.dense?(R[ge[0].r]||(R[ge[0].r]=[]),R[ge[0].r][ge[0].c]=ge[1]):R[aa(ge[0])]=ge[1];break}},U);else if(C[2]==26||C[2]==14)U.Enum=ce,C[2]==14&&(U.qpro=!0,C.l=0),e(C,function(ge,Ie,ma){switch(ma){case 204:W=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ve&&(R["!ref"]=va(I),Te[W]=R,Ee.push(W),R=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},ve=ge[3],W="Sheet"+(ve+1)),Pe>0&&ge[0].r>=Pe)break;U.dense?(R[ge[0].r]||(R[ge[0].r]=[]),R[ge[0].r][ge[0].c]=ge[1]):R[aa(ge[0])]=ge[1],I.e.c<ge[0].c&&(I.e.c=ge[0].c),I.e.r<ge[0].r&&(I.e.r=ge[0].r);break;case 27:ge[14e3]&&(Be[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Be[ge[0]]=ge[1],ge[0]==ve&&(W=ge[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(R["!ref"]=va(I),Te[me||W]=R,Ee.push(me||W),!Be.length)return{SheetNames:Ee,Sheets:Te};for(var Ue={},We=[],Ve=0;Ve<Be.length;++Ve)Te[Ee[Ve]]?(We.push(Be[Ve]||Ee[Ve]),Ue[Be[Ve]]=Te[Be[Ve]]||Te[Ee[Ve]]):(We.push(Be[Ve]),Ue[Be[Ve]]={"!ref":"A1"});return{SheetNames:We,Sheets:Ue}}function s(C,X){var U=X||{};if(+U.codepage>=0&&_r(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Wu(),W=Ya(C["!ref"]),me=Array.isArray(C),ve=[];yr(R,0,o(1030)),yr(R,6,x(W));for(var Te=Math.min(W.e.r,8191),Ee=W.s.r;Ee<=Te;++Ee)for(var Be=vt(Ee),I=W.s.c;I<=W.e.c;++I){Ee===W.s.r&&(ve[I]=it(I));var Pe=ve[I]+Be,Ue=me?(C[Ee]||[])[I]:C[Pe];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?yr(R,13,_(Ee,I,Ue.v)):yr(R,14,E(Ee,I,Ue.v));else{var We=tn(Ue);yr(R,15,v(Ee,I,We.slice(0,239)))}}return yr(R,1),R.end()}function i(C,X){var U=X||{};if(+U.codepage>=0&&_r(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Wu();yr(R,0,d(C));for(var W=0,me=0;W<C.SheetNames.length;++W)(C.Sheets[C.SheetNames[W]]||{})["!ref"]&&yr(R,27,ee(C.SheetNames[W],me++));var ve=0;for(W=0;W<C.SheetNames.length;++W){var Te=C.Sheets[C.SheetNames[W]];if(!(!Te||!Te["!ref"])){for(var Ee=Ya(Te["!ref"]),Be=Array.isArray(Te),I=[],Pe=Math.min(Ee.e.r,8191),Ue=Ee.s.r;Ue<=Pe;++Ue)for(var We=vt(Ue),Ve=Ee.s.c;Ve<=Ee.e.c;++Ve){Ue===Ee.s.r&&(I[Ve]=it(Ve));var ge=I[Ve]+We,Ie=Be?(Te[Ue]||[])[Ve]:Te[ge];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")yr(R,23,ie(Ue,Ve,ve,Ie.v));else{var ma=tn(Ie);yr(R,22,j(Ue,Ve,ve,ma.slice(0,239)))}}++ve}}return yr(R,1),R.end()}function o(C){var X=st(2);return X.write_shift(2,C),X}function d(C){var X=st(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var U=0,R=0,W=0,me=0;me<C.SheetNames.length;++me){var ve=C.SheetNames[me],Te=C.Sheets[ve];if(!(!Te||!Te["!ref"])){++W;var Ee=pi(Te["!ref"]);U<Ee.e.r&&(U=Ee.e.r),R<Ee.e.c&&(R=Ee.e.c)}}return U>8191&&(U=8191),X.write_shift(2,U),X.write_shift(1,W),X.write_shift(1,R),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function f(C,X,U){var R={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&U.qpro?(R.s.c=C.read_shift(1),C.l++,R.s.r=C.read_shift(2),R.e.c=C.read_shift(1),C.l++,R.e.r=C.read_shift(2),R):(R.s.c=C.read_shift(2),R.s.r=C.read_shift(2),X==12&&U.qpro&&(C.l+=2),R.e.c=C.read_shift(2),R.e.r=C.read_shift(2),X==12&&U.qpro&&(C.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function x(C){var X=st(8);return X.write_shift(2,C.s.c),X.write_shift(2,C.s.r),X.write_shift(2,C.e.c),X.write_shift(2,C.e.r),X}function m(C,X,U){var R=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(R[0].c=C.read_shift(1),R[3]=C.read_shift(1),R[0].r=C.read_shift(2),C.l+=2):(R[2]=C.read_shift(1),R[0].c=C.read_shift(2),R[0].r=C.read_shift(2)),R}function g(C,X,U){var R=C.l+X,W=m(C,X,U);if(W[1].t="s",U.vers==20768){C.l++;var me=C.read_shift(1);return W[1].v=C.read_shift(me,"utf8"),W}return U.qpro&&C.l++,W[1].v=C.read_shift(R-C.l,"cstr"),W}function v(C,X,U){var R=st(7+U.length);R.write_shift(1,255),R.write_shift(2,X),R.write_shift(2,C),R.write_shift(1,39);for(var W=0;W<R.length;++W){var me=U.charCodeAt(W);R.write_shift(1,me>=128?95:me)}return R.write_shift(1,0),R}function b(C,X,U){var R=m(C,X,U);return R[1].v=C.read_shift(2,"i"),R}function _(C,X,U){var R=st(7);return R.write_shift(1,255),R.write_shift(2,X),R.write_shift(2,C),R.write_shift(2,U,"i"),R}function y(C,X,U){var R=m(C,X,U);return R[1].v=C.read_shift(8,"f"),R}function E(C,X,U){var R=st(13);return R.write_shift(1,255),R.write_shift(2,X),R.write_shift(2,C),R.write_shift(8,U,"f"),R}function T(C,X,U){var R=C.l+X,W=m(C,X,U);if(W[1].v=C.read_shift(8,"f"),U.qpro)C.l=R;else{var me=C.read_shift(2);H(C.slice(C.l,C.l+me),W),C.l+=me}return W}function A(C,X,U){var R=X&32768;return X&=-32769,X=(R?C:0)+(X>=8192?X-16384:X),(R?"":"$")+(U?it(X):vt(X))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function H(C,X){pt(C,0);for(var U=[],R=0,W="",me="",ve="",Te="";C.l<C.length;){var Ee=C[C.l++];switch(Ee){case 0:U.push(C.read_shift(8,"f"));break;case 1:me=A(X[0].c,C.read_shift(2),!0),W=A(X[0].r,C.read_shift(2),!1),U.push(me+W);break;case 2:{var Be=A(X[0].c,C.read_shift(2),!0),I=A(X[0].r,C.read_shift(2),!1);me=A(X[0].c,C.read_shift(2),!0),W=A(X[0].r,C.read_shift(2),!1),U.push(Be+I+":"+me+W)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(C.read_shift(2));break;case 6:{for(var Pe="";Ee=C[C.l++];)Pe+=String.fromCharCode(Ee);U.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Te=U.pop(),ve=U.pop(),U.push(["AND","OR"][Ee-20]+"("+ve+","+Te+")");break;default:if(Ee<32&&S[Ee])Te=U.pop(),ve=U.pop(),U.push(ve+S[Ee]+Te);else if(D[Ee]){if(R=D[Ee][1],R==69&&(R=C[C.l++]),R>U.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+U.join("|")+"|");return}var Ue=U.slice(-R);U.length-=R,U.push(D[Ee][0]+"("+Ue.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}U.length==1?X[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function V(C){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=C.read_shift(2),X[3]=C[C.l++],X[0].c=C[C.l++],X}function Y(C,X){var U=V(C);return U[1].t="s",U[1].v=C.read_shift(X-4,"cstr"),U}function j(C,X,U,R){var W=st(6+R.length);W.write_shift(2,C),W.write_shift(1,U),W.write_shift(1,X),W.write_shift(1,39);for(var me=0;me<R.length;++me){var ve=R.charCodeAt(me);W.write_shift(1,ve>=128?95:ve)}return W.write_shift(1,0),W}function J(C,X){var U=V(C);U[1].v=C.read_shift(2);var R=U[1].v>>1;if(U[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return U[1].v=R,U}function z(C,X){var U=V(C),R=C.read_shift(4),W=C.read_shift(4),me=C.read_shift(2);if(me==65535)return R===0&&W===3221225472?(U[1].t="e",U[1].v=15):R===0&&W===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ve=me&32768;return me=(me&32767)-16446,U[1].v=(1-ve*2)*(W*Math.pow(2,me+32)+R*Math.pow(2,me)),U}function ie(C,X,U,R){var W=st(14);if(W.write_shift(2,C),W.write_shift(1,U),W.write_shift(1,X),R==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var me=0,ve=0,Te=0,Ee=0;return R<0&&(me=1,R=-R),ve=Math.log2(R)|0,R/=Math.pow(2,ve-31),Ee=R>>>0,(Ee&2147483648)==0&&(R/=2,++ve,Ee=R>>>0),R-=Ee,Ee|=2147483648,Ee>>>=0,R*=Math.pow(2,32),Te=R>>>0,W.write_shift(4,Te),W.write_shift(4,Ee),ve+=16383+(me?32768:0),W.write_shift(2,ve),W}function K(C,X){var U=z(C);return C.l+=X-14,U}function q(C,X){var U=V(C),R=C.read_shift(4);return U[1].v=R>>6,U}function re(C,X){var U=V(C),R=C.read_shift(8,"f");return U[1].v=R,U}function pe(C,X){var U=re(C);return C.l+=X-10,U}function Ae(C,X){return C[C.l+X-1]==0?C.read_shift(X,"cstr"):""}function Z(C,X){var U=C[C.l++];U>X-1&&(U=X-1);for(var R="";R.length<U;)R+=String.fromCharCode(C[C.l++]);return R}function oe(C,X,U){if(!(!U.qpro||X<21)){var R=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var W=C.read_shift(X-21,"cstr");return[R,W]}}function Re(C,X){for(var U={},R=C.l+X;C.l<R;){var W=C.read_shift(2);if(W==14e3){for(U[W]=[0,""],U[W][0]=C.read_shift(2);C[C.l];)U[W][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return U}function ee(C,X){var U=st(5+C.length);U.write_shift(2,14e3),U.write_shift(2,X);for(var R=0;R<C.length;++R){var W=C.charCodeAt(R);U[U.l++]=W>127?95:W}return U[U.l++]=0,U}var P={0:{n:"BOF",f:at},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:J},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:n}}();function N_(e){var n={},t=e.match(Nt),s=0,i=!1;if(t)for(;s!=t.length;++s){var o=Ze(t[s]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=uf[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return n}var k_=function(){var e=Ol("t"),n=Ol("rPr");function t(o){var d=o.match(e);if(!d)return{t:"s",v:""};var f={t:"s",v:ba(d[1])},x=o.match(n);return x&&(f.s=N_(x[1])),f}var s=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(d){return d.replace(s,"").split(i).map(t).filter(function(f){return f.v})}}(),C_=function(){var n=/(\r\n|\n)/g;function t(i,o,d){var f=[];i.u&&f.push("text-decoration: underline;"),i.uval&&f.push("text-underline-style:"+i.uval+";"),i.sz&&f.push("font-size:"+i.sz+"pt;"),i.outline&&f.push("text-effect: outline;"),i.shadow&&f.push("text-shadow: auto;"),o.push('<span style="'+f.join("")+'">'),i.b&&(o.push("<b>"),d.push("</b>")),i.i&&(o.push("<i>"),d.push("</i>")),i.strike&&(o.push("<s>"),d.push("</s>"));var x=i.valign||"";return x=="superscript"||x=="super"?x="sup":x=="subscript"&&(x="sub"),x!=""&&(o.push("<"+x+">"),d.push("</"+x+">")),d.push("</span>"),i}function s(i){var o=[[],i.v,[]];return i.v?(i.s&&t(i.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(s).join("")}}(),O_=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,D_=/<(?:\w+:)?r>/,R_=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Nf(e,n){var t=n?n.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=ba(Ma(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Ma(e),t&&(s.h=gf(s.t))):e.match(D_)&&(s.r=Ma(e),s.t=ba(Ma((e.replace(R_,"").match(O_)||[]).join("").replace(Nt,""))),t&&(s.h=C_(k_(s.r)))),s):{t:""}}var j_=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,F_=/<(?:\w+:)?(?:si|sstItem)>/g,L_=/<\/(?:\w+:)?(?:si|sstItem)>/;function M_(e,n){var t=[],s="";if(!e)return t;var i=e.match(j_);if(i){s=i[2].replace(F_,"").split(L_);for(var o=0;o!=s.length;++o){var d=Nf(s[o].trim(),n);d!=null&&(t[t.length]=d)}i=Ze(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function I_(e){return[e.read_shift(4),e.read_shift(4)]}function B_(e,n){var t=[],s=!1;return nn(e,function(o,d,f){switch(f){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(d.T,!s||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function Og(e){for(var n=[],t=e.split(""),s=0;s<t.length;++s)n[s]=t[s].charCodeAt(0);return n}function an(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function U_(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=an(e,4),n.U=an(e,4),n.W=an(e,4),n}function P_(e){for(var n=e.read_shift(4),t=e.l+n-4,s={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return s}function H_(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(P_(e));return n}function z_(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function V_(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=an(e,4),n.U=an(e,4),n.W=an(e,4),n}function G_(e){var n=V_(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Dg(e,n){var t=e.l+n,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var i=!1;switch(s.AlgID){case 26126:case 26127:case 26128:i=s.Flags==36;break;case 26625:i=s.Flags==4;break;case 0:i=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,s}function Rg(e,n){var t={},s=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,s),e.l=s,t}function Y_(e){var n=an(e);switch(n.Minor){case 2:return[n.Minor,X_(e)];case 3:return[n.Minor,q_()];case 4:return[n.Minor,K_(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function X_(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),s=Dg(e,t),i=Rg(e,e.length-e.l);return{t:"Std",h:s,v:i}}function q_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K_(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),s={};return t.replace(Nt,function(o){var d=Ze(o);switch(Lr(d[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(f){s[f]=d[f]});break;case"<dataIntegrity":s.encryptedHmacKey=d.encryptedHmacKey,s.encryptedHmacValue=d.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=d.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(d);break;default:throw d[0]}}),s}function W_(e,n){var t={},s=t.EncryptionVersionInfo=an(e,4);if(n-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);t.Flags=e.read_shift(4),n-=4;var i=e.read_shift(4);return n-=4,t.EncryptionHeader=Dg(e,i),n-=i,t.EncryptionVerifier=Rg(e,n),t}function $_(e){var n={},t=n.EncryptionVersionInfo=an(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function Z_(e){var n=0,t,s=Og(e),i=s.length+1,o,d,f,x,m;for(t=In(i),t[0]=s.length,o=1;o!=i;++o)t[o]=s[o-1];for(o=i-1;o>=0;--o)d=t[o],f=(n&16384)===0?0:1,x=n<<1&32767,m=f|x,n=m^d;return n^52811}var jg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(d){return(d/2|d*128)&255},i=function(d,f){return s(d^f)},o=function(d){for(var f=n[d.length-1],x=104,m=d.length-1;m>=0;--m)for(var g=d[m],v=0;v!=7;++v)g&64&&(f^=t[x]),g*=2,--x;return f};return function(d){for(var f=Og(d),x=o(f),m=f.length,g=In(16),v=0;v!=16;++v)g[v]=0;var b,_,y;for((m&1)===1&&(b=x>>8,g[m]=i(e[0],b),--m,b=x&255,_=f[f.length-1],g[m]=i(_,b));m>0;)--m,b=x>>8,g[m]=i(f[m],b),--m,b=x&255,g[m]=i(f[m],b);for(m=15,y=15-f.length;y>0;)b=x>>8,g[m]=i(e[y],b),--m,--y,b=x&255,g[m]=i(f[m],b),--m,--y;return g}}(),Q_=function(e,n,t,s,i){i||(i=n),s||(s=jg(e));var o,d;for(o=0;o!=n.length;++o)d=n[o],d^=s[t],d=(d>>5|d<<3)&255,i[o]=d,++t;return[i,t,s]},J_=function(e){var n=0,t=jg(e);return function(s){var i=Q_("",s,n,t);return n=i[1],i[0]}};function eT(e,n,t,s){var i={key:at(e),verificationBytes:at(e)};return t.password&&(i.verifier=Z_(t.password)),s.valid=i.verificationBytes===i.verifier,s.valid&&(s.insitu=J_(t.password)),i}function aT(e,n,t){var s=t||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=$_(e):s.Data=W_(e,n),s}function tT(e,n,t){var s={Type:t.biff>=8?e.read_shift(2):0};return s.Type?aT(e,n-2,s):eT(e,t.biff>=8?n:n-2,t,s),s}var rT=function(){function e(i,o){switch(o.type){case"base64":return n(Wt(i),o);case"binary":return n(i,o);case"buffer":return n(xa&&Buffer.isBuffer(i)?i.toString("binary"):ps(i),o);case"array":return n(hs(i),o)}throw new Error("Unrecognized type "+o.type)}function n(i,o){var d=o||{},f=d.dense?[]:{},x=i.match(/\\trowd.*?\\row\b/g);if(!x.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:x.length-1}};return x.forEach(function(g,v){Array.isArray(f)&&(f[v]=[]);for(var b=/\\\w+\b/g,_=0,y,E=-1;y=b.exec(g);){switch(y[0]){case"\\cell":var T=g.slice(_,b.lastIndex-y[0].length);if(T[0]==" "&&(T=T.slice(1)),++E,T.length){var A={v:T,t:"s"};Array.isArray(f)?f[v][E]=A:f[aa({r:v,c:E})]=A}break}_=b.lastIndex}E>m.e.c&&(m.e.c=E)}),f["!ref"]=va(m),f}function t(i,o){return Un(e(i,o),o)}function s(i){for(var o=["{\\rtf1\\ansi"],d=Ya(i["!ref"]),f,x=Array.isArray(i),m=d.s.r;m<=d.e.r;++m){o.push("\\trowd\\trautofit1");for(var g=d.s.c;g<=d.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=d.s.c;g<=d.e.c;++g){var v=aa({r:m,c:g});f=x?(i[m]||[])[g]:i[v],!(!f||f.v==null&&(!f.f||f.F))&&(o.push(" "+(f.w||(tn(f),f.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:s}}();function nT(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function jl(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function sT(e){var n=e[0]/255,t=e[1]/255,s=e[2]/255,i=Math.max(n,t,s),o=Math.min(n,t,s),d=i-o;if(d===0)return[0,0,n];var f=0,x=0,m=i+o;switch(x=d/(m>1?2-m:m),i){case n:f=((t-s)/d+6)%6;break;case t:f=(s-n)/d+2;break;case s:f=(n-t)/d+4;break}return[f/6,x,m/2]}function iT(e){var n=e[0],t=e[1],s=e[2],i=t*2*(s<.5?s:1-s),o=s-i/2,d=[o,o,o],f=6*n,x;if(t!==0)switch(f|0){case 0:case 6:x=i*f,d[0]+=i,d[1]+=x;break;case 1:x=i*(2-f),d[0]+=x,d[1]+=i;break;case 2:x=i*(f-2),d[1]+=i,d[2]+=x;break;case 3:x=i*(4-f),d[1]+=x,d[2]+=i;break;case 4:x=i*(f-4),d[2]+=i,d[0]+=x;break;case 5:x=i*(6-f),d[2]+=x,d[0]+=i;break}for(var m=0;m!=3;++m)d[m]=Math.round(d[m]*255);return d}function p0(e,n){if(n===0)return e;var t=sT(nT(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),jl(iT(t))}var Fg=6,lT=15,cT=1,Ot=Fg;function g0(e){return Math.floor((e+Math.round(128/Ot)/256)*Ot)}function v0(e){return Math.floor((e-5)/Ot*100+.5)/100}function Ju(e){return Math.round((e*Ot+5)/Ot*256)/256}function Pu(e){return Ju(v0(g0(e)))}function kf(e){var n=Math.abs(e-Pu(e)),t=Ot;if(n>.005)for(Ot=cT;Ot<lT;++Ot)Math.abs(e-Pu(e))<=n&&(n=Math.abs(e-Pu(e)),t=Ot);Ot=t}function xi(e){e.width?(e.wpx=g0(e.width),e.wch=v0(e.wpx),e.MDW=Ot):e.wpx?(e.wch=v0(e.wpx),e.width=Ju(e.wch),e.MDW=Ot):typeof e.wch=="number"&&(e.width=Ju(e.wch),e.wpx=g0(e.width),e.MDW=Ot),e.customWidth&&delete e.customWidth}var oT=96,Lg=oT;function Mg(e){return e*96/Lg}function Fl(e){return e*Lg/96}var uT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fT(e,n,t,s){n.Borders=[];var i={},o=!1;(e[0].match(Nt)||[]).forEach(function(d){var f=Ze(d);switch(Lr(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},f.diagonalUp&&(i.diagonalUp=Ba(f.diagonalUp)),f.diagonalDown&&(i.diagonalDown=Ba(f.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+f[0]+" in borders")}})}function dT(e,n,t,s){n.Fills=[];var i={},o=!1;(e[0].match(Nt)||[]).forEach(function(d){var f=Ze(d);switch(Lr(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":f.patternType&&(i.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),f.indexed&&(i.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(i.bgColor.theme=parseInt(f.theme,10)),f.tint&&(i.bgColor.tint=parseFloat(f.tint)),f.rgb&&(i.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),f.theme&&(i.fgColor.theme=parseInt(f.theme,10)),f.tint&&(i.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(i.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+f[0]+" in fills")}})}function hT(e,n,t,s){n.Fonts=[];var i={},o=!1;(e[0].match(Nt)||[]).forEach(function(d){var f=Ze(d);switch(Lr(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":f.val&&(i.name=Ma(f.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=f.val?Ba(f.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=f.val?Ba(f.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(f.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=f.val?Ba(f.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=f.val?Ba(f.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=f.val?Ba(f.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=f.val?Ba(f.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=f.val?Ba(f.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":f.val&&(i.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(i.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(i.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(i.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=uf[parseInt(f.val,10)];break;case"<color":if(i.color||(i.color={}),f.auto&&(i.color.auto=Ba(f.auto)),f.rgb)i.color.rgb=f.rgb.slice(-6);else if(f.indexed){i.color.index=parseInt(f.indexed,10);var x=fs[i.color.index];i.color.index==81&&(x=fs[1]),x||(x=fs[1]),i.color.rgb=x[0].toString(16)+x[1].toString(16)+x[2].toString(16)}else f.theme&&(i.color.theme=parseInt(f.theme,10),f.tint&&(i.color.tint=parseFloat(f.tint)),f.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=p0(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+f[0]+" in fonts")}})}function xT(e,n,t){n.NumberFmt=[];for(var s=Fr(sa),i=0;i<s.length;++i)n.NumberFmt[s[i]]=sa[s[i]];var o=e[0].match(Nt);if(o)for(i=0;i<o.length;++i){var d=Ze(o[i]);switch(Lr(d[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=ba(Ma(d.formatCode)),x=parseInt(d.numFmtId,10);if(n.NumberFmt[x]=f,x>0){if(x>392){for(x=392;x>60&&n.NumberFmt[x]!=null;--x);n.NumberFmt[x]=f}us(f,x)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+d[0]+" in numFmts")}}}var n0=["numFmtId","fillId","fontId","borderId","xfId"],s0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mT(e,n,t){n.CellXf=[];var s,i=!1;(e[0].match(Nt)||[]).forEach(function(o){var d=Ze(o),f=0;switch(Lr(d[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=d,delete s[0],f=0;f<n0.length;++f)s[n0[f]]&&(s[n0[f]]=parseInt(s[n0[f]],10));for(f=0;f<s0.length;++f)s[s0[f]]&&(s[s0[f]]=Ba(s[s0[f]]));if(n.NumberFmt&&s.numFmtId>392){for(f=392;f>60;--f)if(n.NumberFmt[s.numFmtId]==n.NumberFmt[f]){s.numFmtId=f;break}}n.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var x={};d.vertical&&(x.vertical=d.vertical),d.horizontal&&(x.horizontal=d.horizontal),d.textRotation!=null&&(x.textRotation=d.textRotation),d.indent&&(x.indent=d.indent),d.wrapText&&(x.wrapText=Ba(d.wrapText)),s.alignment=x;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+d[0]+" in cellXfs")}})}var pT=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,x,m){var g={};if(!f)return g;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=f.match(n))&&xT(v,g,m),(v=f.match(i))&&hT(v,g,x,m),(v=f.match(s))&&dT(v,g,x,m),(v=f.match(o))&&fT(v,g,x,m),(v=f.match(t))&&mT(v,g,m),g}}();function gT(e,n){var t=e.read_shift(2),s=St(e);return[t,s]}function vT(e,n,t){var s={};s.sz=e.read_shift(2)/20;var i=kE(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(s.underline=d);var f=e.read_shift(1);f>0&&(s.family=f);var x=e.read_shift(1);switch(x>0&&(s.charset=x),e.l++,s.color=NE(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=St(e),s}var bT=At;function yT(e,n){var t=e.l+n,s=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:i}}var ET=At;function _T(e,n,t){var s={};s.NumberFmt=[];for(var i in sa)s.NumberFmt[i]=sa[i];s.CellXf=[],s.Fonts=[];var o=[],d=!1;return nn(e,function(x,m,g){switch(g){case 44:s.NumberFmt[x[0]]=x[1],us(x[1],x[0]);break;case 43:s.Fonts.push(x),x.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(x.color.rgb=p0(n.themeElements.clrScheme[x.color.theme].rgb,x.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&s.CellXf.push(x);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:o.push(g),d=!0;break;case 38:o.pop(),d=!1;break;default:if(m.T>0)o.push(g);else if(m.T<0)o.pop();else if(!d||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),s}var TT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wT(e,n,t){n.themeElements.clrScheme=[];var s={};(e[0].match(Nt)||[]).forEach(function(i){var o=Ze(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=o.val;break;case"<a:sysClr":s.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[TT.indexOf(o[0])]=s,s={}):s.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function ST(){}function AT(){}var NT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,CT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function OT(e,n,t){n.themeElements={};var s;[["clrScheme",NT,wT],["fontScheme",kT,ST],["fmtScheme",CT,AT]].forEach(function(i){if(!(s=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](s,n,t)})}var DT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ig(e,n){(!e||e.length===0)&&(e=RT());var t,s={};if(!(t=e.match(DT)))throw new Error("themeElements not found in theme");return OT(t[0],s,n),s.raw=e,s}function RT(e,n){var t=[Kp];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function jT(e,n,t){var s=e.l+n,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=s;return}var o=e.slice(e.l);e.l=s;var d;try{d=qp(o,{type:"array"})}catch{return}var f=Kt(d,"theme/theme/theme1.xml",!0);if(f)return Ig(f,t)}}function FT(e){return e.read_shift(4)}function LT(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=MT(e,4);break;case 2:n.xclrValue=Tg(e);break;case 3:n.xclrValue=FT(e);break;case 4:e.l+=4;break}return e.l+=8,n}function MT(e,n){return At(e,n)}function IT(e,n){return At(e,n)}function BT(e){var n=e.read_shift(2),t=e.read_shift(2)-4,s=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=LT(e);break;case 6:s[1]=IT(e,t);break;case 14:case 15:s[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return s}function UT(e,n){var t=e.l+n;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),o=[];i-- >0;)o.push(BT(e,t-e.l));return{ixfe:s,ext:o}}function PT(e,n){n.forEach(function(t){t[0]})}function HT(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:St(e)}}function zT(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function VT(e){return e.l+=4,e.read_shift(4)!=0}function GT(e,n,t){var s={Types:[],Cell:[],Value:[]},i=t||{},o=[],d=!1,f=2;return nn(e,function(x,m,g){switch(g){case 335:s.Types.push({name:x.name});break;case 51:x.forEach(function(v){f==1?s.Cell.push({type:s.Types[v[0]-1].name,index:v[1]}):f==0&&s.Value.push({type:s.Types[v[0]-1].name,index:v[1]})});break;case 337:f=x?1:0;break;case 338:f=2;break;case 35:o.push(g),d=!0;break;case 36:o.pop(),d=!1;break;default:if(!m.T){if(!d||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),s}function YT(e,n,t){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var i=!1,o=2,d;return e.replace(Nt,function(f){var x=Ze(f);switch(Lr(x[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:x.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<s.Types.length;++m)s.Types[m].name==x.name&&(d=s.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?s.Cell.push({type:s.Types[x.t-1].name,index:+x.v}):o==0&&s.Value.push({type:s.Types[x.t-1].name,index:+x.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!d)break;d.offsets||(d.offsets=[]),d.offsets.push(+x.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+x[0]+" in metadata")}return f}),s}function XT(e){var n=[];if(!e)return n;var t=1;return(e.match(Nt)||[]).forEach(function(s){var i=Ze(s);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,n.push(i);break}}),n}function qT(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=aa(t);var s=e.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}function KT(e,n,t){var s=[];return nn(e,function(o,d,f){switch(f){case 63:s.push(o);break;default:if(!d.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),s}function WT(e,n,t,s){if(!e)return e;var i=s||{},o=!1;nn(e,function(f,x,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!x.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},i)}function $T(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function np(e,n,t,s){var i=Array.isArray(e),o;n.forEach(function(d){var f=Dt(d.ref);if(i?(e[f.r]||(e[f.r]=[]),o=e[f.r][f.c]):o=e[d.ref],!o){o={t:"z"},i?e[f.r][f.c]=o:e[d.ref]=o;var x=Ya(e["!ref"]||"BDWGO1000001:A1");x.s.r>f.r&&(x.s.r=f.r),x.e.r<f.r&&(x.e.r=f.r),x.s.c>f.c&&(x.s.c=f.c),x.e.c<f.c&&(x.e.c=f.c);var m=va(x);m!==e["!ref"]&&(e["!ref"]=m)}o.c||(o.c=[]);var g={a:d.author,t:d.t,r:d.r,T:t};d.h&&(g.h=d.h);for(var v=o.c.length-1;v>=0;--v){if(!t&&o.c[v].T)return;t&&!o.c[v].T&&o.c.splice(v,1)}if(t&&s){for(v=0;v<s.length;++v)if(g.a==s[v].id){g.a=s[v].name||g.a;break}}o.c.push(g)})}function ZT(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],s=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(d){if(!(d===""||d.trim()==="")){var f=d.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&t.push(f[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(d){if(!(d===""||d.trim()==="")){var f=d.match(/<(?:\w+:)?comment[^>]*>/);if(f){var x=Ze(f[0]),m={author:x.authorId&&t[x.authorId]||"sheetjsghost",ref:x.ref,guid:x.guid},g=Dt(x.ref);if(!(n.sheetRows&&n.sheetRows<=g.r)){var v=d.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),b=!!v&&!!v[1]&&Nf(v[1])||{r:"",t:"",h:""};m.r=b.r,b.r=="<t></t>"&&(b.t=b.h=""),m.t=(b.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(m.h=b.h),s.push(m)}}}}),s}function QT(e,n){var t=[],s=!1,i={},o=0;return e.replace(Nt,function(f,x){var m=Ze(f);switch(Lr(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":o=x+f.length;break;case"</text>":i.t=e.slice(o,x).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return f}),t}function JT(e,n){var t=[],s=!1;return e.replace(Nt,function(o){var d=Ze(o);switch(Lr(d[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:d.displayname,id:d.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),t}function e3(e){var n={};n.iauthor=e.read_shift(4);var t=vs(e);return n.rfx=t.s,n.ref=aa(t.s),e.l+=16,n}var a3=St;function t3(e,n){var t=[],s=[],i={},o=!1;return nn(e,function(f,x,m){switch(m){case 632:s.push(f);break;case 635:i=f;break;case 637:i.t=f.t,i.h=f.h,i.r=f.r;break;case 636:if(i.author=s[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!x.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),t}var r3="application/vnd.ms-office.vbaProject";function n3(e){var n=ga.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,s){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ga.utils.cfb_add(n,i,e.FileIndex[s].content)}}),ga.write(n)}function s3(){return{"!type":"dialog"}}function i3(){return{"!type":"dialog"}}function l3(){return{"!type":"macro"}}function c3(){return{"!type":"macro"}}var fi=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(s,i,o,d){var f=!1,x=!1;o.length==0?x=!0:o.charAt(0)=="["&&(x=!0,o=o.slice(1,-1)),d.length==0?f=!0:d.charAt(0)=="["&&(f=!0,d=d.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,g=d.length>0?parseInt(d,10)|0:0;return f?g+=n.c:--g,x?m+=n.r:--m,i+(f?"":"$")+it(g)+(x?"":"$")+vt(m)}return function(i,o){return n=o,i.replace(e,t)}}(),Bg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,o3=function(){return function(n,t){return n.replace(Bg,function(s,i,o,d,f,x){var m=Ef(d)-(o?0:t.c),g=yf(x)-(f?0:t.r),v=g==0?"":f?g+1:"["+g+"]",b=m==0?"":o?m+1:"["+m+"]";return i+"R"+v+"C"+b})}}();function Ug(e,n){return e.replace(Bg,function(t,s,i,o,d,f){return s+(i=="$"?i+o:it(Ef(o)+n.c))+(d=="$"?d+f:vt(yf(f)+n.r))})}function u3(e,n,t){var s=pi(n),i=s.s,o=Dt(t),d={r:o.r-i.r,c:o.c-i.c};return Ug(e,d)}function f3(e){return e.length!=1}function sp(e){return e.replace(/_xlfn\./g,"")}function Ja(e){e.l+=1}function Bn(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Pg(e,n,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return Hg(e);t.biff==12&&(s=4)}var i=e.read_shift(s),o=e.read_shift(s),d=Bn(e),f=Bn(e);return{s:{r:i,c:d[0],cRel:d[1],rRel:d[2]},e:{r:o,c:f[0],cRel:f[1],rRel:f[2]}}}function Hg(e){var n=Bn(e),t=Bn(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function d3(e,n,t){if(t.biff<8)return Hg(e);var s=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),o=Bn(e),d=Bn(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:d[0],cRel:d[1],rRel:d[2]}}}function zg(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return h3(e);var s=e.read_shift(t&&t.biff==12?4:2),i=Bn(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function h3(e){var n=Bn(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function x3(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function m3(e,n,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return p3(e);var i=e.read_shift(s>=12?4:2),o=e.read_shift(2),d=(o&16384)>>14,f=(o&32768)>>15;if(o&=16383,f==1)for(;i>524287;)i-=1048576;if(d==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:d,rRel:f}}function p3(e){var n=e.read_shift(2),t=e.read_shift(1),s=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),i==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:i,rRel:s}}function g3(e,n,t){var s=(e[e.l++]&96)>>5,i=Pg(e,t.biff>=2&&t.biff<=5?6:8,t);return[s,i]}function v3(e,n,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var d=Pg(e,o,t);return[s,i,d]}function b3(e,n,t){var s=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}function y3(e,n,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,i]}function E3(e,n,t){var s=(e[e.l++]&96)>>5,i=d3(e,n-1,t);return[s,i]}function _3(e,n,t){var s=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[s]}function ip(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function T3(e,n,t){e.l+=2;for(var s=e.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=s;++o)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function w3(e,n,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function S3(e,n,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function A3(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function N3(e,n,t){var s=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[s]}function Vg(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function k3(e){return e.read_shift(2),Vg(e)}function C3(e){return e.read_shift(2),Vg(e)}function O3(e,n,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=zg(e,0,t);return[s,i]}function D3(e,n,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=m3(e,0,t);return[s,i]}function R3(e,n,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=zg(e,0,t);return[s,i,o]}function j3(e,n,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[Fw[i],Xg[i],s]}function F3(e,n,t){var s=e[e.l++],i=e.read_shift(1),o=t&&t.biff<=3?[s==88?-1:0,e.read_shift(1)]:L3(e);return[i,(o[0]===0?Xg:jw)[o[1]]]}function L3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function M3(e,n,t){e.l+=t&&t.biff==2?3:4}function I3(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function B3(e){return e.l++,bs[e.read_shift(1)]}function U3(e){return e.l++,e.read_shift(2)}function P3(e){return e.l++,e.read_shift(1)!==0}function H3(e){return e.l++,Tt(e)}function z3(e,n,t){return e.l++,Bl(e,n-1,t)}function V3(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Wa(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=bs[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Tt(e);break;case 2:t[1]=ys(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function G3(e,n,t){for(var s=e.read_shift(t.biff==12?4:2),i=[],o=0;o!=s;++o)i.push((t.biff==12?vs:_0)(e));return i}function Y3(e,n,t){var s=0,i=0;t.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,--i==0&&(i=256));for(var o=0,d=[];o!=s&&(d[o]=[]);++o)for(var f=0;f!=i;++f)d[o][f]=V3(e,t.biff);return d}function X3(e,n,t){var s=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function q3(e,n,t){if(t.biff==5)return K3(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[s,i,o]}function K3(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[n,t,s]}function W3(e,n,t){var s=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function $3(e,n,t){var s=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function Z3(e,n,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[s]}function Q3(e,n,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,i]}var J3=At,ew=At,aw=At;function Pl(e,n,t){return e.l+=2,[x3(e)]}function Cf(e){return e.l+=6,[]}var tw=Pl,rw=Cf,nw=Cf,sw=Pl;function Gg(e){return e.l+=2,[at(e),e.read_shift(2)&1]}var iw=Pl,lw=Gg,cw=Cf,ow=Pl,uw=Pl,fw=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dw(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),d=fw[t>>2&31];return{ixti:n,coltype:t&3,rt:d,idx:s,c:i,C:o}}function hw(e){return e.l+=2,[e.read_shift(4)]}function xw(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function mw(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function pw(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function gw(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function vw(e){return e.l+=4,[0,0]}var lp={1:{n:"PtgExp",f:I3},2:{n:"PtgTbl",f:aw},3:{n:"PtgAdd",f:Ja},4:{n:"PtgSub",f:Ja},5:{n:"PtgMul",f:Ja},6:{n:"PtgDiv",f:Ja},7:{n:"PtgPower",f:Ja},8:{n:"PtgConcat",f:Ja},9:{n:"PtgLt",f:Ja},10:{n:"PtgLe",f:Ja},11:{n:"PtgEq",f:Ja},12:{n:"PtgGe",f:Ja},13:{n:"PtgGt",f:Ja},14:{n:"PtgNe",f:Ja},15:{n:"PtgIsect",f:Ja},16:{n:"PtgUnion",f:Ja},17:{n:"PtgRange",f:Ja},18:{n:"PtgUplus",f:Ja},19:{n:"PtgUminus",f:Ja},20:{n:"PtgPercent",f:Ja},21:{n:"PtgParen",f:Ja},22:{n:"PtgMissArg",f:Ja},23:{n:"PtgStr",f:z3},26:{n:"PtgSheet",f:xw},27:{n:"PtgEndSheet",f:mw},28:{n:"PtgErr",f:B3},29:{n:"PtgBool",f:P3},30:{n:"PtgInt",f:U3},31:{n:"PtgNum",f:H3},32:{n:"PtgArray",f:_3},33:{n:"PtgFunc",f:j3},34:{n:"PtgFuncVar",f:F3},35:{n:"PtgName",f:X3},36:{n:"PtgRef",f:O3},37:{n:"PtgArea",f:g3},38:{n:"PtgMemArea",f:W3},39:{n:"PtgMemErr",f:J3},40:{n:"PtgMemNoMem",f:ew},41:{n:"PtgMemFunc",f:$3},42:{n:"PtgRefErr",f:Z3},43:{n:"PtgAreaErr",f:b3},44:{n:"PtgRefN",f:D3},45:{n:"PtgAreaN",f:E3},46:{n:"PtgMemAreaN",f:pw},47:{n:"PtgMemNoMemN",f:gw},57:{n:"PtgNameX",f:q3},58:{n:"PtgRef3d",f:R3},59:{n:"PtgArea3d",f:v3},60:{n:"PtgRefErr3d",f:Q3},61:{n:"PtgAreaErr3d",f:y3},255:{}},bw={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yw={1:{n:"PtgElfLel",f:Gg},2:{n:"PtgElfRw",f:ow},3:{n:"PtgElfCol",f:tw},6:{n:"PtgElfRwV",f:uw},7:{n:"PtgElfColV",f:sw},10:{n:"PtgElfRadical",f:iw},11:{n:"PtgElfRadicalS",f:cw},13:{n:"PtgElfColS",f:rw},15:{n:"PtgElfColSV",f:nw},16:{n:"PtgElfRadicalLel",f:lw},25:{n:"PtgList",f:dw},29:{n:"PtgSxName",f:hw},255:{}},Ew={0:{n:"PtgAttrNoop",f:vw},1:{n:"PtgAttrSemi",f:N3},2:{n:"PtgAttrIf",f:S3},4:{n:"PtgAttrChoose",f:T3},8:{n:"PtgAttrGoto",f:w3},16:{n:"PtgAttrSum",f:M3},32:{n:"PtgAttrBaxcel",f:ip},33:{n:"PtgAttrBaxcel",f:ip},64:{n:"PtgAttrSpace",f:k3},65:{n:"PtgAttrSpaceSemi",f:C3},128:{n:"PtgAttrIfError",f:A3},255:{}};function Hl(e,n,t,s){if(s.biff<8)return At(e,n);for(var i=e.l+n,o=[],d=0;d!==t.length;++d)switch(t[d][0]){case"PtgArray":t[d][1]=Y3(e,0,s),o.push(t[d][1]);break;case"PtgMemArea":t[d][2]=G3(e,t[d][1],s),o.push(t[d][2]);break;case"PtgExp":s&&s.biff==12&&(t[d][1][1]=e.read_shift(4),o.push(t[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[d][0]}return n=i-e.l,n!==0&&o.push(At(e,n)),o}function zl(e,n,t){for(var s=e.l+n,i,o,d=[];s!=e.l;)n=s-e.l,o=e[e.l],i=lp[o]||lp[bw[o]],(o===24||o===25)&&(i=(o===24?yw:Ew)[e[e.l+1]]),!i||!i.f?At(e,n):d.push([i.n,i.f(e,n,t)]);return d}function _w(e){for(var n=[],t=0;t<e.length;++t){for(var s=e[t],i=[],o=0;o<s.length;++o){var d=s[o];if(d)switch(d[0]){case 2:i.push('"'+d[1].replace(/"/g,'""')+'"');break;default:i.push(d[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var Tw={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ww(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Yg(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!s)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function cp(e,n,t){var s=Yg(e,n,t);return s=="#REF"?s:ww(s,t)}function _t(e,n,t,s,i){var o=i&&i.biff||8,d={s:{c:0,r:0}},f=[],x,m,g,v=0,b=0,_,y="";if(!e[0]||!e[0][0])return"";for(var E=-1,T="",A=0,D=e[0].length;A<D;++A){var S=e[0][A];switch(S[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(x=f.pop(),m=f.pop(),E>=0){switch(e[0][E][1][0]){case 0:T=Ga(" ",e[0][E][1][1]);break;case 1:T=Ga("\r",e[0][E][1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}m=m+T,E=-1}f.push(m+Tw[S[0]]+x);break;case"PtgIsect":x=f.pop(),m=f.pop(),f.push(m+" "+x);break;case"PtgUnion":x=f.pop(),m=f.pop(),f.push(m+","+x);break;case"PtgRange":x=f.pop(),m=f.pop(),f.push(m+":"+x);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=vl(S[1][1],d,i),f.push(bl(g,o));break;case"PtgRefN":g=t?vl(S[1][1],t,i):S[1][1],f.push(bl(g,o));break;case"PtgRef3d":v=S[1][1],g=vl(S[1][2],d,i),y=cp(s,v,i),f.push(y+"!"+bl(g,o));break;case"PtgFunc":case"PtgFuncVar":var H=S[1][0],V=S[1][1];H||(H=0),H&=127;var Y=H==0?[]:f.slice(-H);f.length-=H,V==="User"&&(V=Y.shift()),f.push(V+"("+Y.join(",")+")");break;case"PtgBool":f.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(S[1]);break;case"PtgNum":f.push(String(S[1]));break;case"PtgStr":f.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(S[1]);break;case"PtgAreaN":_=zm(S[1][1],t?{s:t}:d,i),f.push(Bu(_,i));break;case"PtgArea":_=zm(S[1][1],d,i),f.push(Bu(_,i));break;case"PtgArea3d":v=S[1][1],_=S[1][2],y=cp(s,v,i),f.push(y+"!"+Bu(_,i));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=S[1][2];var j=(s.names||[])[b-1]||(s[0]||[])[b],J=j?j.Name:"SH33TJSNAME"+String(b);J&&J.slice(0,6)=="_xlfn."&&!i.xlfn&&(J=J.slice(6)),f.push(J);break;case"PtgNameX":var z=S[1][1];b=S[1][2];var ie;if(i.biff<=5)z<0&&(z=-z),s[z]&&(ie=s[z][b]);else{var K="";if(((s[z]||[])[0]||[])[0]==14849||(((s[z]||[])[0]||[])[0]==1025?s[z][b]&&s[z][b].itab>0&&(K=s.SheetNames[s[z][b].itab-1]+"!"):K=s.SheetNames[b-1]+"!"),s[z]&&s[z][b])K+=s[z][b].Name;else if(s[0]&&s[0][b])K+=s[0][b].Name;else{var q=(Yg(s,z,i)||"").split(";;");q[b-1]?K=q[b-1]:K+="SH33TJSERRX"}f.push(K);break}ie||(ie={Name:"SH33TJSERRY"}),f.push(ie.Name);break;case"PtgParen":var re="(",pe=")";if(E>=0){switch(T="",e[0][E][1][0]){case 2:re=Ga(" ",e[0][E][1][1])+re;break;case 3:re=Ga("\r",e[0][E][1][1])+re;break;case 4:pe=Ga(" ",e[0][E][1][1])+pe;break;case 5:pe=Ga("\r",e[0][E][1][1])+pe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}E=-1}f.push(re+f.pop()+pe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":g={c:S[1][1],r:S[1][0]};var Ae={c:t.c,r:t.r};if(s.sharedf[aa(g)]){var Z=s.sharedf[aa(g)];f.push(_t(Z,d,Ae,s,i))}else{var oe=!1;for(x=0;x!=s.arrayf.length;++x)if(m=s.arrayf[x],!(g.c<m[0].s.c||g.c>m[0].e.c)&&!(g.r<m[0].s.r||g.r>m[0].e.r)){f.push(_t(m[1],d,Ae,s,i)),oe=!0;break}oe||f.push(S[1])}break;case"PtgArray":f.push("{"+_w(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&E>=0&&Re.indexOf(e[0][A][0])==-1){S=e[0][E];var ee=!0;switch(S[1][0]){case 4:ee=!1;case 0:T=Ga(" ",S[1][1]);break;case 5:ee=!1;case 1:T=Ga("\r",S[1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}f.push((ee?T:"")+f.pop()+(ee?"":T)),E=-1}}if(f.length>1&&i.WTF)throw new Error("bad formula stack");return f[0]}function Sw(e,n,t){var s=e.l+n,i=t.biff==2?1:2,o,d=e.read_shift(i);if(d==65535)return[[],At(e,n-2)];var f=zl(e,d,t);return n!==d+i&&(o=Hl(e,n-d-i,f,t)),e.l=s,[f,o]}function Aw(e,n,t){var s=e.l+n,i=t.biff==2?1:2,o,d=e.read_shift(i);if(d==65535)return[[],At(e,n-2)];var f=zl(e,d,t);return n!==d+i&&(o=Hl(e,n-d-i,f,t)),e.l=s,[f,o]}function Nw(e,n,t,s){var i=e.l+n,o=zl(e,s,t),d;return i!==e.l&&(d=Hl(e,i-e.l,o,t)),[o,d]}function kw(e,n,t){var s=e.l+n,i,o=e.read_shift(2),d=zl(e,o,t);return o==65535?[[],At(e,n-2)]:(n!==o+2&&(i=Hl(e,s-o-2,d,t)),[d,i])}function Cw(e){var n;if(Jr(e,e.l+6)!==65535)return[Tt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function Hu(e,n,t){var s=e.l+n,i=Mr(e);t.biff==2&&++e.l;var o=Cw(e),d=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var f=Aw(e,s-e.l,t);return{cell:i,val:o[0],formula:f,shared:d>>3&1,tt:o[1]}}function T0(e,n,t){var s=e.read_shift(4),i=zl(e,s,t),o=e.read_shift(4),d=o>0?Hl(e,o,i,t):null;return[i,d]}var Ow=T0,w0=T0,Dw=T0,Rw=T0,jw={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Fw={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function op(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zu(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var Tl={},di={};function wl(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function qg(e,n,t,s,i,o){try{s.cellNF&&(e.z=sa[n])}catch(f){if(s.WTF)throw f}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=dt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(sa[n]==null&&us(Ly[n]||"General",n),e.t==="e")e.w=e.w||bs[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cl(e.v);else if(e.t==="d"){var d=jt(e.v);(d|0)===d?e.w=d.toString(10):e.w=Cl(d)}else{if(e.v===void 0)return"";e.w=ds(e.v,di)}else e.t==="d"?e.w=ur(n,jt(e.v),di):e.w=ur(n,e.v,di)}catch(f){if(s.WTF)throw f}if(s.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=p0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=p0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(s.WTF&&o.Fills)throw f}}}function Lw(e,n){var t=Ya(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=va(t))}var Mw=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Iw=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Bw=/<(?:\w:)?hyperlink [^>]*>/mg,Uw=/"(\w*:\w*)"/,Pw=/<(?:\w:)?col\b[^>]*[\/]?>/g,Hw=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,zw=/<(?:\w:)?pageMargins[^>]*\/>/g,Kg=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vw=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Gw=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Yw(e,n,t,s,i,o,d){if(!e)return e;s||(s={"!id":{}});var f=n.dense?[]:{},x={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",g="",v=e.match(Iw);v?(m=e.slice(0,v.index),g=e.slice(v.index+v[0].length)):m=g=e;var b=m.match(Kg);b?Of(b[0],f,i,t):(b=m.match(Vw))&&Xw(b[0],b[1]||"",f,i,t);var _=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var y=m.slice(_,_+50).match(Uw);y&&Lw(f,y[1])}var E=m.match(Gw);E&&E[1]&&Qw(E[1],i);var T=[];if(n.cellStyles){var A=m.match(Pw);A&&Ww(T,A)}v&&Jw(v[1],f,n,x,o,d);var D=g.match(Hw);D&&(f["!autofilter"]=$w(D[0]));var S=[],H=g.match(Mw);if(H)for(_=0;_!=H.length;++_)S[_]=Ya(H[_].slice(H[_].indexOf('"')+1));var V=g.match(Bw);V&&qw(f,V,s);var Y=g.match(zw);if(Y&&(f["!margins"]=Kw(Ze(Y[0]))),!f["!ref"]&&x.e.c>=x.s.c&&x.e.r>=x.s.r&&(f["!ref"]=va(x)),n.sheetRows>0&&f["!ref"]){var j=Ya(f["!ref"]);n.sheetRows<=+j.e.r&&(j.e.r=n.sheetRows-1,j.e.r>x.e.r&&(j.e.r=x.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>x.e.c&&(j.e.c=x.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),f["!fullref"]=f["!ref"],f["!ref"]=va(j))}return T.length>0&&(f["!cols"]=T),S.length>0&&(f["!merges"]=S),f}function Of(e,n,t,s){var i=Ze(e);t.Sheets[s]||(t.Sheets[s]={}),i.codeName&&(t.Sheets[s].CodeName=ba(Ma(i.codeName)))}function Xw(e,n,t,s,i){Of(e.slice(0,e.indexOf(">")),t,s,i)}function qw(e,n,t){for(var s=Array.isArray(e),i=0;i!=n.length;++i){var o=Ze(Ma(n[i]),!0);if(!o.ref)return;var d=((t||{})["!id"]||[])[o.id];d?(o.Target=d.Target,o.location&&(o.Target+="#"+ba(o.location))):(o.Target="#"+ba(o.location),d={Target:o.Target,TargetMode:"Internal"}),o.Rel=d,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var f=Ya(o.ref),x=f.s.r;x<=f.e.r;++x)for(var m=f.s.c;m<=f.e.c;++m){var g=aa({c:m,r:x});s?(e[x]||(e[x]=[]),e[x][m]||(e[x][m]={t:"z",v:void 0}),e[x][m].l=o):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=o)}}}function Kw(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function Ww(e,n){for(var t=!1,s=0;s!=n.length;++s){var i=Ze(n[s],!0);i.hidden&&(i.hidden=Ba(i.hidden));var o=parseInt(i.min,10)-1,d=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,kf(i.width)),xi(i);o<=d;)e[o++]=gt(i)}}function $w(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var Zw=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Qw(e,n){n.Views||(n.Views=[{}]),(e.match(Zw)||[]).forEach(function(t,s){var i=Ze(t);n.Views[s]||(n.Views[s]={}),+i.zoomScale&&(n.Views[s].zoom=+i.zoomScale),Ba(i.rightToLeft)&&(n.Views[s].RTL=!0)})}var Jw=function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=Ol("v"),d=Ol("f");return function(x,m,g,v,b,_){for(var y=0,E="",T=[],A=[],D=0,S=0,H=0,V="",Y,j,J=0,z=0,ie,K,q=0,re=0,pe=Array.isArray(_.CellXf),Ae,Z=[],oe=[],Re=Array.isArray(m),ee=[],P={},ce=!1,C=!!g.sheetStubs,X=x.split(n),U=0,R=X.length;U!=R;++U){E=X[U].trim();var W=E.length;if(W!==0){var me=0;e:for(y=0;y<W;++y)switch(E[y]){case">":if(E[y-1]!="/"){++y;break e}if(g&&g.cellStyles){if(j=Ze(E.slice(me,y),!0),J=j.r!=null?parseInt(j.r,10):J+1,z=-1,g.sheetRows&&g.sheetRows<J)continue;P={},ce=!1,j.ht&&(ce=!0,P.hpt=parseFloat(j.ht),P.hpx=Fl(P.hpt)),j.hidden=="1"&&(ce=!0,P.hidden=!0),j.outlineLevel!=null&&(ce=!0,P.level=+j.outlineLevel),ce&&(ee[J-1]=P)}break;case"<":me=y;break}if(me>=y)break;if(j=Ze(E.slice(me,y),!0),J=j.r!=null?parseInt(j.r,10):J+1,z=-1,!(g.sheetRows&&g.sheetRows<J)){v.s.r>J-1&&(v.s.r=J-1),v.e.r<J-1&&(v.e.r=J-1),g&&g.cellStyles&&(P={},ce=!1,j.ht&&(ce=!0,P.hpt=parseFloat(j.ht),P.hpx=Fl(P.hpt)),j.hidden=="1"&&(ce=!0,P.hidden=!0),j.outlineLevel!=null&&(ce=!0,P.level=+j.outlineLevel),ce&&(ee[J-1]=P)),T=E.slice(y).split(e);for(var ve=0;ve!=T.length&&T[ve].trim().charAt(0)=="<";++ve);for(T=T.slice(ve),y=0;y!=T.length;++y)if(E=T[y].trim(),E.length!==0){if(A=E.match(t),D=y,S=0,H=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,A!=null&&A.length===2){for(D=0,V=A[1],S=0;S!=V.length&&!((H=V.charCodeAt(S)-64)<1||H>26);++S)D=26*D+H;--D,z=D}else++z;for(S=0;S!=E.length&&E.charCodeAt(S)!==62;++S);if(++S,j=Ze(E.slice(0,S),!0),j.r||(j.r=aa({r:J-1,c:z})),V=E.slice(S),Y={t:""},(A=V.match(o))!=null&&A[1]!==""&&(Y.v=ba(A[1])),g.cellFormula){if((A=V.match(d))!=null&&A[1]!==""){if(Y.f=ba(Ma(A[1])).replace(/\r\n/g,`
`),g.xlfn||(Y.f=sp(Y.f)),A[0].indexOf('t="array"')>-1)Y.F=(V.match(i)||[])[1],Y.F.indexOf(":")>-1&&Z.push([Ya(Y.F),Y.F]);else if(A[0].indexOf('t="shared"')>-1){K=Ze(A[0]);var Te=ba(Ma(A[1]));g.xlfn||(Te=sp(Te)),oe[parseInt(K.si,10)]=[K,Te,j.r]}}else(A=V.match(/<f[^>]*\/>/))&&(K=Ze(A[0]),oe[K.si]&&(Y.f=u3(oe[K.si][1],oe[K.si][2],j.r)));var Ee=Dt(j.r);for(S=0;S<Z.length;++S)Ee.r>=Z[S][0].s.r&&Ee.r<=Z[S][0].e.r&&Ee.c>=Z[S][0].s.c&&Ee.c<=Z[S][0].e.c&&(Y.F=Z[S][1])}if(j.t==null&&Y.v===void 0)if(Y.f||Y.F)Y.v=0,Y.t="n";else if(C)Y.t="z";else continue;else Y.t=j.t||"n";switch(v.s.c>z&&(v.s.c=z),v.e.c<z&&(v.e.c=z),Y.t){case"n":if(Y.v==""||Y.v==null){if(!C)continue;Y.t="z"}else Y.v=parseFloat(Y.v);break;case"s":if(typeof Y.v>"u"){if(!C)continue;Y.t="z"}else ie=Tl[parseInt(Y.v,10)],Y.v=ie.t,Y.r=ie.r,g.cellHTML&&(Y.h=ie.h);break;case"str":Y.t="s",Y.v=Y.v!=null?Ma(Y.v):"",g.cellHTML&&(Y.h=gf(Y.v));break;case"inlineStr":A=V.match(s),Y.t="s",A!=null&&(ie=Nf(A[1]))?(Y.v=ie.t,g.cellHTML&&(Y.h=ie.h)):Y.v="";break;case"b":Y.v=Ba(Y.v);break;case"d":g.cellDates?Y.v=dt(Y.v,1):(Y.v=jt(dt(Y.v,1)),Y.t="n");break;case"e":(!g||g.cellText!==!1)&&(Y.w=Y.v),Y.v=mg[Y.v];break}if(q=re=0,Ae=null,pe&&j.s!==void 0&&(Ae=_.CellXf[j.s],Ae!=null&&(Ae.numFmtId!=null&&(q=Ae.numFmtId),g.cellStyles&&Ae.fillId!=null&&(re=Ae.fillId))),qg(Y,q,re,g,b,_),g.cellDates&&pe&&Y.t=="n"&&mi(sa[q])&&(Y.t="d",Y.v=E0(Y.v)),j.cm&&g.xlmeta){var Be=(g.xlmeta.Cell||[])[+j.cm-1];Be&&Be.type=="XLDAPR"&&(Y.D=!0)}if(Re){var I=Dt(j.r);m[I.r]||(m[I.r]=[]),m[I.r][I.c]=Y}else m[j.r]=Y}}}}ee.length>0&&(m["!rows"]=ee)}}();function eS(e,n){var t={},s=e.l+n;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}var aS=vs;function tS(){}function rS(e,n){var t={},s=e[e.l];return++e.l,t.above=!(s&64),t.left=!(s&128),e.l+=18,t.name=SE(e),t}function nS(e){var n=fr(e);return[n]}function sS(e){var n=gs(e);return[n]}function iS(e){var n=fr(e),t=e.read_shift(1);return[n,t,"b"]}function lS(e){var n=gs(e),t=e.read_shift(1);return[n,t,"b"]}function cS(e){var n=fr(e),t=e.read_shift(1);return[n,t,"e"]}function oS(e){var n=gs(e),t=e.read_shift(1);return[n,t,"e"]}function uS(e){var n=fr(e),t=e.read_shift(4);return[n,t,"s"]}function fS(e){var n=gs(e),t=e.read_shift(4);return[n,t,"s"]}function dS(e){var n=fr(e),t=Tt(e);return[n,t,"n"]}function Wg(e){var n=gs(e),t=Tt(e);return[n,t,"n"]}function hS(e){var n=fr(e),t=wf(e);return[n,t,"n"]}function xS(e){var n=gs(e),t=wf(e);return[n,t,"n"]}function mS(e){var n=fr(e),t=_f(e);return[n,t,"is"]}function pS(e){var n=fr(e),t=St(e);return[n,t,"str"]}function gS(e){var n=gs(e),t=St(e);return[n,t,"str"]}function vS(e,n,t){var s=e.l+n,i=fr(e);i.r=t["!row"];var o=e.read_shift(1),d=[i,o,"b"];if(t.cellFormula){e.l+=2;var f=w0(e,s-e.l,t);d[3]=_t(f,null,i,t.supbooks,t)}else e.l=s;return d}function bS(e,n,t){var s=e.l+n,i=fr(e);i.r=t["!row"];var o=e.read_shift(1),d=[i,o,"e"];if(t.cellFormula){e.l+=2;var f=w0(e,s-e.l,t);d[3]=_t(f,null,i,t.supbooks,t)}else e.l=s;return d}function yS(e,n,t){var s=e.l+n,i=fr(e);i.r=t["!row"];var o=Tt(e),d=[i,o,"n"];if(t.cellFormula){e.l+=2;var f=w0(e,s-e.l,t);d[3]=_t(f,null,i,t.supbooks,t)}else e.l=s;return d}function ES(e,n,t){var s=e.l+n,i=fr(e);i.r=t["!row"];var o=St(e),d=[i,o,"str"];if(t.cellFormula){e.l+=2;var f=w0(e,s-e.l,t);d[3]=_t(f,null,i,t.supbooks,t)}else e.l=s;return d}var _S=vs;function TS(e,n){var t=e.l+n,s=vs(e),i=Tf(e),o=St(e),d=St(e),f=St(e);e.l=t;var x={rfx:s,relId:i,loc:o,display:f};return d&&(x.Tooltip=d),x}function wS(){}function SS(e,n,t){var s=e.l+n,i=dg(e),o=e.read_shift(1),d=[i];if(d[2]=o,t.cellFormula){var f=Ow(e,s-e.l,t);d[1]=f}else e.l=s;return d}function AS(e,n,t){var s=e.l+n,i=vs(e),o=[i];if(t.cellFormula){var d=Rw(e,s-e.l,t);o[1]=d,e.l=s}else e.l=s;return o}var NS=["left","right","top","bottom","header","footer"];function kS(e){var n={};return NS.forEach(function(t){n[t]=Tt(e)}),n}function CS(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function OS(){}function DS(){}function RS(e,n,t,s,i,o,d){if(!e)return e;var f=n||{};s||(s={"!id":{}});var x=f.dense?[]:{},m,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,b=!1,_,y,E,T,A,D,S,H,V,Y=[];f.biff=12,f["!row"]=0;var j=0,J=!1,z=[],ie={},K=f.supbooks||i.supbooks||[[]];if(K.sharedf=ie,K.arrayf=z,K.SheetNames=i.SheetNames||i.Sheets.map(function(Re){return Re.name}),!f.supbooks&&(f.supbooks=K,i.Names))for(var q=0;q<i.Names.length;++q)K[0][q+1]=i.Names[q];var re=[],pe=[],Ae=!1;b0[16]={n:"BrtShortReal",f:Wg};var Z;if(nn(e,function(ee,P,ce){if(!b)switch(ce){case 148:m=ee;break;case 0:_=ee,f.sheetRows&&f.sheetRows<=_.r&&(b=!0),H=vt(T=_.r),f["!row"]=_.r,(ee.hidden||ee.hpt||ee.level!=null)&&(ee.hpt&&(ee.hpx=Fl(ee.hpt)),pe[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ee[2]},ee[2]){case"n":y.v=ee[1];break;case"s":S=Tl[ee[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!ee[1];break;case"e":y.v=ee[1],f.cellText!==!1&&(y.w=bs[y.v]);break;case"str":y.t="s",y.v=ee[1];break;case"is":y.t="s",y.v=ee[1].t;break}if((E=d.CellXf[ee[0].iStyleRef])&&qg(y,E.numFmtId,null,f,o,d),A=ee[0].c==-1?A+1:ee[0].c,f.dense?(x[T]||(x[T]=[]),x[T][A]=y):x[it(A)+H]=y,f.cellFormula){for(J=!1,j=0;j<z.length;++j){var C=z[j];_.r>=C[0].s.r&&_.r<=C[0].e.r&&A>=C[0].s.c&&A<=C[0].e.c&&(y.F=va(C[0]),J=!0)}!J&&ee.length>3&&(y.f=ee[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>A&&(g.s.c=A),g.e.r<_.r&&(g.e.r=_.r),g.e.c<A&&(g.e.c=A),f.cellDates&&E&&y.t=="n"&&mi(sa[E.numFmtId])){var X=os(y.v);X&&(y.t="d",y.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}Z&&(Z.type=="XLDAPR"&&(y.D=!0),Z=void 0);break;case 1:case 12:if(!f.sheetStubs||v)break;y={t:"z",v:void 0},A=ee[0].c==-1?A+1:ee[0].c,f.dense?(x[T]||(x[T]=[]),x[T][A]=y):x[it(A)+H]=y,g.s.r>_.r&&(g.s.r=_.r),g.s.c>A&&(g.s.c=A),g.e.r<_.r&&(g.e.r=_.r),g.e.c<A&&(g.e.c=A),Z&&(Z.type=="XLDAPR"&&(y.D=!0),Z=void 0);break;case 176:Y.push(ee);break;case 49:Z=((f.xlmeta||{}).Cell||[])[ee-1];break;case 494:var U=s["!id"][ee.relId];for(U?(ee.Target=U.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=U):ee.relId==""&&(ee.Target="#"+ee.loc),T=ee.rfx.s.r;T<=ee.rfx.e.r;++T)for(A=ee.rfx.s.c;A<=ee.rfx.e.c;++A)f.dense?(x[T]||(x[T]=[]),x[T][A]||(x[T][A]={t:"z",v:void 0}),x[T][A].l=ee):(D=aa({c:A,r:T}),x[D]||(x[D]={t:"z",v:void 0}),x[D].l=ee);break;case 426:if(!f.cellFormula)break;z.push(ee),V=f.dense?x[T][A]:x[it(A)+H],V.f=_t(ee[1],g,{r:_.r,c:A},K,f),V.F=va(ee[0]);break;case 427:if(!f.cellFormula)break;ie[aa(ee[0].s)]=ee[1],V=f.dense?x[T][A]:x[it(A)+H],V.f=_t(ee[1],g,{r:_.r,c:A},K,f);break;case 60:if(!f.cellStyles)break;for(;ee.e>=ee.s;)re[ee.e--]={width:ee.w/256,hidden:!!(ee.flags&1),level:ee.level},Ae||(Ae=!0,kf(ee.w/256)),xi(re[ee.e+1]);break;case 161:x["!autofilter"]={ref:va(ee)};break;case 476:x["!margins"]=ee;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),ee.name&&(i.Sheets[t].CodeName=ee.name),(ee.above||ee.left)&&(x["!outline"]={above:ee.above,left:ee.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ee.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!P.T){if(!v||f.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},f),delete f.supbooks,delete f["!row"],!x["!ref"]&&(g.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(x["!ref"]=va(m||g)),f.sheetRows&&x["!ref"]){var oe=Ya(x["!ref"]);f.sheetRows<=+oe.e.r&&(oe.e.r=f.sheetRows-1,oe.e.r>g.e.r&&(oe.e.r=g.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>g.e.c&&(oe.e.c=g.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),x["!fullref"]=x["!ref"],x["!ref"]=va(oe))}return Y.length>0&&(x["!merges"]=Y),re.length>0&&(x["!cols"]=re),pe.length>0&&(x["!rows"]=pe),x}function jS(e){var n=[],t=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var d=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);d&&(n[+d[1]]=t?+d[2]:d[2])});var i=ba((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){s=o.replace(/<.*?>/g,"")}),[n,i,s]}function FS(e,n,t,s,i,o){var d=o||{"!type":"chart"};if(!e)return o;var f=0,x=0,m="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var b=jS(v);g.s.r=g.s.c=0,g.e.c=f,m=it(f),b[0].forEach(function(_,y){d[m+vt(y)]={t:"n",v:_,z:b[1]},x=y}),g.e.r<x&&(g.e.r=x),++f}),f>0&&(d["!ref"]=va(g)),d}function LS(e,n,t,s,i){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},d,f=e.match(Kg);return f&&Of(f[0],o,i,t),(d=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=d[1]),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}function MS(e,n){e.l+=10;var t=St(e);return{name:t}}function IS(e,n,t,s,i){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},d=!1;return nn(e,function(x,m,g){switch(g){case 550:o["!rel"]=x;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),x.name&&(i.Sheets[t].CodeName=x.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!d||n.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},n),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}var $g=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],BS=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],US=[],PS=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function up(e,n){for(var t=0;t!=e.length;++t)for(var s=e[t],i=0;i!=n.length;++i){var o=n[i];if(s[o[0]]==null)s[o[0]]=o[1];else switch(o[2]){case"bool":typeof s[o[0]]=="string"&&(s[o[0]]=Ba(s[o[0]]));break;case"int":typeof s[o[0]]=="string"&&(s[o[0]]=parseInt(s[o[0]],10));break}}}function fp(e,n){for(var t=0;t!=n.length;++t){var s=n[t];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Ba(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function Zg(e){fp(e.WBProps,$g),fp(e.CalcPr,PS),up(e.WBView,BS),up(e.Sheets,US),di.date1904=Ba(e.WBProps.date1904)}var HS="][*?/\\".split("");function zS(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return HS.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var VS=/<\w+:workbook/;function GS(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,i="xmlns",o={},d=0;if(e.replace(Nt,function(x,m){var g=Ze(x);switch(Lr(g[0])){case"<?xml":break;case"<workbook":x.match(VS)&&(i="xmlns"+x.match(/<(\w+):/)[1]),t.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],t.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$g.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":t.WBProps[v[0]]=Ba(g[v[0]]);break;case"int":t.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:t.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(t.WBProps.CodeName=Ma(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],t.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=ba(Ma(g.name)),delete g[0],t.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":o={},o.Name=Ma(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),Ba(g.hidden||"0")&&(o.Hidden=!0),d=m+x.length;break;case"</definedName>":o.Ref=ba(Ma(e.slice(d,m))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],t.CalcPr=g;break;case"<calcPr/>":delete g[0],t.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return x}),cE.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Zg(t),t}function YS(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=$u(e),t.name=St(e),t}function XS(e,n){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=n>8?St(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(s&65536),t.backupFile=!!(s&64),t.checkCompatibility=!!(s&4096),t.date1904=!!(s&1),t.filterPrivacy=!!(s&8),t.hidePivotFieldList=!!(s&1024),t.promptedSolutions=!!(s&16),t.publishItems=!!(s&2048),t.refreshAllConnections=!!(s&262144),t.saveExternalLinkValues=!!(s&128),t.showBorderUnselectedTables=!!(s&4),t.showInkAnnotation=!!(s&32),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(s&32768),t.updateLinks=["userSet","never","always"][s>>8&3],t}function qS(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function KS(e,n,t){var s=e.l+n;e.l+=4,e.l+=1;var i=e.read_shift(4),o=AE(e),d=Dw(e,0,t),f=Tf(e);e.l=s;var x={Name:o,Ptg:d};return i<268435455&&(x.Sheet=i),f&&(x.Comment=f),x}function WS(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1;n||(n={}),n.biff=12;var o=[],d=[[]];return d.SheetNames=[],d.XTI=[],b0[16]={n:"BrtFRTArchID$",f:qS},nn(e,function(x,m,g){switch(g){case 156:d.SheetNames.push(x.name),t.Sheets.push(x);break;case 153:t.WBProps=x;break;case 39:x.Sheet!=null&&(n.SID=x.Sheet),x.Ref=_t(x.Ptg,null,null,d,n),delete n.SID,delete x.Ptg,o.push(x);break;case 1036:break;case 357:case 358:case 355:case 667:d[0].length?d.push([g,x]):d[0]=[g,x],d[d.length-1].XTI=[];break;case 362:d.length===0&&(d[0]=[],d[0].XTI=[]),d[d.length-1].XTI=d[d.length-1].XTI.concat(x),d.XTI=d.XTI.concat(x);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(g),i=!0;break;case 36:s.pop(),i=!1;break;case 37:s.push(g),i=!0;break;case 38:s.pop(),i=!1;break;case 16:break;default:if(!m.T){if(!i||n.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},n),Zg(t),t.Names=o,t.supbooks=d,t}function $S(e,n,t){return n.slice(-4)===".bin"?WS(e,t):GS(e,t)}function ZS(e,n,t,s,i,o,d,f){return n.slice(-4)===".bin"?RS(e,s,t,i,o,d,f):Yw(e,s,t,i,o,d,f)}function QS(e,n,t,s,i,o,d,f){return n.slice(-4)===".bin"?IS(e,s,t,i,o):LS(e,s,t,i,o)}function JS(e,n,t,s,i,o,d,f){return n.slice(-4)===".bin"?l3():c3()}function eA(e,n,t,s,i,o,d,f){return n.slice(-4)===".bin"?s3():i3()}function aA(e,n,t,s){return n.slice(-4)===".bin"?_T(e,t,s):pT(e,t,s)}function tA(e,n,t){return Ig(e,t)}function rA(e,n,t){return n.slice(-4)===".bin"?B_(e,t):M_(e,t)}function nA(e,n,t){return n.slice(-4)===".bin"?t3(e,t):ZT(e,t)}function sA(e,n,t){return n.slice(-4)===".bin"?KT(e):XT(e)}function iA(e,n,t,s){return t.slice(-4)===".bin"?WT(e,n,t,s):void 0}function lA(e,n,t){return n.slice(-4)===".bin"?GT(e,n,t):YT(e,n,t)}var Qg=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Jg=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function br(e,n){var t=e.split(/\s+/),s=[];if(s[0]=t[0],t.length===1)return s;var i=e.match(Qg),o,d,f,x;if(i)for(x=0;x!=i.length;++x)o=i[x].match(Jg),(d=o[1].indexOf(":"))===-1?s[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?f="xmlns"+o[1].slice(6):f=o[1].slice(d+1),s[f]=o[2].slice(1,o[2].length-1));return s}function cA(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var s=e.match(Qg),i,o,d,f;if(s)for(f=0;f!=s.length;++f)i=s[f].match(Jg),(o=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?d="xmlns"+i[1].slice(6):d=i[1].slice(o+1),t[d]=i[2].slice(1,i[2].length-1));return t}var Sl;function oA(e,n){var t=Sl[e]||ba(e);return t==="General"?ds(n):ur(t,n)}function uA(e,n,t,s){var i=s;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ba(s);break;case"i2":case"int":i=parseInt(s,10);break;case"r4":case"float":i=parseFloat(s);break;case"date":case"dateTime.tz":i=dt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ba(n)]=i}function fA(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bs[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cl(e.v):e.w=ds(e.v):e.w=oA(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var s=Sl[n]||n||"General";if(t.cellNF&&(e.z=s),t.cellDates&&e.t=="n"&&mi(s)){var i=os(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(t.WTF)throw o}}}function dA(e,n,t){if(t.cellStyles&&n.Interior){var s=n.Interior;s.Pattern&&(s.patternType=uT[s.Pattern]||s.Pattern)}e[n.ID]=n}function hA(e,n,t,s,i,o,d,f,x,m){var g="General",v=s.StyleID,b={};m=m||{};var _=[],y=0;for(v===void 0&&f&&(v=f.StyleID),v===void 0&&d&&(v=d.StyleID);o[v]!==void 0&&(o[v].nf&&(g=o[v].nf),o[v].Interior&&_.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(t.Type){case"Boolean":s.t="b",s.v=Ba(e);break;case"String":s.t="s",s.r=jm(ba(e)),s.v=e.indexOf("<")>-1?ba(n||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(dt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=ba(e):s.v<60&&(s.v=s.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=mg[e],m.cellText!==!1&&(s.w=e);break;default:e==""&&n==""?s.t="z":(s.t="s",s.v=jm(n||e));break}if(fA(s,g,m),m.cellFormula!==!1)if(s.Formula){var E=ba(s.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),s.f=fi(E,i),delete s.Formula,s.ArrayRange=="RC"?s.F=fi("RC:RC",i):s.ArrayRange&&(s.F=fi(s.ArrayRange,i),x.push([Ya(s.F),s.F]))}else for(y=0;y<x.length;++y)i.r>=x[y][0].s.r&&i.r<=x[y][0].e.r&&i.c>=x[y][0].s.c&&i.c<=x[y][0].e.c&&(s.F=x[y][1]);m.cellStyles&&(_.forEach(function(T){!b.patternType&&T.patternType&&(b.patternType=T.patternType)}),s.s=b),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function xA(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Vu(e,n){var t=n||{};Hp();var s=hl(vf(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(s=Ma(s));var i=s.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var d=gt(t);return d.type="string",Rl.to_workbook(s,d)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ie){i.indexOf("<"+Ie)>=0&&(o=!0)}),o)return TA(s,t);Sl={"General Number":"General","General Date":sa[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":sa[15],"Short Date":sa[14],"Long Time":sa[19],"Medium Time":sa[18],"Short Time":sa[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:sa[2],Standard:sa[4],Percent:sa[10],Scientific:sa[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,x=[],m,g={},v=[],b=t.dense?[]:{},_="",y={},E={},T=br('<Data ss:Type="String">'),A=0,D=0,S=0,H={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},Y={},j="",J=0,z=[],ie={},K={},q=0,re=[],pe=[],Ae={},Z=[],oe,Re=!1,ee=[],P=[],ce={},C=0,X=0,U={Sheets:[],WBProps:{date1904:!1}},R={};Dl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";f=Dl.exec(s);)switch(f[3]=(W=f[3]).toLowerCase()){case"data":if(W=="data"){if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&x.push([f[3],!0]);break}if(x[x.length-1][1])break;f[1]==="/"?hA(s.slice(A,f.index),j,T,x[x.length-1][0]=="comment"?Ae:y,{c:D,r:S},V,Z[D],E,ee,t):(j="",T=br(f[0]),A=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(pe.length>0&&(y.c=pe),(!t.sheetRows||t.sheetRows>S)&&y.v!==void 0&&(t.dense?(b[S]||(b[S]=[]),b[S][D]=y):b[it(D)+vt(S)]=y),y.HRef&&(y.l={Target:ba(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(C=D+(parseInt(y.MergeAcross,10)|0),X=S+(parseInt(y.MergeDown,10)|0),z.push({s:{c:D,r:S},e:{c:C,r:X}})),!t.sheetStubs)y.MergeAcross?D=C+1:++D;else if(y.MergeAcross||y.MergeDown){for(var me=D;me<=C;++me)for(var ve=S;ve<=X;++ve)(me>D||ve>S)&&(t.dense?(b[ve]||(b[ve]=[]),b[ve][me]={t:"z"}):b[it(me)+vt(ve)]={t:"z"});D=C+1}else++D;else y=cA(f[0]),y.Index&&(D=+y.Index-1),D<H.s.c&&(H.s.c=D),D>H.e.c&&(H.e.c=D),f[0].slice(-2)==="/>"&&++D,pe=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(S<H.s.r&&(H.s.r=S),S>H.e.r&&(H.e.r=S),f[0].slice(-2)==="/>"&&(E=br(f[0]),E.Index&&(S=+E.Index-1)),D=0,++S):(E=br(f[0]),E.Index&&(S=+E.Index-1),ce={},(E.AutoFitHeight=="0"||E.Height)&&(ce.hpx=parseInt(E.Height,10),ce.hpt=Mg(ce.hpx),P[S]=ce),E.Hidden=="1"&&(ce.hidden=!0,P[S]=ce));break;case"worksheet":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"));v.push(_),H.s.r<=H.e.r&&H.s.c<=H.e.c&&(b["!ref"]=va(H),t.sheetRows&&t.sheetRows<=H.e.r&&(b["!fullref"]=b["!ref"],H.e.r=t.sheetRows-1,b["!ref"]=va(H))),z.length&&(b["!merges"]=z),Z.length>0&&(b["!cols"]=Z),P.length>0&&(b["!rows"]=P),g[_]=b}else H={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=D=0,x.push([f[3],!1]),m=br(f[0]),_=ba(m.Name),b=t.dense?[]:{},z=[],ee=[],P=[],R={name:_,Hidden:0},U.Sheets.push(R);break;case"table":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else{if(f[0].slice(-2)=="/>")break;x.push([f[3],!1]),Z=[],Re=!1}break;case"style":f[1]==="/"?dA(V,Y,t):Y=br(f[0]);break;case"numberformat":Y.nf=ba(br(f[0]).Format||"General"),Sl[Y.nf]&&(Y.nf=Sl[Y.nf]);for(var Te=0;Te!=392&&sa[Te]!=Y.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(sa[Te]==null){us(Y.nf,Te);break}}break;case"column":if(x[x.length-1][0]!=="table")break;if(oe=br(f[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!Re&&oe.wpx>10){Re=!0,Ot=Fg;for(var Ee=0;Ee<Z.length;++Ee)Z[Ee]&&xi(Z[Ee])}Re&&xi(oe),Z[oe.Index-1||Z.length]=oe;for(var Be=0;Be<+oe.Span;++Be)Z[Z.length]=gt(oe);break;case"namedrange":if(f[1]==="/")break;U.Names||(U.Names=[]);var I=Ze(f[0]),Pe={Name:I.Name,Ref:fi(I.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Pe.Sheet=U.Sheets.length-1),U.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?j+=s.slice(J,f.index):J=f.index+f[0].length;break;case"interior":if(!t.cellStyles)break;Y.Interior=br(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?ZE(ie,W,s.slice(q,f.index)):q=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else x.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"));xA(Ae),pe.push(Ae)}else x.push([f[3],!1]),m=br(f[0]),Ae={a:m.Author};break;case"autofilter":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var Ue=br(f[0]);b["!autofilter"]={ref:fi(Ue.Range).replace(/\$/g,"")},x.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&x.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((m=x.pop())[0]!==f[3])throw new Error("Bad state: "+m.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&x.push([f[3],!0]);break;case"null":break;default:if(x.length==0&&f[3]=="document"||x.length==0&&f[3]=="uof")return gp(s,t);var We=!0;switch(x[x.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(f[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(s.slice(q,f.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else q=f.index+f[0].length;break;case"header":b["!margins"]||wl(b["!margins"]={},"xlml"),isNaN(+Ze(f[0]).Margin)||(b["!margins"].header=+Ze(f[0]).Margin);break;case"footer":b["!margins"]||wl(b["!margins"]={},"xlml"),isNaN(+Ze(f[0]).Margin)||(b["!margins"].footer=+Ze(f[0]).Margin);break;case"pagemargins":var Ve=Ze(f[0]);b["!margins"]||wl(b["!margins"]={},"xlml"),isNaN(+Ve.Top)||(b["!margins"].top=+Ve.Top),isNaN(+Ve.Left)||(b["!margins"].left=+Ve.Left),isNaN(+Ve.Right)||(b["!margins"].right=+Ve.Right),isNaN(+Ve.Bottom)||(b["!margins"].bottom=+Ve.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||f[3].match(/!\[CDATA/))break;if(!x[x.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+x.join("|");if(x[x.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?uA(K,W,re,s.slice(q,f.index)):(re=f,q=f.index+f[0].length);break}if(t.WTF)throw"Unrecognized tag: "+f[3]+"|"+x.join("|")}var ge={};return!t.bookSheets&&!t.bookProps&&(ge.Sheets=g),ge.SheetNames=v,ge.Workbook=U,ge.SSF=gt(sa),ge.Props=ie,ge.Custprops=K,ge}function ef(e,n){switch(jf(n=n||{}),n.type||"base64"){case"base64":return Vu(Wt(e),n);case"binary":case"buffer":case"file":return Vu(e,n);case"array":return Vu(ps(e),n)}}function mA(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=CE(t),t.length-t.l<=4)return n;var s=t.read_shift(4);if(s==0||s>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(s=t.read_shift(4),s!==1907505652)||(n.UnicodeClipboardFormat=OE(t),s=t.read_shift(4),s==0||s>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var pA=[60,1084,2066,2165,2175];function gA(e,n,t,s,i){var o=s,d=[],f=t.slice(t.l,t.l+o);if(i&&i.enc&&i.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(f)}d.push(f),t.l+=o;for(var x=Jr(t,t.l),m=af[x],g=0;m!=null&&pA.indexOf(x)>-1;)o=Jr(t,t.l+2),g=t.l+4,x==2066?g+=4:(x==2165||x==2175)&&(g+=12),f=t.slice(g,t.l+4+o),d.push(f),t.l+=4+o,m=af[x=Jr(t,t.l)];var v=jn(d);pt(v,0);var b=0;v.lens=[];for(var _=0;_<d.length;++_)v.lens.push(b),b+=d[_].length;if(v.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+s;return n.f(v,v.length,i)}function Dr(e,n,t){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=sa[s])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||bs[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Cl(e.v):e.w=ds(e.v):e.w=ur(s,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&s&&e.t=="n"&&mi(sa[s]||String(s))){var i=os(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function i0(e,n,t){return{v:e,ixfe:n,t}}function vA(e,n){var t={opts:{}},s={},i=n.dense?[]:{},o={},d={},f=null,x=[],m="",g={},v,b="",_,y,E,T,A={},D=[],S,H,V=[],Y=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},J={},z=function(Oe){return Oe<8?fs[Oe]:Oe<64&&Y[Oe-8]||fs[Oe]},ie=function(Oe,ze,_a){var ya=ze.XF.data;if(!(!ya||!ya.patternType||!_a||!_a.cellStyles)){ze.s={},ze.s.patternType=ya.patternType;var Pa;(Pa=jl(z(ya.icvFore)))&&(ze.s.fgColor={rgb:Pa}),(Pa=jl(z(ya.icvBack)))&&(ze.s.bgColor={rgb:Pa})}},K=function(Oe,ze,_a){if(!(ce>1)&&!(_a.sheetRows&&Oe.r>=_a.sheetRows)){if(_a.cellStyles&&ze.XF&&ze.XF.data&&ie(Oe,ze,_a),delete ze.ixfe,delete ze.XF,v=Oe,b=aa(Oe),(!d||!d.s||!d.e)&&(d={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<d.s.r&&(d.s.r=Oe.r),Oe.c<d.s.c&&(d.s.c=Oe.c),Oe.r+1>d.e.r&&(d.e.r=Oe.r+1),Oe.c+1>d.e.c&&(d.e.c=Oe.c+1),_a.cellFormula&&ze.f){for(var ya=0;ya<D.length;++ya)if(!(D[ya][0].s.c>Oe.c||D[ya][0].s.r>Oe.r)&&!(D[ya][0].e.c<Oe.c||D[ya][0].e.r<Oe.r)){ze.F=va(D[ya][0]),(D[ya][0].s.c!=Oe.c||D[ya][0].s.r!=Oe.r)&&delete ze.f,ze.f&&(ze.f=""+_t(D[ya][1],d,Oe,ee,q));break}}_a.dense?(i[Oe.r]||(i[Oe.r]=[]),i[Oe.r][Oe.c]=ze):i[b]=ze}},q={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(q.password=n.password);var re,pe=[],Ae=[],Z=[],oe=[],Re=!1,ee=[];ee.SheetNames=q.snames,ee.sharedf=q.sharedf,ee.arrayf=q.arrayf,ee.names=[],ee.XTI=[];var P=0,ce=0,C=0,X=[],U=[],R;q.codepage=1200,_r(1200);for(var W=!1;e.l<e.length-1;){var me=e.l,ve=e.read_shift(2);if(ve===0&&P===10)break;var Te=e.l===e.length?0:e.read_shift(2),Ee=af[ve];if(Ee&&Ee.f){if(n.bookSheets&&P===133&&ve!==133)break;if(P=ve,Ee.r===2||Ee.r==12){var Be=e.read_shift(2);if(Te-=2,!q.enc&&Be!==ve&&((Be&255)<<8|Be>>8)!==ve)throw new Error("rt mismatch: "+Be+"!="+ve);Ee.r==12&&(e.l+=10,Te-=10)}var I={};if(ve===10?I=Ee.f(e,Te,q):I=gA(ve,Ee,e,Te,q),ce==0&&[9,521,1033,2057].indexOf(P)===-1)continue;switch(ve){case 34:t.opts.Date1904=j.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(q.enc||(e.l=0),q.enc=I,!n.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:q.lastuser=I;break;case 66:var Pe=Number(I);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}_r(q.codepage=Pe),W=!0;break;case 317:q.rrtabid=I;break;case 25:q.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:q.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(i["!type"]="dialog"),I.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),I.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(I);break;case 430:ee.push([I]),ee[ee.length-1].XTI=[];break;case 35:case 547:ee[ee.length-1].push(I);break;case 24:case 536:R={Name:I.Name,Ref:_t(I.rgce,d,null,ee,q)},I.itab>0&&(R.Sheet=I.itab-1),ee.names.push(R),ee[0]||(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(U[I.itab-1]={ref:va(I.rgce[0][0][1][2])});break;case 22:q.ExternCount=I;break;case 23:ee.length==0&&(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].XTI=ee[ee.length-1].XTI.concat(I),ee.XTI=ee.XTI.concat(I);break;case 2196:if(q.biff<8)break;R!=null&&(R.Comment=I[1]);break;case 18:i["!protect"]=I;break;case 19:I!==0&&q.WTF&&console.error("Password verifier: "+I);break;case 133:o[I.pos]=I,q.snames.push(I.name);break;case 10:{if(--ce)break;if(d.e){if(d.e.r>0&&d.e.c>0){if(d.e.r--,d.e.c--,i["!ref"]=va(d),n.sheetRows&&n.sheetRows<=d.e.r){var Ue=d.e.r;d.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=va(d),d.e.r=Ue}d.e.r++,d.e.c++}pe.length>0&&(i["!merges"]=pe),Ae.length>0&&(i["!objects"]=Ae),Z.length>0&&(i["!cols"]=Z),oe.length>0&&(i["!rows"]=oe),j.Sheets.push(J)}m===""?g=i:s[m]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(q.biff===8&&(q.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),q.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(q.biff=5,W=!0,_r(q.codepage=28591)),q.biff==8&&I.BIFFVer==0&&I.dt==16&&(q.biff=2),ce++)break;if(i=n.dense?[]:{},q.biff<8&&!W&&(W=!0,_r(q.codepage=n.codepage||1252)),q.biff<5||I.BIFFVer==0&&I.dt==4096){m===""&&(m="Sheet1"),d={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:e.l-Te,name:m};o[We.pos]=We,q.snames.push(m)}else m=(o[me]||{name:""}).name;I.dt==32&&(i["!type"]="chart"),I.dt==64&&(i["!type"]="macro"),pe=[],Ae=[],q.arrayf=D=[],Z=[],oe=[],Re=!1,J={Hidden:(o[me]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[I.r]||[])[I.c]:i[aa({c:I.c,r:I.r})])&&++I.c,S={ixfe:I.ixfe,XF:V[I.ixfe]||{},v:I.val,t:"n"},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n);break;case 5:case 517:S={ixfe:I.ixfe,XF:V[I.ixfe],v:I.val,t:I.t},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n);break;case 638:S={ixfe:I.ixfe,XF:V[I.ixfe],v:I.rknum,t:"n"},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n);break;case 189:for(var Ve=I.c;Ve<=I.C;++Ve){var ge=I.rkrec[Ve-I.c][0];S={ixfe:ge,XF:V[ge],v:I.rkrec[Ve-I.c][1],t:"n"},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:Ve,r:I.r},S,n)}break;case 6:case 518:case 1030:{if(I.val=="String"){f=I;break}if(S=i0(I.val,I.cell.ixfe,I.tt),S.XF=V[S.ixfe],n.cellFormula){var Ie=I.formula;if(Ie&&Ie[0]&&Ie[0][0]&&Ie[0][0][0]=="PtgExp"){var ma=Ie[0][0][1][0],we=Ie[0][0][1][1],Fe=aa({r:ma,c:we});A[Fe]?S.f=""+_t(I.formula,d,I.cell,ee,q):S.F=((n.dense?(i[ma]||[])[we]:i[Fe])||{}).F}else S.f=""+_t(I.formula,d,I.cell,ee,q)}C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K(I.cell,S,n),f=I}break;case 7:case 519:if(f)f.val=I,S=i0(I,f.cell.ixfe,"s"),S.XF=V[S.ixfe],n.cellFormula&&(S.f=""+_t(f.formula,d,f.cell,ee,q)),C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K(f.cell,S,n),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(I);var la=aa(I[0].s);if(_=n.dense?(i[I[0].s.r]||[])[I[0].s.c]:i[la],n.cellFormula&&_){if(!f||!la||!_)break;_.f=""+_t(I[1],d,I[0],ee,q),_.F=va(I[0])}}break;case 1212:{if(!n.cellFormula)break;if(b){if(!f)break;A[aa(f.cell)]=I[0],_=n.dense?(i[f.cell.r]||[])[f.cell.c]:i[aa(f.cell)],(_||{}).f=""+_t(I[0],d,v,ee,q)}}break;case 253:S=i0(x[I.isst].t,I.ixfe,"s"),x[I.isst].h&&(S.h=x[I.isst].h),S.XF=V[S.ixfe],C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:I.ixfe,XF:V[I.ixfe],t:"z"},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n));break;case 190:if(n.sheetStubs)for(var Ge=I.c;Ge<=I.C;++Ge){var ra=I.ixfe[Ge-I.c];S={ixfe:ra,XF:V[ra],t:"z"},C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:Ge,r:I.r},S,n)}break;case 214:case 516:case 4:S=i0(I.val,I.ixfe,"s"),S.XF=V[S.ixfe],C>0&&(S.z=X[S.ixfe>>8&63]),Dr(S,n,t.opts.Date1904),K({c:I.c,r:I.r},S,n);break;case 0:case 512:ce===1&&(d=I);break;case 252:x=I;break;case 1054:if(q.biff==4){X[C++]=I[1];for(var Na=0;Na<C+163&&sa[Na]!=I[1];++Na);Na>=163&&us(I[1],C+163)}else us(I[1],I[0]);break;case 30:{X[C++]=I;for(var ca=0;ca<C+163&&sa[ca]!=I;++ca);ca>=163&&us(I,C+163)}break;case 229:pe=pe.concat(I);break;case 93:Ae[I.cmo[0]]=q.lastobj=I;break;case 438:q.lastobj.TxO=I;break;case 127:q.lastobj.ImData=I;break;case 440:for(T=I[0].s.r;T<=I[0].e.r;++T)for(E=I[0].s.c;E<=I[0].e.c;++E)_=n.dense?(i[T]||[])[E]:i[aa({c:E,r:T})],_&&(_.l=I[1]);break;case 2048:for(T=I[0].s.r;T<=I[0].e.r;++T)for(E=I[0].s.c;E<=I[0].e.c;++E)_=n.dense?(i[T]||[])[E]:i[aa({c:E,r:T})],_&&_.l&&(_.l.Tooltip=I[1]);break;case 28:{if(q.biff<=5&&q.biff>=2)break;_=n.dense?(i[I[0].r]||[])[I[0].c]:i[aa(I[0])];var na=Ae[I[2]];_||(n.dense?(i[I[0].r]||(i[I[0].r]=[]),_=i[I[0].r][I[0].c]={t:"z"}):_=i[aa(I[0])]={t:"z"},d.e.r=Math.max(d.e.r,I[0].r),d.s.r=Math.min(d.s.r,I[0].r),d.e.c=Math.max(d.e.c,I[0].c),d.s.c=Math.min(d.s.c,I[0].c)),_.c||(_.c=[]),y={a:I[1],t:na.TxO.t},_.c.push(y)}break;case 2173:PT(V[I.ixfe],I.ext);break;case 125:{if(!q.cellStyles)break;for(;I.e>=I.s;)Z[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},Re||(Re=!0,kf(I.w/256)),xi(Z[I.e+1])}break;case 520:{var ke={};I.level!=null&&(oe[I.r]=ke,ke.level=I.level),I.hidden&&(oe[I.r]=ke,ke.hidden=!0),I.hpt&&(oe[I.r]=ke,ke.hpt=I.hpt,ke.hpx=Fl(I.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||wl(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=I;break;case 161:i["!margins"]||wl(i["!margins"]={}),i["!margins"].header=I.header,i["!margins"].footer=I.footer;break;case 574:I.RTL&&(j.Views[0].RTL=!0);break;case 146:Y=I;break;case 2198:re=I;break;case 140:H=I;break;case 442:m?J.CodeName=I||J.name:j.WBProps.CodeName=I||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=Te}return t.SheetNames=Fr(o).sort(function(Qe,Oe){return Number(Qe)-Number(Oe)}).map(function(Qe){return o[Qe].name}),n.bookSheets||(t.Sheets=s),!t.SheetNames.length&&g["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=g)):t.Preamble=g,t.Sheets&&U.forEach(function(Qe,Oe){t.Sheets[t.SheetNames[Oe]]["!autofilter"]=Qe}),t.Strings=x,t.SSF=gt(sa),q.enc&&(t.Encryption=q.enc),re&&(t.Themes=re),t.Metadata={},H!==void 0&&(t.Metadata.Country=H),ee.names.length>0&&(j.Names=ee.names),t.Workbook=j,t}var dp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bA(e,n,t){var s=ga.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var i=Wm(s,ME,dp.DSI);for(var o in i)n[o]=i[o]}catch(m){if(t.WTF)throw m}var d=ga.find(e,"/!SummaryInformation");if(d&&d.size>0)try{var f=Wm(d,IE,dp.SI);for(var x in f)n[x]==null&&(n[x]=f[x])}catch(m){if(t.WTF)throw m}n.HeadingPairs&&n.TitlesOfParts&&(gg(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function e2(e,n){n||(n={}),jf(n),Cp(),n.codepage&&ff(n.codepage);var t,s;if(e.FullPaths){if(ga.find(e,"/encryption"))throw new Error("File is password-protected");t=ga.find(e,"!CompObj"),s=ga.find(e,"/Workbook")||ga.find(e,"/Book")}else{switch(n.type){case"base64":e=Er(Wt(e));break;case"binary":e=Er(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pt(e,0),s={content:e}}var i,o;if(t&&mA(t),n.bookProps&&!n.bookSheets)i={};else{var d=xa?"buffer":"array";if(s&&s.content)i=vA(s.content,n);else if((o=ga.find(e,"PerfectOffice_MAIN"))&&o.content)i=_l.to_workbook(o.content,(n.type=d,n));else if((o=ga.find(e,"NativeContent_MAIN"))&&o.content)i=_l.to_workbook(o.content,(n.type=d,n));else throw(o=ga.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&ga.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=n3(e))}var f={};return e.FullPaths&&bA(e,f,n),i.Props=i.Custprops=f,n.bookFiles&&(i.cfb=e),i}var b0={0:{f:eS},1:{f:nS},2:{f:hS},3:{f:cS},4:{f:iS},5:{f:dS},6:{f:pS},7:{f:uS},8:{f:ES},9:{f:yS},10:{f:vS},11:{f:bS},12:{f:sS},13:{f:xS},14:{f:oS},15:{f:lS},16:{f:Wg},17:{f:gS},18:{f:fS},19:{f:_f},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KS},40:{},42:{},43:{f:vT},44:{f:gT},45:{f:bT},46:{f:ET},47:{f:yT},48:{},49:{f:_E},50:{},51:{f:zT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Cg},62:{f:mS},63:{f:qT},64:{f:OS},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:At,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CS},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rS},148:{f:aS,p:16},151:{f:wS},152:{},153:{f:XS},154:{},155:{},156:{f:YS},157:{},158:{},159:{T:1,f:I_},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_S},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:HT},336:{T:-1},337:{f:VT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$u},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SS},427:{f:AS},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kS},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tS},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:TS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$u},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:a3},633:{T:1},634:{T:-1},635:{T:1,f:e3},636:{T:-1},637:{f:wE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:MS},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:DS},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},af={6:{f:Hu},10:{f:Dn},12:{f:at},13:{f:at},14:{f:Wa},15:{f:Wa},16:{f:Tt},17:{f:Wa},18:{f:Wa},19:{f:at},20:{f:Jm},21:{f:Jm},23:{f:kg},24:{f:ap},25:{f:Wa},26:{},27:{},28:{f:Q4},29:{},34:{f:Wa},35:{f:ep},38:{f:Tt},39:{f:Tt},40:{f:Tt},41:{f:Tt},42:{f:Wa},43:{f:Wa},47:{f:tT},49:{f:j4},51:{f:at},60:{},61:{f:O4},64:{f:Wa},65:{f:R4},66:{f:at},77:{},80:{},81:{},82:{},85:{f:at},89:{},90:{},91:{},92:{f:_4},93:{f:e_},94:{},95:{f:Wa},96:{},97:{},99:{f:Wa},125:{f:Cg},128:{f:V4},129:{f:T4},130:{f:at},131:{f:Wa},132:{f:Wa},133:{f:w4},134:{},140:{f:i_},141:{f:at},144:{},146:{f:c_},151:{},152:{},153:{},154:{},155:{},156:{f:at},157:{},158:{},160:{f:h_},161:{f:u_},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:U4},190:{f:P4},193:{f:Dn},197:{},198:{},199:{},200:{},201:{},202:{f:Wa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:at},220:{},221:{f:Wa},222:{},224:{f:z4},225:{f:E4},226:{f:Dn},227:{},229:{f:J4},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:S4},253:{f:F4},255:{f:A4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_g},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wa},353:{f:Dn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Y4},431:{f:Wa},432:{},433:{},434:{},437:{},438:{f:r_},439:{f:Wa},440:{f:n_},441:{},442:{f:Ul},443:{},444:{f:at},445:{},446:{},448:{f:Dn},449:{f:C4,r:2},450:{f:Dn},512:{f:Zm},513:{f:d_},515:{f:G4},516:{f:L4},517:{f:Qm},519:{f:x_},520:{f:N4},523:{},545:{f:tp},549:{f:$m},566:{},574:{f:D4},638:{f:B4},659:{},1048:{},1054:{f:M4},1084:{},1212:{f:W4},2048:{f:s_},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:r0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Dn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:o_,r:12},2173:{f:UT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:K4,r:12},2197:{},2198:{f:jT,r:12},2199:{},2200:{},2201:{},2202:{f:$4,r:12},2203:{f:Dn},2204:{},2205:{},2206:{},2207:{},2211:{f:k4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:at},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:f_},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:l_},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zm},1:{},2:{f:v_},3:{f:g_},4:{f:p_},5:{f:Qm},7:{f:b_},8:{},9:{f:r0},11:{},22:{f:at},30:{f:I4},31:{},32:{},33:{f:tp},36:{},37:{f:$m},50:{f:y_},62:{},52:{},67:{},68:{f:at},69:{},86:{},126:{},127:{f:m_},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:E_},223:{},234:{},354:{},421:{},518:{f:Hu},521:{f:r0},536:{f:ap},547:{f:ep},561:{},579:{},1030:{f:Hu},1033:{f:r0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function yr(e,n,t,s){var i=n;if(!isNaN(i)){var o=(t||[]).length||0,d=e.next(4);d.write_shift(2,i),d.write_shift(2,o),o>0&&og(t)&&e.push(t)}}function hp(e,n){var t=n||{},s=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),d=i.index,f=o&&o.index||e.length,x=Gy(e.slice(d,f),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,g=0,v=0,b=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(d=0;d<x.length;++d){var E=x[d].trim(),T=E.slice(0,3).toLowerCase();if(T=="<tr"){if(++m,t.sheetRows&&t.sheetRows<=m){--m;break}g=0;continue}if(!(T!="<td"&&T!="<th")){var A=E.split(/<\/t[dh]>/i);for(f=0;f<A.length;++f){var D=A[f].trim();if(D.match(/<t[dh]/i)){for(var S=D,H=0;S.charAt(0)=="<"&&(H=S.indexOf(">"))>-1;)S=S.slice(H+1);for(var V=0;V<y.length;++V){var Y=y[V];Y.s.c==g&&Y.s.r<m&&m<=Y.e.r&&(g=Y.e.c+1,V=-1)}var j=Ze(D.slice(0,D.indexOf(">")));b=j.colspan?+j.colspan:1,((v=+j.rowspan)>1||b>1)&&y.push({s:{r:m,c:g},e:{r:m+(v||1)-1,c:g+b-1}});var J=j.t||j["data-t"]||"";if(!S.length){g+=b;continue}if(S=$p(S),_.s.r>m&&(_.s.r=m),_.e.r<m&&(_.e.r=m),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!S.length){g+=b;continue}var z={t:"s",v:S};t.raw||!S.trim().length||J=="s"||(S==="TRUE"?z={t:"b",v:!0}:S==="FALSE"?z={t:"b",v:!1}:isNaN(wr(S))?isNaN(hi(S).getDate())||(z={t:"d",v:dt(S)},t.cellDates||(z={t:"n",v:jt(z.v)}),z.z=t.dateNF||sa[14]):z={t:"n",v:wr(S)}),t.dense?(s[m]||(s[m]=[]),s[m][g]=z):s[aa({r:m,c:g})]=z,g+=b}}}}return s["!ref"]=va(_),y.length&&(s["!merges"]=y),s}function yA(e,n,t,s){for(var i=e["!merges"]||[],o=[],d=n.s.c;d<=n.e.c;++d){for(var f=0,x=0,m=0;m<i.length;++m)if(!(i[m].s.r>t||i[m].s.c>d)&&!(i[m].e.r<t||i[m].e.c<d)){if(i[m].s.r<t||i[m].s.c<d){f=-1;break}f=i[m].e.r-i[m].s.r+1,x=i[m].e.c-i[m].s.c+1;break}if(!(f<0)){var g=aa({r:t,c:d}),v=s.dense?(e[t]||[])[d]:e[g],b=v&&v.v!=null&&(v.h||gf(v.w||(tn(v),v.w)||""))||"",_={};f>1&&(_.rowspan=f),x>1&&(_.colspan=x),s.editable?b='<span contenteditable="true">'+b+"</span>":v&&(_["data-t"]=v&&v.t||"z",v.v!=null&&(_["data-v"]=v.v),v.z!=null&&(_["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+v.l.Target+'">'+b+"</a>")),_.id=(s.id||"sjs")+"-"+g,o.push(iE("td",b,_))}}var y="<tr>";return y+o.join("")+"</tr>"}var EA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_A="</body></html>";function TA(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Un(hp(t[0],n),n);var s=Lf();return t.forEach(function(i,o){Mf(s,hp(i,n),"Sheet"+(o+1))}),s}function wA(e,n,t){var s=[];return s.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function SA(e,n){var t=n||{},s=t.header!=null?t.header:EA,i=t.footer!=null?t.footer:_A,o=[s],d=pi(e["!ref"]);t.dense=Array.isArray(e),o.push(wA(e,d,t));for(var f=d.s.r;f<=d.e.r;++f)o.push(yA(e,d,f,t));return o.push("</table>"+i),o.join("")}function a2(e,n,t){var s=t||{},i=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var d=typeof s.origin=="string"?Dt(s.origin):s.origin;i=d.r,o=d.c}var f=n.getElementsByTagName("tr"),x=Math.min(s.sheetRows||1e7,f.length),m={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var g=pi(e["!ref"]);m.s.r=Math.min(m.s.r,g.s.r),m.s.c=Math.min(m.s.c,g.s.c),m.e.r=Math.max(m.e.r,g.e.r),m.e.c=Math.max(m.e.c,g.e.c),i==-1&&(m.e.r=i=g.e.r+1)}var v=[],b=0,_=e["!rows"]||(e["!rows"]=[]),y=0,E=0,T=0,A=0,D=0,S=0;for(e["!cols"]||(e["!cols"]=[]);y<f.length&&E<x;++y){var H=f[y];if(xp(H)){if(s.display)continue;_[E]={hidden:!0}}var V=H.children;for(T=A=0;T<V.length;++T){var Y=V[T];if(!(s.display&&xp(Y))){var j=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):$p(Y.innerHTML),J=Y.getAttribute("data-z")||Y.getAttribute("z");for(b=0;b<v.length;++b){var z=v[b];z.s.c==A+o&&z.s.r<E+i&&E+i<=z.e.r&&(A=z.e.c+1-o,b=-1)}S=+Y.getAttribute("colspan")||1,((D=+Y.getAttribute("rowspan")||1)>1||S>1)&&v.push({s:{r:E+i,c:A+o},e:{r:E+i+(D||1)-1,c:A+o+(S||1)-1}});var ie={t:"s",v:j},K=Y.getAttribute("data-t")||Y.getAttribute("t")||"";j!=null&&(j.length==0?ie.t=K||"z":s.raw||j.trim().length==0||K=="s"||(j==="TRUE"?ie={t:"b",v:!0}:j==="FALSE"?ie={t:"b",v:!1}:isNaN(wr(j))?isNaN(hi(j).getDate())||(ie={t:"d",v:dt(j)},s.cellDates||(ie={t:"n",v:jt(ie.v)}),ie.z=s.dateNF||sa[14]):ie={t:"n",v:wr(j)})),ie.z===void 0&&J!=null&&(ie.z=J);var q="",re=Y.getElementsByTagName("A");if(re&&re.length)for(var pe=0;pe<re.length&&!(re[pe].hasAttribute("href")&&(q=re[pe].getAttribute("href"),q.charAt(0)!="#"));++pe);q&&q.charAt(0)!="#"&&(ie.l={Target:q}),s.dense?(e[E+i]||(e[E+i]=[]),e[E+i][A+o]=ie):e[aa({c:A+o,r:E+i})]=ie,m.e.c<A+o&&(m.e.c=A+o),A+=S}}++E}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,E-1+i),e["!ref"]=va(m),E>=x&&(e["!fullref"]=va((m.e.r=f.length-y+E-1+i,m))),e}function t2(e,n){var t=n||{},s=t.dense?[]:{};return a2(s,e,n)}function AA(e,n){return Un(t2(e,n),n)}function xp(e){var n="",t=NA(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function NA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kA(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ba(n.replace(/<[^>]*>/g,""));return[t]}var mp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function r2(e,n){var t=n||{},s=vf(e),i=[],o,d,f={name:""},x="",m=0,g,v,b={},_=[],y=t.dense?[]:{},E,T,A={value:""},D="",S=0,H=[],V=-1,Y=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,z={},ie=[],K={},q=0,re=0,pe=[],Ae=1,Z=1,oe=[],Re={Names:[]},ee={},P=["",""],ce=[],C={},X="",U=0,R=!1,W=!1,me=0;for(Dl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=Dl.exec(s);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"工作表":E[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?y["!ref"]=va(j):y["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=j.e.r&&(y["!fullref"]=y["!ref"],j.e.r=t.sheetRows-1,y["!ref"]=va(j)),ie.length&&(y["!merges"]=ie),pe.length&&(y["!rows"]=pe),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),b[g.name]=y,W=!1):E[0].charAt(E[0].length-2)!=="/"&&(g=Ze(E[0],!1),V=Y=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,y=t.dense?[]:{},ie=[],pe=[],W=!0);break;case"table-row-group":E[1]==="/"?--J:++J;break;case"table-row":case"行":if(E[1]==="/"){V+=Ae,Ae=1;break}if(v=Ze(E[0],!1),v.行号?V=v.行号-1:V==-1&&(V=0),Ae=+v["number-rows-repeated"]||1,Ae<10)for(me=0;me<Ae;++me)J>0&&(pe[V+me]={level:J});Y=-1;break;case"covered-table-cell":E[1]!=="/"&&++Y,t.sheetStubs&&(t.dense?(y[V]||(y[V]=[]),y[V][Y]={t:"z"}):y[aa({r:V,c:Y})]={t:"z"}),D="",H=[];break;case"table-cell":case"数据":if(E[0].charAt(E[0].length-2)==="/")++Y,A=Ze(E[0],!1),Z=parseInt(A["number-columns-repeated"]||"1",10),T={t:"z",v:null},A.formula&&t.cellFormula!=!1&&(T.f=op(ba(A.formula))),(A.数据类型||A["value-type"])=="string"&&(T.t="s",T.v=ba(A["string-value"]||""),t.dense?(y[V]||(y[V]=[]),y[V][Y]=T):y[aa({r:V,c:Y})]=T),Y+=Z-1;else if(E[1]!=="/"){++Y,D="",S=0,H=[],Z=1;var ve=Ae?V+Ae-1:V;if(Y>j.e.c&&(j.e.c=Y),Y<j.s.c&&(j.s.c=Y),V<j.s.r&&(j.s.r=V),ve>j.e.r&&(j.e.r=ve),A=Ze(E[0],!1),ce=[],C={},T={t:A.数据类型||A["value-type"],v:null},t.cellFormula)if(A.formula&&(A.formula=ba(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(q=parseInt(A["number-matrix-rows-spanned"],10)||0,re=parseInt(A["number-matrix-columns-spanned"],10)||0,K={s:{r:V,c:Y},e:{r:V+q-1,c:Y+re-1}},T.F=va(K),oe.push([K,T.F])),A.formula)T.f=op(A.formula);else for(me=0;me<oe.length;++me)V>=oe[me][0].s.r&&V<=oe[me][0].e.r&&Y>=oe[me][0].s.c&&Y<=oe[me][0].e.c&&(T.F=oe[me][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(q=parseInt(A["number-rows-spanned"],10)||0,re=parseInt(A["number-columns-spanned"],10)||0,K={s:{r:V,c:Y},e:{r:V+q-1,c:Y+re-1}},ie.push(K)),A["number-columns-repeated"]&&(Z=parseInt(A["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=Ba(A["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(A.value);break;case"percentage":T.t="n",T.v=parseFloat(A.value);break;case"currency":T.t="n",T.v=parseFloat(A.value);break;case"date":T.t="d",T.v=dt(A["date-value"]),t.cellDates||(T.t="n",T.v=jt(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=Hy(A["time-value"])/86400,t.cellDates&&(T.t="d",T.v=E0(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(A.数据数值);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",A["string-value"]!=null&&(D=ba(A["string-value"]),H=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(R=!1,T.t==="s"&&(T.v=D||"",H.length&&(T.R=H),R=S==0),ee.Target&&(T.l=ee),ce.length>0&&(T.c=ce,ce=[]),D&&t.cellText!==!1&&(T.w=D),R&&(T.t="z",delete T.v),(!R||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=V))for(var Te=0;Te<Ae;++Te){if(Z=parseInt(A["number-columns-repeated"]||"1",10),t.dense)for(y[V+Te]||(y[V+Te]=[]),y[V+Te][Y]=Te==0?T:gt(T);--Z>0;)y[V+Te][Y+Z]=gt(T);else for(y[aa({r:V+Te,c:Y})]=T;--Z>0;)y[aa({r:V+Te,c:Y+Z})]=gt(T);j.e.c<=Y&&(j.e.c=Y)}Z=parseInt(A["number-columns-repeated"]||"1",10),Y+=Z-1,Z=0,T={},D="",H=[]}ee={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o;C.t=D,H.length&&(C.R=H),C.a=X,ce.push(C)}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);X="",U=0,D="",S=0,H=[];break;case"creator":E[1]==="/"?X=s.slice(U,E.index):U=E.index+E[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);D="",S=0,H=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(z[f.name]=x,(o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&(x="",f=Ze(E[0],!1),i.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":d=Ze(E[0],!1),x+=mp[E[3]][d.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":d=Ze(E[0],!1),x+=mp[E[3]][d.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":x+=s.slice(m,E.index);break}else m=E.index+E[0].length;break;case"named-range":d=Ze(E[0],!1),P=zu(d["cell-range-address"]);var Ee={Name:d.name,Ref:P[0]+"!"+P[1]};W&&(Ee.Sheet=_.length),Re.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(E[1]==="/"&&(!A||!A["string-value"])){var Be=kA(s.slice(S,E.index));D=(D.length>0?D+`
`:"")+Be[0]}else Ze(E[0],!1),S=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{P=zu(Ze(E[0])["target-range-address"]),b[P[0]]["!autofilter"]={ref:P[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ee=Ze(E[0],!1),!ee.href)break;ee.Target=ba(ee.href),delete ee.href,ee.Target.charAt(0)=="#"&&ee.Target.indexOf(".")>-1?(P=zu(ee.Target.slice(1)),ee.Target="#"+P[0]+"!"+P[1]):ee.Target.match(/^\.\.[\\\/]/)&&(ee.Target=ee.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(E)}}var I={Sheets:b,SheetNames:_,Workbook:Re};return t.bookSheets&&delete I.Sheets,I}function pp(e,n){n=n||{},or(e,"META-INF/manifest.xml")&&GE(et(e,"META-INF/manifest.xml"),n);var t=Kt(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var s=r2(Ma(t),n);return or(e,"meta.xml")&&(s.Props=pg(et(e,"meta.xml"))),s}function gp(e,n){return r2(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Df(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function tf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ma(ps(e))}function rf(e){var n=e.reduce(function(i,o){return i+o.length},0),t=new Uint8Array(n),s=0;return e.forEach(function(i){t.set(i,s),s+=i.length}),t}function vp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function CA(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,s=e[n+14]&1,i=n+13;i>=n;--i)s=s*256+e[i];return(e[n+15]&128?-s:s)*Math.pow(10,t-6176)}function Ll(e,n){var t=n?n[0]:0,s=e[t]&127;e:if(e[t++]>=128&&(s|=(e[t]&127)<<7,e[t++]<128||(s|=(e[t]&127)<<14,e[t++]<128)||(s|=(e[t]&127)<<21,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),s}function lt(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function wt(e){for(var n=[],t=[0];t[0]<e.length;){var s=t[0],i=Ll(e,t),o=i&7;i=Math.floor(i/8);var d=0,f;if(i==0)break;switch(o){case 0:{for(var x=t[0];e[t[0]++]>=128;);f=e.slice(x,t[0])}break;case 5:d=4,f=e.slice(t[0],t[0]+d),t[0]+=d;break;case 1:d=8,f=e.slice(t[0],t[0]+d),t[0]+=d;break;case 2:d=Ll(e,t),f=e.slice(t[0],t[0]+d),t[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(s))}var m={data:f,type:o};n[i]==null?n[i]=[m]:n[i].push(m)}return n}function Rf(e,n){return(e==null?void 0:e.map(function(t){return n(t.data)}))||[]}function OA(e){for(var n,t=[],s=[0];s[0]<e.length;){var i=Ll(e,s),o=wt(e.slice(s[0],s[0]+i));s[0]+=i;var d={id:lt(o[1][0].data),messages:[]};o[2].forEach(function(f){var x=wt(f.data),m=lt(x[3][0].data);d.messages.push({meta:x,data:e.slice(s[0],s[0]+m)}),s[0]+=m}),(n=o[3])!=null&&n[0]&&(d.merge=lt(o[3][0].data)>>>0>0),t.push(d)}return t}function DA(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=Ll(n,t),i=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var d=n[t[0]++]>>2;if(d<60)++d;else{var f=d-59;d=n[t[0]],f>1&&(d|=n[t[0]+1]<<8),f>2&&(d|=n[t[0]+2]<<16),f>3&&(d|=n[t[0]+3]<<24),d>>>=0,d++,t[0]+=f}i.push(n.slice(t[0],t[0]+d)),t[0]+=d;continue}else{var x=0,m=0;if(o==1?(m=(n[t[0]]>>2&7)+4,x=(n[t[0]++]&224)<<3,x|=n[t[0]++]):(m=(n[t[0]++]>>2)+1,o==2?(x=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(x=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),i=[rf(i)],x==0)throw new Error("Invalid offset 0");if(x>i[0].length)throw new Error("Invalid offset beyond length");if(m>=x)for(i.push(i[0].slice(-x)),m-=x;m>=i[i.length-1].length;)i.push(i[i.length-1]),m-=i[i.length-1].length;i.push(i[0].slice(-x,-x+m))}}var g=rf(i);if(g.length!=s)throw new Error("Unexpected length: ".concat(g.length," != ").concat(s));return g}function RA(e){for(var n=[],t=0;t<e.length;){var s=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(DA(s,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return rf(n)}function jA(e,n,t,s){var i=Df(e),o=i.getUint32(4,!0),d=(s>1?12:8)+vp(o&(s>1?3470:398))*4,f=-1,x=-1,m=NaN,g=new Date(2001,0,1);o&512&&(f=i.getUint32(d,!0),d+=4),d+=vp(o&(s>1?12288:4096))*4,o&16&&(x=i.getUint32(d,!0),d+=4),o&32&&(m=i.getFloat64(d,!0),d+=8),o&64&&(g.setTime(g.getTime()+i.getFloat64(d,!0)*1e3),d+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:n[x]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(f>-1)v={t:"s",v:t[f]};else if(x>-1)v={t:"s",v:n[x]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function FA(e,n,t){var s=Df(e),i=s.getUint32(8,!0),o=12,d=-1,f=-1,x=NaN,m=NaN,g=new Date(2001,0,1);i&1&&(x=CA(e,o),o+=16),i&2&&(m=s.getFloat64(o,!0),o+=8),i&4&&(g.setTime(g.getTime()+s.getFloat64(o,!0)*1e3),o+=8),i&8&&(f=s.getUint32(o,!0),o+=4),i&16&&(d=s.getUint32(o,!0),o+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:n[f]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:t[d]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:x};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return v}function LA(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return jA(e,n,t,e[0]);case 5:return FA(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Mn(e){var n=wt(e);return Ll(n[1][0].data)}function bp(e,n){var t=wt(n.data),s=lt(t[1][0].data),i=t[3],o=[];return(i||[]).forEach(function(d){var f=wt(d.data),x=lt(f[1][0].data)>>>0;switch(s){case 1:o[x]=tf(f[3][0].data);break;case 8:{var m=e[Mn(f[9][0].data)][0],g=wt(m.data),v=e[Mn(g[1][0].data)][0],b=lt(v.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));var _=wt(v.data);o[x]=_[3].map(function(y){return tf(y.data)}).join("")}break}}),o}function MA(e,n){var t,s,i,o,d,f,x,m,g,v,b,_,y,E,T=wt(e),A=lt(T[1][0].data)>>>0,D=lt(T[2][0].data)>>>0,S=((s=(t=T[8])==null?void 0:t[0])==null?void 0:s.data)&&lt(T[8][0].data)>0||!1,H,V;if((o=(i=T[7])==null?void 0:i[0])!=null&&o.data&&n!=0)H=(f=(d=T[7])==null?void 0:d[0])==null?void 0:f.data,V=(m=(x=T[6])==null?void 0:x[0])==null?void 0:m.data;else if((v=(g=T[4])==null?void 0:g[0])!=null&&v.data&&n!=1)H=(_=(b=T[4])==null?void 0:b[0])==null?void 0:_.data,V=(E=(y=T[3])==null?void 0:y[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var Y=S?4:1,j=Df(H),J=[],z=0;z<H.length/2;++z){var ie=j.getUint16(z*2,!0);ie<65535&&J.push([z,ie])}if(J.length!=D)throw"Expected ".concat(D," cells, found ").concat(J.length);var K=[];for(z=0;z<J.length-1;++z)K[J[z][0]]=V.subarray(J[z][1]*Y,J[z+1][1]*Y);return J.length>=1&&(K[J[J.length-1][0]]=V.subarray(J[J.length-1][1]*Y)),{R:A,cells:K}}function IA(e,n){var t,s=wt(n.data),i=(t=s==null?void 0:s[7])!=null&&t[0]?lt(s[7][0].data)>>>0>0?1:0:-1,o=Rf(s[5],function(d){return MA(d,i)});return{nrows:lt(s[4][0].data)>>>0,data:o.reduce(function(d,f){return d[f.R]||(d[f.R]=[]),f.cells.forEach(function(x,m){if(d[f.R][m])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(m));d[f.R][m]=x}),d},[])}}function BA(e,n,t){var s,i=wt(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(lt(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(lt(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=va(o);var d=wt(i[4][0].data),f=bp(e,e[Mn(d[4][0].data)][0]),x=(s=d[17])!=null&&s[0]?bp(e,e[Mn(d[17][0].data)][0]):[],m=wt(d[3][0].data),g=0;m[1].forEach(function(v){var b=wt(v.data),_=e[Mn(b[2][0].data)][0],y=lt(_.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var E=IA(e,_);E.data.forEach(function(T,A){T.forEach(function(D,S){var H=aa({r:g+A,c:S}),V=LA(D,f,x);V&&(t[H]=V)})}),g+=E.nrows})}function UA(e,n){var t=wt(n.data),s={"!ref":"A1"},i=e[Mn(t[2][0].data)],o=lt(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return BA(e,i[0],s),s}function PA(e,n){var t,s=wt(n.data),i={name:(t=s[1])!=null&&t[0]?tf(s[1][0].data):"",sheets:[]},o=Rf(s[2],Mn);return o.forEach(function(d){e[d].forEach(function(f){var x=lt(f.meta[1][0].data);x==6e3&&i.sheets.push(UA(e,f))})}),i}function HA(e,n){var t=Lf(),s=wt(n.data),i=Rf(s[1],Mn);if(i.forEach(function(o){e[o].forEach(function(d){var f=lt(d.meta[1][0].data);if(f==2){var x=PA(e,d);x.sheets.forEach(function(m,g){Mf(t,m,g==0?x.name:x.name+"_"+g,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Gu(e){var n,t,s,i,o={},d=[];if(e.FullPaths.forEach(function(x){if(x.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(x){if(x.name.match(/\.iwa$/)){var m;try{m=RA(x.content)}catch(v){return console.log("?? "+x.content.length+" "+(v.message||v))}var g;try{g=OA(m)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){o[v.id]=v.messages,d.push(v.id)})}}),!d.length)throw new Error("File has no messages");var f=((i=(s=(t=(n=o==null?void 0:o[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:s[1])==null?void 0:i[0].data)&&lt(o[1][0].meta[1][0].data)==1&&o[1][0];if(f||d.forEach(function(x){o[x].forEach(function(m){var g=lt(m.meta[1][0].data)>>>0;if(g==1)if(!f)f=m;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return HA(o,f)}function zA(e){return function(t){for(var s=0;s!=e.length;++s){var i=e[s];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function jf(e){zA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function VA(e){return oi.WS.indexOf(e)>-1?"sheet":e==oi.CS?"chart":e==oi.DS?"dialog":e==oi.MS?"macro":e&&e.length?e:"sheet"}function GA(e,n){if(!e)return 0;try{e=n.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,VA(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function YA(e,n,t,s,i,o,d,f,x,m,g,v){try{o[s]=yl(Kt(e,t,!0),n);var b=et(e,n),_;switch(f){case"sheet":_=ZS(b,n,i,x,o[s],m,g,v);break;case"chart":if(_=QS(b,n,i,x,o[s],m,g,v),!_||!_["!drawel"])break;var y=ml(_["!drawel"].Target,n),E=Zu(y),T=$T(Kt(e,y,!0),yl(Kt(e,E,!0),y)),A=ml(T,y),D=Zu(A);_=FS(Kt(e,A,!0),A,x,yl(Kt(e,D,!0),A),m,_);break;case"macro":_=JS(b,n,i,x,o[s],m,g,v);break;case"dialog":_=eA(b,n,i,x,o[s],m,g,v);break;default:throw new Error("Unrecognized sheet type "+f)}d[s]=_;var S=[];o&&o[s]&&Fr(o[s]).forEach(function(H){var V="";if(o[s][H].Type==oi.CMNT){V=ml(o[s][H].Target,n);var Y=nA(et(e,V,!0),V,x);if(!Y||!Y.length)return;np(_,Y,!1)}o[s][H].Type==oi.TCMNT&&(V=ml(o[s][H].Target,n),S=S.concat(QT(et(e,V,!0),x)))}),S&&S.length&&np(_,S,!0,x.people||[])}catch(H){if(x.WTF)throw H}}function lr(e){return e.charAt(0)=="/"?e.slice(1):e}function XA(e,n){if(Hp(),n=n||{},jf(n),or(e,"META-INF/manifest.xml")||or(e,"objectdata.xml"))return pp(e,n);if(or(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gu<"u"){if(e.FileIndex)return Gu(e);var t=ga.utils.cfb_new();return Dm(e).forEach(function(pe){qy(t,pe,Xy(e,pe))}),Gu(t)}throw new Error("Unsupported NUMBERS file")}if(!or(e,"[Content_Types].xml"))throw or(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):or(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=Dm(e),i=zE(Kt(e,"[Content_Types].xml")),o=!1,d,f;if(i.workbooks.length===0&&(f="xl/workbook.xml",et(e,f,!0)&&i.workbooks.push(f)),i.workbooks.length===0){if(f="xl/workbook.bin",!et(e,f,!0))throw new Error("Could not find workbook");i.workbooks.push(f),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var x={},m={};if(!n.bookSheets&&!n.bookProps){if(Tl=[],i.sst)try{Tl=rA(et(e,lr(i.sst)),i.sst,n)}catch(pe){if(n.WTF)throw pe}n.cellStyles&&i.themes.length&&(x=tA(Kt(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(m=aA(et(e,lr(i.style)),i.style,x,n))}i.links.map(function(pe){try{var Ae=yl(Kt(e,Zu(lr(pe))),pe);return iA(et(e,lr(pe)),Ae,pe,n)}catch{}});var g=$S(et(e,lr(i.workbooks[0])),i.workbooks[0],n),v={},b="";i.coreprops.length&&(b=et(e,lr(i.coreprops[0]),!0),b&&(v=pg(b)),i.extprops.length!==0&&(b=et(e,lr(i.extprops[0]),!0),b&&qE(b,v,n)));var _={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(b=Kt(e,lr(i.custprops[0]),!0),b&&(_=WE(b,n)));var y={};if((n.bookSheets||n.bookProps)&&(g.Sheets?d=g.Sheets.map(function(Ae){return Ae.name}):v.Worksheets&&v.SheetNames.length>0&&(d=v.SheetNames),n.bookProps&&(y.Props=v,y.Custprops=_),n.bookSheets&&typeof d<"u"&&(y.SheetNames=d),n.bookSheets?y.SheetNames:n.bookProps))return y;d={};var E={};n.bookDeps&&i.calcchain&&(E=sA(et(e,lr(i.calcchain)),i.calcchain));var T=0,A={},D,S;{var H=g.Sheets;v.Worksheets=H.length,v.SheetNames=[];for(var V=0;V!=H.length;++V)v.SheetNames[V]=H[V].name}var Y=o?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),J=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");or(e,J)||(J="xl/_rels/workbook."+Y+".rels");var z=yl(Kt(e,J,!0),J.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=lA(et(e,lr(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=JT(et(e,lr(i.people[0])),n)),z&&(z=GA(z,g.Sheets));var ie=et(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=v.Worksheets;++T){var K="sheet";if(z&&z[T]?(D="xl/"+z[T][1].replace(/[\/]?xl\//,""),or(e,D)||(D=z[T][1]),or(e,D)||(D=J.replace(/_rels\/.*$/,"")+z[T][1]),K=z[T][2]):(D="xl/worksheets/sheet"+(T+1-ie)+"."+Y,D=D.replace(/sheet0\./,"sheet.")),S=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(T!=n.sheets)continue e;break;case"string":if(v.SheetNames[T].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var q=!1,re=0;re!=n.sheets.length;++re)typeof n.sheets[re]=="number"&&n.sheets[re]==T&&(q=1),typeof n.sheets[re]=="string"&&n.sheets[re].toLowerCase()==v.SheetNames[T].toLowerCase()&&(q=1);if(!q)continue e}}YA(e,D,S,v.SheetNames[T],T,A,d,K,n,g,x,m)}return y={Directory:i,Workbook:g,Props:v,Custprops:_,Deps:E,Sheets:d,SheetNames:v.SheetNames,Strings:Tl,Styles:m,Themes:x,SSF:gt(sa)},n&&n.bookFiles&&(e.files?(y.keys=s,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(pe,Ae){pe=pe.replace(/^Root Entry[\/]/,""),y.keys.push(pe),y.files[pe]=e.FileIndex[Ae]}))),n&&n.bookVBA&&(i.vba.length>0?y.vbaraw=et(e,lr(i.vba[0]),!0):i.defaults&&i.defaults.bin===r3&&(y.vbaraw=et(e,"xl/vbaProject.bin",!0))),y}function qA(e,n){var t=n||{},s="Workbook",i=ga.find(e,s);try{if(s="/!DataSpaces/Version",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(U_(i.content),s="/!DataSpaces/DataSpaceMap",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=H_(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=z_(i.content);if(d.length!=1||d[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);G_(i.content)}catch{}if(s="/EncryptionInfo",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=Y_(i.content);if(s="/EncryptedPackage",i=ga.find(e,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],i.content,t.password||"",t);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Ff(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Wt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function KA(e,n){return ga.find(e,"EncryptedPackage")?qA(e,n):e2(e,n)}function WA(e,n){var t,s=e,i=n||{};return i.type||(i.type=xa&&Buffer.isBuffer(e)?"buffer":"base64"),t=qp(s,i),XA(t,i)}function n2(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return ef(e.slice(t),n);default:break e}return Rl.to_workbook(e,n)}function $A(e,n){var t="",s=Ff(e,n);switch(n.type){case"base64":t=Wt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=hs(e);break;default:throw new Error("Unrecognized type "+n.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(t=Ma(t)),n.type="binary",n2(t,n)}function ZA(e,n){var t=e;return n.type=="base64"&&(t=Wt(t)),t=kl.utils.decode(1200,t.slice(2),"str"),n.type="binary",n2(t,n)}function QA(e){return e.match(/[^\x00-\x7F]/)?pl(e):e}function Yu(e,n,t,s){return s?(t.type="string",Rl.to_workbook(e,t)):Rl.to_workbook(n,t)}function y0(e,n){Cp();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return y0(new Uint8Array(e),(t=gt(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var s=e,i=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),di={},t.dateNF&&(di.dateNF=t.dateNF),t.type||(t.type=xa&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=xa?"buffer":"binary",s=Uy(e),typeof Uint8Array<"u"&&!xa&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,s=QA(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var d=new ArrayBuffer(3),f=new Uint8Array(d);if(f.foo="bar",!f.foo)return t=gt(t),t.type="array",y0(df(s),t)}switch((i=Ff(s,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return KA(ga.read(s,t),t);break;case 9:if(i[1]<=8)return e2(s,t);break;case 60:return ef(s,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return A_(s,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return w_.to_workbook(s,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?WA(s,t):Yu(e,s,t,o);case 239:return i[3]===60?ef(s,t):Yu(e,s,t,o);case 255:if(i[1]===254)return ZA(s,t);if(i[1]===0&&i[2]===2&&i[3]===0)return _l.to_workbook(s,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return _l.to_workbook(s,t);break;case 3:case 131:case 139:case 140:return rp.to_workbook(s,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return rT.to_workbook(s,t);break;case 10:case 13:case 32:return $A(s,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return __.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?rp.to_workbook(s,t):Yu(e,s,t,o)}function JA(e,n,t,s,i,o,d,f){var x=vt(t),m=f.defval,g=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),v=!0,b=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:t,enumerable:!1})}catch{b.__rowNum__=t}else b.__rowNum__=t;if(!d||e[t])for(var _=n.s.c;_<=n.e.c;++_){var y=d?e[t][_]:e[s[_]+x];if(y===void 0||y.t===void 0){if(m===void 0)continue;o[_]!=null&&(b[o[_]]=m);continue}var E=y.v;switch(y.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(o[_]!=null){if(E==null)if(y.t=="e"&&E===null)b[o[_]]=null;else if(m!==void 0)b[o[_]]=m;else if(g&&E===null)b[o[_]]=null;else continue;else b[o[_]]=g&&(y.t!=="n"||y.t==="n"&&f.rawNumbers!==!1)?E:tn(y,E,f);E!=null&&(v=!1)}}return{row:b,isempty:v}}function nf(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},s=0,i=1,o=[],d=0,f="",x={s:{r:0,c:0},e:{r:0,c:0}},m=n||{},g=m.range!=null?m.range:e["!ref"];switch(m.header===1?s=1:m.header==="A"?s=2:Array.isArray(m.header)?s=3:m.header==null&&(s=0),typeof g){case"string":x=Ya(g);break;case"number":x=Ya(e["!ref"]),x.s.r=g;break;default:x=g}s>0&&(i=0);var v=vt(x.s.r),b=[],_=[],y=0,E=0,T=Array.isArray(e),A=x.s.r,D=0,S={};T&&!e[A]&&(e[A]=[]);var H=m.skipHidden&&e["!cols"]||[],V=m.skipHidden&&e["!rows"]||[];for(D=x.s.c;D<=x.e.c;++D)if(!(H[D]||{}).hidden)switch(b[D]=it(D),t=T?e[A][D]:e[b[D]+v],s){case 1:o[D]=D-x.s.c;break;case 2:o[D]=b[D];break;case 3:o[D]=m.header[D-x.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),f=d=tn(t,null,m),E=S[d]||0,!E)S[d]=1;else{do f=d+"_"+E++;while(S[f]);S[d]=E,S[f]=1}o[D]=f}for(A=x.s.r+i;A<=x.e.r;++A)if(!(V[A]||{}).hidden){var Y=JA(e,x,A,b,s,o,T,m);(Y.isempty===!1||(s===1?m.blankrows!==!1:m.blankrows))&&(_[y++]=Y.row)}return _.length=y,_}var yp=/"/g;function eN(e,n,t,s,i,o,d,f){for(var x=!0,m=[],g="",v=vt(t),b=n.s.c;b<=n.e.c;++b)if(s[b]){var _=f.dense?(e[t]||[])[b]:e[s[b]+v];if(_==null)g="";else if(_.v!=null){x=!1,g=""+(f.rawNumbers&&_.t=="n"?_.v:tn(_,null,f));for(var y=0,E=0;y!==g.length;++y)if((E=g.charCodeAt(y))===i||E===o||E===34||f.forceQuotes){g='"'+g.replace(yp,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(x=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(yp,'""')+'"')):g="";m.push(g)}return f.blankrows===!1&&x?null:m.join(d)}function s2(e,n){var t=[],s=n??{};if(e==null||e["!ref"]==null)return"";var i=Ya(e["!ref"]),o=s.FS!==void 0?s.FS:",",d=o.charCodeAt(0),f=s.RS!==void 0?s.RS:`
`,x=f.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),g="",v=[];s.dense=Array.isArray(e);for(var b=s.skipHidden&&e["!cols"]||[],_=s.skipHidden&&e["!rows"]||[],y=i.s.c;y<=i.e.c;++y)(b[y]||{}).hidden||(v[y]=it(y));for(var E=0,T=i.s.r;T<=i.e.r;++T)(_[T]||{}).hidden||(g=eN(e,i,T,v,d,x,o,s),g!=null&&(s.strip&&(g=g.replace(m,"")),(g||s.blankrows!==!1)&&t.push((E++?f:"")+g)));return delete s.dense,t.join("")}function aN(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=s2(e,n);return t}function tN(e){var n="",t,s="";if(e==null||e["!ref"]==null)return[];var i=Ya(e["!ref"]),o="",d=[],f,x=[],m=Array.isArray(e);for(f=i.s.c;f<=i.e.c;++f)d[f]=it(f);for(var g=i.s.r;g<=i.e.r;++g)for(o=vt(g),f=i.s.c;f<=i.e.c;++f)if(n=d[f]+o,t=m?(e[g]||[])[f]:e[n],s="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;s=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)s=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)s=""+t.v;else if(t.t=="b")s=t.v?"TRUE":"FALSE";else if(t.w!==void 0)s="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?s="'"+t.v:s=""+t.v}}x[x.length]=n+"="+s}return x}function i2(e,n,t){var s=t||{},i=+!s.skipHeader,o=e||{},d=0,f=0;if(o&&s.origin!=null)if(typeof s.origin=="number")d=s.origin;else{var x=typeof s.origin=="string"?Dt(s.origin):s.origin;d=x.r,f=x.c}var m,g={s:{c:0,r:0},e:{c:f,r:d+n.length-1+i}};if(o["!ref"]){var v=Ya(o["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),d==-1&&(d=v.e.r+1,g.e.r=d+n.length-1+i)}else d==-1&&(d=0,g.e.r=n.length-1+i);var b=s.header||[],_=0;n.forEach(function(E,T){Fr(E).forEach(function(A){(_=b.indexOf(A))==-1&&(b[_=b.length]=A);var D=E[A],S="z",H="",V=aa({c:f+_,r:d+T+i});m=Ml(o,V),D&&typeof D=="object"&&!(D instanceof Date)?o[V]=D:(typeof D=="number"?S="n":typeof D=="boolean"?S="b":typeof D=="string"?S="s":D instanceof Date?(S="d",s.cellDates||(S="n",D=jt(D)),H=s.dateNF||sa[14]):D===null&&s.nullError&&(S="e",D=0),m?(m.t=S,m.v=D,delete m.w,delete m.R,H&&(m.z=H)):o[V]=m={t:S,v:D},H&&(m.z=H))})}),g.e.c=Math.max(g.e.c,f+b.length-1);var y=vt(d);if(i)for(_=0;_<b.length;++_)o[it(_+f)+y]={t:"s",v:b[_]};return o["!ref"]=va(g),o}function rN(e,n){return i2(null,e,n)}function Ml(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var s=Dt(n);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Ml(e,aa(n)):Ml(e,aa({r:n,c:t||0}))}function nN(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Lf(){return{SheetNames:[],Sheets:{}}}function Mf(e,n,t,s){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var d=o&&o[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=d+i)!=-1;++i);}if(zS(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function sN(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=nN(e,n);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t}function iN(e,n){return e.z=n,e}function l2(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function lN(e,n,t){return l2(e,"#"+n,t)}function cN(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function oN(e,n,t,s){for(var i=typeof n!="string"?n:Ya(n),o=typeof n=="string"?n:va(n),d=i.s.r;d<=i.e.r;++d)for(var f=i.s.c;f<=i.e.c;++f){var x=Ml(e,d,f);x.t="n",x.F=o,delete x.v,d==i.s.r&&f==i.s.c&&(x.f=t,s&&(x.D=!0))}return e}var c2={encode_col:it,encode_row:vt,encode_cell:aa,encode_range:va,decode_col:Ef,decode_row:yf,split_cell:EE,decode_cell:Dt,decode_range:pi,format_cell:tn,sheet_add_aoa:fg,sheet_add_json:i2,sheet_add_dom:a2,aoa_to_sheet:gi,json_to_sheet:rN,table_to_sheet:t2,table_to_book:AA,sheet_to_csv:s2,sheet_to_txt:aN,sheet_to_json:nf,sheet_to_html:SA,sheet_to_formulae:tN,sheet_to_row_object_array:nf,sheet_get_cell:Ml,book_new:Lf,book_append_sheet:Mf,book_set_sheet_visibility:sN,cell_set_number_format:iN,cell_set_hyperlink:l2,cell_set_internal_link:lN,cell_add_comment:cN,sheet_set_array_formula:oN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const jr=e=>e.toLowerCase().trim(),Ke=e=>{if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){const n=e.replace(/[€$]/g,"").trim().replace(/\./g,"").replace(/,/g,"."),t=parseFloat(n);return isNaN(t)?0:t}return 0},uN=e=>{if(!e||typeof e!="string")return null;const n=e.split("/");if(n.length===3)return new Date(`${n[2]}-${n[1]}-${n[0]}`);const t=new Date(e);return isNaN(t.getTime())?null:t},fN={"nombre de la campaña":"campaignName","nombre del conjunto de anuncios":"adSetName","nombre del anuncio":"adName",día:"day",edad:"age",sexo:"gender","importe gastado (eur)":"spend","entrega de la campaña":"campaignDelivery","entrega del conjunto de anuncios":"adSetDelivery","entrega del anuncio":"adDelivery",impresiones:"impressions",alcance:"reach",frecuencia:"frequency",compras:"purchases","visitas a la página de destino":"landingPageViews","clics (todos)":"clicksAll","cpm (costo por mil impresiones)":"cpm","ctr (todos)":"ctrAll","cpc (todos)":"cpcAll","reproducciones de video de 3 segundos":"videoPlays3s","pagos iniciados":"checkoutsInitiated","me gusta en facebook":"pageLikes","artículos agregados al carrito":"addsToCart","pagos iniciados en el sitio web":"checkoutsInitiatedOnWebsite","presupuesto de la campaña":"campaignBudget","tipo de presupuesto de la campaña":"campaignBudgetType","públicos personalizados incluidos":"includedCustomAudiences","públicos personalizados excluidos":"excludedCustomAudiences","clics en el enlace":"linkClicks","información de pago agregada":"paymentInfoAdds","interacción con la página":"pageEngagement","comentarios de publicaciones":"postComments","interacciones con la publicación":"postInteractions","reacciones a publicaciones":"postReactions","veces que se compartieron las publicaciones":"postShares",puja:"bid","tipo de puja":"bidType","url del sitio web":"websiteUrl","ctr (porcentaje de clics en el enlace)":"ctrLink",divisa:"currency","valor de conversión de compras":"purchaseValue",objetivo:"objective","tipo de compra":"purchaseType","inicio del informe":"reportStart","fin del informe":"reportEnd",atencion:"attention",deseo:"desire",interes:"interest","reproducciones de video hasta el 25%":"videoPlays25percent","reproducciones de video hasta el 50%":"videoPlays50percent","reproducciones de video hasta el 75%":"videoPlays75percent","reproducciones de video hasta el 95%":"videoPlays95percent","reproducciones de video hasta el 100%":"videoPlays100percent","porcentaje de reproducciones de video de 3 segundos por impresiones":"videoPlayRate3s",aov:"aov","lp view rate":"lpViewRate","adc – lpv":"adcToLpv","captura de video":"videoCapture","captura video":"videoCapture","tasa de conversión de landing":"landingConversionRate","% compras":"percentPurchases",visualizaciones:"visualizations","cvr(link click)":"cvrLinkClick","retencion video":"videoRetentionProprietary","retención de video":"videoRetentionMeta","tiempo promedio de reproducción del video":"videoAveragePlayTime",thruplays:"thruPlays","reproducciones de video":"videoPlays","reproducciones de video continuas de 2 segundos únicas":"videoPlays2sContinuousUnique","ctr único (porcentaje de clics en el enlace)":"ctrUniqueLink","nombre de la cuenta":"accountName","impresiones/compras":"impressionsPerPurchase","nombre del video":"videoFileName","imagen, video y presentación":"creativeIdentifier","porcentaje de compras por visitas a la página de destino":"purchaseRateFromLandingPageViews","nombre de la imagen":"imageName","campaign name":"campaignName","ad set name":"adSetName","ad name":"adName",day:"day",age:"age",gender:"gender","amount spent (eur)":"spend","campaign delivery":"campaignDelivery","ad set delivery":"adSetDelivery","ad delivery":"adDelivery",impressions:"impressions",reach:"reach",frequency:"frequency",purchases:"purchases","landing page views":"landingPageViews","clicks (all)":"clicksAll","cpm (cost per 1,000 impressions)":"cpm","ctr (all)":"ctrAll","cpc (all)":"cpcAll","3-second video plays":"videoPlays3s","checkouts initiated":"checkoutsInitiated","page likes":"pageLikes","adds to cart":"addsToCart","checkouts initiated on website":"checkoutsInitiatedOnWebsite","campaign budget":"campaignBudget","campaign budget type":"campaignBudgetType","included custom audiences":"includedCustomAudiences","excluded custom audiences":"excludedCustomAudiences","link clicks":"linkClicks","payment info adds":"paymentInfoAdds","page engagement":"pageEngagement","post comments":"postComments","post interactions":"postInteractions","post reactions":"postReactions","post shares":"postShares",bid:"bid","bid type":"bidType","website url":"websiteUrl","ctr (link click-through rate)":"ctrLink",currency:"currency","purchase conversion value":"purchaseValue",objective:"objective","purchase type":"purchaseType","reporting starts":"reportStart","reporting ends":"reportEnd",attention:"attention",desire:"desire",interest:"interest","video plays at 25%":"videoPlays25percent","video plays at 50%":"videoPlays50percent","video plays at 75%":"videoPlays75percent","video plays at 95%":"videoPlays95percent","video plays at 100%":"videoPlays100percent","3-second video play rate":"videoPlayRate3s","video capture":"videoCapture","landing page conversion rate":"landingConversionRate","% purchases":"percentPurchases","cvr (link click)":"cvrLinkClick","video retention (proprietary)":"videoRetentionProprietary","video retention (meta)":"videoRetentionMeta","average video play time":"videoAveragePlayTime","video plays":"videoPlays","2-second continuous video plays (unique)":"videoPlays2sContinuousUnique","unique ctr (link click-through rate)":"ctrUniqueLink","account name":"accountName","impressions/purchases":"impressionsPerPurchase","video file name":"videoFileName","image name":"imageName","creative asset":"creativeIdentifier"},Ep=["nombre de la cuenta","account name","nombre del anuncio","ad name","día","day"],dN=["nombre de la cuenta","account name","nombre del anuncio","ad name","ad creative thumbnail url"],_p=async(e,n,t,s=!1)=>{const i=await e.arrayBuffer(),o=y0(i),d=o.SheetNames[0],f=o.Sheets[d],x=c2.sheet_to_json(f);if(x.length===0)throw new Error("El archivo de Looker está vacío o tiene un formato no válido.");const m=Object.keys(x[0]).map(jr);if(!dN.some(V=>m.includes(V)))throw new Error("Columnas requeridas para Looker no encontradas. Asegúrate de que el reporte es correcto.");const v=m.find(V=>V==="nombre de la cuenta"||V==="account name");if(!v)throw new Error("Columna de nombre de cuenta no encontrada en el archivo de Looker.");const b=Object.keys(x[0]),_=b.find(V=>jr(V)===v),y=[...new Set(x.map(V=>V[_]))].filter(V=>V&&typeof V=="string"&&V.trim()!==""),E=y.filter(V=>!n.some(Y=>Y.metaAccountName===V||Y.name===V));if(s)return{newAccountNames:E};if(E.length>0)throw new Error(`Nuevas cuentas encontradas en archivo de Looker: ${E.join(", ")}. Por favor, créalas primero.`);const T=[],A=y.filter(V=>n.some(Y=>Y.metaAccountName===V||Y.name===V)),D=b.find(V=>jr(V)==="nombre del anuncio"||jr(V)==="ad name"),S=b.find(V=>jr(V)==="ad creative thumbnail url"),H=b.find(V=>jr(V)==="ad preview link");for(const V of A){const Y=n.find(q=>q.metaAccountName===V||q.name===V),j=x.filter(q=>q[_]===V),J=t[Y.id]||{},z={},ie=[];let K=0;j.forEach(q=>{const re=q[D],pe=q[S];re&&pe&&!J[re]&&(z[re]={imageUrl:pe,adPreviewLink:H?q[H]:void 0},ie.push(re),K++)}),K>0&&T.push({client:Y,lookerDataPatch:z,undoKeys:ie,newRecordsCount:K})}return T},sf=async(e,n,t,s,i=!1)=>{let o;if(e instanceof File){const A=await e.arrayBuffer(),D=y0(A),S=D.SheetNames[0],H=D.Sheets[S];o=c2.sheet_to_json(H)}else o=e;if(o.length===0)throw new Error("El archivo está vacío o tiene un formato no válido.");const d=Object.keys(o[0]).map(jr);if(!Ep.some(A=>d.includes(A)))throw new Error(`Columnas requeridas no encontradas. Asegúrate de que el reporte es correcto. Faltan: ${Ep.join(", ")}`);const x=d.find(A=>A==="nombre de la cuenta"||A==="account name");if(!x)throw new Error("Columna 'Nombre de la cuenta' o 'Account name' no encontrada.");const m=d.find(A=>A==="día"||A==="day");if(!m)throw new Error("Columna 'Día' o 'Day' no encontrada.");const g=Object.keys(o[0]),v=g.find(A=>jr(A)===x);g.find(A=>jr(A)===m);const b=[...new Set(o.map(A=>A[v]))].filter(A=>A&&typeof A=="string"&&A.trim()!==""),_=b.filter(A=>!n.some(D=>D.metaAccountName===A));if(i)return{newAccountNames:_};if(_.length>0)throw new Error(`Nuevas cuentas encontradas: ${_.join(", ")}. Por favor, créalas primero.`);const y=[],E=b.filter(A=>n.some(D=>D.metaAccountName===A));if(E.length===0)throw new Error("Ninguna de las cuentas en el archivo está registrada en el sistema.");const T=d.reduce((A,D)=>{const S=fN[D];return S&&(A[D]=S),A},{});for(const A of E){const D=n.find(K=>K.metaAccountName===A),S=o.filter(K=>K[v]===A),H=new Set((t[D.id]||[]).map(K=>K.uniqueId)),V=[],Y=[],j=new Set;S.forEach(K=>{const q={clientId:D.id},re=g.reduce((Z,oe)=>(Z[jr(oe)]=K[oe],Z),{});Object.keys(T).forEach(Z=>{const oe=T[Z];oe&&(q[oe]=re[Z])});const pe=q,Ae=`${pe.day}_${pe.campaignName}_${pe.adName}_${pe.age}_${pe.gender}`;if(!H.has(Ae)){const Z={...pe,uniqueId:Ae,spend:Ke(pe.spend),impressions:Ke(pe.impressions),reach:Ke(pe.reach),frequency:Ke(pe.frequency),purchases:Ke(pe.purchases),landingPageViews:Ke(pe.landingPageViews),clicksAll:Ke(pe.clicksAll),cpm:Ke(pe.cpm),ctrAll:Ke(pe.ctrAll),cpcAll:Ke(pe.cpcAll),videoPlays3s:Ke(pe.videoPlays3s),checkoutsInitiated:Ke(pe.checkoutsInitiated),pageLikes:Ke(pe.pageLikes),addsToCart:Ke(pe.addsToCart),checkoutsInitiatedOnWebsite:Ke(pe.checkoutsInitiatedOnWebsite),linkClicks:Ke(pe.linkClicks),paymentInfoAdds:Ke(pe.paymentInfoAdds),pageEngagement:Ke(pe.pageEngagement),postComments:Ke(pe.postComments),postInteractions:Ke(pe.postInteractions),postReactions:Ke(pe.postReactions),postShares:Ke(pe.postShares),ctrLink:Ke(pe.ctrLink),purchaseValue:Ke(pe.purchaseValue),attention:Ke(pe.attention),desire:Ke(pe.desire),interest:Ke(pe.interest),videoPlays25percent:Ke(pe.videoPlays25percent),videoPlays50percent:Ke(pe.videoPlays50percent),videoPlays75percent:Ke(pe.videoPlays75percent),videoPlays95percent:Ke(pe.videoPlays95percent),videoPlays100percent:Ke(pe.videoPlays100percent),videoPlayRate3s:Ke(pe.videoPlayRate3s),aov:Ke(pe.aov),lpViewRate:Ke(pe.lpViewRate),adcToLpv:Ke(pe.adcToLpv),landingConversionRate:Ke(pe.landingConversionRate),percentPurchases:Ke(pe.percentPurchases),visualizations:Ke(pe.visualizations),cvrLinkClick:Ke(pe.cvrLinkClick),videoRetentionProprietary:Ke(pe.videoRetentionProprietary),videoRetentionMeta:Ke(pe.videoRetentionMeta),videoAveragePlayTime:Ke(pe.videoAveragePlayTime),thruPlays:Ke(pe.thruPlays),videoPlays:Ke(pe.videoPlays),videoPlays2sContinuousUnique:Ke(pe.videoPlays2sContinuousUnique),ctrUniqueLink:Ke(pe.ctrUniqueLink),impressionsPerPurchase:Ke(pe.impressionsPerPurchase),purchaseRateFromLandingPageViews:Ke(pe.purchaseRateFromLandingPageViews)};V.push(Z),Y.push(Ae),j.add(pe.day)}});const J=V.map(K=>uN(K.day)).filter(K=>K!==null),z=J.length>0?new Date(Math.min(...J.map(K=>K.getTime()))).toISOString().split("T")[0]:void 0,ie=J.length>0?new Date(Math.max(...J.map(K=>K.getTime()))).toISOString().split("T")[0]:void 0;V.length>0&&y.push({client:D,records:V,undoKeys:Y,newRecordsCount:V.length,periodStart:z,periodEnd:ie,daysDetected:j.size})}return y},Xu=async e=>{const n=await e.arrayBuffer(),t=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")},qu=({title:e,description:n,icon:t,onButtonClick:s,buttonText:i,disabled:o})=>u.jsxs("div",{className:"bg-brand-border/30 rounded-lg p-6 flex flex-col items-start justify-between",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[u.jsx("div",{className:"text-brand-primary",children:t}),u.jsx("h3",{className:"text-lg font-bold text-brand-text",children:e})]}),u.jsx("p",{className:"text-sm text-brand-text-secondary mb-4",children:n})]}),u.jsx("button",{onClick:s,disabled:o,className:"w-full bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i})]}),hN=({clients:e,setClients:n,lookerData:t,setLookerData:s,performanceData:i,setPerformanceData:o,bitacoraReports:d,setBitacoraReports:f,onSyncFromMeta:x,metaApiConfig:m,currentUser:g})=>{const[v,b]=ue.useState(!1),[_,y]=ue.useState(null),[E,T]=ue.useState(!1),[A,D]=ue.useState(!1),[S,H]=ue.useState(!1),[V,Y]=ue.useState([]),[j,J]=ue.useState(null),[z,ie]=ue.useState(null),[K,q]=ue.useState([]),re=ue.useRef(null),pe=ue.useRef(null),Ae=ue.useRef(null);ue.useEffect(()=>{ta.getImportHistory().then(R=>{q(R.sort((W,me)=>new Date(me.timestamp).getTime()-new Date(W.timestamp).getTime()))})},[]);const Z=async R=>{const W={...R,id:crypto.randomUUID(),timestamp:new Date().toISOString()};q(me=>[W,...me]),await ta.saveImportHistory([W,...K])},oe=async(R,W,me)=>{const ve=await Xu(R),Te=await ta.getProcessedHashes();if(Object.values(Te).flat().includes(ve))throw new Error(`Este archivo (${R.name}) ya ha sido importado previamente.`);const Ee=await sf(R,me,i,W,!1);o(we=>{const Fe={...we};return Ee.forEach(({client:la,records:Ge})=>{Fe[la.id]=[...Fe[la.id]||[],...Ge],console.log(`[IMPORT] Added ${Ge.length} records for client ${la.name} (${la.id})`)}),console.log("[IMPORT] New performance data structure:",Object.keys(Fe).map(la=>`${la}: ${Fe[la].length} records`)),Fe});const Be=Ee.reduce((we,Fe)=>we+Fe.newRecordsCount,0);if(Be===0){y({type:"info",message:"Importación completada. No se encontraron filas nuevas."});return}const I=Ee.map(we=>we.client.name).join(", "),Pe=Ee.map(we=>we.periodStart).filter(Boolean),Ue=Ee.map(we=>we.periodEnd).filter(Boolean),We=Ee.reduce((we,Fe)=>we+(Fe.daysDetected||0),0),Ve=Pe.length>0?new Date(Math.min(...Pe.map(we=>new Date(we).getTime()))):null,ge=Ue.length>0?new Date(Math.max(...Ue.map(we=>new Date(we).getTime()))):null;let Ie="";Ve&&ge&&(Ie=` Período detectado: ${Ve.toLocaleDateString("es-ES")} - ${ge.toLocaleDateString("es-ES")} (${We} días).`),y({type:"success",message:`Importación completada. ${Be} nuevas filas añadidas para: ${I}.${Ie}`});const ma={...Te};for(const we of Ee)we.newRecordsCount>0&&(await Z({source:W,fileName:R.name,fileHash:ve,clientName:we.client.name,description:`${we.newRecordsCount} filas de rendimiento añadidas`,undoData:{type:"meta",keys:we.undoKeys,clientId:we.client.id}}),ma[we.client.id]=[...ma[we.client.id]||[],ve]);await ta.saveProcessedHashes(ma)},Re=async(R,W)=>{const me=await Xu(R),ve=await ta.getProcessedHashes();if(Object.values(ve).flat().includes(me))throw new Error(`Este archivo (${R.name}) ya ha sido importado previamente.`);const Te=await _p(R,W,t,!1);s(Pe=>{const Ue=JSON.parse(JSON.stringify(Pe));return Te.forEach(({client:We,lookerDataPatch:Ve})=>{Ue[We.id]||(Ue[We.id]={}),Object.assign(Ue[We.id],Ve)}),Ue});const Ee=Te.reduce((Pe,Ue)=>Pe+Ue.newRecordsCount,0);if(Ee===0){y({type:"info",message:"Importación de Looker completada. No se encontraron creativos nuevos."});return}const Be=Te.map(Pe=>Pe.client.name).join(", ");y({type:"success",message:`Importación de Looker completada. ${Ee} nuevos creativos vinculados para: ${Be}.`});const I={...ve};for(const Pe of Te)Pe.newRecordsCount>0&&(await Z({source:"looker",fileName:R.name,fileHash:me,clientName:Pe.client.name,description:`${Pe.newRecordsCount} creativos vinculados`,undoData:{type:"looker",keys:Pe.undoKeys,clientId:Pe.client.id}}),I[Pe.client.id]=[...I[Pe.client.id]||[],me]);await ta.saveProcessedHashes(I)},ee=(R,W)=>{var ve;const me=(ve=R.target.files)==null?void 0:ve[0];me&&(W==="txt"?ce(me):P(me,W),R.target.value="")},P=async(R,W)=>{b(!0),y({type:"info",message:`Procesando reporte de ${W}...`});try{if(W==="looker"){const me=await _p(R,e,t,!0);"newAccountNames"in me&&me.newAccountNames.length>0?(Y(me.newAccountNames),J({file:R,source:W}),T(!0)):await Re(R,e)}else{const me=await sf(R,e,i,W,!0);"newAccountNames"in me&&me.newAccountNames.length>0?(Y(me.newAccountNames),J({file:R,source:W}),T(!0)):await oe(R,W,e)}}catch(me){const ve=me instanceof Error?me.message:"Error inesperado.";y({type:"error",message:ve})}finally{b(!1)}},ce=async R=>{try{const W=await R.text();ie({content:W,file:R}),D(!0)}catch{y({type:"error",message:"Error al leer el archivo TXT."})}},C=async R=>{var W;if(z){D(!1),b(!0),y({type:"info",message:"Analizando y guardando reporte Bitácora..."});try{const me=e.find(Ue=>Ue.id===R);if(!me)throw new Error("Cliente no encontrado");const ve=await Xu(z.file),Te=await ta.getProcessedHashes();if((W=Te[R])!=null&&W.includes(ve))throw new Error(`Este archivo (${z.file.name}) ya ha sido importado para este cliente.`);const Ee=ly(z.content),Be=crypto.randomUUID(),I={...Ee,id:Be,clientId:R,fileName:z.file.name,importDate:new Date().toISOString()};f([...d,I]),y({type:"success",message:`Reporte "${z.file.name}" importado con éxito.`}),await Z({source:"txt",fileName:z.file.name,fileHash:ve,clientName:me.name,description:"Reporte de bitácora añadido",undoData:{type:"txt",keys:[Be],clientId:R}});const Pe={...Te};Pe[R]=[...Pe[R]||[],ve],await ta.saveProcessedHashes(Pe)}catch(me){const ve=me instanceof Error?me.message:"Error desconocido.";y({type:"error",message:`Error al procesar el reporte TXT: ${ve}`})}finally{b(!1),ie(null)}}},X=async R=>{const W=R.map(ve=>({id:crypto.randomUUID(),name:ve,logo:`https://avatar.vercel.sh/${encodeURIComponent(ve)}.png?text=${encodeURIComponent(ve.charAt(0))}`,currency:"EUR",userId:g.id,metaAccountName:ve})),me=[...e,...W];if(n(me),T(!1),Je.info(`Created ${W.length} new clients from import.`),j)try{j.source==="looker"?await Re(j.file,me):await oe(j.file,j.source,me)}catch(ve){const Te=ve instanceof Error?ve.message:"Error inesperado.";y({type:"error",message:Te})}finally{J(null)}},U=R=>{var W;return(W=R.current)==null?void 0:W.click()};return u.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg space-y-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Centro de Importación de Datos"}),_&&u.jsx("div",{className:`p-4 rounded-md text-sm font-semibold ${_.type==="success"?"bg-green-500/20 text-green-300":_.type==="error"?"bg-red-500/20 text-red-300":"bg-blue-500/20 text-blue-300"}`,children:_.message}),u.jsx("input",{type:"file",ref:re,onChange:R=>ee(R,"looker"),accept:".xlsx",className:"hidden"}),u.jsx("input",{type:"file",ref:pe,onChange:R=>ee(R,"meta"),accept:".xlsx",className:"hidden"}),u.jsx("input",{type:"file",ref:Ae,onChange:R=>ee(R,"txt"),accept:".txt",className:"hidden"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(qu,{title:"Rendimiento (Meta)",description:"Sube el XLSX exportado desde Meta Ads para importar los datos de rendimiento de las campañas.",icon:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M5 11a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z"}),u.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V3zm2 5a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm-1 5a1 1 0 00-1 1v2a1 1 0 001 1h12a1 1 0 001-1v-2a1 1 0 00-1-1H4z",clipRule:"evenodd"})]}),onButtonClick:()=>U(pe),buttonText:"Subir XLSX de Meta",disabled:v}),u.jsx(qu,{title:"Creativos (Looker)",description:"Sube el XLSX de Looker Studio con los nombres de anuncios y las URLs de los creativos para vincularlos.",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),onButtonClick:()=>U(re),buttonText:"Subir XLSX de Looker",disabled:v}),u.jsx(qu,{title:"Reporte Bitácora (TXT)",description:"Sube un reporte de bitácora en formato TXT para un análisis semanal o mensual detallado.",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),onButtonClick:()=>U(Ae),buttonText:"Subir TXT de Bitácora",disabled:v})]}),u.jsxs("div",{className:"border-t border-brand-border pt-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-2",children:"Sincronización API"}),u.jsx("p",{className:"text-sm text-brand-text-secondary mb-4",children:'Sincroniza datos directamente desde la API de Meta para los clientes que tengan un "Nombre de Cuenta de Meta" configurado.'}),u.jsx("button",{onClick:()=>H(!0),disabled:!m,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:m?"Sincronizar cliente":"Configura la API de Meta en la pestaña de Configuración",children:"Sincronizar desde Meta API"})]})]}),u.jsx(sy,{isOpen:E,onClose:()=>T(!1),newAccountNames:V,onConfirm:X}),u.jsx(Ku,{isOpen:A,onClose:()=>D(!1),clients:e,onClientSelect:C,title:"Seleccionar Cliente para Reporte TXT",description:"Elige a qué cliente pertenece este reporte de Bitácora."}),u.jsx(Ku,{isOpen:S,onClose:()=>H(!1),clients:e.filter(R=>R.metaAccountName),onClientSelect:x,title:"Seleccionar Cliente para Sincronizar",description:"Elige qué cliente quieres sincronizar desde la API de Meta."}),u.jsx(cy,{history:K,setHistory:q,setLookerData:s})]})},dl=({title:e,children:n,defaultOpen:t=!1})=>{const[s,i]=ue.useState(t);return u.jsxs("div",{className:"border-b border-brand-border",children:[u.jsxs("button",{className:"flex justify-between items-center w-full py-5 text-left text-brand-text",onClick:()=>i(!s),"aria-expanded":s,children:[u.jsx("span",{className:"text-lg font-semibold",children:e}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transform transition-transform duration-300 ${s?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&u.jsx("div",{className:"pb-5 pr-4 pl-2 text-brand-text-secondary space-y-4 leading-relaxed",children:n})]})},xN=()=>{const e=({children:f})=>u.jsx("p",{children:f}),n=({children:f})=>u.jsx("h3",{className:"text-lg font-semibold text-brand-text mt-4 mb-2",children:f}),t=({children:f})=>u.jsx("ul",{className:"list-disc list-outside ml-5 space-y-2",children:f}),s=({children:f})=>u.jsx("ol",{className:"list-decimal list-outside ml-5 space-y-2",children:f}),i=({children:f})=>u.jsx("li",{children:f}),o=({children:f})=>u.jsx("strong",{className:"font-semibold text-brand-text",children:f}),d=({children:f})=>u.jsx("code",{className:"bg-brand-bg text-yellow-300 font-mono text-sm px-1.5 py-1 rounded-md",children:f});return u.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-8 shadow-lg animate-fade-in",children:[u.jsx("h2",{className:"text-3xl font-bold text-brand-text mb-2",children:"Centro de Ayuda"}),u.jsx("p",{className:"text-brand-text-secondary mb-8",children:"Encuentra respuestas a preguntas comunes y guías para usar la aplicación."}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs(dl,{title:"1. Primeros Pasos",defaultOpen:!0,children:[u.jsx(e,{children:"Para empezar a usar la aplicación, sigue estos pasos iniciales:"}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Configurar la Base de Datos:"})," Ve a la pestaña ",u.jsx(d,{children:"Configuración"}),". La app usa una base de datos simulada en tu navegador (LocalStorage). Los datos de conexión vienen pre-rellenados. Solo tienes que hacer clic en ",u.jsx(o,{children:'"Probar y Guardar Conexión"'}),". Si la conexión es exitosa, el indicador de estado en la barra de navegación cambiará a verde."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Iniciar Sesión:"})," La primera vez que uses la app, no habrá usuarios. Inicia sesión con el usuario por defecto: ",u.jsx(d,{children:"Admin"})," y contraseña ",u.jsx(d,{children:"Admin"}),". Una vez dentro, se recomienda ir a la pestaña ",u.jsx(d,{children:"Usuarios"})," y cambiar la contraseña."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Crear un Cliente:"})," Antes de analizar un creativo, debes tener al menos un cliente. Ve a la pestaña ",u.jsx(d,{children:"Clientes"})," y haz clic en ",u.jsx(o,{children:'"Añadir Cliente"'}),". Rellena el nombre, la moneda de su cuenta publicitaria y, opcionalmente, un logo."]})]})]}),u.jsxs(dl,{title:"2. Cómo Analizar Creativos",children:[u.jsx(e,{children:"El núcleo de la aplicación es el análisis de creativos mediante IA. El flujo de trabajo es el siguiente:"}),u.jsxs(s,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Subir Creativo:"})," En la vista principal (",u.jsx(d,{children:"Análisis de Creativos"}),"), arrastra y suelta una imagen o video, o haz clic para seleccionarlo."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Asignar Cliente:"})," Se te pedirá que asignes el creativo a uno de tus clientes. Esto es crucial para mantener los análisis organizados y usar el historial del cliente como contexto para la IA."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Seleccionar Formato:"})," Una vez asignado, deberás elegir un grupo de formatos para el análisis: ",u.jsx(d,{children:"Formatos Cuadrados/Rectangulares"})," (para Feeds, etc.) o ",u.jsx(d,{children:"Formatos Verticales"})," (para Stories, Reels)."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Interpretar el Análisis:"})," La IA generará un reporte completo que incluye:",u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Puntuaciones:"})," Efectividad y Claridad para una evaluación rápida."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Zonas de Riesgo:"})," Una vista previa que muestra las áreas donde la interfaz de Meta podría tapar elementos clave de tu creativo."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Recomendaciones:"})," Consejos específicos para mejorar el rendimiento del anuncio."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Análisis Advantage+:"})," Sugerencias sobre qué mejoras automáticas de Meta activar."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Conclusión:"})," Un resumen accionable con los puntos más importantes."]})]})]})]})]}),u.jsxs(dl,{title:"3. Gestión de Rendimiento (Importar XLSX)",children:[u.jsx(e,{children:"Puedes cruzar los análisis cualitativos de la IA con datos cuantitativos de tus reportes de Meta Ads."}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Importar Reporte (Admin):"})," En la pestaña ",u.jsx(d,{children:"Importar"}),", sube el archivo XLSX que contiene el rendimiento de todas tus campañas. El sistema procesará los datos y los guardará en la base de datos simulada."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Vinculación de Datos:"})," La aplicación intenta vincular cada fila del reporte con un creativo analizado previamente. La vinculación se realiza mediante una estrategia robusta en varios pasos:",u.jsxs(s,{children:[u.jsxs(i,{children:["Busca si el nombre del archivo original (ej: ",u.jsx(d,{children:"mi_creativo.png"}),") está contenido en el campo ",u.jsx(d,{children:'"Imagen, video y presentación"'})," del reporte."]}),u.jsxs(i,{children:['Si no hay coincidencia, compara una versión "limpia" del nombre del archivo con el campo ',u.jsx(d,{children:'"Nombre de la imagen"'}),"."]}),u.jsxs(i,{children:["Como último recurso, busca el ",u.jsx(d,{children:'"Identificador de la imagen"'})," del reporte dentro del nombre del archivo original."]})]})]}),u.jsxs(i,{children:[u.jsx(o,{children:"Ver Rendimiento:"})," En la pestaña ",u.jsx(d,{children:"Rendimiento"}),", puedes ver un resumen por cliente. Al hacer clic en un cliente, verás una tabla o tarjetas con el rendimiento de cada anuncio. Los anuncios vinculados a un análisis de IA se marcarán con un ícono especial."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Conclusión de IA:"})," En la vista de detalle de un cliente, puedes solicitar una conclusión estratégica de la IA, que analizará los anuncios vinculados y te dará recomendaciones basadas en los que tuvieron mejor y peor rendimiento."]})]})]}),u.jsxs(dl,{title:"4. Análisis Estratégico Integral (NUEVO)",children:[u.jsx(e,{children:"La funcionalidad más avanzada que combina el análisis de creativos por IA con métricas de rendimiento para generar un plan de acción estratégico completo."}),u.jsx(n,{children:"📋 ¿Qué es el Análisis Estratégico Integral?"}),u.jsxs(e,{children:["Esta funcionalidad toma todos los creativos que ya analizaste con IA, los combina con los datos de rendimiento importados, y genera un ",u.jsx(o,{children:"plan estratégico completo"})," usando IA avanzada."]}),u.jsx(n,{children:"🎯 Requisitos Previos"}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Creativos Analizados:"}),' Debes tener creativos analizados por IA en la pestaña "Análisis de Creativos"']}),u.jsxs(i,{children:[u.jsx(o,{children:"Datos de Rendimiento:"})," Debes haber importado datos de rendimiento (archivos XLSX de Meta)"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Datos Vinculados:"})," Los creativos deben estar correctamente vinculados con los datos de rendimiento"]})]}),u.jsx(n,{children:"🚀 Cómo Usar"}),u.jsxs(s,{children:[u.jsxs(i,{children:[u.jsx(o,{children:'Ve a "Plan Estratégico"'})," en el menú principal"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Selecciona un Cliente:"})," Solo aparecerán clientes que tengan creativos analizados Y datos de rendimiento"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Selecciona Período:"})," Ajusta las fechas para el análisis"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Genera Análisis:"}),' Haz clic en "Generar Análisis Estratégico"']}),u.jsxs(i,{children:[u.jsx(o,{children:"Revisa el Plan:"})," La IA generará un plan completo con acciones priorizadas"]})]}),u.jsx(n,{children:"📊 ¿Qué Obtienes?"}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Resumen Ejecutivo:"})," Análisis holístico que conecta calidad de creativos con rendimiento real"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Plan de Acción:"})," 4-6 acciones estratégicas priorizadas (Alta/Media/Baja prioridad) con timelines e impacto esperado"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Insights por Creativo:"})," Conexión específica entre el análisis de IA y rendimiento de cada anuncio"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Recomendaciones de Rendimiento:"})," Categorizadas por Presupuesto, Targeting, Creativos, Pujas y Placements"]})]}),u.jsx(n,{children:"💡 Ejemplo de Análisis"}),u.jsx(e,{children:"La IA podría generar algo como:"}),u.jsx(e,{children:u.jsx(o,{children:`"Los creativos con puntuaciones de efectividad superiores a 70 están generando un ROAS 40% más alto. Recomiendo escalar el presupuesto del 'Summer Glow Campaign' en un 50% y optimizar los 2 creativos con problemas en zonas seguras para Stories."`})}),u.jsx(n,{children:"🎯 Casos de Uso"}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Reportes para Clientes:"})," Genera reportes ejecutivos completos"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Optimización Guiada:"})," Sigue un plan paso a paso basado en datos reales"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Priorización:"})," Entiende qué acciones tendrán mayor impacto"]}),u.jsxs(i,{children:[u.jsx(o,{children:"Correlaciones:"})," Descubre patrones entre calidad creativa y rendimiento"]})]})]}),u.jsxs(dl,{title:"5. Funciones de Administrador",children:[u.jsxs(e,{children:["Si tienes rol de ",u.jsx(o,{children:"Admin"}),", tienes acceso a vistas y funciones adicionales:"]}),u.jsxs(t,{children:[u.jsxs(i,{children:[u.jsx(o,{children:"Importar:"})," Permite subir el reporte maestro XLSX con datos de todas las cuentas."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Usuarios:"})," Permite crear, editar y eliminar usuarios de la aplicación."]}),u.jsxs(i,{children:[u.jsx(o,{children:"Panel de Control:"}),' Ofrece una vista de bajo nivel de la "base de datos". Puedes ver el estado de las "tablas", crearlas si es necesario, y realizar acciones de limpieza, como borrar todo el historial de análisis o resetear por completo los datos de la aplicación. ',u.jsx(o,{children:"Usa esta sección con cuidado."})]}),u.jsxs(i,{children:[u.jsx(o,{children:"Clientes:"})," Un administrador puede ver y gestionar los clientes de todos los usuarios, no solo los propios."]})]})]})]})]})},mN={INFO:"text-brand-text-secondary",SUCCESS:"text-green-400",WARNING:"text-yellow-400",ERROR:"text-red-400",DEBUG:"text-blue-400"},pN=()=>{const[e,n]=ue.useState(Je.getLogs()),t=ue.useRef(null);ue.useEffect(()=>{const i=d=>{n(f=>[...f,d])},o=Je.subscribe(i);return n(Je.getLogs()),()=>o()},[]),ue.useEffect(()=>{t.current&&(t.current.scrollTop=t.current.scrollHeight)},[e]);const s=()=>{Je.clear(),n([])};return u.jsxs("div",{className:"max-w-7xl mx-auto bg-brand-surface rounded-lg p-6 shadow-lg animate-fade-in",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"System Logs"}),u.jsxs("button",{onClick:s,className:"bg-brand-border hover:bg-brand-border/70 text-brand-text font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Clear Logs"]})]}),u.jsx("div",{ref:t,className:"bg-brand-bg p-4 rounded-md font-mono text-xs h-96 overflow-y-auto w-full",children:e.map((i,o)=>u.jsxs("div",{className:`flex gap-4 items-start whitespace-pre-wrap border-b border-brand-border/20 py-1 ${mN[i.level]}`,children:[u.jsx("span",{className:"flex-shrink-0 font-semibold",children:i.timestamp.toLocaleTimeString()}),u.jsx("p",{className:"flex-grow",children:i.message})]},o))})]})},gN=e=>{if(!e)return null;const n=e.split("/");if(n.length===3){const[s,i,o]=n.map(Number);return new Date(o,i-1,s)}const t=new Date(e);return isNaN(t.getTime())?null:t},vN=({card:e})=>{const[n,t]=ue.useState(!1);return u.jsxs("div",{className:"bg-brand-border/30 rounded-lg p-5 transition-all duration-300",children:[u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"text-lg font-bold text-brand-text",children:e.title}),u.jsx("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2",children:e.supportingMetrics.map(s=>u.jsxs("div",{children:[u.jsx("span",{className:"text-xs text-brand-text-secondary uppercase tracking-wider",children:s.metricName}),u.jsx("p",{className:"text-brand-primary font-bold text-lg",children:s.value})]},s.metricName))})]}),u.jsxs("button",{onClick:()=>t(!n),className:"flex-shrink-0 bg-brand-border hover:bg-brand-bg text-brand-text-secondary font-semibold py-2 px-3 rounded-md text-sm transition-colors flex items-center gap-2",children:[n?"Ocultar":"Ver Explicación",u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transform transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),n&&u.jsxs("div",{className:"mt-4 pt-4 border-t border-brand-border/50 space-y-4 animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Explicación del Hallazgo"}),u.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.explanation})]}),e.fatigueAnalysis&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Análisis de Fatiga"}),u.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.fatigueAnalysis})]}),e.demographicInsights&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-brand-text mb-1",children:"Insights Demográficos"}),u.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.demographicInsights})]}),u.jsxs("div",{className:"bg-brand-primary/10 p-3 rounded-md",children:[u.jsx("h4",{className:"font-semibold text-brand-primary mb-1",children:"Plan de Acción Recomendado"}),u.jsx("p",{className:"text-brand-text-secondary text-sm leading-relaxed",children:e.recommendation})]})]})]})},bN=()=>u.jsx("div",{className:"space-y-4 animate-pulse",children:[...Array(3)].map((e,n)=>u.jsx("div",{className:"bg-brand-border/30 rounded-lg p-5",children:u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-5 bg-brand-border rounded-md w-3/4"}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"h-8 bg-brand-border rounded-md w-1/4"}),u.jsx("div",{className:"h-8 bg-brand-border rounded-md w-1/4"})]})]}),u.jsx("div",{className:"h-9 w-32 bg-brand-border rounded-md"})]})},n))}),yN=({clients:e,lookerData:n,getTrendsAnalysis:t,performanceData:s,startDate:i,endDate:o,onDateChange:d})=>{const[f,x]=ue.useState(""),[m,g]=ue.useState(!1),[v,b]=ue.useState(null);ue.useEffect(()=>{e.length>0&&!f&&x(e[0].id)},[e,f]);const _=async()=>{if(!f||!i||!o){alert("Por favor, selecciona un cliente y un rango de fechas.");return}g(!0),b(null),Je.info("Starting trends analysis",{selectedClientId:f,startDate:i,endDate:o});const y=e.find(K=>K.id===f);if(!y){g(!1);return}const E=n[y.id]||{},T=s[y.id]||[],A=new Date(i);A.setHours(0,0,0,0);const D=new Date(o);D.setHours(23,59,59,999);const S=T.filter(K=>{const q=gN(K.day);return q&&q>=A&&q<=D&&K.adDelivery.toLowerCase()==="active"&&K.impressions>0}),H=S.reduce((K,q)=>(q.adName&&(K[q.adName]||(K[q.adName]=[]),K[q.adName].push(q)),K),{}),Y=Object.entries(H).map(([K,q])=>{var Ve;const re=q.reduce((ge,Ie)=>{const ma=Ie.impressions||0;return ge.spend+=Ie.spend||0,ge.purchaseValue+=Ie.purchaseValue||0,ge.purchases+=Ie.purchases||0,ge.impressions+=ma,ge.clicks+=Ie.clicksAll||0,ge.linkClicks+=Ie.linkClicks||0,ge.thruPlays+=Ie.thruPlays||0,ge.frequencyTotal+=(Ie.frequency||0)*ma,(Ie.videoAveragePlayTime||0)>0&&ma>0&&(ge.videoAveragePlayTimeWeightedTotal+=(Ie.videoAveragePlayTime||0)*ma,ge.videoImpressions+=ma),ge.reach+=Ie.reach||0,ge.landingPageViews+=Ie.landingPageViews||0,ge.addsToCart+=Ie.addsToCart||0,ge.checkoutsInitiated+=Ie.checkoutsInitiated||0,ge.postInteractions+=Ie.postInteractions||0,ge.postReactions+=Ie.postReactions||0,ge.postComments+=Ie.postComments||0,ge.postShares+=Ie.postShares||0,ge.pageLikes+=Ie.pageLikes||0,ge.atencion+=Ie.attention||0,ge.interes+=Ie.interest||0,ge.deseo+=Ie.desire||0,ge},{spend:0,purchaseValue:0,purchases:0,impressions:0,clicks:0,linkClicks:0,thruPlays:0,videoAveragePlayTimeWeightedTotal:0,videoImpressions:0,frequencyTotal:0,landingPageViews:0,addsToCart:0,checkoutsInitiated:0,postInteractions:0,reach:0,atencion:0,interes:0,deseo:0,postReactions:0,postComments:0,postShares:0,pageLikes:0}),pe=T.filter(ge=>ge.adName===K),Ae=new Set;pe.forEach(ge=>{var Ie,ma,we;((Ie=ge.adDelivery)==null?void 0:Ie.toLowerCase())==="active"&&((ma=ge.adSetDelivery)==null?void 0:ma.toLowerCase())==="active"&&((we=ge.campaignDelivery)==null?void 0:we.toLowerCase())==="active"&&Ae.add(ge.day)});const Z=Ae.size,oe=[...new Set(pe.map(ge=>ge.adSetName))],Re=[...new Set(pe.map(ge=>ge.campaignName))],ee=[...new Set(pe.flatMap(ge=>{var Ie;return((Ie=ge.includedCustomAudiences)==null?void 0:Ie.split(",").map(ma=>ma.trim()))||[]}).filter(Boolean))],P=[...new Set(pe.flatMap(ge=>{var Ie;return((Ie=ge.excludedCustomAudiences)==null?void 0:Ie.split(",").map(ma=>ma.trim()))||[]}).filter(Boolean))],ce=re.spend>0?re.purchaseValue/re.spend:0,C=re.purchases>0?re.spend/re.purchases:0,X=re.impressions>0?re.spend/re.impressions*1e3:0,U=re.impressions>0?re.clicks/re.impressions*100:0,R=re.impressions>0?re.linkClicks/re.impressions*100:0,W=re.impressions>0?re.frequencyTotal/re.impressions:0,me=re.videoImpressions>0?re.videoAveragePlayTimeWeightedTotal/re.videoImpressions:0,ve=re.purchases>0?re.purchaseValue/re.purchases:0,Te=re.clicks>0?re.spend/re.clicks:0,Ee=re.linkClicks>0?re.landingPageViews/re.linkClicks*100:0,Be=re.landingPageViews>0?re.purchases/re.landingPageViews*100:0,I=E[K],Pe=new Set(q.map(ge=>ge.adSetName)).size>1,Ue=(Ve=q.find(ge=>ge.videoFileName))==null?void 0:Ve.videoFileName,We=!!Ue||q.some(ge=>ge.thruPlays>0)&&me>1;return{adName:K,adSetNames:oe,campaignNames:Re,includedCustomAudiences:ee,excludedCustomAudiences:P,spend:re.spend,purchases:re.purchases,purchaseValue:re.purchaseValue,impressions:re.impressions,clicks:re.clicks,linkClicks:re.linkClicks,roas:ce,cpa:C,cpm:X,ctr:U,ctrLink:R,frequency:W,videoAveragePlayTime:me,thruPlays:re.thruPlays,isMatched:!!I,creativeDescription:I==null?void 0:I.creativeDescription,currency:y.currency,inMultipleAdSets:Pe,imageUrl:I==null?void 0:I.imageUrl,adPreviewLink:I==null?void 0:I.adPreviewLink,creativeType:We?"video":"image",analysisResult:I==null?void 0:I.analysisResult,videoFileName:Ue,ticketPromedio:ve,alcance:re.reach,cpc:Te,visitasLP:re.landingPageViews,tasaVisitaLP:Ee,tasaCompra:Be,addsToCart:re.addsToCart,checkoutsInitiated:re.checkoutsInitiated,postInteractions:re.postInteractions,postReactions:re.postReactions,postComments:re.postComments,postShares:re.postShares,pageLikes:re.pageLikes,activeDays:Z,atencion:re.atencion,interes:re.interes,deseo:re.deseo,isVideoUploaded:!1,demographics:[],previousWeekMetrics:void 0}}).filter(K=>K.creativeDescription&&K.roas>1).sort((K,q)=>q.spend-K.spend).slice(0,7);if(Y.length===0){alert("No hay suficientes anuncios con buen rendimiento y análisis de IA en este período para generar un análisis de tendencias. Intenta con un rango de fechas más amplio o analiza más creativos."),g(!1);return}const j=new Set(Y.map(K=>K.adName)),J=S.filter(K=>j.has(K.adName)),z=`${new Date(i).toLocaleDateString("es-ES")} - ${new Date(o).toLocaleDateString("es-ES")}`,ie=await t(Y,y,z,J);b(ie),g(!1)};return u.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("header",{className:"text-center",children:[u.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Análisis de Tendencias y Estrategias"}),u.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Obtén una visión estratégica de la IA sobre qué está funcionando, por qué, y qué hacer a continuación."})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg flex flex-col md:flex-row items-center gap-6",children:[u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("label",{htmlFor:"client-selector",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Cliente"}),u.jsx("select",{id:"client-selector",value:f,onChange:y=>x(y.target.value),className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",children:e.map(y=>u.jsx("option",{value:y.id,children:y.name},y.id))})]}),u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("label",{className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Período"}),u.jsx(c0,{onDateChange:d,startDate:i,endDate:o})]}),u.jsx("div",{className:"w-full md:w-auto self-end",children:u.jsxs("button",{onClick:_,disabled:m||!f,className:"w-full bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),u.jsx("span",{children:m?"Analizando...":"Analizar Tendencias"})]})})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg min-h-[20rem]",children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text mb-6",children:"Resultados del Análisis Estratégico"}),m&&u.jsx(bN,{}),!m&&v&&(v.trends.length>0?u.jsx("div",{className:"space-y-4",children:v.trends.map((y,E)=>u.jsx(vN,{card:y},E))}):u.jsxs("div",{className:"text-center py-10",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Análisis completado sin resultados."}),u.jsx("p",{className:"text-brand-text-secondary",children:"La IA no pudo generar tendencias con los datos actuales. Prueba un rango de fechas diferente o con más anuncios analizados."})]})),!m&&!v&&u.jsxs("div",{className:"text-center py-10",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),u.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Listo para analizar"}),u.jsx("p",{className:"text-brand-text-secondary",children:'Configura el cliente y el período, y presiona "Analizar Tendencias" para empezar.'})]})]})]})},EN=({label:e,data:n,icon:t})=>{var o;if(!n)return null;let s="",i=null;if(typeof n=="object"&&"value"in n){const d={};if((o=n.symbol)!=null&&o.includes("€")?(d.style="currency",d.currency="EUR"):(d.minimumFractionDigits=2,d.maximumFractionDigits=2),s=n.value.toLocaleString("es-ES",d),n.symbol&&!n.symbol.includes("€")&&(s+=` ${n.symbol}`),n.change!==void 0&&n.direction&&n.direction!=="neutral"){const f=n.direction==="up",x=e.toLowerCase()==="cpa"?!f:f;i=u.jsxs("span",{className:`text-sm font-bold ${x?"text-green-300":"text-red-400"}`,children:[f?"▲":"▼"," ",(n.change*100).toFixed(1),"% vs sem. ant."]})}}else s=String(n);return u.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 flex flex-col justify-between shadow-lg hover:shadow-cyan-500/10 transition-shadow",children:[u.jsxs("div",{className:"flex items-center justify-between text-cyan-300",children:[u.jsx("p",{className:"text-sm font-semibold uppercase tracking-wider",children:e}),t]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-3xl font-bold text-white my-2",children:s}),u.jsx("div",{className:"h-5",children:i})]})]})},_N=({table:e})=>{const n=e.headers.find(i=>i.includes("Semana actual"))||e.headers[1];if(!n)return null;const t=e.rows.map(i=>{const o=i["Paso del Embudo"],d=i[n],f=typeof d=="object"?d.value:0;return{name:String(o),value:f}}).filter(i=>i.value>0);let s=0;return t.length>0&&(s=t[0].value),u.jsx("div",{className:"space-y-2",children:t.map((i,o)=>{const d=s>0?i.value/s*100:0;return u.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[u.jsx("div",{className:"w-40 text-right truncate text-cyan-200",children:i.name}),u.jsx("div",{className:"flex-1 bg-gray-700/50 rounded-full h-6",children:u.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-6 rounded-full flex items-center justify-end pr-2",style:{width:`${d}%`},children:u.jsx("span",{className:"font-bold text-white text-xs",children:i.value.toLocaleString("es-ES")})})})]},o)})})},Tp=({table:e,clientLookerData:n})=>u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-cyan-200",children:[u.jsx("thead",{className:"text-xs text-cyan-100 uppercase bg-white/5",children:u.jsx("tr",{children:e.headers.map(t=>u.jsx("th",{scope:"col",className:"px-4 py-3 whitespace-nowrap",children:t},t))})}),u.jsx("tbody",{children:e.rows.map((t,s)=>u.jsx("tr",{className:"border-b border-white/10 hover:bg-white/5",children:e.headers.map(i=>{const o=t[i],d=t.Anuncio,f=typeof d=="string"?d:String((d==null?void 0:d.value)||""),x=f?n[f]:null;if(i==="Anuncio"&&(x!=null&&x.imageUrl))return u.jsx("td",{className:"px-4 py-3 max-w-xs",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:x.imageUrl,alt:f,className:"h-10 w-10 rounded-md object-cover bg-brand-bg flex-shrink-0"}),u.jsx("span",{className:"font-medium text-white truncate",title:f,children:f})]})},i);if(typeof o=="object"&&o!==null&&"value"in o){const m=o;return u.jsxs("td",{className:"px-4 py-3 font-mono",children:[u.jsxs("span",{children:[m.symbol&&!m.symbol.includes("%")?m.symbol:"",m.value.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),m.symbol&&m.symbol.includes("%")?m.symbol:""]}),m.change!==void 0&&u.jsxs("span",{className:`ml-2 text-xs ${m.direction==="up"?"text-green-400":m.direction==="down"?"text-red-400":"text-cyan-200"}`,children:["(",(m.change*100).toFixed(1),"% ",m.direction==="up"?"▲":"▼",")"]})]},i)}return u.jsx("td",{className:"px-4 py-3",children:String(o)},i)})},s))})]})}),TN=e=>{const n=e.match(/\((\d{1,2} \w{3,}\.? – \d{1,2} \w{3,}\.? \d{4})\)/);return n&&n[1]?n[1].replace(/[\s.]/g,"").replace("–","_"):null},wp=(e,n)=>{const t=s=>{const i=e.find(o=>typeof o.Métrica=="string"&&o.Métrica.toLowerCase()===s.toLowerCase());return i?i[n]:"N/A"};return{roas:t("roas"),inversion:t("inversion"),ventas:t("ventas"),cpa:t("cpa")}},wN={ene:0,feb:1,mar:2,abr:3,may:4,jun:5,jul:6,ago:7,sep:8,oct:9,nov:10,dic:11},Sp=e=>{const n=e.match(/– (\d{1,2}) (\w{3,})\.? (\d{4})/);if(n){const[,t,s,i]=n,o=wN[s.toLowerCase().substring(0,3)];if(t&&o!==void 0&&i)return new Date(parseInt(i,10),o,parseInt(t,10))}return null},l0=({label:e,data:n})=>{var i;if(!n)return null;let t="",s=null;if(typeof n=="object"&&"value"in n){const o={};if((i=n.symbol)!=null&&i.includes("€")?(o.style="currency",o.currency="EUR"):(o.minimumFractionDigits=2,o.maximumFractionDigits=2),t=n.value.toLocaleString("es-ES",o),n.symbol&&!n.symbol.includes("€")&&(t+=` ${n.symbol}`),n.change!==void 0&&n.direction&&n.direction!=="neutral"){const d=n.direction==="up",f=e.toLowerCase()==="cpa"?!d:d;s=u.jsxs("span",{className:`ml-1.5 text-xs font-bold ${f?"text-green-400":"text-red-400"}`,children:[d?"▲":"▼"," ",(n.change*100).toFixed(1),"%"]})}}else t=String(n);return u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-brand-text-secondary uppercase",children:e}),u.jsxs("p",{className:"font-semibold text-brand-text text-lg",children:[t,s]})]})},SN=({clients:e,lookerData:n,bitacoraReports:t})=>{var _,y;const[s,i]=ue.useState(""),[o,d]=ue.useState(null),[f,x]=ue.useState(!1);ue.useEffect(()=>{e.length>0&&!s&&i(e[0].id)},[e,s]);const m=ue.useMemo(()=>{if(!s)return[];const E=t.filter(A=>A.clientId===s),T=new Map;for(const A of E){if(!A.mainSummaryTable)continue;const D=A.mainSummaryTable;for(const S of D.headers){if(S.toLowerCase()==="métrica")continue;const H=TN(S);if(!H)continue;const V={weekId:H,reportId:A.id,periodLabel:S,metrics:wp(D.rows,S),importDate:A.importDate},Y=T.get(H);(!Y||new Date(V.importDate)>new Date(Y.importDate))&&T.set(H,V)}}return Array.from(T.values()).sort((A,D)=>{const S=Sp(A.periodLabel),H=Sp(D.periodLabel);return S&&H?H.getTime()-S.getTime():new Date(D.importDate).getTime()-new Date(A.importDate).getTime()})},[t,s]),g=ue.useMemo(()=>t.find(E=>E.id===o)||null,[t,o]),v=n[s]||{},b=ue.useMemo(()=>{if(!g||!g.mainSummaryTable)return[];const E=g.mainSummaryTable,T=E.headers.find(D=>D.includes("Semana actual"))||E.headers[1];if(!T)return[];const A=wp(E.rows,T);return[{label:"Inversión",data:A.inversion,icon:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-1.134 0V7.151c.196.062.387.148.567.267zM11.567 7.418c.155-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-1.134 0V7.151c.196.062.387.148.567.267z"}),u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.5 4.5 0 00-1.876.763.5.5 0 00.374.938 3.5 3.5 0 013.704 0 .5.5 0 00.374-.938A4.5 4.5 0 0011 5.092V5zM10 14a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})]})},{label:"Ventas",data:A.ventas,icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4z",clipRule:"evenodd"})})},{label:"ROAS",data:A.roas,icon:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]})},{label:"CPA",data:A.cpa,icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}]},[g]);return u.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("header",{className:"text-center",children:[u.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Visor de Reportes de Bitácora"}),u.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Selecciona un cliente y un reporte para ver el análisis detallado de la cuenta."})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[u.jsxs("div",{className:"max-w-sm mb-6",children:[u.jsx("label",{htmlFor:"client-selector-reports",className:"block text-sm font-medium text-brand-text-secondary mb-1",children:"Seleccionar Cliente"}),u.jsx("select",{id:"client-selector-reports",value:s,onChange:E=>{i(E.target.value),d(null)},className:"w-full bg-brand-bg border border-brand-border text-brand-text rounded-md p-3 focus:ring-brand-primary focus:border-brand-primary",disabled:e.length===0,children:e.length>0?e.map(E=>u.jsx("option",{value:E.id,children:E.name},E.id)):u.jsx("option",{children:"No hay clientes"})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-8",children:[u.jsxs("aside",{className:"md:col-span-4 lg:col-span-3",children:[u.jsx("h2",{className:"font-bold text-brand-text mb-2",children:"Resúmenes Semanales"}),u.jsxs("div",{className:"bg-brand-bg rounded-md p-2 space-y-2 max-h-[70vh] overflow-y-auto",children:[f&&u.jsx("p",{className:"text-sm text-brand-text-secondary p-2",children:"Cargando reportes..."}),!f&&m.length===0&&u.jsx("p",{className:"text-sm text-brand-text-secondary p-2",children:"No hay reportes semanales para este cliente."}),m.map(E=>u.jsxs("div",{className:`w-full text-left p-3 rounded-md transition-all duration-300 ${o===E.reportId?"bg-brand-primary/10 ring-2 ring-brand-primary":"bg-brand-border/30 hover:bg-brand-border/50"}`,children:[u.jsx("button",{onClick:()=>d(E.reportId),className:"w-full text-left font-semibold block text-brand-text mb-3",children:E.periodLabel}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-3",children:[u.jsx(l0,{label:"ROAS",data:E.metrics.roas}),u.jsx(l0,{label:"Inversión",data:E.metrics.inversion}),u.jsx(l0,{label:"Ventas",data:E.metrics.ventas}),u.jsx(l0,{label:"CPA",data:E.metrics.cpa})]})]},E.weekId))]})]}),u.jsx("main",{className:"md:col-span-8 lg:col-span-9",children:g?u.jsxs("div",{className:"space-y-8",children:[u.jsxs("h2",{className:"text-3xl font-bold text-cyan-300",children:["Revisión Global: ",(y=(_=g.mainSummaryTable)==null?void 0:_.headers[1].match(/\((.*?)\)/))==null?void 0:y[1]]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:b.map(E=>u.jsx(EN,{...E},E.label))}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[u.jsxs("div",{className:"lg:col-span-3 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[u.jsx("h3",{className:"font-semibold text-cyan-300 mb-4",children:"Embudo de Conversión"}),g.funnelAnalysisTable?u.jsx(_N,{table:g.funnelAnalysisTable}):u.jsx("p",{className:"text-sm text-cyan-200/50",children:"Datos de embudo no disponibles."})]}),u.jsxs("div",{className:"lg:col-span-2 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[u.jsx("h3",{className:"font-semibold text-cyan-300 mb-4",children:"Tendencia de Ratios"}),g.ratioTrendsTable?u.jsx(Tp,{table:g.ratioTrendsTable,clientLookerData:{}}):u.jsx("p",{className:"text-sm text-cyan-200/50",children:"Datos de tendencias no disponibles."})]})]}),g.topAdsTables.map((E,T)=>u.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-4 shadow-lg",children:[u.jsx("h3",{className:"font-semibold text-cyan-300 mb-3",children:E.title}),u.jsx(Tp,{table:E,clientLookerData:v})]},`top-ads-${T}`))]}):u.jsx("div",{className:"flex items-center justify-center h-full bg-brand-bg rounded-lg border-2 border-dashed border-brand-border",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),u.jsx("p",{className:"mt-4 font-semibold text-brand-text",children:"Selecciona un resumen semanal"}),u.jsx("p",{className:"text-brand-text-secondary",children:"Elige un resumen de la lista de la izquierda para ver su contenido detallado."})]})})})]})]})]})},AN=({clients:e,lookerData:n,performanceData:t,getStrategicAnalysis:s,startDate:i,endDate:o,onDateChange:d})=>{const[f,x]=ue.useState(""),[m,g]=ue.useState(!1),[v,b]=ue.useState(null),[_,y]=ue.useState(null),E=ue.useMemo(()=>e.filter(S=>{var j;const H=n[S.id]||{},V=Object.values(H).some(J=>J.analysisResult),Y=((j=t[S.id])==null?void 0:j.length)>0;return V&&Y}),[e,n,t]),T=ue.useMemo(()=>e.find(S=>S.id===f),[e,f]),A=S=>{const H=n[S.id]||{},Y=(t[S.id]||[]).filter(z=>{const ie=new Date(z.day),K=new Date(i),q=new Date(o);return ie>=K&&ie<=q}),j=Object.entries(H).filter(([z,ie])=>ie.analysisResult).map(([z,ie])=>{const K=Y.filter(re=>re.adName===z),q=kN(K);return{adName:z,creativeDescription:ie.creativeDescription||"",analysisResult:ie.analysisResult,performanceData:q,keyInsights:CN(ie.analysisResult,q)}}),J={totalSpend:Y.reduce((z,ie)=>z+ie.spend,0),totalRevenue:Y.reduce((z,ie)=>z+ie.purchaseValue,0),overallROAS:lf(Y),bestPerformingAds:ON(j),worstPerformingAds:DN(j),trendAnalysis:RN(Y),demographicInsights:jN()};return{client:S,creativeSummaries:j,performanceMetrics:J,dateRange:{start:i,end:o}}},D=async()=>{if(T){g(!0),y(null);try{const S=A(T),H=await s(S);b(H)}catch(S){y(S instanceof Error?S.message:"Error en el análisis estratégico")}finally{g(!1)}}};return u.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 animate-fade-in",children:[u.jsxs("header",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Análisis Estratégico Integral"}),u.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Combina análisis de creativos con métricas de rendimiento para generar planes de acción estratégicos."})]}),u.jsx(c0,{onDateChange:d,startDate:i,endDate:o})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Seleccionar Cliente para Análisis"}),E.length===0?u.jsx("div",{className:"text-center py-8",children:u.jsxs("div",{className:"text-brand-text-secondary",children:[u.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),u.jsx("p",{className:"text-lg font-medium",children:"No hay clientes elegibles"}),u.jsxs("p",{className:"mt-2",children:["Para usar esta función, necesitas clientes con:",u.jsx("br",{}),"• Creativos analizados por IA",u.jsx("br",{}),"• Datos de rendimiento importados"]})]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(S=>{const H=n[S.id]||{},V=Object.values(H).filter(j=>j.analysisResult).length,Y=Object.keys(H).length;return u.jsxs("button",{onClick:()=>x(S.id),className:`p-4 rounded-lg border-2 transition-all text-left ${f===S.id?"border-brand-primary bg-brand-primary/10":"border-brand-border hover:border-brand-primary/50"}`,children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("img",{src:S.logo,alt:S.name,className:"h-10 w-10 rounded-full"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-brand-text",children:S.name}),u.jsxs("p",{className:"text-sm text-brand-text-secondary",children:[V," de ",Y," creativos analizados"]})]})]}),u.jsxs("div",{className:"text-xs text-brand-text-secondary",children:["✓ Creativos con análisis IA",u.jsx("br",{}),"✓ Datos de rendimiento disponibles"]})]},S.id)})}),T&&u.jsx("div",{className:"mt-6 flex justify-center",children:u.jsx("button",{onClick:D,disabled:m,className:"bg-brand-primary hover:bg-brand-primary-hover text-white font-bold py-3 px-8 rounded-lg shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3",children:m?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Analizando estrategia..."]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Generar Análisis Estratégico"]})})})]})]}),_&&u.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[u.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"font-medium",children:"Error en el análisis:"})]}),u.jsx("p",{className:"mt-1 text-red-300",children:_})]}),v&&T&&u.jsx(NN,{result:v,client:T,dateRange:{start:i,end:o}})]})},NN=({result:e,client:n,dateRange:t})=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[u.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Resumen Ejecutivo - ",n.name]}),u.jsxs("div",{className:"prose prose-invert max-w-none",children:[u.jsxs("p",{className:"text-brand-text-secondary text-sm mb-4",children:["Período analizado: ",new Date(t.start).toLocaleDateString()," - ",new Date(t.end).toLocaleDateString()]}),u.jsx("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:u.jsx("p",{className:"text-brand-text leading-relaxed",children:e.executiveSummary})})]})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[u.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Plan de Acción Estratégico"]}),u.jsx("div",{className:"space-y-4",children:e.actionPlan.map((s,i)=>u.jsxs("div",{className:"border-l-4 border-brand-primary pl-4",children:[u.jsx("h4",{className:"font-semibold text-brand-text",children:s.title}),u.jsx("p",{className:"text-brand-text-secondary mt-1",children:s.description}),u.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[u.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.priority==="HIGH"?"bg-red-500/20 text-red-400":s.priority==="MEDIUM"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:["Prioridad ",s.priority]}),u.jsxs("span",{className:"text-xs text-brand-text-secondary",children:["Impacto esperado: ",s.expectedImpact]})]})]},i))})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[u.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Insights de Creativos"]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.creativeInsights.map((s,i)=>u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h4",{className:"font-semibold text-brand-text mb-2",children:s.adName}),u.jsx("p",{className:"text-sm text-brand-text-secondary mb-2",children:s.insight}),u.jsx("div",{className:"text-xs text-brand-primary",children:s.recommendation})]},i))})]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-brand-text mb-4 flex items-center gap-2",children:[u.jsx("svg",{className:"h-6 w-6 text-brand-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Recomendaciones de Rendimiento"]}),u.jsx("div",{className:"space-y-3",children:e.performanceRecommendations.map((s,i)=>u.jsxs("div",{className:"flex items-start gap-3 p-3 bg-brand-bg/50 rounded-lg",children:[u.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-primary mt-2 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-brand-text",children:s.recommendation}),u.jsxs("p",{className:"text-sm text-brand-text-secondary mt-1",children:["Impacto esperado: ",s.expectedImpact]})]})]},i))})]})]}),kN=(e,n)=>{var s;if(e.length===0)return{adName:"",spend:0,revenue:0,roas:0,impressions:0,clicks:0,ctr:0,cpc:0,purchases:0};const t=e.reduce((i,o)=>({spend:i.spend+o.spend,revenue:i.revenue+o.purchaseValue,impressions:i.impressions+o.impressions,clicks:i.clicks+o.linkClicks,purchases:i.purchases+o.purchases}),{spend:0,revenue:0,impressions:0,clicks:0,purchases:0});return{adName:((s=e[0])==null?void 0:s.adName)||"",spend:t.spend,revenue:t.revenue,roas:t.spend>0?t.revenue/t.spend:0,impressions:t.impressions,clicks:t.clicks,ctr:t.impressions>0?t.clicks/t.impressions*100:0,cpc:t.clicks>0?t.spend/t.clicks:0,purchases:t.purchases}},CN=(e,n)=>{const t=[];return e.effectivenessScore<50&&t.push(`Efectividad baja (${e.effectivenessScore}/100)`),n.roas<2&&t.push(`ROAS por debajo del promedio (${n.roas.toFixed(2)})`),e.funnelStage==="TOFU"&&n.ctr>2&&t.push("Buen CTR para creative de awareness"),t},lf=e=>{const n=e.reduce((s,i)=>s+i.spend,0),t=e.reduce((s,i)=>s+i.purchaseValue,0);return n>0?t/n:0},ON=e=>e.sort((n,t)=>t.performanceData.roas-n.performanceData.roas).slice(0,3).map(n=>n.adName),DN=e=>e.sort((n,t)=>n.performanceData.roas-t.performanceData.roas).slice(0,3).map(n=>n.adName),RN=e=>{if(e.length<2)return"Datos insuficientes para análisis de tendencias";const n=e.sort((d,f)=>new Date(d.day).getTime()-new Date(f.day).getTime()),t=n.slice(0,Math.floor(n.length/2)),s=n.slice(Math.floor(n.length/2)),i=lf(t),o=lf(s);return o>i*1.1?"Tendencia positiva en ROAS":o<i*.9?"Tendencia negativa en ROAS":"ROAS estable en el período"},jN=e=>"Análisis demográfico disponible con más datos",Rn=(e,n)=>e+(Math.random()-.5)*n*e,FN=(e,n)=>(console.log(`[Meta API Simulator] Fetching data for account: ${n} with App ID: ${e.appId}`),new Promise(t=>{setTimeout(()=>{const s=new Date,i=[],o=["11-07-2025_Summer Sale_Image_TOF_Offer_Choker Iris__Product__V1_Brand_In-house_Studio_Details_(CP)","summer sale 20%off (gorgeous hair) 🎬img 🎯oferta 👤diseno 🖼️una imagen o video 💬ninguno 🧪04/07/2025 - copia","🆔Los 5 accesorios de esta primavera | 🎬Video | 🎯Problema | 👤Actriz | 🖼️Una imagen o video | 💬Ninguno | 🧪 - Copia"];for(let d=0;d<7;d++){const f=new Date(s);f.setDate(s.getDate()-d);const x=`${f.getDate().toString().padStart(2,"0")}/${(f.getMonth()+1).toString().padStart(2,"0")}/${f.getFullYear()}`;o.forEach((m,g)=>{const v=m.toLowerCase().includes("video"),b=Rn(50,.4),_=Rn(1e4,.3),y=Rn(_*.02,.5),E=Rn(b/3,.6),T=E*Rn(80,.2);i.push({accountName:n,adName:m,day:x,spend:b,impressions:_,linkClicks:y,purchases:E,purchaseValue:T,frequency:Rn(1.5,.2),cpm:b/_*1e3,ctrLink:y/_*100,adDelivery:"active",age:"25-34",gender:g%2===0?"female":"male",campaignName:"Simulated API Campaign",adSetName:"Simulated Ad Set",videoFileName:v?`${m.substring(0,20).replace(/\|/g,"_")}.mp4`:void 0,thruPlays:v?Rn(_*.1,.3):0,videoAveragePlayTime:v?Rn(12,.5):0})})}console.log(`[Meta API Simulator] Generated ${i.length} records.`),t(i)},1500)})),LN=({onFileUpload:e})=>{const[n,t]=ue.useState(null),[s,i]=ue.useState(!1),o=ue.useRef(null),d=b=>{var y;const _=(y=b.target.files)==null?void 0:y[0];_&&(t(_.name),e(_))},f=()=>{var b;(b=o.current)==null||b.click()},x=ue.useCallback(b=>{if(b.preventDefault(),b.stopPropagation(),i(!1),b.dataTransfer.files&&b.dataTransfer.files[0]){const _=b.dataTransfer.files[0];t(_.name),e(_)}},[e]),m=b=>{b.preventDefault(),b.stopPropagation()},g=b=>{b.preventDefault(),b.stopPropagation(),i(!0)},v=b=>{b.preventDefault(),b.stopPropagation(),i(!1)};return u.jsxs("div",{className:"bg-brand-surface rounded-lg p-6 shadow-lg",children:[u.jsx("h2",{className:"text-xl font-semibold text-brand-text mb-4 text-center",children:"Sube tu Creativo"}),u.jsxs("div",{className:`border-2 border-dashed rounded-lg p-10 text-center cursor-pointer transition-colors ${s?"border-brand-primary bg-brand-primary/10":"border-brand-border hover:border-brand-primary bg-brand-bg"}`,onClick:f,onDrop:x,onDragOver:m,onDragEnter:g,onDragLeave:v,children:[u.jsx("input",{type:"file",ref:o,onChange:d,className:"hidden",accept:"image/*,video/*"}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-12 w-12 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),u.jsx("p",{className:"mt-4 text-lg font-semibold text-brand-text",children:"Arrastra y suelta tu archivo o haz clic para seleccionar"}),u.jsx("p",{className:"mt-2 text-sm text-brand-text-secondary",children:n?u.jsx("span",{className:"text-brand-primary font-medium break-all",children:n}):"Soporta imágenes y videos. El análisis se adaptará al formato."})]}),u.jsx("p",{className:"text-xs text-brand-text-secondary mt-4 text-center",children:"Al subir tu creativo, te pediremos que lo asignes a un cliente para un mejor seguimiento y cache de resultados."})]})},MN=[{id:"SQUARE_LIKE",name:"Formatos Cuadrados/Rectangulares",description:"Feeds, Marketplace, Explore...",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"VERTICAL",name:"Formatos Verticales",description:"Stories, Reels...",icon:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}],IN=({onSelectFormat:e})=>u.jsxs("div",{className:"max-w-4xl mx-auto bg-brand-surface rounded-lg p-6 shadow-lg animate-fade-in",children:[u.jsx("h2",{className:"text-xl font-semibold text-brand-text mb-6 text-center",children:"Selecciona un grupo de formatos para analizar"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:MN.map(n=>u.jsxs("button",{onClick:()=>e(n.id),className:"group flex flex-col items-center justify-center p-6 bg-brand-border/30 rounded-lg text-brand-text-secondary hover:bg-brand-primary hover:text-white transition-all transform hover:scale-105",children:[u.jsx("div",{className:"text-brand-primary group-hover:text-white transition-colors",children:n.icon}),u.jsx("span",{className:"mt-4 text-lg font-bold text-brand-text group-hover:text-white transition-colors",children:n.name}),u.jsx("span",{className:"mt-1 text-sm",children:n.description})]},n.id))})]}),BN=({language:e,onLanguageChange:n})=>{const t=[{id:"es",name:"Español"},{id:"en",name:"English"}];return u.jsxs("div",{className:"flex justify-center items-center gap-2 mb-6",children:[u.jsx("span",{className:"text-sm text-brand-text-secondary",children:e==="es"?"Idioma del Análisis:":"Analysis Language:"}),u.jsx("div",{className:"flex rounded-lg bg-brand-border p-1",children:t.map(s=>u.jsx("button",{onClick:()=>n(s.id),className:`px-3 py-1 text-sm font-semibold rounded-md transition-colors ${e===s.id?"bg-brand-primary text-white":"bg-transparent text-brand-text-secondary hover:bg-brand-surface"}`,children:s.name},s.id))})]})},UN={CRITICAL:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.21 3.03-1.742 3.03H4.42c-1.532 0-2.492-1.696-1.742-3.03l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),ACTIONABLE:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),POSITIVE:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-400 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},PN=({safeZone:e})=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-500/30 pointer-events-none z-30 rounded-t-md",style:{height:e.top}}),u.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-red-500/30 pointer-events-none z-30 rounded-b-md",style:{height:e.bottom}}),e.left&&u.jsx("div",{className:"absolute top-0 bottom-0 left-0 bg-red-500/30 pointer-events-none z-30",style:{width:e.left}}),e.right&&u.jsx("div",{className:"absolute top-0 bottom-0 right-0 bg-red-500/30 pointer-events-none z-30",style:{width:e.right}})]}),HN=({conclusion:e})=>u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6",children:[u.jsx("h2",{className:"text-xl md:text-2xl font-bold text-brand-text mb-4",children:e.headline}),u.jsx("ul",{className:"space-y-3",children:e.checklist.map((n,t)=>u.jsxs("li",{className:"flex items-start gap-3",children:[UN[n.severity],u.jsx("span",{className:"text-brand-text-secondary",children:n.text})]},t))})]}),zN=()=>u.jsxs("div",{className:"animate-pulse flex flex-col gap-8",children:[u.jsx("div",{className:"h-10 bg-brand-border rounded-md w-64"}),u.jsxs("div",{className:"bg-brand-surface rounded-lg p-4 shadow-lg",children:[u.jsx("div",{className:"w-full max-w-lg mx-auto bg-brand-border rounded-md aspect-video"}),u.jsx("div",{className:"h-8 bg-brand-border rounded-md w-48 mx-auto mt-4"})]}),u.jsxs("div",{className:"space-y-8",children:[u.jsx(of,{analysisResult:null,isLoading:!0}),u.jsxs("div",{className:"bg-brand-surface rounded-lg shadow-lg p-6 mt-8",children:[u.jsx("div",{className:"h-6 bg-brand-border rounded w-1/3 mb-4"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex gap-3 items-start",children:[u.jsx("div",{className:"w-5 h-5 rounded-full bg-brand-border/50 flex-shrink-0"}),u.jsx("div",{className:"h-4 bg-brand-border rounded w-full"})]}),u.jsxs("div",{className:"flex gap-3 items-start",children:[u.jsx("div",{className:"w-5 h-5 rounded-full bg-brand-border/50 flex-shrink-0"}),u.jsx("div",{className:"h-4 bg-brand-border rounded w-5/6"})]})]})]})]})]}),VN=({creativeSet:e,formatGroup:n,analysisResult:t,isLoading:s,onGoBack:i})=>{const[o,d]=ue.useState(!0),f=ue.useMemo(()=>Nb.find(m=>m.group===n),[n]),x=ue.useMemo(()=>e.videoFile?{file:e.videoFile,url:URL.createObjectURL(e.videoFile),type:"video",width:1080,height:1920,format:"vertical",hash:""}:n==="VERTICAL"?e.vertical||e.square:e.square||e.vertical,[e,n]);return s?u.jsx(zN,{}):u.jsxs("div",{className:"animate-fade-in flex flex-col gap-8",children:[u.jsxs("button",{onClick:i,className:"self-start -mb-2 bg-brand-border/50 text-brand-text-secondary hover:bg-brand-border px-4 py-2 rounded-md transition-colors flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Seleccionar otro formato"]}),u.jsxs("div",{className:"bg-brand-surface rounded-lg p-4 shadow-lg",children:[u.jsx("div",{className:"relative w-full max-w-lg mx-auto bg-brand-bg rounded-md",children:x?u.jsxs("div",{className:"relative",children:[x.type==="image"?u.jsx("img",{src:x.url,alt:"Creative Preview",className:"w-full h-auto max-h-[60vh] object-contain rounded-md"}):u.jsx("video",{src:x.url,className:"w-full h-auto max-h-[60vh] object-contain rounded-md",loop:!0,autoPlay:!0,muted:!0,playsInline:!0}),o&&u.jsx(PN,{safeZone:f.safeZone})]}):u.jsx("div",{className:"aspect-video flex items-center justify-center text-brand-text-secondary",children:u.jsx("span",{children:"No creative available"})})}),u.jsxs("div",{className:"mt-4 flex justify-center items-center gap-3",children:[u.jsx("label",{htmlFor:"safe-zone-toggle",className:"text-sm text-brand-text-secondary",children:"Mostrar Zonas Rojas"}),u.jsx("button",{id:"safe-zone-toggle",onClick:()=>d(!o),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${o?"bg-brand-primary":"bg-brand-border"}`,"aria-pressed":o,children:u.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${o?"translate-x-6":"translate-x-1"}`})})]})]}),u.jsxs("div",{className:"space-y-8",children:[u.jsx(of,{analysisResult:t,isLoading:s}),t&&u.jsx(HN,{conclusion:t.overallConclusion})]})]})},GN=(e,n)=>new Promise((t,s)=>{const i=e.type.startsWith("image/")?"image":"video",o=(f,x,m)=>{const g=f/x,v={file:e,url:URL.createObjectURL(e),type:i,width:f,height:x,format:g>=1?"square":"vertical",hash:m};t(v)},d=async f=>{const x=await f.arrayBuffer(),m=await crypto.subtle.digest("SHA-256",x);return Array.from(new Uint8Array(m)).map(g=>g.toString(16).padStart(2,"0")).join("")};if(i==="image"){const f=new Image;f.onload=async()=>{const x=await d(e);o(f.naturalWidth,f.naturalHeight,x),URL.revokeObjectURL(n)},f.onerror=x=>{URL.revokeObjectURL(n),s(x)},f.src=n}else{const f=document.createElement("video");f.onloadedmetadata=async()=>{const x=await d(e);o(f.videoWidth,f.videoHeight,x),URL.revokeObjectURL(n)},f.onerror=x=>{URL.revokeObjectURL(n),s(x)},f.src=n}}),YN=({clients:e,getFormatAnalysis:n})=>{const[t,s]=ue.useState("upload"),[i,o]=ue.useState(null),[d,f]=ue.useState(!1),[x,m]=ue.useState(null),[g,v]=ue.useState("es"),[b,_]=ue.useState(null),[y,E]=ue.useState(null),[T,A]=ue.useState(!1),D=()=>{s("upload"),o(null),f(!1),m(null),_(null),E(null),A(!1),Je.info("Creative analysis flow reset.")},S=async j=>{Je.info("File uploaded for analysis",{name:j.name,type:j.type});const J=URL.createObjectURL(j);try{const z=await GN(j,J),K=z.type==="video"?{square:null,vertical:null,videoFile:j}:{square:z.format==="square"?z:null,vertical:z.format==="vertical"?z:null,videoFile:null};o(K),e.length>0?f(!0):alert("No hay clientes creados. Por favor, crea un cliente en la pestaña 'Clientes' antes de continuar.")}catch(z){Je.error("Error processing uploaded file",z),alert("Hubo un error al procesar el archivo. Asegúrate de que es un formato de imagen o video válido."),D()}},H=j=>{const J=e.find(z=>z.id===j);J&&(m(J),f(!1),s("select_format"),Je.info("Client selected for analysis",{clientName:J.name}))},V=async j=>{if(!i||!x)return;_(j),s("analyzing"),A(!0),Je.info("Format selected, starting AI analysis...",{formatGroup:j,clientName:x.name});const J=`Análisis del creativo para el cliente "${x.name}".`,z=!!i.videoFile,ie=await n(i,j,g,J,z);E(ie),A(!1),s("results"),Je.success("AI analysis complete.")},Y=()=>{switch(t){case"upload":return u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsx(LN,{onFileUpload:S})});case"select_format":return u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx(BN,{language:g,onLanguageChange:v}),u.jsx(IN,{onSelectFormat:V})]});case"analyzing":case"results":return i&&b?u.jsx(VN,{creativeSet:i,formatGroup:b,analysisResult:y,isLoading:T,onGoBack:D}):null;default:return null}};return u.jsxs("div",{className:"animate-fade-in",children:[u.jsxs("header",{className:"text-center mb-10",children:[u.jsx("h1",{className:"text-4xl font-bold tracking-tight text-brand-text sm:text-5xl",children:"Análisis de Creativos con IA"}),u.jsx("p",{className:"mt-4 text-lg text-brand-text-secondary",children:"Sube tu imagen o video para recibir un análisis instantáneo y recomendaciones de mejora."})]}),Y(),u.jsx(Ku,{isOpen:d,onClose:()=>D(),clients:e,onClientSelect:H,title:"Asignar Creativo a Cliente",description:"Selecciona a qué cliente pertenece este creativo. Esto ayuda a la IA a usar el contexto adecuado."})]})};class XN{constructor(){this.dbName="Ver6Database",this.version=1,this.db=null}async initialize(){return new Promise((n,t)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>t(s.error),s.onsuccess=()=>{this.db=s.result,n()},s.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains("clients")||o.createObjectStore("clients",{keyPath:"id"}),o.objectStoreNames.contains("performance_data")||o.createObjectStore("performance_data",{keyPath:"client_id"}),o.objectStoreNames.contains("looker_data")||o.createObjectStore("looker_data",{keyPath:"client_id"}),o.objectStoreNames.contains("import_history")||o.createObjectStore("import_history",{keyPath:"id"}),o.objectStoreNames.contains("processed_hashes")||o.createObjectStore("processed_hashes",{keyPath:"client_id"}),o.objectStoreNames.contains("config")||o.createObjectStore("config",{keyPath:"key"}),o.objectStoreNames.contains("generic_data")||o.createObjectStore("generic_data")}})}async saveData(n,t,s){if(!this.db)throw new Error("Database not initialized");return new Promise((i,o)=>{const f=this.db.transaction([n],"readwrite").objectStore(n),x=s?f.put({id:s,data:t}):f.put(t);x.onerror=()=>o(x.error),x.onsuccess=()=>i()})}async getData(n,t){if(!this.db)throw new Error("Database not initialized");return new Promise((s,i)=>{const d=this.db.transaction([n],"readonly").objectStore(n),f=t?d.get(t):d.getAll();f.onerror=()=>i(f.error),f.onsuccess=()=>{const x=f.result;s(t&&x?x.data:x||null)}})}async clearStore(n){if(!this.db)throw new Error("Database not initialized");return new Promise((t,s)=>{const d=this.db.transaction([n],"readwrite").objectStore(n).clear();d.onerror=()=>s(d.error),d.onsuccess=()=>t()})}async deleteData(n,t){if(!this.db)throw new Error("Database not initialized");return new Promise((s,i)=>{const f=this.db.transaction([n],"readwrite").objectStore(n).delete(t);f.onerror=()=>i(f.error),f.onsuccess=()=>s()})}async saveClients(n){await this.saveData("clients",n,"all")}async getClients(){return await this.getData("clients","all")||[]}async savePerformanceData(n){for(const[t,s]of Object.entries(n))await this.saveData("performance_data",s,t)}async getPerformanceData(){const n=await this.getData("performance_data"),t={};if(Array.isArray(n))for(const s of n)s.id&&s.data&&(t[s.id]=s.data);return t}async cleanOldData(){console.log("[IndexedDB] Cleaning old data...")}}const Al=new XN;async function qN(){console.log("[MIGRATION] Starting migration from localStorage to IndexedDB...");try{await Al.initialize();const e=localStorage.getItem("db_clients");if(e){const t=JSON.parse(e);await Al.saveClients(t),console.log("[MIGRATION] Migrated clients")}const n=localStorage.getItem("db_performance_data");if(n){const t=JSON.parse(n);await Al.savePerformanceData(t),console.log("[MIGRATION] Migrated performance data")}return console.log("[MIGRATION] Migration completed successfully"),!0}catch(e){return console.error("[MIGRATION] Error during migration:",e),!1}}const KN=({isOpen:e,onClose:n,clients:t,performanceData:s,lookerData:i,importHistory:o})=>{const[d,f]=ue.useState({}),[x,m]=ue.useState({}),[g,v]=ue.useState({used:"0",quota:"0",items:0}),b=ue.useCallback(async()=>{if(!e)return;const T={};for(let A=0;A<localStorage.length;A++){const D=localStorage.key(A);if(D&&D.startsWith("db_"))try{const S=localStorage.getItem(D);if(S){const H=JSON.parse(S);T[D]={size:new Blob([S]).size,type:Array.isArray(H)?"array":typeof H,length:Array.isArray(H)?H.length:Object.keys(H||{}).length}}}catch{T[D]={size:0,type:"error",length:0,error:"Error parsing data"}}}f(T);try{const A=await ta.getProcessedHashes();m(A);const D=ta.getLocalStorageUsage();v(D)}catch(A){console.error("Error loading diagnostic data:",A)}},[e]);if(ue.useEffect(()=>{b()},[b]),!e)return null;const _=T=>{if(T===0)return"0 Bytes";const A=1024,D=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(T)/Math.log(A));return parseFloat((T/Math.pow(A,S)).toFixed(2))+" "+D[S]},y=Object.values(s).flat().length,E=Object.values(i).reduce((T,A)=>T+Object.keys(A).length,0);return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-brand-surface rounded-xl border border-brand-border max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-brand-border",children:[u.jsx("h2",{className:"text-xl font-bold text-brand-text",children:"Diagnóstico de Datos"}),u.jsx("button",{onClick:n,className:"text-brand-text-secondary hover:text-brand-text",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"📊 Resumen General"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-brand-primary",children:t.length}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Clientes"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-green-400",children:y}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Registros Performance"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-purple-400",children:E}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Creativos Looker"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-orange-400",children:o.length}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Importaciones"})]})]})]}),u.jsxs("div",{className:`rounded-lg p-4 border-2 ${parseFloat(g.used)>4?"bg-red-500/10 border-red-500/30":parseFloat(g.used)>2?"bg-yellow-500/10 border-yellow-500/30":"bg-green-500/10 border-green-500/30"}`,children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"💾 Uso del Almacenamiento Local"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:`text-2xl font-bold ${parseFloat(g.used)>4?"text-red-400":parseFloat(g.used)>2?"text-yellow-400":"text-green-400"}`,children:[g.used,"MB"]}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Usado"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[g.quota,"MB"]}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Límite Estimado"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-purple-400",children:g.items}),u.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Items Totales"})]})]}),parseFloat(g.used)>4&&u.jsx("div",{className:"mt-3 p-2 bg-red-500/20 rounded text-sm text-red-400",children:"⚠️ Almacenamiento casi lleno. Esto puede causar errores al importar datos."}),parseFloat(g.used)>2&&parseFloat(g.used)<=4&&u.jsx("div",{className:"mt-3 p-2 bg-yellow-500/20 rounded text-sm text-yellow-400",children:"⚠️ Almacenamiento con uso elevado. Considere limpiar datos antiguos."})]}),u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"👥 Datos por Cliente"}),t.length===0?u.jsx("p",{className:"text-brand-text-secondary",children:"No hay clientes configurados"}):u.jsx("div",{className:"space-y-2",children:t.map(T=>{var H,V;const A=((H=s[T.id])==null?void 0:H.length)||0,D=Object.keys(i[T.id]||{}).length,S=((V=x[T.id])==null?void 0:V.length)||0;return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-brand-surface rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("img",{src:T.logo,alt:T.name,className:"w-8 h-8 rounded-full"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-brand-text",children:T.name}),u.jsxs("div",{className:"text-xs text-brand-text-secondary",children:["Meta: ",T.metaAccountName||"No configurado"]})]})]}),u.jsxs("div",{className:"flex gap-4 text-sm",children:[u.jsxs("span",{className:"text-green-400",children:[A," perf"]}),u.jsxs("span",{className:"text-purple-400",children:[D," ads"]}),u.jsxs("span",{className:"text-orange-400",children:[S," files"]})]})]},T.id)})})]}),u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"📁 Historial de Importaciones"}),o.length===0?u.jsx("p",{className:"text-brand-text-secondary",children:"No hay importaciones registradas"}):u.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:o.slice(0,10).map(T=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-brand-surface rounded",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-brand-text",children:T.fileName}),u.jsxs("div",{className:"text-xs text-brand-text-secondary",children:[T.clientName," - ",T.description]})]}),u.jsx("div",{className:"text-xs text-brand-text-secondary",children:new Date(T.timestamp).toLocaleDateString()})]},T.id))})]}),u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"💾 Almacenamiento Local"}),u.jsx("div",{className:"space-y-2",children:Object.entries(d).map(([T,A])=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-brand-surface rounded",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-brand-text",children:T.replace("db_","")}),u.jsx("div",{className:"text-xs text-brand-text-secondary",children:A.error?A.error:`${A.type} - ${A.length} items`})]}),u.jsx("div",{className:"text-xs text-brand-text-secondary",children:_(A.size)})]},T))})]}),u.jsxs("div",{className:"bg-brand-bg/50 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-3",children:"🔐 Archivos Procesados (Hashes)"}),Object.keys(x).length===0?u.jsx("p",{className:"text-brand-text-secondary",children:"No hay archivos procesados registrados"}):u.jsx("div",{className:"space-y-2",children:Object.entries(x).map(([T,A])=>{const D=t.find(S=>S.id===T);return u.jsxs("div",{className:"p-2 bg-brand-surface rounded",children:[u.jsx("div",{className:"text-sm font-medium text-brand-text mb-1",children:(D==null?void 0:D.name)||"Cliente desconocido"}),u.jsxs("div",{className:"text-xs text-brand-text-secondary",children:[A.length," archivos procesados"]}),A.length>0&&u.jsxs("div",{className:"mt-1 text-xs text-brand-text-secondary break-all",children:["Último: ",A[A.length-1].substring(0,16),"..."]})]},T)})})]}),u.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-3",children:"⚠️ Acciones de Limpieza"}),u.jsx("p",{className:"text-sm text-brand-text-secondary mb-3",children:"Si los datos no se están mostrando correctamente o el almacenamiento está lleno, puedes usar estas acciones:"}),u.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.jsx("button",{onClick:async()=>{if(confirm("¿Migrar a IndexedDB? Esto moverá los datos a un sistema de base de datos más robusto que maneja archivos grandes mejor que localStorage."))try{await qN()?(alert("Migración completada exitosamente. Los datos ahora están en IndexedDB."),await b()):alert("Error durante la migración. Ver consola para detalles.")}catch(T){console.error("Migration error:",T),alert("Error durante la migración.")}},className:"px-3 py-1 bg-purple-500/20 text-purple-400 rounded text-sm hover:bg-purple-500/30",children:"Migrar a IndexedDB"}),u.jsx("button",{onClick:async()=>{if(confirm("¿Limpiar datos antiguos? Esto eliminará importaciones e historial viejo para liberar espacio."))try{await ta.clearOldData(),await b(),alert("Datos antiguos limpiados correctamente.")}catch(T){console.error("Error cleaning old data:",T),alert("Error al limpiar datos antiguos.")}},className:"px-3 py-1 bg-orange-500/20 text-orange-400 rounded text-sm hover:bg-orange-500/30",children:"Limpiar Datos Antiguos"}),u.jsx("button",{onClick:async()=>{if(confirm("¿Limpiar solo el historial de archivos procesados? Esto permitirá reimportar archivos."))try{await ta.saveProcessedHashes({}),await b(),alert("Hashes de archivos limpiados correctamente.")}catch(T){console.error("Error clearing hashes:",T),alert("Error al limpiar hashes.")}},className:"px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm hover:bg-yellow-500/30",children:"Limpiar Hashes"}),u.jsx("button",{onClick:async()=>{const T=localStorage.getItem("db_performance_data");if(T)try{const A=JSON.parse(T);console.log("[DEBUG] Performance data in localStorage:",A);const D=Object.values(A).flat().length;alert(`LocalStorage contiene ${D} registros de performance para ${Object.keys(A).length} clientes.

Ver consola para detalles.`)}catch{alert("Error al parsear datos de performance en localStorage")}else alert("No hay datos de performance en localStorage")},className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm hover:bg-blue-500/30",children:"Debug Performance Data"}),u.jsx("button",{onClick:async()=>{console.log("=== INICIANDO TEST COMPLETO ===");const T=localStorage.getItem("db_performance_data");console.log("1. LocalStorage performance_data:",T?JSON.parse(T):"null");const A=Object.values(s).flat().length;console.log("2. Estado actual de la app:",{clientsWithData:Object.keys(s),totalRecords:A,performanceData:s});try{const D=await ta.getPerformanceData(),S=Object.values(D).flat().length;console.log("3. Datos cargados desde DB:",{clientsWithData:Object.keys(D),totalRecords:S,loadedData:D});const H={localStorageHasData:!!T,appStateHasData:A>0,dbFunctionReturnsData:S>0,dataMatches:JSON.stringify(s)===JSON.stringify(D)};console.log("4. Comparación:",H),alert(`Test completo ejecutado. Ver consola para detalles.

Resumen:
- LocalStorage: ${H.localStorageHasData?"SÍ":"NO"} tiene datos
- App State: ${H.appStateHasData?"SÍ":"NO"} tiene datos
- DB Function: ${H.dbFunctionReturnsData?"SÍ":"NO"} retorna datos
- Datos coinciden: ${H.dataMatches?"SÍ":"NO"}`)}catch(D){console.error("Error en test:",D),alert("Error durante el test. Ver consola.")}console.log("=== FIN TEST COMPLETO ===")},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30",children:"Test Completo"}),u.jsx("button",{onClick:()=>{confirm("¿Recargar la página? Esto reiniciará el estado de la aplicación.")&&window.location.reload()},className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-sm hover:bg-blue-500/30",children:"Recargar Página"}),u.jsx("button",{onClick:async()=>{try{Nl.connected?(Je.info("La tabla de rendimiento ya está ONLINE."),alert("La tabla de rendimiento ya está ONLINE.")):(await Al.initialize(),await Al.savePerformanceData({}),localStorage.setItem("db_performance_data_storage","indexeddb"),Nl.connected=!0,Je.success("Tabla de rendimiento creada y marcada como ONLINE."),console.log("[DIAGNOSTICS] Tabla de rendimiento creada y ONLINE."),alert("Tabla de rendimiento creada correctamente y ONLINE."),await b())}catch(T){Je.error("Error creando la tabla de rendimiento.",{error:T}),console.error("[DIAGNOSTICS] Error creando la tabla de rendimiento:",T),alert("Error creando la tabla de rendimiento. Ver consola y log.")}},className:"px-3 py-1 bg-green-500/20 text-green-400 rounded text-sm hover:bg-green-500/30",children:"Crear tabla de rendimiento"})]})]})]})]})})},Ap=async(e,n,t,s,i)=>{const o=t==="es";return{creativeDescription:o?"Error: API Key no configurada.":"Error: API Key not set.",effectivenessScore:0,effectivenessJustification:o?"API Key no configurada.":"API Key not set.",clarityScore:0,clarityJustification:o?"API Key no configurada.":"API Key not set.",textToImageRatio:0,textToImageRatioJustification:o?"API Key no configurada.":"API Key not set.",funnelStage:"N/A",funnelStageJustification:o?"API Key no configurada.":"API Key not set.",recommendations:[],advantagePlusAnalysis:[],placementSummaries:[],overallConclusion:{headline:o?"Error de Configuración":"Configuration Error",checklist:[{severity:"CRITICAL",text:o?"La API Key de Gemini no está configurada. Por favor, asegúrate de que la variable de entorno API_KEY esté disponible.":"The Gemini API Key is not configured. Please ensure the API_KEY environment variable is available."}]}}},WN=()=>{const[e,n]=ue.useState(!1),[t,s]=ue.useState(null),[i,o]=ue.useState("creative_analysis"),[d,f]=ue.useState(!0),[x,m]=ue.useState(!1),[g,v]=ue.useState([]),[b,_]=ue.useState([]),[y,E]=ue.useState({}),[T,A]=ue.useState(null),[D,S]=ue.useState([]),[H,V]=ue.useState([]),[Y,j]=ue.useState([]),[J,z]=ue.useState({}),ie=new Date,K=new Date(ie);K.setDate(ie.getDate()-7);const[q,re]=ue.useState(K.toISOString().split("T")[0]),[pe,Ae]=ue.useState(ie.toISOString().split("T")[0]);ue.useEffect(()=>{(async()=>{Je.info("Application initializing..."),f(!0),Nl.connected=!0;try{const[R,W,me,ve,Te,Ee,Be,I,Pe]=await Promise.all([ta.getUsers(),ta.getClients(),ta.getLookerData(),ta.getLoggedInUser(),ta.getMetaApiConfig(),ta.getBitacoraReports(),ta.getUploadedVideos(),ta.getImportHistory(),ta.getPerformanceData()]);if(R.length===0){Je.warn("No users found in DB. Creating default Admin user.");const We={id:crypto.randomUUID(),username:"Admin",password:"Admin",role:"admin"};v([We]),await ta.saveUsers([We])}else v(R);_(W),E(me),A(Te),S(Ee),V(Be),j(I),z(Pe);const Ue=Object.values(Pe).flat().length;if(Je.success(`Loaded ${R.length} users, ${W.length} clients, ${Ue} performance records, and data for ${Object.keys(me).length} accounts.`),Ue>0){Je.info(`Performance data loaded for clients: ${Object.keys(Pe).join(", ")}`);for(const[We,Ve]of Object.entries(Pe))Je.info(`Client ${We}: ${Ve.length} performance records`)}else Je.warn("No performance data loaded from database!");ve&&(R.length>0?R:[{id:crypto.randomUUID(),username:"Admin",password:"Admin",role:"admin"}]).some(We=>We.id===ve.id)&&(Je.info(`Found logged in user: ${ve.username}`),s(ve),n(!0))}catch(R){const W=R instanceof Error?R.message:"Unknown DB error";Je.error("Failed to load data from database.",{error:W}),Nl.connected=!1,alert("Error crítico: No se pudieron cargar los datos de la base de datos.")}finally{f(!1)}})()},[]),ue.useEffect(()=>{g.length>0&&(ta.saveUsers(g),Je.info(`[PERSISTENCE] Saved ${g.length} users to DB`))},[g]),ue.useEffect(()=>{ta.saveClients(b),Je.info(`[PERSISTENCE] Saved ${b.length} clients to DB`)},[b]),ue.useEffect(()=>{ta.saveLookerData(y),Je.info(`[PERSISTENCE] Saved Looker data for ${Object.keys(y).length} clients to DB`)},[y]),ue.useEffect(()=>{T&&ta.saveMetaApiConfig(T)},[T]),ue.useEffect(()=>{ta.saveBitacoraReports(D),Je.info(`[PERSISTENCE] Saved ${D.length} bitácora reports to DB`)},[D]),ue.useEffect(()=>{ta.saveUploadedVideos(H),Je.info(`[PERSISTENCE] Saved ${H.length} uploaded videos to DB`)},[H]),ue.useEffect(()=>{ta.saveImportHistory(Y),Je.info(`[PERSISTENCE] Saved ${Y.length} import history records to DB`)},[Y]),ue.useEffect(()=>{const U=Object.values(J).flat().length;U>0||Object.keys(J).length>0?ta.savePerformanceData(J).then(()=>{Je.info(`[PERSISTENCE] Successfully saved ${U} performance records for ${Object.keys(J).length} clients to DB`);const R=Object.keys(J);R.length>0&&Je.info(`[PERSISTENCE] Clients with performance data: ${R.join(", ")}`)}).catch(R=>{Je.error("[PERSISTENCE] Failed to save performance data:",R)}):Je.warn(`[PERSISTENCE] No performance data to save (${U} records, ${Object.keys(J).length} clients)`)},[J]);const Z=ue.useMemo(()=>(t==null?void 0:t.role)==="admin"?b:t?b.filter(U=>U.userId===t.id):[],[b,t]),oe=ue.useCallback(async(U,R)=>"Error: API Key de Gemini no configurada.",[]),Re=ue.useCallback(async(U,R,W,me)=>({trends:[]}),[]),ee=ue.useCallback(async U=>{throw new Error("API Key de Gemini no configurada")},[]),P=async U=>{if(!T){alert("La configuración de la API de Meta no está definida.");return}const R=b.find(W=>W.id===U);if(!R||!R.metaAccountName){alert("El cliente seleccionado no tiene un 'Nombre de Cuenta de Meta' configurado.");return}f(!0);try{const W=await FN(T,R.metaAccountName),me=await sf(W,b,J,"meta",!1);if(!Array.isArray(me))throw new Error("La respuesta del procesador de datos no es válida.");if(me.length===0){alert("Sincronización completada. No se encontraron nuevos registros."),Je.info(`Synced from Meta API for client ${R.name}. No new records.`),f(!1);return}let ve=0;for(const Te of me){const{newRecordsCount:Ee,client:Be,records:I,undoKeys:Pe}=Te;if(Be&&Ee>0){ve+=Ee,z(Ve=>({...Ve,[Be.id]:[...Ve[Be.id]||[],...I]}));const Ue={source:"meta",fileName:`API Sync @ ${new Date().toLocaleString()}`,clientName:Be.name,description:`${Ee} filas sincronizadas desde la API`,undoData:{type:"meta",keys:Pe,clientId:Be.id}},We=await ta.getImportHistory();await ta.saveImportHistory([{...Ue,id:crypto.randomUUID(),timestamp:new Date().toISOString(),fileHash:`api_sync_${Date.now()}`},...We]),j(await ta.getImportHistory())}}alert(`Sincronización completada. Se añadieron ${ve} nuevos registros.`),ve>0&&Je.success(`Synced from Meta API. Added ${ve} records.`)}catch(W){const me=W instanceof Error?W.message:"Error desconocido";alert(`Error durante la sincronización: ${me}`),Je.error("Meta API sync failed",W)}finally{f(!1)}},ce=(U,R)=>{const W=g.find(me=>me.username===U&&me.password===R);return W?(Je.success(`User login successful: ${U}`),s(W),n(!0),ta.saveLoggedInUser(W),!0):(Je.warn(`User login failed for username: ${U}`),!1)},C=()=>{Je.info(`User logout: ${t==null?void 0:t.username}`),n(!1),s(null),ta.saveLoggedInUser(null),o("creative_analysis")},X=()=>d?u.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-brand-bg via-brand-bg to-slate-900 flex items-center justify-center z-50",children:u.jsxs("div",{className:"flex flex-col items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-brand-primary/30 rounded-full animate-pulse"}),u.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-transparent border-t-brand-primary rounded-full animate-spin"})]}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("p",{className:"text-xl font-bold text-brand-text animate-pulse",children:"Creative Assistant"}),u.jsx("p",{className:"text-sm text-brand-text-secondary",children:"Inicializando sistema de análisis IA..."})]}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-bg via-slate-900 to-brand-bg text-brand-text relative overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 opacity-5",children:u.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                                         radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.3) 0%, transparent 50%)`}})}),u.jsx("div",{className:"absolute top-10 left-10 w-32 h-32 bg-brand-primary/10 rounded-full blur-3xl animate-pulse"}),u.jsx("div",{className:"absolute bottom-10 right-10 w-40 h-40 bg-brand-accent/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),u.jsxs("div",{className:"relative z-10",children:[u.jsx("div",{className:"animate-slide-down",children:u.jsx(kb,{currentView:i,onNavigate:o,currentUser:t,onLogout:C,onOpenDiagnostics:()=>m(!0)})}),u.jsxs("main",{className:"animate-fade-in pt-24 lg:pt-20 px-4 sm:px-6 lg:px-8 pb-8",children:[i==="creative_analysis"&&u.jsx(YN,{clients:Z,getFormatAnalysis:Ap}),i==="performance"&&u.jsx(ay,{clients:Z,getPerformanceAnalysis:oe,getFormatAnalysis:Ap,lookerData:y,setLookerData:E,performanceData:J,uploadedVideos:H,setUploadedVideos:V,startDate:q,endDate:pe,onDateChange:(U,R)=>{re(U),Ae(R)}}),i==="strategies"&&u.jsx(yN,{clients:Z,lookerData:y,getTrendsAnalysis:Re,performanceData:J,startDate:q,endDate:pe,onDateChange:(U,R)=>{re(U),Ae(R)}}),i==="strategic_analysis"&&u.jsx(AN,{clients:Z,lookerData:y,performanceData:J,getStrategicAnalysis:ee,startDate:q,endDate:pe,onDateChange:(U,R)=>{re(U),Ae(R)}}),i==="reports"&&u.jsx(SN,{clients:Z,lookerData:y,bitacoraReports:D}),i==="settings"&&u.jsx(Cb,{metaApiConfig:T,setMetaApiConfig:A}),i==="control_panel"&&(t==null?void 0:t.role)==="admin"&&u.jsx(Db,{}),i==="clients"&&u.jsx(Lb,{clients:b,setClients:_,currentUser:t}),i==="import"&&(t==null?void 0:t.role)==="admin"&&u.jsx(hN,{clients:b,setClients:_,lookerData:y,setLookerData:E,performanceData:J,setPerformanceData:z,bitacoraReports:D,setBitacoraReports:S,onSyncFromMeta:P,metaApiConfig:T,currentUser:t}),i==="users"&&(t==null?void 0:t.role)==="admin"&&u.jsx(ny,{users:g,setUsers:v,currentUser:t}),i==="help"&&u.jsx(xN,{}),i==="logs"&&(t==null?void 0:t.role)==="admin"&&u.jsx(pN,{})]})]}),u.jsx(KN,{isOpen:x,onClose:()=>m(!1),clients:b,performanceData:J,lookerData:y,importHistory:Y})]});return e?X():u.jsx(ty,{onLogin:ce})},o2=document.getElementById("root");if(!o2)throw new Error("Could not find root element to mount to");const $N=Ab.createRoot(o2);$N.render(u.jsx(vb.StrictMode,{children:u.jsx(WN,{})}));
